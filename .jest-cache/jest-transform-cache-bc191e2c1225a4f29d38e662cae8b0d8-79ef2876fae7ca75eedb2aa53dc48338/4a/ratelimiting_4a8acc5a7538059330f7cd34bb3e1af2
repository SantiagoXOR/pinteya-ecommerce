4a537d84e7413537017c8f67fae9fd8e
/**
 * Sistema de Rate Limiting para APIs
 * Implementa límites de velocidad para prevenir ataques de fuerza bruta
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get RATE_LIMIT_CONFIGS () {
        return RATE_LIMIT_CONFIGS;
    },
    get checkRateLimit () {
        return checkRateLimit;
    },
    get clearRateLimit () {
        return clearRateLimit;
    },
    get getRateLimitStats () {
        return getRateLimitStats;
    },
    get withAdminRateLimit () {
        return withAdminRateLimit;
    },
    get withAuthRateLimit () {
        return withAuthRateLimit;
    },
    get withPaymentRateLimit () {
        return withPaymentRateLimit;
    },
    get withProductRateLimit () {
        return withProductRateLimit;
    },
    get withRateLimit () {
        return withRateLimit;
    }
});
const RATE_LIMIT_CONFIGS = {
    // APIs de autenticación - muy restrictivo
    auth: {
        windowMs: 15 * 60 * 1000,
        maxRequests: 5,
        message: 'Demasiados intentos de autenticación. Intenta de nuevo en 15 minutos.'
    },
    // APIs admin - restrictivo
    admin: {
        windowMs: 5 * 60 * 1000,
        maxRequests: 30,
        message: 'Demasiadas requests administrativas. Intenta de nuevo en 5 minutos.'
    },
    // APIs de productos - moderado
    products: {
        windowMs: 1 * 60 * 1000,
        maxRequests: 60,
        message: 'Demasiadas requests de productos. Intenta de nuevo en 1 minuto.'
    },
    // APIs de pagos - muy restrictivo
    payments: {
        windowMs: 10 * 60 * 1000,
        maxRequests: 10,
        message: 'Demasiadas requests de pagos. Intenta de nuevo en 10 minutos.'
    },
    // APIs generales - permisivo
    general: {
        windowMs: 1 * 60 * 1000,
        maxRequests: 100,
        message: 'Demasiadas requests. Intenta de nuevo en 1 minuto.'
    }
};
// =====================================================
// ALMACENAMIENTO EN MEMORIA (Compatible con Edge Runtime)
// =====================================================
const rateLimitStore = new Map();
// Limpiar entradas expiradas cada 5 minutos
// Solo en Node.js runtime, no en Edge Runtime
if (typeof setInterval !== 'undefined' && typeof process !== 'undefined' && process.env.NODE_ENV !== 'production') {
    setInterval(()=>{
        const now = Date.now();
        for (const [key, entry] of rateLimitStore.entries()){
            if (entry.resetTime < now) {
                rateLimitStore.delete(key);
            }
        }
    }, 5 * 60 * 1000);
}
// =====================================================
// FUNCIONES DE RATE LIMITING
// =====================================================
/**
 * Genera una clave única para el rate limiting
 */ function generateRateLimitKey(request, prefix = 'default') {
    // Obtener IP del cliente
    let clientIP = 'unknown';
    if ('ip' in request && request.ip) {
        clientIP = request.ip;
    } else if ('headers' in request) {
        // Intentar obtener IP de headers
        const forwarded = getHeader(request, 'x-forwarded-for');
        const realIP = getHeader(request, 'x-real-ip');
        const cfIP = getHeader(request, 'cf-connecting-ip');
        clientIP = forwarded?.split(',')[0] || realIP || cfIP || 'unknown';
    }
    // Obtener User-Agent para mayor especificidad
    const userAgent = getHeader(request, 'user-agent') || 'unknown';
    const userAgentHash = hashString(userAgent);
    return `${prefix}:${clientIP}:${userAgentHash}`;
}
/**
 * Obtiene un header de manera compatible
 */ function getHeader(request, headerName) {
    if ('headers' in request && typeof request.headers.get === 'function') {
        return request.headers.get(headerName);
    } else if ('headers' in request) {
        const header = request.headers[headerName];
        return Array.isArray(header) ? header[0] : header || null;
    }
    return null;
}
/**
 * Hash simple para User-Agent
 */ function hashString(str) {
    let hash = 0;
    for(let i = 0; i < str.length; i++){
        const char = str.charCodeAt(i);
        hash = (hash << 5) - hash + char;
        hash = hash & hash; // Convertir a 32-bit integer
    }
    return Math.abs(hash).toString(36);
}
async function checkRateLimit(request, config, keyPrefix = 'api') {
    try {
        const now = Date.now();
        const key = config.keyGenerator ? config.keyGenerator(request) : generateRateLimitKey(request, keyPrefix);
        // Obtener entrada actual o crear nueva
        let entry = rateLimitStore.get(key);
        if (!entry || entry.resetTime < now) {
            // Crear nueva entrada
            entry = {
                count: 1,
                resetTime: now + config.windowMs,
                firstRequest: now
            };
            rateLimitStore.set(key, entry);
            return {
                allowed: true,
                limit: config.maxRequests,
                remaining: config.maxRequests - 1,
                resetTime: entry.resetTime
            };
        }
        // Incrementar contador
        entry.count++;
        rateLimitStore.set(key, entry);
        // Verificar si excede el límite
        if (entry.count > config.maxRequests) {
            const retryAfter = Math.ceil((entry.resetTime - now) / 1000);
            return {
                allowed: false,
                limit: config.maxRequests,
                remaining: 0,
                resetTime: entry.resetTime,
                retryAfter,
                error: config.message || 'Rate limit exceeded',
                code: 'RATE_LIMIT_EXCEEDED'
            };
        }
        return {
            allowed: true,
            limit: config.maxRequests,
            remaining: config.maxRequests - entry.count,
            resetTime: entry.resetTime
        };
    } catch (error) {
        console.error('[RATE_LIMIT] Error en verificación:', error);
        // En caso de error, permitir la request pero loggear
        return {
            allowed: true,
            limit: config.maxRequests,
            remaining: config.maxRequests,
            resetTime: Date.now() + config.windowMs,
            error: 'Error interno en rate limiting'
        };
    }
}
function withRateLimit(configName, customConfig) {
    const baseConfig = RATE_LIMIT_CONFIGS[configName];
    const config = {
        ...baseConfig,
        ...customConfig
    };
    return function(handler) {
        return async (request, ...args)=>{
            try {
                const rateLimitResult = await checkRateLimit(request, config, configName);
                // Añadir headers de rate limiting
                const headers = {
                    'X-RateLimit-Limit': rateLimitResult.limit.toString(),
                    'X-RateLimit-Remaining': rateLimitResult.remaining.toString(),
                    'X-RateLimit-Reset': Math.ceil(rateLimitResult.resetTime / 1000).toString()
                };
                if (rateLimitResult.retryAfter) {
                    headers['Retry-After'] = rateLimitResult.retryAfter.toString();
                }
                if (!rateLimitResult.allowed) {
                    const errorResponse = {
                        success: false,
                        error: rateLimitResult.error,
                        code: rateLimitResult.code,
                        rateLimit: {
                            limit: rateLimitResult.limit,
                            remaining: rateLimitResult.remaining,
                            resetTime: rateLimitResult.resetTime,
                            retryAfter: rateLimitResult.retryAfter
                        }
                    };
                    if ('query' in request) {
                        // Pages Router
                        const res = args[0];
                        Object.entries(headers).forEach(([key, value])=>{
                            res.setHeader(key, value);
                        });
                        return res.status(429).json(errorResponse);
                    } else {
                        // App Router
                        return new Response(JSON.stringify(errorResponse), {
                            status: 429,
                            headers: {
                                'Content-Type': 'application/json',
                                ...headers
                            }
                        });
                    }
                }
                // Añadir información de rate limiting al request
                request.rateLimit = rateLimitResult;
                // Ejecutar handler original
                const response = await handler(request, ...args);
                // Añadir headers a la respuesta si es posible
                if (response && typeof response.headers?.set === 'function') {
                    Object.entries(headers).forEach(([key, value])=>{
                        response.headers.set(key, value);
                    });
                }
                return response;
            } catch (error) {
                console.error('[RATE_LIMIT] Error en middleware:', error);
                return handler(request, ...args);
            }
        };
    };
}
function withAuthRateLimit() {
    return withRateLimit('auth');
}
function withAdminRateLimit() {
    return withRateLimit('admin');
}
function withProductRateLimit() {
    return withRateLimit('products');
}
function withPaymentRateLimit() {
    return withRateLimit('payments');
}
function clearRateLimit(key) {
    return rateLimitStore.delete(key);
}
function getRateLimitStats() {
    const now = Date.now();
    const entries = Array.from(rateLimitStore.values());
    const activeEntries = entries.filter((entry)=>entry.resetTime > now);
    return {
        totalKeys: rateLimitStore.size,
        activeEntries: activeEntries.length,
        oldestEntry: entries.length > 0 ? Math.min(...entries.map((e)=>e.firstRequest)) : null,
        newestEntry: entries.length > 0 ? Math.max(...entries.map((e)=>e.firstRequest)) : null
    };
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcbGliXFxhdXRoXFxyYXRlLWxpbWl0aW5nLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU2lzdGVtYSBkZSBSYXRlIExpbWl0aW5nIHBhcmEgQVBJc1xuICogSW1wbGVtZW50YSBsw61taXRlcyBkZSB2ZWxvY2lkYWQgcGFyYSBwcmV2ZW5pciBhdGFxdWVzIGRlIGZ1ZXJ6YSBicnV0YVxuICovXG5cbmltcG9ydCB7IE5leHRSZXF1ZXN0IH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHR5cGUgeyBOZXh0QXBpUmVxdWVzdCB9IGZyb20gJ25leHQnO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gVElQT1MgWSBJTlRFUkZBQ0VTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgaW50ZXJmYWNlIFJhdGVMaW1pdFJlc3VsdCB7XG4gIGFsbG93ZWQ6IGJvb2xlYW47XG4gIGxpbWl0OiBudW1iZXI7XG4gIHJlbWFpbmluZzogbnVtYmVyO1xuICByZXNldFRpbWU6IG51bWJlcjtcbiAgcmV0cnlBZnRlcj86IG51bWJlcjtcbiAgZXJyb3I/OiBzdHJpbmc7XG4gIGNvZGU/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmF0ZUxpbWl0Q29uZmlnIHtcbiAgd2luZG93TXM6IG51bWJlcjsgIC8vIFZlbnRhbmEgZGUgdGllbXBvIGVuIG1pbGlzZWd1bmRvc1xuICBtYXhSZXF1ZXN0czogbnVtYmVyOyAgLy8gTcOheGltbyBuw7ptZXJvIGRlIHJlcXVlc3RzIHBvciB2ZW50YW5hXG4gIGtleUdlbmVyYXRvcj86IChyZXF1ZXN0OiBOZXh0UmVxdWVzdCB8IE5leHRBcGlSZXF1ZXN0KSA9PiBzdHJpbmc7XG4gIHNraXBTdWNjZXNzZnVsUmVxdWVzdHM/OiBib29sZWFuO1xuICBza2lwRmFpbGVkUmVxdWVzdHM/OiBib29sZWFuO1xuICBtZXNzYWdlPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJhdGVMaW1pdEVudHJ5IHtcbiAgY291bnQ6IG51bWJlcjtcbiAgcmVzZXRUaW1lOiBudW1iZXI7XG4gIGZpcnN0UmVxdWVzdDogbnVtYmVyO1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQ09ORklHVVJBQ0lPTkVTIERFIFJBVEUgTElNSVRJTkdcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBjb25zdCBSQVRFX0xJTUlUX0NPTkZJR1MgPSB7XG4gIC8vIEFQSXMgZGUgYXV0ZW50aWNhY2nDs24gLSBtdXkgcmVzdHJpY3Rpdm9cbiAgYXV0aDoge1xuICAgIHdpbmRvd01zOiAxNSAqIDYwICogMTAwMCwgLy8gMTUgbWludXRvc1xuICAgIG1heFJlcXVlc3RzOiA1LCAvLyA1IGludGVudG9zIHBvciAxNSBtaW51dG9zXG4gICAgbWVzc2FnZTogJ0RlbWFzaWFkb3MgaW50ZW50b3MgZGUgYXV0ZW50aWNhY2nDs24uIEludGVudGEgZGUgbnVldm8gZW4gMTUgbWludXRvcy4nXG4gIH0sXG4gIFxuICAvLyBBUElzIGFkbWluIC0gcmVzdHJpY3Rpdm9cbiAgYWRtaW46IHtcbiAgICB3aW5kb3dNczogNSAqIDYwICogMTAwMCwgLy8gNSBtaW51dG9zXG4gICAgbWF4UmVxdWVzdHM6IDMwLCAvLyAzMCByZXF1ZXN0cyBwb3IgNSBtaW51dG9zXG4gICAgbWVzc2FnZTogJ0RlbWFzaWFkYXMgcmVxdWVzdHMgYWRtaW5pc3RyYXRpdmFzLiBJbnRlbnRhIGRlIG51ZXZvIGVuIDUgbWludXRvcy4nXG4gIH0sXG4gIFxuICAvLyBBUElzIGRlIHByb2R1Y3RvcyAtIG1vZGVyYWRvXG4gIHByb2R1Y3RzOiB7XG4gICAgd2luZG93TXM6IDEgKiA2MCAqIDEwMDAsIC8vIDEgbWludXRvXG4gICAgbWF4UmVxdWVzdHM6IDYwLCAvLyA2MCByZXF1ZXN0cyBwb3IgbWludXRvXG4gICAgbWVzc2FnZTogJ0RlbWFzaWFkYXMgcmVxdWVzdHMgZGUgcHJvZHVjdG9zLiBJbnRlbnRhIGRlIG51ZXZvIGVuIDEgbWludXRvLidcbiAgfSxcbiAgXG4gIC8vIEFQSXMgZGUgcGFnb3MgLSBtdXkgcmVzdHJpY3Rpdm9cbiAgcGF5bWVudHM6IHtcbiAgICB3aW5kb3dNczogMTAgKiA2MCAqIDEwMDAsIC8vIDEwIG1pbnV0b3NcbiAgICBtYXhSZXF1ZXN0czogMTAsIC8vIDEwIHJlcXVlc3RzIHBvciAxMCBtaW51dG9zXG4gICAgbWVzc2FnZTogJ0RlbWFzaWFkYXMgcmVxdWVzdHMgZGUgcGFnb3MuIEludGVudGEgZGUgbnVldm8gZW4gMTAgbWludXRvcy4nXG4gIH0sXG4gIFxuICAvLyBBUElzIGdlbmVyYWxlcyAtIHBlcm1pc2l2b1xuICBnZW5lcmFsOiB7XG4gICAgd2luZG93TXM6IDEgKiA2MCAqIDEwMDAsIC8vIDEgbWludXRvXG4gICAgbWF4UmVxdWVzdHM6IDEwMCwgLy8gMTAwIHJlcXVlc3RzIHBvciBtaW51dG9cbiAgICBtZXNzYWdlOiAnRGVtYXNpYWRhcyByZXF1ZXN0cy4gSW50ZW50YSBkZSBudWV2byBlbiAxIG1pbnV0by4nXG4gIH1cbn07XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBBTE1BQ0VOQU1JRU5UTyBFTiBNRU1PUklBIChDb21wYXRpYmxlIGNvbiBFZGdlIFJ1bnRpbWUpXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5jb25zdCByYXRlTGltaXRTdG9yZSA9IG5ldyBNYXA8c3RyaW5nLCBSYXRlTGltaXRFbnRyeT4oKTtcblxuLy8gTGltcGlhciBlbnRyYWRhcyBleHBpcmFkYXMgY2FkYSA1IG1pbnV0b3Ncbi8vIFNvbG8gZW4gTm9kZS5qcyBydW50aW1lLCBubyBlbiBFZGdlIFJ1bnRpbWVcbmlmICh0eXBlb2Ygc2V0SW50ZXJ2YWwgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gIHNldEludGVydmFsKCgpID0+IHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGZvciAoY29uc3QgW2tleSwgZW50cnldIG9mIHJhdGVMaW1pdFN0b3JlLmVudHJpZXMoKSkge1xuICAgICAgaWYgKGVudHJ5LnJlc2V0VGltZSA8IG5vdykge1xuICAgICAgICByYXRlTGltaXRTdG9yZS5kZWxldGUoa2V5KTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIDUgKiA2MCAqIDEwMDApO1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRlVOQ0lPTkVTIERFIFJBVEUgTElNSVRJTkdcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogR2VuZXJhIHVuYSBjbGF2ZSDDum5pY2EgcGFyYSBlbCByYXRlIGxpbWl0aW5nXG4gKi9cbmZ1bmN0aW9uIGdlbmVyYXRlUmF0ZUxpbWl0S2V5KFxuICByZXF1ZXN0OiBOZXh0UmVxdWVzdCB8IE5leHRBcGlSZXF1ZXN0LFxuICBwcmVmaXg6IHN0cmluZyA9ICdkZWZhdWx0J1xuKTogc3RyaW5nIHtcbiAgLy8gT2J0ZW5lciBJUCBkZWwgY2xpZW50ZVxuICBsZXQgY2xpZW50SVAgPSAndW5rbm93bic7XG4gIFxuICBpZiAoJ2lwJyBpbiByZXF1ZXN0ICYmIHJlcXVlc3QuaXApIHtcbiAgICBjbGllbnRJUCA9IHJlcXVlc3QuaXA7XG4gIH0gZWxzZSBpZiAoJ2hlYWRlcnMnIGluIHJlcXVlc3QpIHtcbiAgICAvLyBJbnRlbnRhciBvYnRlbmVyIElQIGRlIGhlYWRlcnNcbiAgICBjb25zdCBmb3J3YXJkZWQgPSBnZXRIZWFkZXIocmVxdWVzdCwgJ3gtZm9yd2FyZGVkLWZvcicpO1xuICAgIGNvbnN0IHJlYWxJUCA9IGdldEhlYWRlcihyZXF1ZXN0LCAneC1yZWFsLWlwJyk7XG4gICAgY29uc3QgY2ZJUCA9IGdldEhlYWRlcihyZXF1ZXN0LCAnY2YtY29ubmVjdGluZy1pcCcpO1xuICAgIFxuICAgIGNsaWVudElQID0gZm9yd2FyZGVkPy5zcGxpdCgnLCcpWzBdIHx8IHJlYWxJUCB8fCBjZklQIHx8ICd1bmtub3duJztcbiAgfVxuXG4gIC8vIE9idGVuZXIgVXNlci1BZ2VudCBwYXJhIG1heW9yIGVzcGVjaWZpY2lkYWRcbiAgY29uc3QgdXNlckFnZW50ID0gZ2V0SGVhZGVyKHJlcXVlc3QsICd1c2VyLWFnZW50JykgfHwgJ3Vua25vd24nO1xuICBjb25zdCB1c2VyQWdlbnRIYXNoID0gaGFzaFN0cmluZyh1c2VyQWdlbnQpO1xuXG4gIHJldHVybiBgJHtwcmVmaXh9OiR7Y2xpZW50SVB9OiR7dXNlckFnZW50SGFzaH1gO1xufVxuXG4vKipcbiAqIE9idGllbmUgdW4gaGVhZGVyIGRlIG1hbmVyYSBjb21wYXRpYmxlXG4gKi9cbmZ1bmN0aW9uIGdldEhlYWRlcihcbiAgcmVxdWVzdDogTmV4dFJlcXVlc3QgfCBOZXh0QXBpUmVxdWVzdCxcbiAgaGVhZGVyTmFtZTogc3RyaW5nXG4pOiBzdHJpbmcgfCBudWxsIHtcbiAgaWYgKCdoZWFkZXJzJyBpbiByZXF1ZXN0ICYmIHR5cGVvZiByZXF1ZXN0LmhlYWRlcnMuZ2V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgcmV0dXJuIChyZXF1ZXN0IGFzIE5leHRSZXF1ZXN0KS5oZWFkZXJzLmdldChoZWFkZXJOYW1lKTtcbiAgfSBlbHNlIGlmICgnaGVhZGVycycgaW4gcmVxdWVzdCkge1xuICAgIGNvbnN0IGhlYWRlciA9IChyZXF1ZXN0IGFzIE5leHRBcGlSZXF1ZXN0KS5oZWFkZXJzW2hlYWRlck5hbWVdO1xuICAgIHJldHVybiBBcnJheS5pc0FycmF5KGhlYWRlcikgPyBoZWFkZXJbMF0gOiBoZWFkZXIgfHwgbnVsbDtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBIYXNoIHNpbXBsZSBwYXJhIFVzZXItQWdlbnRcbiAqL1xuZnVuY3Rpb24gaGFzaFN0cmluZyhzdHI6IHN0cmluZyk6IHN0cmluZyB7XG4gIGxldCBoYXNoID0gMDtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBjaGFyID0gc3RyLmNoYXJDb2RlQXQoaSk7XG4gICAgaGFzaCA9ICgoaGFzaCA8PCA1KSAtIGhhc2gpICsgY2hhcjtcbiAgICBoYXNoID0gaGFzaCAmIGhhc2g7IC8vIENvbnZlcnRpciBhIDMyLWJpdCBpbnRlZ2VyXG4gIH1cbiAgcmV0dXJuIE1hdGguYWJzKGhhc2gpLnRvU3RyaW5nKDM2KTtcbn1cblxuLyoqXG4gKiBWZXJpZmljYSBzaSB1bmEgcmVxdWVzdCBlc3TDoSBkZW50cm8gZGUgbG9zIGzDrW1pdGVzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja1JhdGVMaW1pdChcbiAgcmVxdWVzdDogTmV4dFJlcXVlc3QgfCBOZXh0QXBpUmVxdWVzdCxcbiAgY29uZmlnOiBSYXRlTGltaXRDb25maWcsXG4gIGtleVByZWZpeDogc3RyaW5nID0gJ2FwaSdcbik6IFByb21pc2U8UmF0ZUxpbWl0UmVzdWx0PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICBjb25zdCBrZXkgPSBjb25maWcua2V5R2VuZXJhdG9yIFxuICAgICAgPyBjb25maWcua2V5R2VuZXJhdG9yKHJlcXVlc3QpXG4gICAgICA6IGdlbmVyYXRlUmF0ZUxpbWl0S2V5KHJlcXVlc3QsIGtleVByZWZpeCk7XG5cbiAgICAvLyBPYnRlbmVyIGVudHJhZGEgYWN0dWFsIG8gY3JlYXIgbnVldmFcbiAgICBsZXQgZW50cnkgPSByYXRlTGltaXRTdG9yZS5nZXQoa2V5KTtcbiAgICBcbiAgICBpZiAoIWVudHJ5IHx8IGVudHJ5LnJlc2V0VGltZSA8IG5vdykge1xuICAgICAgLy8gQ3JlYXIgbnVldmEgZW50cmFkYVxuICAgICAgZW50cnkgPSB7XG4gICAgICAgIGNvdW50OiAxLFxuICAgICAgICByZXNldFRpbWU6IG5vdyArIGNvbmZpZy53aW5kb3dNcyxcbiAgICAgICAgZmlyc3RSZXF1ZXN0OiBub3dcbiAgICAgIH07XG4gICAgICByYXRlTGltaXRTdG9yZS5zZXQoa2V5LCBlbnRyeSk7XG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFsbG93ZWQ6IHRydWUsXG4gICAgICAgIGxpbWl0OiBjb25maWcubWF4UmVxdWVzdHMsXG4gICAgICAgIHJlbWFpbmluZzogY29uZmlnLm1heFJlcXVlc3RzIC0gMSxcbiAgICAgICAgcmVzZXRUaW1lOiBlbnRyeS5yZXNldFRpbWVcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gSW5jcmVtZW50YXIgY29udGFkb3JcbiAgICBlbnRyeS5jb3VudCsrO1xuICAgIHJhdGVMaW1pdFN0b3JlLnNldChrZXksIGVudHJ5KTtcblxuICAgIC8vIFZlcmlmaWNhciBzaSBleGNlZGUgZWwgbMOtbWl0ZVxuICAgIGlmIChlbnRyeS5jb3VudCA+IGNvbmZpZy5tYXhSZXF1ZXN0cykge1xuICAgICAgY29uc3QgcmV0cnlBZnRlciA9IE1hdGguY2VpbCgoZW50cnkucmVzZXRUaW1lIC0gbm93KSAvIDEwMDApO1xuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICBhbGxvd2VkOiBmYWxzZSxcbiAgICAgICAgbGltaXQ6IGNvbmZpZy5tYXhSZXF1ZXN0cyxcbiAgICAgICAgcmVtYWluaW5nOiAwLFxuICAgICAgICByZXNldFRpbWU6IGVudHJ5LnJlc2V0VGltZSxcbiAgICAgICAgcmV0cnlBZnRlcixcbiAgICAgICAgZXJyb3I6IGNvbmZpZy5tZXNzYWdlIHx8ICdSYXRlIGxpbWl0IGV4Y2VlZGVkJyxcbiAgICAgICAgY29kZTogJ1JBVEVfTElNSVRfRVhDRUVERUQnXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBhbGxvd2VkOiB0cnVlLFxuICAgICAgbGltaXQ6IGNvbmZpZy5tYXhSZXF1ZXN0cyxcbiAgICAgIHJlbWFpbmluZzogY29uZmlnLm1heFJlcXVlc3RzIC0gZW50cnkuY291bnQsXG4gICAgICByZXNldFRpbWU6IGVudHJ5LnJlc2V0VGltZVxuICAgIH07XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbUkFURV9MSU1JVF0gRXJyb3IgZW4gdmVyaWZpY2FjacOzbjonLCBlcnJvcik7XG4gICAgXG4gICAgLy8gRW4gY2FzbyBkZSBlcnJvciwgcGVybWl0aXIgbGEgcmVxdWVzdCBwZXJvIGxvZ2dlYXJcbiAgICByZXR1cm4ge1xuICAgICAgYWxsb3dlZDogdHJ1ZSxcbiAgICAgIGxpbWl0OiBjb25maWcubWF4UmVxdWVzdHMsXG4gICAgICByZW1haW5pbmc6IGNvbmZpZy5tYXhSZXF1ZXN0cyxcbiAgICAgIHJlc2V0VGltZTogRGF0ZS5ub3coKSArIGNvbmZpZy53aW5kb3dNcyxcbiAgICAgIGVycm9yOiAnRXJyb3IgaW50ZXJubyBlbiByYXRlIGxpbWl0aW5nJ1xuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBNaWRkbGV3YXJlIGRlIHJhdGUgbGltaXRpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhSYXRlTGltaXQoXG4gIGNvbmZpZ05hbWU6IGtleW9mIHR5cGVvZiBSQVRFX0xJTUlUX0NPTkZJR1MsXG4gIGN1c3RvbUNvbmZpZz86IFBhcnRpYWw8UmF0ZUxpbWl0Q29uZmlnPlxuKSB7XG4gIGNvbnN0IGJhc2VDb25maWcgPSBSQVRFX0xJTUlUX0NPTkZJR1NbY29uZmlnTmFtZV07XG4gIGNvbnN0IGNvbmZpZyA9IHsgLi4uYmFzZUNvbmZpZywgLi4uY3VzdG9tQ29uZmlnIH07XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIChoYW5kbGVyOiBGdW5jdGlvbikge1xuICAgIHJldHVybiBhc3luYyAocmVxdWVzdDogTmV4dFJlcXVlc3QgfCBOZXh0QXBpUmVxdWVzdCwgLi4uYXJnczogYW55W10pID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJhdGVMaW1pdFJlc3VsdCA9IGF3YWl0IGNoZWNrUmF0ZUxpbWl0KHJlcXVlc3QsIGNvbmZpZywgY29uZmlnTmFtZSk7XG4gICAgICAgIFxuICAgICAgICAvLyBBw7FhZGlyIGhlYWRlcnMgZGUgcmF0ZSBsaW1pdGluZ1xuICAgICAgICBjb25zdCBoZWFkZXJzID0ge1xuICAgICAgICAgICdYLVJhdGVMaW1pdC1MaW1pdCc6IHJhdGVMaW1pdFJlc3VsdC5saW1pdC50b1N0cmluZygpLFxuICAgICAgICAgICdYLVJhdGVMaW1pdC1SZW1haW5pbmcnOiByYXRlTGltaXRSZXN1bHQucmVtYWluaW5nLnRvU3RyaW5nKCksXG4gICAgICAgICAgJ1gtUmF0ZUxpbWl0LVJlc2V0JzogTWF0aC5jZWlsKHJhdGVMaW1pdFJlc3VsdC5yZXNldFRpbWUgLyAxMDAwKS50b1N0cmluZygpXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHJhdGVMaW1pdFJlc3VsdC5yZXRyeUFmdGVyKSB7XG4gICAgICAgICAgaGVhZGVyc1snUmV0cnktQWZ0ZXInXSA9IHJhdGVMaW1pdFJlc3VsdC5yZXRyeUFmdGVyLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXJhdGVMaW1pdFJlc3VsdC5hbGxvd2VkKSB7XG4gICAgICAgICAgY29uc3QgZXJyb3JSZXNwb25zZSA9IHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgZXJyb3I6IHJhdGVMaW1pdFJlc3VsdC5lcnJvcixcbiAgICAgICAgICAgIGNvZGU6IHJhdGVMaW1pdFJlc3VsdC5jb2RlLFxuICAgICAgICAgICAgcmF0ZUxpbWl0OiB7XG4gICAgICAgICAgICAgIGxpbWl0OiByYXRlTGltaXRSZXN1bHQubGltaXQsXG4gICAgICAgICAgICAgIHJlbWFpbmluZzogcmF0ZUxpbWl0UmVzdWx0LnJlbWFpbmluZyxcbiAgICAgICAgICAgICAgcmVzZXRUaW1lOiByYXRlTGltaXRSZXN1bHQucmVzZXRUaW1lLFxuICAgICAgICAgICAgICByZXRyeUFmdGVyOiByYXRlTGltaXRSZXN1bHQucmV0cnlBZnRlclxuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBpZiAoJ3F1ZXJ5JyBpbiByZXF1ZXN0KSB7XG4gICAgICAgICAgICAvLyBQYWdlcyBSb3V0ZXJcbiAgICAgICAgICAgIGNvbnN0IHJlcyA9IGFyZ3NbMF0gYXMgYW55O1xuICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMoaGVhZGVycykuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgICAgICAgIHJlcy5zZXRIZWFkZXIoa2V5LCB2YWx1ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQyOSkuanNvbihlcnJvclJlc3BvbnNlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gQXBwIFJvdXRlclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShKU09OLnN0cmluZ2lmeShlcnJvclJlc3BvbnNlKSwge1xuICAgICAgICAgICAgICBzdGF0dXM6IDQyOSxcbiAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgLi4uaGVhZGVyc1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBw7FhZGlyIGluZm9ybWFjacOzbiBkZSByYXRlIGxpbWl0aW5nIGFsIHJlcXVlc3RcbiAgICAgICAgKHJlcXVlc3QgYXMgYW55KS5yYXRlTGltaXQgPSByYXRlTGltaXRSZXN1bHQ7XG5cbiAgICAgICAgLy8gRWplY3V0YXIgaGFuZGxlciBvcmlnaW5hbFxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGhhbmRsZXIocmVxdWVzdCwgLi4uYXJncyk7XG5cbiAgICAgICAgLy8gQcOxYWRpciBoZWFkZXJzIGEgbGEgcmVzcHVlc3RhIHNpIGVzIHBvc2libGVcbiAgICAgICAgaWYgKHJlc3BvbnNlICYmIHR5cGVvZiByZXNwb25zZS5oZWFkZXJzPy5zZXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICBPYmplY3QuZW50cmllcyhoZWFkZXJzKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgICAgICAgIHJlc3BvbnNlLmhlYWRlcnMuc2V0KGtleSwgdmFsdWUpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xuXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbUkFURV9MSU1JVF0gRXJyb3IgZW4gbWlkZGxld2FyZTonLCBlcnJvcik7XG4gICAgICAgIHJldHVybiBoYW5kbGVyKHJlcXVlc3QsIC4uLmFyZ3MpO1xuICAgICAgfVxuICAgIH07XG4gIH07XG59XG5cbi8qKlxuICogUmF0ZSBsaW1pdGluZyBlc3BlY8OtZmljbyBwYXJhIEFQSXMgZGUgYXV0ZW50aWNhY2nDs25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhBdXRoUmF0ZUxpbWl0KCkge1xuICByZXR1cm4gd2l0aFJhdGVMaW1pdCgnYXV0aCcpO1xufVxuXG4vKipcbiAqIFJhdGUgbGltaXRpbmcgZXNwZWPDrWZpY28gcGFyYSBBUElzIGFkbWluXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoQWRtaW5SYXRlTGltaXQoKSB7XG4gIHJldHVybiB3aXRoUmF0ZUxpbWl0KCdhZG1pbicpO1xufVxuXG4vKipcbiAqIFJhdGUgbGltaXRpbmcgZXNwZWPDrWZpY28gcGFyYSBBUElzIGRlIHByb2R1Y3Rvc1xuICovXG5leHBvcnQgZnVuY3Rpb24gd2l0aFByb2R1Y3RSYXRlTGltaXQoKSB7XG4gIHJldHVybiB3aXRoUmF0ZUxpbWl0KCdwcm9kdWN0cycpO1xufVxuXG4vKipcbiAqIFJhdGUgbGltaXRpbmcgZXNwZWPDrWZpY28gcGFyYSBBUElzIGRlIHBhZ29zXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoUGF5bWVudFJhdGVMaW1pdCgpIHtcbiAgcmV0dXJuIHdpdGhSYXRlTGltaXQoJ3BheW1lbnRzJyk7XG59XG5cbi8qKlxuICogRnVuY2nDs24gcGFyYSBsaW1waWFyIG1hbnVhbG1lbnRlIGVsIHJhdGUgbGltaXQgZGUgdW5hIGNsYXZlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbGVhclJhdGVMaW1pdChrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuICByZXR1cm4gcmF0ZUxpbWl0U3RvcmUuZGVsZXRlKGtleSk7XG59XG5cbi8qKlxuICogRnVuY2nDs24gcGFyYSBvYnRlbmVyIGVzdGFkw61zdGljYXMgZGUgcmF0ZSBsaW1pdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmF0ZUxpbWl0U3RhdHMoKToge1xuICB0b3RhbEtleXM6IG51bWJlcjtcbiAgYWN0aXZlRW50cmllczogbnVtYmVyO1xuICBvbGRlc3RFbnRyeTogbnVtYmVyIHwgbnVsbDtcbiAgbmV3ZXN0RW50cnk6IG51bWJlciB8IG51bGw7XG59IHtcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgY29uc3QgZW50cmllcyA9IEFycmF5LmZyb20ocmF0ZUxpbWl0U3RvcmUudmFsdWVzKCkpO1xuICBjb25zdCBhY3RpdmVFbnRyaWVzID0gZW50cmllcy5maWx0ZXIoZW50cnkgPT4gZW50cnkucmVzZXRUaW1lID4gbm93KTtcbiAgXG4gIHJldHVybiB7XG4gICAgdG90YWxLZXlzOiByYXRlTGltaXRTdG9yZS5zaXplLFxuICAgIGFjdGl2ZUVudHJpZXM6IGFjdGl2ZUVudHJpZXMubGVuZ3RoLFxuICAgIG9sZGVzdEVudHJ5OiBlbnRyaWVzLmxlbmd0aCA+IDAgPyBNYXRoLm1pbiguLi5lbnRyaWVzLm1hcChlID0+IGUuZmlyc3RSZXF1ZXN0KSkgOiBudWxsLFxuICAgIG5ld2VzdEVudHJ5OiBlbnRyaWVzLmxlbmd0aCA+IDAgPyBNYXRoLm1heCguLi5lbnRyaWVzLm1hcChlID0+IGUuZmlyc3RSZXF1ZXN0KSkgOiBudWxsXG4gIH07XG59XG4iXSwibmFtZXMiOlsiUkFURV9MSU1JVF9DT05GSUdTIiwiY2hlY2tSYXRlTGltaXQiLCJjbGVhclJhdGVMaW1pdCIsImdldFJhdGVMaW1pdFN0YXRzIiwid2l0aEFkbWluUmF0ZUxpbWl0Iiwid2l0aEF1dGhSYXRlTGltaXQiLCJ3aXRoUGF5bWVudFJhdGVMaW1pdCIsIndpdGhQcm9kdWN0UmF0ZUxpbWl0Iiwid2l0aFJhdGVMaW1pdCIsImF1dGgiLCJ3aW5kb3dNcyIsIm1heFJlcXVlc3RzIiwibWVzc2FnZSIsImFkbWluIiwicHJvZHVjdHMiLCJwYXltZW50cyIsImdlbmVyYWwiLCJyYXRlTGltaXRTdG9yZSIsIk1hcCIsInNldEludGVydmFsIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwibm93IiwiRGF0ZSIsImtleSIsImVudHJ5IiwiZW50cmllcyIsInJlc2V0VGltZSIsImRlbGV0ZSIsImdlbmVyYXRlUmF0ZUxpbWl0S2V5IiwicmVxdWVzdCIsInByZWZpeCIsImNsaWVudElQIiwiaXAiLCJmb3J3YXJkZWQiLCJnZXRIZWFkZXIiLCJyZWFsSVAiLCJjZklQIiwic3BsaXQiLCJ1c2VyQWdlbnQiLCJ1c2VyQWdlbnRIYXNoIiwiaGFzaFN0cmluZyIsImhlYWRlck5hbWUiLCJoZWFkZXJzIiwiZ2V0IiwiaGVhZGVyIiwiQXJyYXkiLCJpc0FycmF5Iiwic3RyIiwiaGFzaCIsImkiLCJsZW5ndGgiLCJjaGFyIiwiY2hhckNvZGVBdCIsIk1hdGgiLCJhYnMiLCJ0b1N0cmluZyIsImNvbmZpZyIsImtleVByZWZpeCIsImtleUdlbmVyYXRvciIsImNvdW50IiwiZmlyc3RSZXF1ZXN0Iiwic2V0IiwiYWxsb3dlZCIsImxpbWl0IiwicmVtYWluaW5nIiwicmV0cnlBZnRlciIsImNlaWwiLCJlcnJvciIsImNvZGUiLCJjb25zb2xlIiwiY29uZmlnTmFtZSIsImN1c3RvbUNvbmZpZyIsImJhc2VDb25maWciLCJoYW5kbGVyIiwiYXJncyIsInJhdGVMaW1pdFJlc3VsdCIsImVycm9yUmVzcG9uc2UiLCJzdWNjZXNzIiwicmF0ZUxpbWl0IiwicmVzIiwiT2JqZWN0IiwiZm9yRWFjaCIsInZhbHVlIiwic2V0SGVhZGVyIiwic3RhdHVzIiwianNvbiIsIlJlc3BvbnNlIiwiSlNPTiIsInN0cmluZ2lmeSIsInJlc3BvbnNlIiwiZnJvbSIsInZhbHVlcyIsImFjdGl2ZUVudHJpZXMiLCJmaWx0ZXIiLCJ0b3RhbEtleXMiLCJzaXplIiwib2xkZXN0RW50cnkiLCJtaW4iLCJtYXAiLCJlIiwibmV3ZXN0RW50cnkiLCJtYXgiXSwibWFwcGluZ3MiOiJBQUFBOzs7Q0FHQzs7Ozs7Ozs7Ozs7UUFzQ1lBO2VBQUFBOztRQXdIU0M7ZUFBQUE7O1FBdUxOQztlQUFBQTs7UUFPQUM7ZUFBQUE7O1FBNUJBQztlQUFBQTs7UUFQQUM7ZUFBQUE7O1FBcUJBQztlQUFBQTs7UUFQQUM7ZUFBQUE7O1FBL0ZBQztlQUFBQTs7O0FBbE1ULE1BQU1SLHFCQUFxQjtJQUNoQywwQ0FBMEM7SUFDMUNTLE1BQU07UUFDSkMsVUFBVSxLQUFLLEtBQUs7UUFDcEJDLGFBQWE7UUFDYkMsU0FBUztJQUNYO0lBRUEsMkJBQTJCO0lBQzNCQyxPQUFPO1FBQ0xILFVBQVUsSUFBSSxLQUFLO1FBQ25CQyxhQUFhO1FBQ2JDLFNBQVM7SUFDWDtJQUVBLCtCQUErQjtJQUMvQkUsVUFBVTtRQUNSSixVQUFVLElBQUksS0FBSztRQUNuQkMsYUFBYTtRQUNiQyxTQUFTO0lBQ1g7SUFFQSxrQ0FBa0M7SUFDbENHLFVB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