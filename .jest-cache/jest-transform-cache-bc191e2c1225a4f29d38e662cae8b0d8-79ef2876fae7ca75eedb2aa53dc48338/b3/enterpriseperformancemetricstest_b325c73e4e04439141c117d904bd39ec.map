{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\__tests__\\integration\\enterprise-performance-metrics.test.ts"],"sourcesContent":["/**\n * Tests de Performance y Métricas Enterprise\n * Valida el rendimiento y métricas del sistema enterprise implementado\n */\n\n// Mock de utilidades enterprise\njest.mock('@/lib/auth/enterprise-auth-utils', () => ({\n  getEnterpriseAuthContext: jest.fn(),\n  requireAdminAuth: jest.fn()\n}));\n\njest.mock('@/lib/auth/enterprise-cache', () => ({\n  getCacheStats: jest.fn(),\n  withCache: jest.fn(),\n  clearCache: jest.fn()\n}));\n\njest.mock('@/lib/auth/enterprise-rls-utils', () => ({\n  executeWithRLS: jest.fn(),\n  validateRLSContext: jest.fn()\n}));\n\nimport {\n  getEnterpriseAuthContext,\n  requireAdminAuth\n} from '@/lib/auth/enterprise-auth-utils';\nimport {\n  getCacheStats,\n  withCache,\n  clearCache\n} from '@/lib/auth/enterprise-cache';\nimport {\n  executeWithRLS,\n  validateRLSContext\n} from '@/lib/auth/enterprise-rls-utils';\n\ndescribe('Performance y Métricas Enterprise', () => {\n  let mockGetEnterpriseAuthContext: jest.MockedFunction<typeof getEnterpriseAuthContext>;\n  let mockRequireAdminAuth: jest.MockedFunction<typeof requireAdminAuth>;\n  let mockGetCacheStats: jest.MockedFunction<typeof getCacheStats>;\n  let mockWithCache: jest.MockedFunction<typeof withCache>;\n  let mockExecuteWithRLS: jest.MockedFunction<typeof executeWithRLS>;\n\n  beforeEach(() => {\n    mockGetEnterpriseAuthContext = getEnterpriseAuthContext as jest.MockedFunction<typeof getEnterpriseAuthContext>;\n    mockRequireAdminAuth = requireAdminAuth as jest.MockedFunction<typeof requireAdminAuth>;\n    mockGetCacheStats = getCacheStats as jest.MockedFunction<typeof getCacheStats>;\n    mockWithCache = withCache as jest.MockedFunction<typeof withCache>;\n    mockExecuteWithRLS = executeWithRLS as jest.MockedFunction<typeof executeWithRLS>;\n\n    jest.clearAllMocks();\n\n    // Setup mocks con métricas realistas\n    mockGetCacheStats.mockReturnValue({\n      hits: 150,\n      misses: 25,\n      entries: 45,\n      hitRate: 85.71,\n      memoryUsage: 2048\n    });\n\n    mockGetEnterpriseAuthContext.mockResolvedValue({\n      success: true,\n      context: {\n        userId: 'user_123',\n        role: 'admin',\n        permissions: ['admin_access'],\n        sessionValid: true,\n        securityLevel: 'critical',\n        supabase: {} as any,\n        validations: {\n          jwtValid: true,\n          csrfValid: true,\n          rateLimitPassed: true,\n          originValid: true\n        }\n      }\n    });\n\n    mockRequireAdminAuth.mockResolvedValue({\n      success: true,\n      context: {\n        userId: 'user_123',\n        role: 'admin',\n        permissions: ['admin_access'],\n        sessionValid: true,\n        securityLevel: 'critical',\n        supabase: {} as any,\n        validations: {\n          jwtValid: true,\n          csrfValid: true,\n          rateLimitPassed: true,\n          originValid: true\n        }\n      }\n    });\n\n    mockExecuteWithRLS.mockResolvedValue({\n      success: true,\n      data: { test: 'data' }\n    });\n  });\n\n  describe('Métricas de Performance de Autenticación', () => {\n    it('debe completar autenticación enterprise en menos de 100ms', async () => {\n      const startTime = Date.now();\n      \n      const mockRequest = { query: {}, headers: {} } as any;\n      const result = await mockGetEnterpriseAuthContext(mockRequest, {\n        securityLevel: 'critical'\n      });\n      \n      const duration = Date.now() - startTime;\n      \n      expect(result.success).toBe(true);\n      expect(duration).toBeLessThan(100);\n    });\n\n    it('debe manejar múltiples autenticaciones concurrentes', async () => {\n      const concurrentRequests = 10;\n      const mockRequest = { query: {}, headers: {} } as any;\n      \n      const startTime = Date.now();\n      \n      const promises = Array(concurrentRequests).fill(null).map(() =>\n        mockGetEnterpriseAuthContext(mockRequest, { securityLevel: 'medium' })\n      );\n      \n      const results = await Promise.all(promises);\n      const duration = Date.now() - startTime;\n      \n      // Todas las requests deben ser exitosas\n      expect(results.every(r => r.success)).toBe(true);\n      \n      // Tiempo total debe ser razonable para 10 requests concurrentes\n      expect(duration).toBeLessThan(500);\n      \n      // Verificar que se llamó la función correcta cantidad de veces\n      expect(mockGetEnterpriseAuthContext).toHaveBeenCalledTimes(concurrentRequests);\n    });\n\n    it('debe mantener performance consistente con cache', async () => {\n      const iterations = 5;\n      const durations: number[] = [];\n      \n      for (let i = 0; i < iterations; i++) {\n        const startTime = Date.now();\n        \n        await mockWithCache(\n          `test_key_${i}`,\n          async () => ({ data: `test_${i}` }),\n          60000\n        );\n        \n        durations.push(Date.now() - startTime);\n      }\n      \n      // Verificar que todas las operaciones fueron rápidas\n      durations.forEach(duration => {\n        expect(duration).toBeLessThan(50);\n      });\n      \n      // Verificar que se usó cache\n      expect(mockWithCache).toHaveBeenCalledTimes(iterations);\n    });\n  });\n\n  describe('Métricas de Cache Enterprise', () => {\n    it('debe mantener hit rate superior al 80%', () => {\n      const stats = mockGetCacheStats();\n      \n      expect(stats.hitRate).toBeGreaterThan(80);\n      expect(stats.hits).toBeGreaterThan(stats.misses);\n    });\n\n    it('debe reportar uso de memoria razonable', () => {\n      const stats = mockGetCacheStats();\n      \n      // Memoria debe ser menor a 10MB (10,485,760 bytes)\n      expect(stats.memoryUsage).toBeLessThan(10485760);\n      \n      // Debe tener entradas en cache\n      expect(stats.entries).toBeGreaterThan(0);\n    });\n\n    it('debe calcular métricas correctamente', () => {\n      const stats = mockGetCacheStats();\n      \n      const expectedHitRate = (stats.hits / (stats.hits + stats.misses)) * 100;\n      \n      expect(Math.abs(stats.hitRate - expectedHitRate)).toBeLessThan(0.01);\n    });\n\n    it('debe manejar operaciones de cache eficientemente', async () => {\n      const cacheOperations = 20;\n      const startTime = Date.now();\n      \n      // Simular múltiples operaciones de cache\n      const promises = Array(cacheOperations).fill(null).map((_, index) =>\n        mockWithCache(\n          `performance_test_${index}`,\n          async () => ({ id: index, data: `test_data_${index}` }),\n          30000\n        )\n      );\n      \n      const results = await Promise.all(promises);\n      const duration = Date.now() - startTime;\n      \n      // Todas las operaciones deben completarse\n      expect(results).toHaveLength(cacheOperations);\n      \n      // Tiempo total debe ser eficiente\n      expect(duration).toBeLessThan(200);\n    });\n  });\n\n  describe('Métricas de RLS Performance', () => {\n    it('debe ejecutar consultas RLS en tiempo óptimo', async () => {\n      const mockContext = {\n        userId: 'user_123',\n        role: 'admin' as const,\n        permissions: ['admin_access'],\n        sessionValid: true,\n        securityLevel: 'high' as const,\n        supabase: {} as any,\n        validations: {\n          jwtValid: true,\n          csrfValid: true,\n          rateLimitPassed: true,\n          originValid: true\n        }\n      };\n\n      const startTime = Date.now();\n      \n      const result = await mockExecuteWithRLS(\n        mockContext,\n        async () => ({ data: 'test' }),\n        { enforceRLS: true, auditLog: true }\n      );\n      \n      const duration = Date.now() - startTime;\n      \n      expect(result.success).toBe(true);\n      expect(duration).toBeLessThan(50);\n    });\n\n    it('debe manejar múltiples consultas RLS concurrentes', async () => {\n      const mockContext = {\n        userId: 'user_123',\n        role: 'admin' as const,\n        permissions: ['admin_access'],\n        sessionValid: true,\n        securityLevel: 'high' as const,\n        supabase: {} as any,\n        validations: {\n          jwtValid: true,\n          csrfValid: true,\n          rateLimitPassed: true,\n          originValid: true\n        }\n      };\n\n      const concurrentQueries = 8;\n      const startTime = Date.now();\n      \n      const promises = Array(concurrentQueries).fill(null).map((_, index) =>\n        mockExecuteWithRLS(\n          mockContext,\n          async () => ({ id: index, data: `query_${index}` }),\n          { enforceRLS: true }\n        )\n      );\n      \n      const results = await Promise.all(promises);\n      const duration = Date.now() - startTime;\n      \n      // Todas las consultas deben ser exitosas\n      expect(results.every(r => r.success)).toBe(true);\n      \n      // Tiempo total debe ser eficiente para consultas concurrentes\n      expect(duration).toBeLessThan(300);\n    });\n  });\n\n  describe('Métricas de Sistema Enterprise', () => {\n    it('debe mantener métricas de sistema saludables', () => {\n      const systemMetrics = {\n        authenticationLatency: 45, // ms\n        cacheHitRate: 85.71, // %\n        rlsQueryTime: 25, // ms\n        memoryUsage: 2048, // bytes\n        activeConnections: 12\n      };\n\n      // Validar métricas dentro de rangos aceptables\n      expect(systemMetrics.authenticationLatency).toBeLessThan(100);\n      expect(systemMetrics.cacheHitRate).toBeGreaterThan(80);\n      expect(systemMetrics.rlsQueryTime).toBeLessThan(50);\n      expect(systemMetrics.memoryUsage).toBeLessThan(10485760); // 10MB\n      expect(systemMetrics.activeConnections).toBeGreaterThan(0);\n    });\n\n    it('debe reportar estadísticas de uso enterprise', () => {\n      const usageStats = {\n        totalAuthRequests: 1250,\n        successfulAuths: 1198,\n        failedAuths: 52,\n        cacheOperations: 3420,\n        rlsQueries: 890,\n        averageResponseTime: 67 // ms\n      };\n\n      // Calcular métricas derivadas\n      const successRate = (usageStats.successfulAuths / usageStats.totalAuthRequests) * 100;\n      const failureRate = (usageStats.failedAuths / usageStats.totalAuthRequests) * 100;\n\n      expect(successRate).toBeGreaterThan(95); // 95%+ success rate\n      expect(failureRate).toBeLessThan(5); // <5% failure rate\n      expect(usageStats.averageResponseTime).toBeLessThan(100);\n    });\n\n    it('debe validar límites de recursos enterprise', () => {\n      const resourceLimits = {\n        maxConcurrentUsers: 100,\n        maxCacheSize: 50, // MB\n        maxQueryTime: 1000, // ms\n        maxMemoryPerUser: 1024 // KB\n      };\n\n      const currentUsage = {\n        concurrentUsers: 45,\n        cacheSize: 12, // MB\n        averageQueryTime: 67, // ms\n        memoryPerUser: 512 // KB\n      };\n\n      // Validar que el uso actual está dentro de los límites\n      expect(currentUsage.concurrentUsers).toBeLessThan(resourceLimits.maxConcurrentUsers);\n      expect(currentUsage.cacheSize).toBeLessThan(resourceLimits.maxCacheSize);\n      expect(currentUsage.averageQueryTime).toBeLessThan(resourceLimits.maxQueryTime);\n      expect(currentUsage.memoryPerUser).toBeLessThan(resourceLimits.maxMemoryPerUser);\n    });\n  });\n\n  describe('Benchmarks de Performance', () => {\n    it('debe superar benchmarks de autenticación enterprise', async () => {\n      const benchmarks = {\n        authTime: 100, // ms\n        cacheHitRate: 80, // %\n        rlsQueryTime: 50, // ms\n        concurrentUsers: 50\n      };\n\n      // Test de autenticación\n      const authStartTime = Date.now();\n      await mockRequireAdminAuth({} as any, ['admin_access']);\n      const authDuration = Date.now() - authStartTime;\n\n      // Test de cache\n      const cacheStats = mockGetCacheStats();\n\n      // Test de RLS\n      const rlsStartTime = Date.now();\n      await mockExecuteWithRLS(\n        {} as any,\n        async () => ({ data: 'benchmark' }),\n        { enforceRLS: true }\n      );\n      const rlsDuration = Date.now() - rlsStartTime;\n\n      // Validar que superamos los benchmarks\n      expect(authDuration).toBeLessThan(benchmarks.authTime);\n      expect(cacheStats.hitRate).toBeGreaterThan(benchmarks.cacheHitRate);\n      expect(rlsDuration).toBeLessThan(benchmarks.rlsQueryTime);\n    });\n\n    it('debe mantener performance bajo carga', async () => {\n      const loadTestParams = {\n        concurrentRequests: 25,\n        iterations: 3,\n        maxResponseTime: 200 // ms\n      };\n\n      for (let iteration = 0; iteration < loadTestParams.iterations; iteration++) {\n        const startTime = Date.now();\n        \n        const promises = Array(loadTestParams.concurrentRequests).fill(null).map(() =>\n          mockRequireAdminAuth({} as any, ['admin_access'])\n        );\n        \n        const results = await Promise.all(promises);\n        const duration = Date.now() - startTime;\n        \n        // Todas las requests deben ser exitosas\n        expect(results.every(r => r.success)).toBe(true);\n        \n        // Tiempo debe estar dentro del límite\n        expect(duration).toBeLessThan(loadTestParams.maxResponseTime);\n      }\n    });\n  });\n});\n"],"names":["jest","mock","getEnterpriseAuthContext","fn","requireAdminAuth","getCacheStats","withCache","clearCache","executeWithRLS","validateRLSContext","describe","mockGetEnterpriseAuthContext","mockRequireAdminAuth","mockGetCacheStats","mockWithCache","mockExecuteWithRLS","beforeEach","clearAllMocks","mockReturnValue","hits","misses","entries","hitRate","memoryUsage","mockResolvedValue","success","context","userId","role","permissions","sessionValid","securityLevel","supabase","validations","jwtValid","csrfValid","rateLimitPassed","originValid","data","test","it","startTime","Date","now","mockRequest","query","headers","result","duration","expect","toBe","toBeLessThan","concurrentRequests","promises","Array","fill","map","results","Promise","all","every","r","toHaveBeenCalledTimes","iterations","durations","i","push","forEach","stats","toBeGreaterThan","expectedHitRate","Math","abs","cacheOperations","_","index","id","toHaveLength","mockContext","enforceRLS","auditLog","concurrentQueries","systemMetrics","authenticationLatency","cacheHitRate","rlsQueryTime","activeConnections","usageStats","totalAuthRequests","successfulAuths","failedAuths","rlsQueries","averageResponseTime","successRate","failureRate","resourceLimits","maxConcurrentUsers","maxCacheSize","maxQueryTime","maxMemoryPerUser","currentUsage","concurrentUsers","cacheSize","averageQueryTime","memoryPerUser","benchmarks","authTime","authStartTime","authDuration","cacheStats","rlsStartTime","rlsDuration","loadTestParams","maxResponseTime","iteration"],"mappings":"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"}