afae4e8abb7de2a9016e4aa258389b2c
// ===================================
// PINTEYA E-COMMERCE - MONITORING CONFIGURATION API
// ===================================
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    GET: function() {
        return GET;
    },
    PUT: function() {
        return PUT;
    }
});
const _server = require("next/server");
const _adminauth = require("../../../../../lib/auth/admin-auth");
const _circuitbreaker = require("../../../../../lib/mercadopago/circuit-breaker");
const _supabase = require("../../../../../lib/supabase");
const _logger = require("../../../../../lib/logger");
async function GET(request) {
    try {
        // Verificar autenticación de admin
        const authResult = await (0, _adminauth.getAuthenticatedAdmin)(request);
        if (!authResult.isAdmin || !authResult.userId) {
            return _server.NextResponse.json({
                success: false,
                error: 'Acceso no autorizado'
            }, {
                status: 401
            });
        }
        // Obtener configuración actual
        const config = {
            metrics: {
                enabled: true,
                flushInterval: 30000,
                retentionDays: 30,
                aggregationPeriods: [
                    '1m',
                    '5m',
                    '1h',
                    '1d',
                    '7d'
                ]
            },
            alerts: {
                enabled: true,
                escalationEnabled: true,
                defaultCooldown: 5,
                maxAlertsPerHour: 100
            },
            circuitBreakers: {
                enabled: true,
                configs: {
                    mercadopago_critical: _circuitbreaker.mercadoPagoCriticalBreaker.getMetrics(),
                    mercadopago_standard: _circuitbreaker.mercadoPagoStandardBreaker.getMetrics(),
                    webhook_processing: _circuitbreaker.webhookProcessingBreaker.getMetrics()
                }
            },
            dashboard: {
                refreshInterval: 5000,
                maxDataPoints: 100,
                cacheTimeout: 30 // segundos
            },
            compliance: {
                auditEnabled: true,
                retentionPolicies: {
                    authentication: 365,
                    payment_processing: 2555,
                    security_violation: 2555,
                    data_access: 1095 // 3 años
                },
                encryptionEnabled: true
            }
        };
        // Obtener estadísticas del sistema
        const stats = await getSystemStats();
        _logger.logger.info(_logger.LogLevel.INFO, 'Monitoring configuration retrieved', {
            userId: authResult.userId,
            configSections: Object.keys(config).length
        }, _logger.LogCategory.SYSTEM);
        return _server.NextResponse.json({
            success: true,
            data: {
                config,
                stats,
                timestamp: new Date().toISOString()
            }
        });
    } catch (error) {
        _logger.logger.error(_logger.LogLevel.ERROR, 'Failed to get monitoring configuration', {
            error: error instanceof Error ? error.message : 'Unknown error'
        }, _logger.LogCategory.SYSTEM);
        return _server.NextResponse.json({
            success: false,
            error: 'Error interno del servidor'
        }, {
            status: 500
        });
    }
}
async function PUT(request) {
    try {
        // Verificar autenticación de admin
        const authResult = await (0, _adminauth.getAuthenticatedAdmin)(request);
        if (!authResult.isAdmin || !authResult.userId) {
            return _server.NextResponse.json({
                success: false,
                error: 'Acceso no autorizado'
            }, {
                status: 401
            });
        }
        const body = await request.json();
        const { section, config } = body;
        if (!section || !config) {
            return _server.NextResponse.json({
                success: false,
                error: 'Faltan parámetros: section y config'
            }, {
                status: 400
            });
        }
        // Validar y aplicar configuración según la sección
        let updateResult = {};
        switch(section){
            case 'metrics':
                updateResult = await updateMetricsConfig(config, authResult.userId);
                break;
            case 'alerts':
                updateResult = await updateAlertsConfig(config, authResult.userId);
                break;
            case 'circuitBreakers':
                updateResult = await updateCircuitBreakersConfig(config, authResult.userId);
                break;
            case 'dashboard':
                updateResult = await updateDashboardConfig(config, authResult.userId);
                break;
            case 'compliance':
                updateResult = await updateComplianceConfig(config, authResult.userId);
                break;
            default:
                return _server.NextResponse.json({
                    success: false,
                    error: 'Sección de configuración no válida'
                }, {
                    status: 400
                });
        }
        _logger.logger.info(_logger.LogLevel.INFO, `Monitoring configuration updated: ${section}`, {
            userId: authResult.userId,
            section,
            changes: Object.keys(config).length
        }, _logger.LogCategory.SYSTEM);
        return _server.NextResponse.json({
            success: true,
            data: {
                section,
                updated: updateResult,
                timestamp: new Date().toISOString()
            }
        });
    } catch (error) {
        _logger.logger.error(_logger.LogLevel.ERROR, 'Failed to update monitoring configuration', {
            error: error instanceof Error ? error.message : 'Unknown error'
        }, _logger.LogCategory.SYSTEM);
        return _server.NextResponse.json({
            success: false,
            error: 'Error interno del servidor'
        }, {
            status: 500
        });
    }
}
/**
 * Obtiene estadísticas del sistema
 */ async function getSystemStats() {
    const supabase = (0, _supabase.getSupabaseClient)(true);
    if (!supabase) {
        return {
            metrics: {
                total: 0,
                last24h: 0
            },
            alerts: {
                active: 0,
                total: 0
            },
            auditEvents: {
                total: 0,
                last24h: 0
            }
        };
    }
    const last24h = new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString();
    // Estadísticas de métricas
    const { data: metricsStats } = await supabase.from('enterprise_metrics').select('id, timestamp').gte('timestamp', last24h);
    const { count: totalMetrics } = await supabase.from('enterprise_metrics').select('*', {
        count: 'exact',
        head: true
    });
    // Estadísticas de alertas
    const { data: alertsStats } = await supabase.from('enterprise_alerts').select('id, status, triggered_at').eq('status', 'active');
    const { count: totalAlerts } = await supabase.from('enterprise_alerts').select('*', {
        count: 'exact',
        head: true
    });
    // Estadísticas de auditoría
    const { data: auditStats } = await supabase.from('audit_events').select('id, timestamp').gte('timestamp', last24h);
    const { count: totalAuditEvents } = await supabase.from('audit_events').select('*', {
        count: 'exact',
        head: true
    });
    return {
        metrics: {
            total: totalMetrics || 0,
            last24h: metricsStats?.length || 0
        },
        alerts: {
            active: alertsStats?.length || 0,
            total: totalAlerts || 0
        },
        auditEvents: {
            total: totalAuditEvents || 0,
            last24h: auditStats?.length || 0
        }
    };
}
/**
 * Actualiza configuración de métricas
 */ async function updateMetricsConfig(config, userId) {
    // TODO: Implementar actualización de configuración de métricas
    // Por ahora solo validamos y retornamos confirmación
    const validFields = [
        'enabled',
        'flushInterval',
        'retentionDays',
        'aggregationPeriods'
    ];
    const updates = {};
    for (const field of validFields){
        if (config[field] !== undefined) {
            updates[field] = config[field];
        }
    }
    return {
        updated: updates,
        message: 'Metrics configuration updated successfully'
    };
}
/**
 * Actualiza configuración de alertas
 */ async function updateAlertsConfig(config, userId) {
    const validFields = [
        'enabled',
        'escalationEnabled',
        'defaultCooldown',
        'maxAlertsPerHour'
    ];
    const updates = {};
    for (const field of validFields){
        if (config[field] !== undefined) {
            updates[field] = config[field];
        }
    }
    return {
        updated: updates,
        message: 'Alerts configuration updated successfully'
    };
}
/**
 * Actualiza configuración de circuit breakers
 */ async function updateCircuitBreakersConfig(config, userId) {
    const updates = {};
    if (config.enabled !== undefined) {
        updates.enabled = config.enabled;
    }
    // Reset circuit breakers si se solicita
    if (config.reset) {
        if (config.reset.includes('mercadopago_critical')) {
            _circuitbreaker.mercadoPagoCriticalBreaker.reset();
            updates.mercadopago_critical_reset = true;
        }
        if (config.reset.includes('mercadopago_standard')) {
            _circuitbreaker.mercadoPagoStandardBreaker.reset();
            updates.mercadopago_standard_reset = true;
        }
        if (config.reset.includes('webhook_processing')) {
            _circuitbreaker.webhookProcessingBreaker.reset();
            updates.webhook_processing_reset = true;
        }
    }
    return {
        updated: updates,
        message: 'Circuit breakers configuration updated successfully'
    };
}
/**
 * Actualiza configuración del dashboard
 */ async function updateDashboardConfig(config, userId) {
    const validFields = [
        'refreshInterval',
        'maxDataPoints',
        'cacheTimeout'
    ];
    const updates = {};
    for (const field of validFields){
        if (config[field] !== undefined) {
            updates[field] = config[field];
        }
    }
    return {
        updated: updates,
        message: 'Dashboard configuration updated successfully'
    };
}
/**
 * Actualiza configuración de compliance
 */ async function updateComplianceConfig(config, userId) {
    const validFields = [
        'auditEnabled',
        'retentionPolicies',
        'encryptionEnabled'
    ];
    const updates = {};
    for (const field of validFields){
        if (config[field] !== undefined) {
            updates[field] = config[field];
        }
    }
    return {
        updated: updates,
        message: 'Compliance configuration updated successfully'
    };
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcYXBwXFxhcGlcXGFkbWluXFxtb25pdG9yaW5nXFxjb25maWdcXHJvdXRlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQSU5URVlBIEUtQ09NTUVSQ0UgLSBNT05JVE9SSU5HIENPTkZJR1VSQVRJT04gQVBJXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgZ2V0QXV0aGVudGljYXRlZEFkbWluIH0gZnJvbSAnQC9saWIvYXV0aC9hZG1pbi1hdXRoJztcbmltcG9ydCB7IGVudGVycHJpc2VNZXRyaWNzIH0gZnJvbSAnQC9saWIvbW9uaXRvcmluZy9lbnRlcnByaXNlLW1ldHJpY3MnO1xuaW1wb3J0IHsgZW50ZXJwcmlzZUFsZXJ0U3lzdGVtIH0gZnJvbSAnQC9saWIvbW9uaXRvcmluZy9hbGVydC1zeXN0ZW0nO1xuaW1wb3J0IHsgXG4gIG1lcmNhZG9QYWdvQ3JpdGljYWxCcmVha2VyLCBcbiAgbWVyY2Fkb1BhZ29TdGFuZGFyZEJyZWFrZXIsIFxuICB3ZWJob29rUHJvY2Vzc2luZ0JyZWFrZXIgXG59IGZyb20gJ0AvbGliL21lcmNhZG9wYWdvL2NpcmN1aXQtYnJlYWtlcic7XG5pbXBvcnQgeyBnZXRTdXBhYmFzZUNsaWVudCB9IGZyb20gJ0AvbGliL3N1cGFiYXNlJztcbmltcG9ydCB7IGxvZ2dlciwgTG9nTGV2ZWwsIExvZ0NhdGVnb3J5IH0gZnJvbSAnQC9saWIvbG9nZ2VyJztcblxuaW50ZXJmYWNlIE1vbml0b3JpbmdDb25maWcge1xuICBtZXRyaWNzOiB7XG4gICAgZW5hYmxlZDogYm9vbGVhbjtcbiAgICBmbHVzaEludGVydmFsOiBudW1iZXI7XG4gICAgcmV0ZW50aW9uRGF5czogbnVtYmVyO1xuICAgIGFnZ3JlZ2F0aW9uUGVyaW9kczogc3RyaW5nW107XG4gIH07XG4gIGFsZXJ0czoge1xuICAgIGVuYWJsZWQ6IGJvb2xlYW47XG4gICAgZXNjYWxhdGlvbkVuYWJsZWQ6IGJvb2xlYW47XG4gICAgZGVmYXVsdENvb2xkb3duOiBudW1iZXI7XG4gICAgbWF4QWxlcnRzUGVySG91cjogbnVtYmVyO1xuICB9O1xuICBjaXJjdWl0QnJlYWtlcnM6IHtcbiAgICBlbmFibGVkOiBib29sZWFuO1xuICAgIGNvbmZpZ3M6IFJlY29yZDxzdHJpbmcsIGFueT47XG4gIH07XG4gIGRhc2hib2FyZDoge1xuICAgIHJlZnJlc2hJbnRlcnZhbDogbnVtYmVyO1xuICAgIG1heERhdGFQb2ludHM6IG51bWJlcjtcbiAgICBjYWNoZVRpbWVvdXQ6IG51bWJlcjtcbiAgfTtcbiAgY29tcGxpYW5jZToge1xuICAgIGF1ZGl0RW5hYmxlZDogYm9vbGVhbjtcbiAgICByZXRlbnRpb25Qb2xpY2llczogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbiAgICBlbmNyeXB0aW9uRW5hYmxlZDogYm9vbGVhbjtcbiAgfTtcbn1cblxuLyoqXG4gKiBHRVQgL2FwaS9hZG1pbi9tb25pdG9yaW5nL2NvbmZpZ1xuICogT2J0aWVuZSBsYSBjb25maWd1cmFjacOzbiBhY3R1YWwgZGVsIHNpc3RlbWEgZGUgbW9uaXRvcmVvXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICAvLyBWZXJpZmljYXIgYXV0ZW50aWNhY2nDs24gZGUgYWRtaW5cbiAgICBjb25zdCBhdXRoUmVzdWx0ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZEFkbWluKHJlcXVlc3QpO1xuICAgIFxuICAgIGlmICghYXV0aFJlc3VsdC5pc0FkbWluIHx8ICFhdXRoUmVzdWx0LnVzZXJJZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnQWNjZXNvIG5vIGF1dG9yaXphZG8nXG4gICAgICB9LCB7IHN0YXR1czogNDAxIH0pO1xuICAgIH1cblxuICAgIC8vIE9idGVuZXIgY29uZmlndXJhY2nDs24gYWN0dWFsXG4gICAgY29uc3QgY29uZmlnOiBNb25pdG9yaW5nQ29uZmlnID0ge1xuICAgICAgbWV0cmljczoge1xuICAgICAgICBlbmFibGVkOiB0cnVlLFxuICAgICAgICBmbHVzaEludGVydmFsOiAzMDAwMCwgLy8gMzAgc2VndW5kb3NcbiAgICAgICAgcmV0ZW50aW9uRGF5czogMzAsXG4gICAgICAgIGFnZ3JlZ2F0aW9uUGVyaW9kczogWycxbScsICc1bScsICcxaCcsICcxZCcsICc3ZCddXG4gICAgICB9LFxuICAgICAgYWxlcnRzOiB7XG4gICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgIGVzY2FsYXRpb25FbmFibGVkOiB0cnVlLFxuICAgICAgICBkZWZhdWx0Q29vbGRvd246IDUsIC8vIG1pbnV0b3NcbiAgICAgICAgbWF4QWxlcnRzUGVySG91cjogMTAwXG4gICAgICB9LFxuICAgICAgY2lyY3VpdEJyZWFrZXJzOiB7XG4gICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgIGNvbmZpZ3M6IHtcbiAgICAgICAgICBtZXJjYWRvcGFnb19jcml0aWNhbDogbWVyY2Fkb1BhZ29Dcml0aWNhbEJyZWFrZXIuZ2V0TWV0cmljcygpLFxuICAgICAgICAgIG1lcmNhZG9wYWdvX3N0YW5kYXJkOiBtZXJjYWRvUGFnb1N0YW5kYXJkQnJlYWtlci5nZXRNZXRyaWNzKCksXG4gICAgICAgICAgd2ViaG9va19wcm9jZXNzaW5nOiB3ZWJob29rUHJvY2Vzc2luZ0JyZWFrZXIuZ2V0TWV0cmljcygpXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBkYXNoYm9hcmQ6IHtcbiAgICAgICAgcmVmcmVzaEludGVydmFsOiA1MDAwLCAvLyA1IHNlZ3VuZG9zXG4gICAgICAgIG1heERhdGFQb2ludHM6IDEwMCxcbiAgICAgICAgY2FjaGVUaW1lb3V0OiAzMCAvLyBzZWd1bmRvc1xuICAgICAgfSxcbiAgICAgIGNvbXBsaWFuY2U6IHtcbiAgICAgICAgYXVkaXRFbmFibGVkOiB0cnVlLFxuICAgICAgICByZXRlbnRpb25Qb2xpY2llczoge1xuICAgICAgICAgIGF1dGhlbnRpY2F0aW9uOiAzNjUsXG4gICAgICAgICAgcGF5bWVudF9wcm9jZXNzaW5nOiAyNTU1LCAvLyA3IGHDsW9zXG4gICAgICAgICAgc2VjdXJpdHlfdmlvbGF0aW9uOiAyNTU1LFxuICAgICAgICAgIGRhdGFfYWNjZXNzOiAxMDk1IC8vIDMgYcOxb3NcbiAgICAgICAgfSxcbiAgICAgICAgZW5jcnlwdGlvbkVuYWJsZWQ6IHRydWVcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gT2J0ZW5lciBlc3RhZMOtc3RpY2FzIGRlbCBzaXN0ZW1hXG4gICAgY29uc3Qgc3RhdHMgPSBhd2FpdCBnZXRTeXN0ZW1TdGF0cygpO1xuXG4gICAgbG9nZ2VyLmluZm8oTG9nTGV2ZWwuSU5GTywgJ01vbml0b3JpbmcgY29uZmlndXJhdGlvbiByZXRyaWV2ZWQnLCB7XG4gICAgICB1c2VySWQ6IGF1dGhSZXN1bHQudXNlcklkLFxuICAgICAgY29uZmlnU2VjdGlvbnM6IE9iamVjdC5rZXlzKGNvbmZpZykubGVuZ3RoXG4gICAgfSwgTG9nQ2F0ZWdvcnkuU1lTVEVNKTtcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YToge1xuICAgICAgICBjb25maWcsXG4gICAgICAgIHN0YXRzLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfVxuICAgIH0pO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKExvZ0xldmVsLkVSUk9SLCAnRmFpbGVkIHRvIGdldCBtb25pdG9yaW5nIGNvbmZpZ3VyYXRpb24nLCB7XG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICB9LCBMb2dDYXRlZ29yeS5TWVNURU0pO1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdFcnJvciBpbnRlcm5vIGRlbCBzZXJ2aWRvcidcbiAgICB9LCB7IHN0YXR1czogNTAwIH0pO1xuICB9XG59XG5cbi8qKlxuICogUFVUIC9hcGkvYWRtaW4vbW9uaXRvcmluZy9jb25maWdcbiAqIEFjdHVhbGl6YSBsYSBjb25maWd1cmFjacOzbiBkZWwgc2lzdGVtYSBkZSBtb25pdG9yZW9cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBVVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIC8vIFZlcmlmaWNhciBhdXRlbnRpY2FjacOzbiBkZSBhZG1pblxuICAgIGNvbnN0IGF1dGhSZXN1bHQgPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkQWRtaW4ocmVxdWVzdCk7XG4gICAgXG4gICAgaWYgKCFhdXRoUmVzdWx0LmlzQWRtaW4gfHwgIWF1dGhSZXN1bHQudXNlcklkKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6ICdBY2Nlc28gbm8gYXV0b3JpemFkbydcbiAgICAgIH0sIHsgc3RhdHVzOiA0MDEgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgIGNvbnN0IHsgc2VjdGlvbiwgY29uZmlnIH0gPSBib2R5O1xuXG4gICAgaWYgKCFzZWN0aW9uIHx8ICFjb25maWcpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ0ZhbHRhbiBwYXLDoW1ldHJvczogc2VjdGlvbiB5IGNvbmZpZydcbiAgICAgIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgfVxuXG4gICAgLy8gVmFsaWRhciB5IGFwbGljYXIgY29uZmlndXJhY2nDs24gc2Vnw7puIGxhIHNlY2Npw7NuXG4gICAgbGV0IHVwZGF0ZVJlc3VsdDogYW55ID0ge307XG5cbiAgICBzd2l0Y2ggKHNlY3Rpb24pIHtcbiAgICAgIGNhc2UgJ21ldHJpY3MnOlxuICAgICAgICB1cGRhdGVSZXN1bHQgPSBhd2FpdCB1cGRhdGVNZXRyaWNzQ29uZmlnKGNvbmZpZywgYXV0aFJlc3VsdC51c2VySWQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2FsZXJ0cyc6XG4gICAgICAgIHVwZGF0ZVJlc3VsdCA9IGF3YWl0IHVwZGF0ZUFsZXJ0c0NvbmZpZyhjb25maWcsIGF1dGhSZXN1bHQudXNlcklkKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdjaXJjdWl0QnJlYWtlcnMnOlxuICAgICAgICB1cGRhdGVSZXN1bHQgPSBhd2FpdCB1cGRhdGVDaXJjdWl0QnJlYWtlcnNDb25maWcoY29uZmlnLCBhdXRoUmVzdWx0LnVzZXJJZCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnZGFzaGJvYXJkJzpcbiAgICAgICAgdXBkYXRlUmVzdWx0ID0gYXdhaXQgdXBkYXRlRGFzaGJvYXJkQ29uZmlnKGNvbmZpZywgYXV0aFJlc3VsdC51c2VySWQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2NvbXBsaWFuY2UnOlxuICAgICAgICB1cGRhdGVSZXN1bHQgPSBhd2FpdCB1cGRhdGVDb21wbGlhbmNlQ29uZmlnKGNvbmZpZywgYXV0aFJlc3VsdC51c2VySWQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6ICdTZWNjacOzbiBkZSBjb25maWd1cmFjacOzbiBubyB2w6FsaWRhJ1xuICAgICAgICB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgIH1cblxuICAgIGxvZ2dlci5pbmZvKExvZ0xldmVsLklORk8sIGBNb25pdG9yaW5nIGNvbmZpZ3VyYXRpb24gdXBkYXRlZDogJHtzZWN0aW9ufWAsIHtcbiAgICAgIHVzZXJJZDogYXV0aFJlc3VsdC51c2VySWQsXG4gICAgICBzZWN0aW9uLFxuICAgICAgY2hhbmdlczogT2JqZWN0LmtleXMoY29uZmlnKS5sZW5ndGhcbiAgICB9LCBMb2dDYXRlZ29yeS5TWVNURU0pO1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHNlY3Rpb24sXG4gICAgICAgIHVwZGF0ZWQ6IHVwZGF0ZVJlc3VsdCxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgIH1cbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ2dlci5lcnJvcihMb2dMZXZlbC5FUlJPUiwgJ0ZhaWxlZCB0byB1cGRhdGUgbW9uaXRvcmluZyBjb25maWd1cmF0aW9uJywge1xuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgfSwgTG9nQ2F0ZWdvcnkuU1lTVEVNKTtcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnRXJyb3IgaW50ZXJubyBkZWwgc2Vydmlkb3InXG4gICAgfSwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgfVxufVxuXG4vKipcbiAqIE9idGllbmUgZXN0YWTDrXN0aWNhcyBkZWwgc2lzdGVtYVxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRTeXN0ZW1TdGF0cygpIHtcbiAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZUNsaWVudCh0cnVlKTtcbiAgXG4gIGlmICghc3VwYWJhc2UpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbWV0cmljczogeyB0b3RhbDogMCwgbGFzdDI0aDogMCB9LFxuICAgICAgYWxlcnRzOiB7IGFjdGl2ZTogMCwgdG90YWw6IDAgfSxcbiAgICAgIGF1ZGl0RXZlbnRzOiB7IHRvdGFsOiAwLCBsYXN0MjRoOiAwIH1cbiAgICB9O1xuICB9XG5cbiAgY29uc3QgbGFzdDI0aCA9IG5ldyBEYXRlKERhdGUubm93KCkgLSAyNCAqIDYwICogNjAgKiAxMDAwKS50b0lTT1N0cmluZygpO1xuXG4gIC8vIEVzdGFkw61zdGljYXMgZGUgbcOpdHJpY2FzXG4gIGNvbnN0IHsgZGF0YTogbWV0cmljc1N0YXRzIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCdlbnRlcnByaXNlX21ldHJpY3MnKVxuICAgIC5zZWxlY3QoJ2lkLCB0aW1lc3RhbXAnKVxuICAgIC5ndGUoJ3RpbWVzdGFtcCcsIGxhc3QyNGgpO1xuXG4gIGNvbnN0IHsgY291bnQ6IHRvdGFsTWV0cmljcyB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbSgnZW50ZXJwcmlzZV9tZXRyaWNzJylcbiAgICAuc2VsZWN0KCcqJywgeyBjb3VudDogJ2V4YWN0JywgaGVhZDogdHJ1ZSB9KTtcblxuICAvLyBFc3RhZMOtc3RpY2FzIGRlIGFsZXJ0YXNcbiAgY29uc3QgeyBkYXRhOiBhbGVydHNTdGF0cyB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbSgnZW50ZXJwcmlzZV9hbGVydHMnKVxuICAgIC5zZWxlY3QoJ2lkLCBzdGF0dXMsIHRyaWdnZXJlZF9hdCcpXG4gICAgLmVxKCdzdGF0dXMnLCAnYWN0aXZlJyk7XG5cbiAgY29uc3QgeyBjb3VudDogdG90YWxBbGVydHMgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oJ2VudGVycHJpc2VfYWxlcnRzJylcbiAgICAuc2VsZWN0KCcqJywgeyBjb3VudDogJ2V4YWN0JywgaGVhZDogdHJ1ZSB9KTtcblxuICAvLyBFc3RhZMOtc3RpY2FzIGRlIGF1ZGl0b3LDrWFcbiAgY29uc3QgeyBkYXRhOiBhdWRpdFN0YXRzIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCdhdWRpdF9ldmVudHMnKVxuICAgIC5zZWxlY3QoJ2lkLCB0aW1lc3RhbXAnKVxuICAgIC5ndGUoJ3RpbWVzdGFtcCcsIGxhc3QyNGgpO1xuXG4gIGNvbnN0IHsgY291bnQ6IHRvdGFsQXVkaXRFdmVudHMgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oJ2F1ZGl0X2V2ZW50cycpXG4gICAgLnNlbGVjdCgnKicsIHsgY291bnQ6ICdleGFjdCcsIGhlYWQ6IHRydWUgfSk7XG5cbiAgcmV0dXJuIHtcbiAgICBtZXRyaWNzOiB7XG4gICAgICB0b3RhbDogdG90YWxNZXRyaWNzIHx8IDAsXG4gICAgICBsYXN0MjRoOiBtZXRyaWNzU3RhdHM/Lmxlbmd0aCB8fCAwXG4gICAgfSxcbiAgICBhbGVydHM6IHtcbiAgICAgIGFjdGl2ZTogYWxlcnRzU3RhdHM/Lmxlbmd0aCB8fCAwLFxuICAgICAgdG90YWw6IHRvdGFsQWxlcnRzIHx8IDBcbiAgICB9LFxuICAgIGF1ZGl0RXZlbnRzOiB7XG4gICAgICB0b3RhbDogdG90YWxBdWRpdEV2ZW50cyB8fCAwLFxuICAgICAgbGFzdDI0aDogYXVkaXRTdGF0cz8ubGVuZ3RoIHx8IDBcbiAgICB9XG4gIH07XG59XG5cbi8qKlxuICogQWN0dWFsaXphIGNvbmZpZ3VyYWNpw7NuIGRlIG3DqXRyaWNhc1xuICovXG5hc3luYyBmdW5jdGlvbiB1cGRhdGVNZXRyaWNzQ29uZmlnKGNvbmZpZzogYW55LCB1c2VySWQ6IHN0cmluZykge1xuICAvLyBUT0RPOiBJbXBsZW1lbnRhciBhY3R1YWxpemFjacOzbiBkZSBjb25maWd1cmFjacOzbiBkZSBtw6l0cmljYXNcbiAgLy8gUG9yIGFob3JhIHNvbG8gdmFsaWRhbW9zIHkgcmV0b3JuYW1vcyBjb25maXJtYWNpw7NuXG4gIFxuICBjb25zdCB2YWxpZEZpZWxkcyA9IFsnZW5hYmxlZCcsICdmbHVzaEludGVydmFsJywgJ3JldGVudGlvbkRheXMnLCAnYWdncmVnYXRpb25QZXJpb2RzJ107XG4gIGNvbnN0IHVwZGF0ZXM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcblxuICBmb3IgKGNvbnN0IGZpZWxkIG9mIHZhbGlkRmllbGRzKSB7XG4gICAgaWYgKGNvbmZpZ1tmaWVsZF0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgdXBkYXRlc1tmaWVsZF0gPSBjb25maWdbZmllbGRdO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdXBkYXRlZDogdXBkYXRlcyxcbiAgICBtZXNzYWdlOiAnTWV0cmljcyBjb25maWd1cmF0aW9uIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5J1xuICB9O1xufVxuXG4vKipcbiAqIEFjdHVhbGl6YSBjb25maWd1cmFjacOzbiBkZSBhbGVydGFzXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUFsZXJ0c0NvbmZpZyhjb25maWc6IGFueSwgdXNlcklkOiBzdHJpbmcpIHtcbiAgY29uc3QgdmFsaWRGaWVsZHMgPSBbJ2VuYWJsZWQnLCAnZXNjYWxhdGlvbkVuYWJsZWQnLCAnZGVmYXVsdENvb2xkb3duJywgJ21heEFsZXJ0c1BlckhvdXInXTtcbiAgY29uc3QgdXBkYXRlczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuXG4gIGZvciAoY29uc3QgZmllbGQgb2YgdmFsaWRGaWVsZHMpIHtcbiAgICBpZiAoY29uZmlnW2ZpZWxkXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB1cGRhdGVzW2ZpZWxkXSA9IGNvbmZpZ1tmaWVsZF07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB1cGRhdGVkOiB1cGRhdGVzLFxuICAgIG1lc3NhZ2U6ICdBbGVydHMgY29uZmlndXJhdGlvbiB1cGRhdGVkIHN1Y2Nlc3NmdWxseSdcbiAgfTtcbn1cblxuLyoqXG4gKiBBY3R1YWxpemEgY29uZmlndXJhY2nDs24gZGUgY2lyY3VpdCBicmVha2Vyc1xuICovXG5hc3luYyBmdW5jdGlvbiB1cGRhdGVDaXJjdWl0QnJlYWtlcnNDb25maWcoY29uZmlnOiBhbnksIHVzZXJJZDogc3RyaW5nKSB7XG4gIGNvbnN0IHVwZGF0ZXM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcblxuICBpZiAoY29uZmlnLmVuYWJsZWQgIT09IHVuZGVmaW5lZCkge1xuICAgIHVwZGF0ZXMuZW5hYmxlZCA9IGNvbmZpZy5lbmFibGVkO1xuICB9XG5cbiAgLy8gUmVzZXQgY2lyY3VpdCBicmVha2VycyBzaSBzZSBzb2xpY2l0YVxuICBpZiAoY29uZmlnLnJlc2V0KSB7XG4gICAgaWYgKGNvbmZpZy5yZXNldC5pbmNsdWRlcygnbWVyY2Fkb3BhZ29fY3JpdGljYWwnKSkge1xuICAgICAgbWVyY2Fkb1BhZ29Dcml0aWNhbEJyZWFrZXIucmVzZXQoKTtcbiAgICAgIHVwZGF0ZXMubWVyY2Fkb3BhZ29fY3JpdGljYWxfcmVzZXQgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAoY29uZmlnLnJlc2V0LmluY2x1ZGVzKCdtZXJjYWRvcGFnb19zdGFuZGFyZCcpKSB7XG4gICAgICBtZXJjYWRvUGFnb1N0YW5kYXJkQnJlYWtlci5yZXNldCgpO1xuICAgICAgdXBkYXRlcy5tZXJjYWRvcGFnb19zdGFuZGFyZF9yZXNldCA9IHRydWU7XG4gICAgfVxuICAgIGlmIChjb25maWcucmVzZXQuaW5jbHVkZXMoJ3dlYmhvb2tfcHJvY2Vzc2luZycpKSB7XG4gICAgICB3ZWJob29rUHJvY2Vzc2luZ0JyZWFrZXIucmVzZXQoKTtcbiAgICAgIHVwZGF0ZXMud2ViaG9va19wcm9jZXNzaW5nX3Jlc2V0ID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHVwZGF0ZWQ6IHVwZGF0ZXMsXG4gICAgbWVzc2FnZTogJ0NpcmN1aXQgYnJlYWtlcnMgY29uZmlndXJhdGlvbiB1cGRhdGVkIHN1Y2Nlc3NmdWxseSdcbiAgfTtcbn1cblxuLyoqXG4gKiBBY3R1YWxpemEgY29uZmlndXJhY2nDs24gZGVsIGRhc2hib2FyZFxuICovXG5hc3luYyBmdW5jdGlvbiB1cGRhdGVEYXNoYm9hcmRDb25maWcoY29uZmlnOiBhbnksIHVzZXJJZDogc3RyaW5nKSB7XG4gIGNvbnN0IHZhbGlkRmllbGRzID0gWydyZWZyZXNoSW50ZXJ2YWwnLCAnbWF4RGF0YVBvaW50cycsICdjYWNoZVRpbWVvdXQnXTtcbiAgY29uc3QgdXBkYXRlczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuXG4gIGZvciAoY29uc3QgZmllbGQgb2YgdmFsaWRGaWVsZHMpIHtcbiAgICBpZiAoY29uZmlnW2ZpZWxkXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB1cGRhdGVzW2ZpZWxkXSA9IGNvbmZpZ1tmaWVsZF07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB1cGRhdGVkOiB1cGRhdGVzLFxuICAgIG1lc3NhZ2U6ICdEYXNoYm9hcmQgY29uZmlndXJhdGlvbiB1cGRhdGVkIHN1Y2Nlc3NmdWxseSdcbiAgfTtcbn1cblxuLyoqXG4gKiBBY3R1YWxpemEgY29uZmlndXJhY2nDs24gZGUgY29tcGxpYW5jZVxuICovXG5hc3luYyBmdW5jdGlvbiB1cGRhdGVDb21wbGlhbmNlQ29uZmlnKGNvbmZpZzogYW55LCB1c2VySWQ6IHN0cmluZykge1xuICBjb25zdCB2YWxpZEZpZWxkcyA9IFsnYXVkaXRFbmFibGVkJywgJ3JldGVudGlvblBvbGljaWVzJywgJ2VuY3J5cHRpb25FbmFibGVkJ107XG4gIGNvbnN0IHVwZGF0ZXM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcblxuICBmb3IgKGNvbnN0IGZpZWxkIG9mIHZhbGlkRmllbGRzKSB7XG4gICAgaWYgKGNvbmZpZ1tmaWVsZF0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgdXBkYXRlc1tmaWVsZF0gPSBjb25maWdbZmllbGRdO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdXBkYXRlZDogdXBkYXRlcyxcbiAgICBtZXNzYWdlOiAnQ29tcGxpYW5jZSBjb25maWd1cmF0aW9uIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5J1xuICB9O1xufVxuIl0sIm5hbWVzIjpbIkdFVCIsIlBVVCIsInJlcXVlc3QiLCJhdXRoUmVzdWx0IiwiZ2V0QXV0aGVudGljYXRlZEFkbWluIiwiaXNBZG1pbiIsInVzZXJJZCIsIk5leHRSZXNwb25zZSIsImpzb24iLCJzdWNjZXNzIiwiZXJyb3IiLCJzdGF0dXMiLCJjb25maWciLCJtZXRyaWNzIiwiZW5hYmxlZCIsImZsdXNoSW50ZXJ2YWwiLCJyZXRlbnRpb25EYXlzIiwiYWdncmVnYXRpb25QZXJpb2RzIiwiYWxlcnRzIiwiZXNjYWxhdGlvbkVuYWJsZWQiLCJkZWZhdWx0Q29vbGRvd24iLCJtYXhBbGVydHNQZXJIb3VyIiwiY2lyY3VpdEJyZWFrZXJzIiwiY29uZmlncyIsIm1lcmNhZG9wYWdvX2NyaXRpY2FsIiwibWVyY2Fkb1BhZ29Dcml0aWNhbEJyZWFrZXIiLCJnZXRNZXRyaWNzIiwibWVyY2Fkb3BhZ29fc3RhbmRhcmQiLCJtZXJjYWRvUGFnb1N0YW5kYXJkQnJlYWtlciIsIndlYmhvb2tfcHJvY2Vzc2luZyIsIndlYmhvb2tQcm9jZXNzaW5nQnJlYWtlciIsImRhc2hib2FyZCIsInJlZnJlc2hJbnRlcnZhbCIsIm1heERhdGFQb2ludHMiLCJjYWNoZVRpbWVvdXQiLCJjb21wbGlhbmNlIiwiYXVkaXRFbmFibGVkIiwicmV0ZW50aW9uUG9saWNpZXMiLCJhdXRoZW50aWNhdGlvbiIsInBheW1lbnRfcHJvY2Vzc2luZyIsInNlY3VyaXR5X3Zpb2xhdGlvbiIsImRhdGFfYWNjZXNzIiwiZW5jcnlwdGlvbkVuYWJsZWQiLCJzdGF0cyIsImdldFN5c3RlbVN0YXRzIiwibG9nZ2VyIiwiaW5mbyIsIkxvZ0xldmVsIiwiSU5GTyIsImNvbmZpZ1NlY3Rpb25zIiwiT2JqZWN0Iiwia2V5cyIsImxlbmd0aCIsIkxvZ0NhdGVnb3J5IiwiU1lTVEVNIiwiZGF0YSIsInRpbWVzdGFtcCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsIkVSUk9SIiwiRXJyb3IiLCJtZXNzYWdlIiwiYm9keSIsInNlY3Rpb24iLCJ1cGRhdGVSZXN1bHQiLCJ1cGRhdGVNZXRyaWNzQ29uZmlnIiwidXBkYXRlQWxlcnRzQ29uZmlnIiwidXBkYXRlQ2lyY3VpdEJyZWFrZXJzQ29uZmlnIiwidXBkYXRlRGFzaGJvYXJkQ29uZmlnIiwidXBkYXRlQ29tcGxpYW5jZUNvbmZpZyIsImNoYW5nZXMiLCJ1cGRhdGVkIiwic3VwYWJhc2UiLCJnZXRTdXBhYmFzZUNsaWVudCIsInRvdGFsIiwibGFzdDI0aCIsImFjdGl2ZSIsImF1ZGl0RXZlbnRzIiwibm93IiwibWV0cmljc1N0YXRzIiwiZnJvbSIsInNlbGVjdCIsImd0ZSIsImNvdW50IiwidG90YWxNZXRyaWNzIiwiaGVhZCIsImFsZXJ0c1N0YXRzIiwiZXEiLCJ0b3RhbEFsZXJ0cyIsImF1ZGl0U3RhdHMiLCJ0b3RhbEF1ZGl0RXZlbnRzIiwidmFsaWRGaWVsZHMiLCJ1cGRhdGVzIiwiZmllbGQiLCJ1bmRlZmluZWQiLCJyZXNldCIsImluY2x1ZGVzIiwibWVyY2Fkb3BhZ29fY3JpdGljYWxfcmVzZXQiLCJtZXJjYWRvcGFnb19zdGFuZGFyZF9yZXNldCIsIndlYmhvb2tfcHJvY2Vzc2luZ19yZXNldCJdLCJtYXBwaW5ncyI6IkFBQUEsc0NBQXNDO0FBQ3RDLG9EQUFvRDtBQUNwRCxzQ0FBc0M7Ozs7Ozs7Ozs7OztJQStDaEJBLEdBQUc7ZUFBSEE7O0lBb0ZBQyxHQUFHO2VBQUhBOzs7d0JBaklvQjsyQkFDSjtnQ0FPL0I7MEJBQzJCO3dCQUNZO0FBbUN2QyxlQUFlRCxJQUFJRSxPQUFvQjtJQUM1QyxJQUFJO1FBQ0YsbUNBQW1DO1FBQ25DLE1BQU1DLGFBQWEsTUFBTUMsSUFBQUEsZ0NBQXFCLEVBQUNGO1FBRS9DLElBQUksQ0FBQ0MsV0FBV0UsT0FBTyxJQUFJLENBQUNGLFdBQVdHLE1BQU0sRUFBRTtZQUM3QyxPQUFPQyxvQkFB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