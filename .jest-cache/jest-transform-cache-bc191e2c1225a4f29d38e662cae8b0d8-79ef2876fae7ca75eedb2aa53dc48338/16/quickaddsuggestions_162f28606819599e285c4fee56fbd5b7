4fbf9d9c74aee3e2674560c7c62d485b
"use client";
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return _default;
    }
});
const _jsxruntime = require("react/jsx-runtime");
const _react = /*#__PURE__*/ _interop_require_wildcard(require("react"));
const _button = require("./button");
const _optimizedimports = require("../../lib/optimized-imports");
const _utils = require("../../lib/utils");
const _products = require("../../lib/api/products");
const _productadapter = require("../../lib/adapters/product-adapter");
const _image = /*#__PURE__*/ _interop_require_default(require("next/image"));
const _reactredux = require("react-redux");
const _cartslice = require("../../redux/features/cart-slice");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
const QuickAddSuggestions = ({ onAddToCart, onClose, className })=>{
    const [products, setProducts] = (0, _react.useState)([]);
    const [loading, setLoading] = (0, _react.useState)(true);
    const [error, setError] = (0, _react.useState)(null);
    const dispatch = (0, _reactredux.useDispatch)();
    (0, _react.useEffect)(()=>{
        const abortController = new AbortController();
        const fetchPopularProducts = async ()=>{
            try {
                setLoading(true);
                setError(null);
                // Obtener productos con descuento (populares) limitados a 3
                const response = await (0, _products.getProducts)({
                    limit: 3,
                    sortBy: 'created_at',
                    sortOrder: 'desc'
                }, abortController.signal);
                // Verificar si el componente aún está montado
                if (abortController.signal.aborted) {
                    return;
                }
                if (response.success && response.data) {
                    setProducts(response.data);
                } else {
                    setError('No se pudieron cargar los productos');
                }
            } catch (err) {
                // Solo mostrar error si no fue cancelado
                if (!abortController.signal.aborted && err instanceof Error && err.name !== 'AbortError') {
                    console.error('Error fetching popular products:', err);
                    setError('Error al cargar productos populares');
                }
            } finally{
                // Solo actualizar loading si no fue cancelado
                if (!abortController.signal.aborted) {
                    setLoading(false);
                }
            }
        };
        fetchPopularProducts();
        // Cleanup: cancelar la request si el componente se desmonta
        return ()=>{
            abortController.abort();
        };
    }, []);
    const handleAddToCart = (productId)=>{
        // Buscar el producto en la lista
        const product = products.find((p)=>p.id.toString() === productId);
        if (product) {
            // Convertir el producto al formato esperado por el carrito
            const cartItem = {
                id: product.id,
                title: product.name,
                brand: product.brand || '',
                price: product.price,
                discountedPrice: product.discounted_price || product.price,
                imgs: {
                    thumbnails: product.images ? [
                        product.images[0]
                    ] : [],
                    previews: product.images || []
                },
                reviews: 0,
                quantity: 1
            };
            dispatch((0, _cartslice.addItemToCart)(cartItem));
        }
        // Llamar callback personalizado si existe
        if (onAddToCart) {
            onAddToCart(productId);
        }
    };
    return /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
        className: (0, _utils.cn)("bg-white rounded-xl border border-gray-200 p-4", className),
        children: [
            /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                className: "flex items-center justify-between mb-4",
                children: /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                    children: [
                        /*#__PURE__*/ (0, _jsxruntime.jsx)("h4", {
                            className: "font-bold text-gray-900 text-sm",
                            children: "Productos Populares"
                        }),
                        /*#__PURE__*/ (0, _jsxruntime.jsx)("p", {
                            className: "text-xs text-gray-600",
                            children: "Agrega r\xe1pidamente a tu carrito"
                        })
                    ]
                })
            }),
            /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                className: "space-y-3",
                children: loading ? /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                    className: "flex items-center justify-center py-8",
                    children: [
                        /*#__PURE__*/ (0, _jsxruntime.jsx)(_optimizedimports.Loader2, {
                            className: "w-6 h-6 animate-spin text-gray-400"
                        }),
                        /*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                            className: "ml-2 text-sm text-gray-500",
                            children: "Cargando productos..."
                        })
                    ]
                }) : error ? /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    className: "text-center py-4",
                    children: /*#__PURE__*/ (0, _jsxruntime.jsx)("p", {
                        className: "text-sm text-red-500",
                        children: error
                    })
                }) : products.length === 0 ? /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    className: "text-center py-4",
                    children: /*#__PURE__*/ (0, _jsxruntime.jsx)("p", {
                        className: "text-sm text-gray-500",
                        children: "No hay productos disponibles"
                    })
                }) : products.map((product)=>{
                    const currentPrice = product.discounted_price || product.price;
                    const originalPrice = product.discounted_price ? product.price : null;
                    const hasDiscount = originalPrice && currentPrice < originalPrice;
                    return /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                        className: "flex items-center gap-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors duration-200",
                        children: [
                            /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                className: "w-16 h-16 bg-gray-200 rounded-xl overflow-hidden flex-shrink-0 shadow-sm border border-gray-300",
                                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_image.default, {
                                    src: (0, _productadapter.getValidImageUrl)(product.images?.[0]),
                                    alt: product.name,
                                    width: 64,
                                    height: 64,
                                    className: "w-full h-full object-cover"
                                })
                            }),
                            /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                className: "flex-1 min-w-0",
                                children: [
                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("h5", {
                                        className: "font-semibold text-xs text-gray-900 line-clamp-1",
                                        children: product.name
                                    }),
                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("p", {
                                        className: "text-2xs text-gray-500 mb-1",
                                        children: product.brand || 'Sin marca'
                                    }),
                                    /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                        className: "flex items-center gap-2",
                                        children: [
                                            /*#__PURE__*/ (0, _jsxruntime.jsxs)("span", {
                                                className: "font-bold text-sm",
                                                style: {
                                                    color: '#ea5a17'
                                                },
                                                children: [
                                                    "$",
                                                    currentPrice.toLocaleString()
                                                ]
                                            }),
                                            hasDiscount && /*#__PURE__*/ (0, _jsxruntime.jsxs)("span", {
                                                className: "text-2xs text-gray-400 line-through",
                                                children: [
                                                    "$",
                                                    originalPrice.toLocaleString()
                                                ]
                                            })
                                        ]
                                    }),
                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                        className: "flex items-center gap-1 mt-1",
                                        children: /*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                                            className: "text-2xs text-gray-600",
                                            children: product.category?.name || 'General'
                                        })
                                    })
                                ]
                            }),
                            /*#__PURE__*/ (0, _jsxruntime.jsx)(_button.Button, {
                                size: "sm",
                                onClick: ()=>handleAddToCart(product.id.toString()),
                                className: "h-10 w-10 p-0 bg-yellow-400 hover:bg-yellow-500 text-black rounded-xl shadow-md hover:shadow-lg transition-all duration-200",
                                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_optimizedimports.Plus, {
                                    className: "w-5 h-5"
                                })
                            })
                        ]
                    }, product.id);
                })
            }),
            /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                className: "mt-4 pt-3 border-t border-gray-200",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_button.Button, {
                    variant: "ghost",
                    size: "sm",
                    onClick: onClose,
                    className: "w-full text-xs text-gray-600 hover:text-gray-900",
                    children: "Ver todos los productos →"
                })
            })
        ]
    });
};
const _default = QuickAddSuggestions;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcY29tcG9uZW50c1xcdWlcXHF1aWNrLWFkZC1zdWdnZXN0aW9ucy50c3giXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2UgY2xpZW50XCI7XG5cbmltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0IH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBCdXR0b24gfSBmcm9tIFwiQC9jb21wb25lbnRzL3VpL2J1dHRvblwiO1xuaW1wb3J0IHsgUGx1cywgU3RhciwgTG9hZGVyMiB9IGZyb20gXCJAL2xpYi9vcHRpbWl6ZWQtaW1wb3J0c1wiO1xuaW1wb3J0IHsgY24gfSBmcm9tIFwiQC9saWIvdXRpbHNcIjtcbmltcG9ydCB7IGdldFByb2R1Y3RzIH0gZnJvbSBcIkAvbGliL2FwaS9wcm9kdWN0c1wiO1xuaW1wb3J0IHsgUHJvZHVjdFdpdGhDYXRlZ29yeSB9IGZyb20gXCJAL3R5cGVzL2FwaVwiO1xuaW1wb3J0IHsgZ2V0VmFsaWRJbWFnZVVybCB9IGZyb20gXCJAL2xpYi9hZGFwdGVycy9wcm9kdWN0LWFkYXB0ZXJcIjtcbmltcG9ydCBJbWFnZSBmcm9tIFwibmV4dC9pbWFnZVwiO1xuaW1wb3J0IHsgdXNlRGlzcGF0Y2ggfSBmcm9tIFwicmVhY3QtcmVkdXhcIjtcbmltcG9ydCB7IEFwcERpc3BhdGNoIH0gZnJvbSBcIkAvcmVkdXgvc3RvcmVcIjtcbmltcG9ydCB7IGFkZEl0ZW1Ub0NhcnQgfSBmcm9tIFwiQC9yZWR1eC9mZWF0dXJlcy9jYXJ0LXNsaWNlXCI7XG5cbmludGVyZmFjZSBRdWlja0FkZFN1Z2dlc3Rpb25zUHJvcHMge1xuICBvbkFkZFRvQ2FydD86IChwcm9kdWN0SWQ6IHN0cmluZykgPT4gdm9pZDtcbiAgb25DbG9zZT86ICgpID0+IHZvaWQ7XG4gIGNsYXNzTmFtZT86IHN0cmluZztcbn1cblxuY29uc3QgUXVpY2tBZGRTdWdnZXN0aW9uczogUmVhY3QuRkM8UXVpY2tBZGRTdWdnZXN0aW9uc1Byb3BzPiA9ICh7XG4gIG9uQWRkVG9DYXJ0LFxuICBvbkNsb3NlLFxuICBjbGFzc05hbWVcbn0pID0+IHtcbiAgY29uc3QgW3Byb2R1Y3RzLCBzZXRQcm9kdWN0c10gPSB1c2VTdGF0ZTxQcm9kdWN0V2l0aENhdGVnb3J5W10+KFtdKTtcbiAgY29uc3QgW2xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGUodHJ1ZSk7XG4gIGNvbnN0IFtlcnJvciwgc2V0RXJyb3JdID0gdXNlU3RhdGU8c3RyaW5nIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IGRpc3BhdGNoID0gdXNlRGlzcGF0Y2g8QXBwRGlzcGF0Y2g+KCk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBhYm9ydENvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG5cbiAgICBjb25zdCBmZXRjaFBvcHVsYXJQcm9kdWN0cyA9IGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHNldExvYWRpbmcodHJ1ZSk7XG4gICAgICAgIHNldEVycm9yKG51bGwpO1xuXG4gICAgICAgIC8vIE9idGVuZXIgcHJvZHVjdG9zIGNvbiBkZXNjdWVudG8gKHBvcHVsYXJlcykgbGltaXRhZG9zIGEgM1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdldFByb2R1Y3RzKHtcbiAgICAgICAgICBsaW1pdDogMyxcbiAgICAgICAgICBzb3J0Qnk6ICdjcmVhdGVkX2F0JyxcbiAgICAgICAgICBzb3J0T3JkZXI6ICdkZXNjJ1xuICAgICAgICB9LCBhYm9ydENvbnRyb2xsZXIuc2lnbmFsKTtcblxuICAgICAgICAvLyBWZXJpZmljYXIgc2kgZWwgY29tcG9uZW50ZSBhw7puIGVzdMOhIG1vbnRhZG9cbiAgICAgICAgaWYgKGFib3J0Q29udHJvbGxlci5zaWduYWwuYWJvcnRlZCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChyZXNwb25zZS5zdWNjZXNzICYmIHJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgICBzZXRQcm9kdWN0cyhyZXNwb25zZS5kYXRhKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzZXRFcnJvcignTm8gc2UgcHVkaWVyb24gY2FyZ2FyIGxvcyBwcm9kdWN0b3MnKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIC8vIFNvbG8gbW9zdHJhciBlcnJvciBzaSBubyBmdWUgY2FuY2VsYWRvXG4gICAgICAgIGlmICghYWJvcnRDb250cm9sbGVyLnNpZ25hbC5hYm9ydGVkICYmIGVyciBpbnN0YW5jZW9mIEVycm9yICYmIGVyci5uYW1lICE9PSAnQWJvcnRFcnJvcicpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBwb3B1bGFyIHByb2R1Y3RzOicsIGVycik7XG4gICAgICAgICAgc2V0RXJyb3IoJ0Vycm9yIGFsIGNhcmdhciBwcm9kdWN0b3MgcG9wdWxhcmVzJyk7XG4gICAgICAgIH1cbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIC8vIFNvbG8gYWN0dWFsaXphciBsb2FkaW5nIHNpIG5vIGZ1ZSBjYW5jZWxhZG9cbiAgICAgICAgaWYgKCFhYm9ydENvbnRyb2xsZXIuc2lnbmFsLmFib3J0ZWQpIHtcbiAgICAgICAgICBzZXRMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICBmZXRjaFBvcHVsYXJQcm9kdWN0cygpO1xuXG4gICAgLy8gQ2xlYW51cDogY2FuY2VsYXIgbGEgcmVxdWVzdCBzaSBlbCBjb21wb25lbnRlIHNlIGRlc21vbnRhXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGFib3J0Q29udHJvbGxlci5hYm9ydCgpO1xuICAgIH07XG4gIH0sIFtdKTtcblxuICBjb25zdCBoYW5kbGVBZGRUb0NhcnQgPSAocHJvZHVjdElkOiBzdHJpbmcpID0+IHtcbiAgICAvLyBCdXNjYXIgZWwgcHJvZHVjdG8gZW4gbGEgbGlzdGFcbiAgICBjb25zdCBwcm9kdWN0ID0gcHJvZHVjdHMuZmluZChwID0+IHAuaWQudG9TdHJpbmcoKSA9PT0gcHJvZHVjdElkKTtcblxuICAgIGlmIChwcm9kdWN0KSB7XG4gICAgICAvLyBDb252ZXJ0aXIgZWwgcHJvZHVjdG8gYWwgZm9ybWF0byBlc3BlcmFkbyBwb3IgZWwgY2Fycml0b1xuICAgICAgY29uc3QgY2FydEl0ZW0gPSB7XG4gICAgICAgIGlkOiBwcm9kdWN0LmlkLFxuICAgICAgICB0aXRsZTogcHJvZHVjdC5uYW1lLFxuICAgICAgICBicmFuZDogcHJvZHVjdC5icmFuZCB8fCAnJyxcbiAgICAgICAgcHJpY2U6IHByb2R1Y3QucHJpY2UsXG4gICAgICAgIGRpc2NvdW50ZWRQcmljZTogcHJvZHVjdC5kaXNjb3VudGVkX3ByaWNlIHx8IHByb2R1Y3QucHJpY2UsXG4gICAgICAgIGltZ3M6IHtcbiAgICAgICAgICB0aHVtYm5haWxzOiBwcm9kdWN0LmltYWdlcyA/IFtwcm9kdWN0LmltYWdlc1swXV0gOiBbXSxcbiAgICAgICAgICBwcmV2aWV3czogcHJvZHVjdC5pbWFnZXMgfHwgW11cbiAgICAgICAgfSxcbiAgICAgICAgcmV2aWV3czogMCwgLy8gTm8gdGVuZW1vcyByZXZpZXdzIGVuIGxhIEFQSSBhY3R1YWxcbiAgICAgICAgcXVhbnRpdHk6IDFcbiAgICAgIH07XG5cbiAgICAgIGRpc3BhdGNoKGFkZEl0ZW1Ub0NhcnQoY2FydEl0ZW0pKTtcbiAgICB9XG5cbiAgICAvLyBMbGFtYXIgY2FsbGJhY2sgcGVyc29uYWxpemFkbyBzaSBleGlzdGVcbiAgICBpZiAob25BZGRUb0NhcnQpIHtcbiAgICAgIG9uQWRkVG9DYXJ0KHByb2R1Y3RJZCk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9e2NuKFwiYmctd2hpdGUgcm91bmRlZC14bCBib3JkZXIgYm9yZGVyLWdyYXktMjAwIHAtNFwiLCBjbGFzc05hbWUpfT5cbiAgICAgIHsvKiBIZWFkZXIgKi99XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlbiBtYi00XCI+XG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgPGg0IGNsYXNzTmFtZT1cImZvbnQtYm9sZCB0ZXh0LWdyYXktOTAwIHRleHQtc21cIj5Qcm9kdWN0b3MgUG9wdWxhcmVzPC9oND5cbiAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXhzIHRleHQtZ3JheS02MDBcIj5BZ3JlZ2EgcsOhcGlkYW1lbnRlIGEgdHUgY2Fycml0bzwvcD5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cblxuICAgICAgey8qIExpc3RhIGRlIHByb2R1Y3RvcyAqL31cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS0zXCI+XG4gICAgICAgIHtsb2FkaW5nID8gKFxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgcHktOFwiPlxuICAgICAgICAgICAgPExvYWRlcjIgY2xhc3NOYW1lPVwidy02IGgtNiBhbmltYXRlLXNwaW4gdGV4dC1ncmF5LTQwMFwiIC8+XG4gICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJtbC0yIHRleHQtc20gdGV4dC1ncmF5LTUwMFwiPkNhcmdhbmRvIHByb2R1Y3Rvcy4uLjwvc3Bhbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSA6IGVycm9yID8gKFxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXIgcHktNFwiPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LXJlZC01MDBcIj57ZXJyb3J9PC9wPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApIDogcHJvZHVjdHMubGVuZ3RoID09PSAwID8gKFxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXIgcHktNFwiPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LWdyYXktNTAwXCI+Tm8gaGF5IHByb2R1Y3RvcyBkaXNwb25pYmxlczwvcD5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSA6IChcbiAgICAgICAgICBwcm9kdWN0cy5tYXAoKHByb2R1Y3QpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRQcmljZSA9IHByb2R1Y3QuZGlzY291bnRlZF9wcmljZSB8fCBwcm9kdWN0LnByaWNlO1xuICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxQcmljZSA9IHByb2R1Y3QuZGlzY291bnRlZF9wcmljZSA/IHByb2R1Y3QucHJpY2UgOiBudWxsO1xuICAgICAgICAgICAgY29uc3QgaGFzRGlzY291bnQgPSBvcmlnaW5hbFByaWNlICYmIGN1cnJlbnRQcmljZSA8IG9yaWdpbmFsUHJpY2U7XG5cbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICBrZXk9e3Byb2R1Y3QuaWR9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTMgcC0zIGJnLWdyYXktNTAgcm91bmRlZC1sZyBob3ZlcjpiZy1ncmF5LTEwMCB0cmFuc2l0aW9uLWNvbG9ycyBkdXJhdGlvbi0yMDBcIlxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgey8qIEltYWdlbiBkZWwgcHJvZHVjdG8gKi99XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LTE2IGgtMTYgYmctZ3JheS0yMDAgcm91bmRlZC14bCBvdmVyZmxvdy1oaWRkZW4gZmxleC1zaHJpbmstMCBzaGFkb3ctc20gYm9yZGVyIGJvcmRlci1ncmF5LTMwMFwiPlxuICAgICAgICAgICAgICAgICAgPEltYWdlXG4gICAgICAgICAgICAgICAgICAgIHNyYz17Z2V0VmFsaWRJbWFnZVVybChwcm9kdWN0LmltYWdlcz8uWzBdKX1cbiAgICAgICAgICAgICAgICAgICAgYWx0PXtwcm9kdWN0Lm5hbWV9XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoPXs2NH1cbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0PXs2NH1cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy1mdWxsIGgtZnVsbCBvYmplY3QtY292ZXJcIlxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgIHsvKiBJbmZvIGRlbCBwcm9kdWN0byAqL31cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBtaW4tdy0wXCI+XG4gICAgICAgICAgICAgICAgICA8aDUgY2xhc3NOYW1lPVwiZm9udC1zZW1pYm9sZCB0ZXh0LXhzIHRleHQtZ3JheS05MDAgbGluZS1jbGFtcC0xXCI+XG4gICAgICAgICAgICAgICAgICAgIHtwcm9kdWN0Lm5hbWV9XG4gICAgICAgICAgICAgICAgICA8L2g1PlxuICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC0yeHMgdGV4dC1ncmF5LTUwMCBtYi0xXCI+e3Byb2R1Y3QuYnJhbmQgfHwgJ1NpbiBtYXJjYSd9PC9wPlxuXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0yXCI+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImZvbnQtYm9sZCB0ZXh0LXNtXCIgc3R5bGU9e3sgY29sb3I6ICcjZWE1YTE3JyB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAke2N1cnJlbnRQcmljZS50b0xvY2FsZVN0cmluZygpfVxuICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgIHtoYXNEaXNjb3VudCAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC0yeHMgdGV4dC1ncmF5LTQwMCBsaW5lLXRocm91Z2hcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICR7b3JpZ2luYWxQcmljZSEudG9Mb2NhbGVTdHJpbmcoKX1cbiAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgICAgey8qIENhdGVnb3LDrWEgKi99XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0xIG10LTFcIj5cbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC0yeHMgdGV4dC1ncmF5LTYwMFwiPntwcm9kdWN0LmNhdGVnb3J5Py5uYW1lIHx8ICdHZW5lcmFsJ308L3NwYW4+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgIHsvKiBCb3TDs24gYWdyZWdhciAqL31cbiAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICBzaXplPVwic21cIlxuICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gaGFuZGxlQWRkVG9DYXJ0KHByb2R1Y3QuaWQudG9TdHJpbmcoKSl9XG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJoLTEwIHctMTAgcC0wIGJnLXllbGxvdy00MDAgaG92ZXI6YmcteWVsbG93LTUwMCB0ZXh0LWJsYWNrIHJvdW5kZWQteGwgc2hhZG93LW1kIGhvdmVyOnNoYWRvdy1sZyB0cmFuc2l0aW9uLWFsbCBkdXJhdGlvbi0yMDBcIlxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgIDxQbHVzIGNsYXNzTmFtZT1cInctNSBoLTVcIiAvPlxuICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSlcbiAgICAgICAgKX1cbiAgICAgIDwvZGl2PlxuXG4gICAgICB7LyogRm9vdGVyIGNvbiBlbmxhY2UgYSB2ZXIgbcOhcyAqL31cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXQtNCBwdC0zIGJvcmRlci10IGJvcmRlci1ncmF5LTIwMFwiPlxuICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgdmFyaWFudD1cImdob3N0XCJcbiAgICAgICAgICBzaXplPVwic21cIlxuICAgICAgICAgIG9uQ2xpY2s9e29uQ2xvc2V9XG4gICAgICAgICAgY2xhc3NOYW1lPVwidy1mdWxsIHRleHQteHMgdGV4dC1ncmF5LTYwMCBob3Zlcjp0ZXh0LWdyYXktOTAwXCJcbiAgICAgICAgPlxuICAgICAgICAgIFZlciB0b2RvcyBsb3MgcHJvZHVjdG9zIOKGklxuICAgICAgICA8L0J1dHRvbj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICApO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgUXVpY2tBZGRTdWdnZXN0aW9ucztcbiJdLCJuYW1lcyI6WyJRdWlja0FkZFN1Z2dlc3Rpb25zIiwib25BZGRUb0NhcnQiLCJvbkNsb3NlIiwiY2xhc3NOYW1lIiwicHJvZHVjdHMiLCJzZXRQcm9kdWN0cyIsInVzZVN0YXRlIiwibG9hZGluZyIsInNldExvYWRpbmciLCJlcnJvciIsInNldEVycm9yIiwiZGlzcGF0Y2giLCJ1c2VEaXNwYXRjaCIsInVzZUVmZmVjdCIsImFib3J0Q29udHJvbGxlciIsIkFib3J0Q29udHJvbGxlciIsImZldGNoUG9wdWxhclByb2R1Y3RzIiwicmVzcG9uc2UiLCJnZXRQcm9kdWN0cyIsImxpbWl0Iiwic29ydEJ5Iiwic29ydE9yZGVyIiwic2lnbmFsIiwiYWJvcnRlZCIsInN1Y2Nlc3MiLCJkYXRhIiwiZXJyIiwiRXJyb3IiLCJuYW1lIiwiY29uc29sZSIsImFib3J0IiwiaGFuZGxlQWRkVG9DYXJ0IiwicHJvZHVjdElkIiwicHJvZHVjdCIsImZpbmQiLCJwIiwiaWQiLCJ0b1N0cmluZyIsImNhcnRJdGVtIiwidGl0bGUiLCJicmFuZCIsInByaWNlIiwiZGlzY291bnRlZFByaWNlIiwiZGlzY291bnRlZF9wcmljZSIsImltZ3MiLCJ0aHVtYm5haWxzIiwiaW1hZ2VzIiwicHJldmlld3MiLCJyZXZpZXdzIiwicXVhbnRpdHkiLCJhZGRJdGVtVG9DYXJ0IiwiZGl2IiwiY24iLCJoNCIsIkxvYWRlcjIiLCJzcGFuIiwibGVuZ3RoIiwibWFwIiwiY3VycmVudFByaWNlIiwib3JpZ2luYWxQcmljZSIsImhhc0Rpc2NvdW50IiwiSW1hZ2UiLCJzcmMiLCJnZXRWYWxpZEltYWdlVXJsIiwiYWx0Iiwid2lkdGgiLCJoZWlnaHQiLCJoNSIsInN0eWxlIiwiY29sb3IiLCJ0b0xvY2FsZVN0cmluZyIsImNhdGVnb3J5IiwiQnV0dG9uIiwic2l6ZSIsIm9uQ2xpY2siLCJQbHVzIiwidmFyaWFudCJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7OytCQThNQTs7O2VBQUE7Ozs7K0RBNU0yQzt3QkFDcEI7a0NBQ2E7dUJBQ2pCOzBCQUNTO2dDQUVLOzhEQUNmOzRCQUNVOzJCQUVFOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQVE5QixNQUFNQSxzQkFBMEQsQ0FBQyxFQUMvREMsV0FBVyxFQUNYQyxPQUFPLEVBQ1BDLFNBQVMsRUFDVjtJQUNDLE1BQU0sQ0FBQ0MsVUFBVUMsWUFBWSxHQUFHQyxJQUFBQSxlQUFRLEVBQXdCLEVBQUU7SUFDbEUsTUFBTSxDQUFDQyxTQUFTQyxXQUFXLEdBQUdGLElBQUFBLGVBQVEsRUFBQztJQUN2QyxNQUFNLENBQUNHLE9BQU9DLFNBQVMsR0FBR0osSUFBQUEsZUFBUSxFQUFnQjtJQUNsRCxNQUFNSyxXQUFXQyxJQUFBQSx1QkFBVztJQUU1QkMsSUFBQUEsZ0JBQVMsRUFBQztRQUNSLE1BQU1DLGtCQUFrQixJQUFJQztRQUU1QixNQUFNQyx1QkFBdUI7WUFDM0IsSUFBSTtnQkFDRlIsV0FBVztnQkFDWEUsU0FBUztnQkFFVCw0REFBNEQ7Z0JBQzVE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