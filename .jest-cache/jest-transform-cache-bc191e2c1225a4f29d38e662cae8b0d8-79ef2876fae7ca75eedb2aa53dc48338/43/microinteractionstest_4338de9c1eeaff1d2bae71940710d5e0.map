{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\components\\Header\\__tests__\\microinteractions.test.tsx"],"sourcesContent":["/**\n * @jest-environment jsdom\n */\n\nimport React from 'react';\nimport { render, screen, fireEvent, waitFor } from '@testing-library/react';\nimport { Provider } from 'react-redux';\nimport { configureStore } from '@reduxjs/toolkit';\nimport Header from '../index';\nimport { CartSidebarModalProvider } from '@/app/context/CartSidebarModalContext';\nimport cartReducer from '@/redux/features/cart-slice';\n\n// Mock de Clerk\njest.mock('@clerk/nextjs', () => ({\n  SignedIn: ({ children }: { children: React.ReactNode }) => <div data-testid=\"signed-in\">{children}</div>,\n  SignedOut: ({ children }: { children: React.ReactNode }) => <div data-testid=\"signed-out\">{children}</div>,\n  UserButton: () => <div data-testid=\"user-button\">User</div>,\n  useUser: () => ({ isLoaded: true }),\n}));\n\n// Mock de hooks\njest.mock('@/hooks/useGeolocation', () => ({\n  useGeolocation: () => ({\n    detectedZone: { name: 'C贸rdoba Capital', available: true },\n    requestLocation: jest.fn(),\n    permissionStatus: 'granted',\n    isLoading: false,\n    error: null,\n    location: null,\n    testLocation: jest.fn(),\n    deliveryZones: [{ id: 'cordoba-capital', name: 'C贸rdoba Capital' }],\n  }),\n}));\n\njest.mock('@/hooks/useCartAnimation', () => ({\n  useCartAnimation: () => ({ isAnimating: false }),\n}));\n\n// Mock de componentes\njest.mock('@/components/ui/optimized-cart-icon', () => ({\n  OptimizedCartIcon: () => <div data-testid=\"cart-icon\">Cart</div>,\n}));\n\njest.mock('@/components/ui/OptimizedLogo', () => ({\n  HeaderLogo: ({ className, isMobile }: { className?: string; isMobile?: boolean }) => (\n    <img\n      data-testid={isMobile ? \"header-logo-mobile\" : \"header-logo\"}\n      className={className}\n      alt=\"Pinteya\"\n    />\n  ),\n}));\n\njest.mock('@/components/ui/SearchAutocompleteIntegrated', () => ({\n  SearchAutocompleteIntegrated: ({ className, placeholder }: { className?: string; placeholder?: string }) => (\n    <input data-testid=\"search-input\" className={className} placeholder={placeholder} />\n  ),\n}));\n\n// Mock de GeolocationDebugger\njest.mock('../GeolocationDebugger', () => {\n  return function GeolocationDebugger() {\n    return <div data-testid=\"geolocation-debugger\">Geolocation Debugger</div>;\n  };\n});\n\n// Store de prueba\nconst createTestStore = () => {\n  return configureStore({\n    reducer: {\n      cartReducer,\n    },\n    preloadedState: {\n      cartReducer: {\n        items: [\n          { id: '1', name: 'Producto Test', price: 100, quantity: 1 }\n        ],\n      },\n    },\n  });\n};\n\nconst TestWrapper = ({ children }: { children: React.ReactNode }) => {\n  const store = createTestStore();\n  return (\n    <Provider store={store}>\n      <CartSidebarModalProvider>\n        {children}\n      </CartSidebarModalProvider>\n    </Provider>\n  );\n};\n\ndescribe('Header Microinteractions', () => {\n  beforeEach(() => {\n    // Mock de window.scrollY para sticky header\n    Object.defineProperty(window, 'scrollY', {\n      writable: true,\n      value: 0,\n    });\n\n    // Mock de addEventListener para scroll\n    window.addEventListener = jest.fn();\n    window.removeEventListener = jest.fn();\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('Sticky Header Behavior', () => {\n    it('should apply sticky classes when scrolling', async () => {\n      render(\n        <TestWrapper>\n          <Header />\n        </TestWrapper>\n      );\n\n      const header = screen.getByRole('banner');\n      expect(header).toHaveClass('fixed');\n      expect(header).toHaveClass('header-sticky-transition');\n    });\n\n    it('should register scroll event listener', () => {\n      render(\n        <TestWrapper>\n          <Header />\n        </TestWrapper>\n      );\n\n      expect(window.addEventListener).toHaveBeenCalledWith(\n        'scroll',\n        expect.any(Function),\n        { passive: true }\n      );\n    });\n  });\n\n  describe('Button Animations', () => {\n    it('should apply hover classes to cart button', () => {\n      render(\n        <TestWrapper>\n          <Header />\n        </TestWrapper>\n      );\n\n      const cartButton = screen.getByTestId('cart-icon').closest('button');\n      expect(cartButton).toHaveClass('floating-button');\n      expect(cartButton).toHaveClass('focus-ring');\n    });\n\n    it('should apply animation classes to logo', () => {\n      render(\n        <TestWrapper>\n          <Header />\n        </TestWrapper>\n      );\n\n      // Buscar logo desktop o mobile\n      const logoDesktop = screen.queryByTestId('header-logo');\n      const logoMobile = screen.queryByTestId('header-logo-mobile');\n\n      const logo = logoDesktop || logoMobile;\n      expect(logo).toBeTruthy();\n\n      if (logo) {\n        expect(logo).toHaveClass('transition-all');\n        expect(logo).toHaveClass('duration-300');\n      }\n    });\n  });\n\n  describe('Search Animations', () => {\n    it('should apply search focus ring classes', () => {\n      render(\n        <TestWrapper>\n          <Header />\n        </TestWrapper>\n      );\n\n      // Buscar el contenedor del search que tiene la clase search-focus-ring\n      const searchContainers = screen.getByTestId('search-input').closest('form')?.querySelector('div');\n      expect(searchContainers).toBeTruthy();\n    });\n\n    it('should have transition classes on search input', () => {\n      render(\n        <TestWrapper>\n          <Header />\n        </TestWrapper>\n      );\n\n      const searchInput = screen.getByTestId('search-input');\n      expect(searchInput.className).toContain('transition-all');\n      expect(searchInput.className).toContain('duration-300');\n    });\n  });\n\n  describe('Geolocation Animations', () => {\n    it('should apply hover animations to location button', () => {\n      render(\n        <TestWrapper>\n          <Header />\n        </TestWrapper>\n      );\n\n      // Buscar el elemento de ubicaci贸n en el topbar\n      const locationElements = screen.getAllByText(/C贸rdoba Capital/i);\n      expect(locationElements.length).toBeGreaterThan(0);\n    });\n  });\n\n  describe('Accessibility', () => {\n    it('should have focus-ring classes for keyboard navigation', () => {\n      render(\n        <TestWrapper>\n          <Header />\n        </TestWrapper>\n      );\n\n      const cartButton = screen.getByTestId('cart-icon').closest('button');\n      expect(cartButton).toHaveClass('focus-ring');\n    });\n\n    it('should maintain accessibility attributes', () => {\n      render(\n        <TestWrapper>\n          <Header />\n        </TestWrapper>\n      );\n\n      const header = screen.getByRole('banner');\n      expect(header).toBeInTheDocument();\n    });\n  });\n\n  describe('Performance', () => {\n    it('should use CSS transitions instead of JavaScript animations', () => {\n      render(\n        <TestWrapper>\n          <Header />\n        </TestWrapper>\n      );\n\n      const cartButton = screen.getByTestId('cart-icon').closest('button');\n      expect(cartButton?.className).toContain('transition-all');\n      expect(cartButton?.className).toContain('duration-300');\n    });\n\n    it('should have passive scroll listeners', () => {\n      render(\n        <TestWrapper>\n          <Header />\n        </TestWrapper>\n      );\n\n      expect(window.addEventListener).toHaveBeenCalledWith(\n        'scroll',\n        expect.any(Function),\n        { passive: true }\n      );\n    });\n  });\n\n  describe('Responsive Behavior', () => {\n    it('should apply responsive classes', () => {\n      render(\n        <TestWrapper>\n          <Header />\n        </TestWrapper>\n      );\n\n      const logo = screen.getByTestId('header-logo');\n      expect(logo.className).toContain('hidden sm:block');\n    });\n  });\n});\n"],"names":["jest","mock","SignedIn","children","div","data-testid","SignedOut","UserButton","useUser","isLoaded","useGeolocation","detectedZone","name","available","requestLocation","fn","permissionStatus","isLoading","error","location","testLocation","deliveryZones","id","useCartAnimation","isAnimating","OptimizedCartIcon","HeaderLogo","className","isMobile","img","alt","SearchAutocompleteIntegrated","placeholder","input","GeolocationDebugger","createTestStore","configureStore","reducer","cartReducer","preloadedState","items","price","quantity","TestWrapper","store","Provider","CartSidebarModalProvider","describe","beforeEach","Object","defineProperty","window","writable","value","addEventListener","removeEventListener","afterEach","clearAllMocks","it","render","Header","header","screen","getByRole","expect","toHaveClass","toHaveBeenCalledWith","any","Function","passive","cartButton","getByTestId","closest","logoDesktop","queryByTestId","logoMobile","logo","toBeTruthy","searchContainers","querySelector","searchInput","toContain","locationElements","getAllByText","length","toBeGreaterThan","toBeInTheDocument"],"mappings":"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"}