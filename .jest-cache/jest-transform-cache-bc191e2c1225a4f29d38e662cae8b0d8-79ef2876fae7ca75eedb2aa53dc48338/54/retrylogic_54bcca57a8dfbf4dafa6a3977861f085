8b3afc204e5ae0ceba487cf994cce7e2
// ===================================
// PINTEYA E-COMMERCE - RETRY LOGIC WITH EXPONENTIAL BACKOFF
// ===================================
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get RETRY_CONFIGS () {
        return RETRY_CONFIGS;
    },
    get createRetryFunction () {
        return createRetryFunction;
    },
    get retryMercadoPagoOperation () {
        return retryMercadoPagoOperation;
    },
    get retryWebhookOperation () {
        return retryWebhookOperation;
    },
    get retryWithBackoff () {
        return retryWithBackoff;
    }
});
const _logger = require("./logger");
const _metrics = require("./metrics");
const RETRY_CONFIGS = {
    // Para llamadas críticas a MercadoPago
    MERCADOPAGO_CRITICAL: {
        maxRetries: 3,
        baseDelayMs: 1000,
        maxDelayMs: 30000,
        backoffMultiplier: 2,
        jitterMs: 500,
        retryableErrors: [
            'ECONNRESET',
            'ENOTFOUND',
            'ECONNREFUSED',
            'ETIMEDOUT',
            'NETWORK_ERROR',
            'TIMEOUT',
            '500',
            '502',
            '503',
            '504',
            '429' // Rate limit - retry después de delay
        ],
        nonRetryableErrors: [
            '400',
            '401',
            '403',
            '404',
            '422',
            'INVALID_CREDENTIALS',
            'INVALID_REQUEST',
            'PAYMENT_REJECTED'
        ]
    },
    // Para operaciones de consulta menos críticas
    MERCADOPAGO_QUERY: {
        maxRetries: 2,
        baseDelayMs: 500,
        maxDelayMs: 10000,
        backoffMultiplier: 2,
        jitterMs: 250,
        retryableErrors: [
            'ECONNRESET',
            'ENOTFOUND',
            'ETIMEDOUT',
            '500',
            '502',
            '503',
            '504'
        ],
        nonRetryableErrors: [
            '400',
            '401',
            '403',
            '404',
            '422'
        ]
    },
    // Para webhooks (menos agresivo)
    WEBHOOK_PROCESSING: {
        maxRetries: 1,
        baseDelayMs: 2000,
        maxDelayMs: 5000,
        backoffMultiplier: 1.5,
        jitterMs: 1000,
        retryableErrors: [
            'ECONNRESET',
            'ETIMEDOUT',
            '500',
            '503'
        ],
        nonRetryableErrors: [
            '400',
            '401',
            '403',
            '404',
            '422',
            'DUPLICATE_WEBHOOK'
        ]
    }
};
/**
 * Calcula el delay para el siguiente intento usando backoff exponencial con jitter
 */ function calculateDelay(attempt, config) {
    // Backoff exponencial: baseDelay * (multiplier ^ attempt)
    const exponentialDelay = config.baseDelayMs * Math.pow(config.backoffMultiplier, attempt);
    // Aplicar límite máximo
    const cappedDelay = Math.min(exponentialDelay, config.maxDelayMs);
    // Agregar jitter aleatorio para evitar thundering herd
    const jitter = Math.random() * config.jitterMs;
    return Math.floor(cappedDelay + jitter);
}
/**
 * Determina si un error es reintentable
 */ function isRetryableError(error, config) {
    const errorMessage = (error.message || '').toLowerCase();
    const errorName = (error.name || '').toLowerCase();
    // Verificar errores no reintenables primero (tienen prioridad)
    for (const nonRetryableError of config.nonRetryableErrors){
        if (errorMessage.includes(nonRetryableError.toLowerCase()) || errorName.includes(nonRetryableError.toLowerCase())) {
            return false;
        }
    }
    // Verificar errores reintenables
    for (const retryableError of config.retryableErrors){
        if (errorMessage.includes(retryableError.toLowerCase()) || errorName.includes(retryableError.toLowerCase())) {
            return true;
        }
    }
    // Por defecto, no reintentar errores desconocidos
    return false;
}
/**
 * Extrae información del error para logging
 */ function extractErrorInfo(error) {
    const message = (error.message || '').toLowerCase();
    const name = (error.name || '').toLowerCase();
    // Detectar errores de red
    const networkErrors = [
        'econnreset',
        'enotfound',
        'econnrefused',
        'etimedout'
    ];
    const isNetwork = networkErrors.some((netError)=>message.includes(netError) || name.includes(netError));
    // Extraer código de estado HTTP si existe
    const statusMatch = message.match(/(\d{3})/);
    const statusCode = statusMatch ? parseInt(statusMatch[1]) : undefined;
    return {
        type: name || 'unknown',
        code: statusCode?.toString(),
        statusCode,
        isNetwork
    };
}
async function retryWithBackoff(operation, config, operationName = 'unknown') {
    const startTime = Date.now();
    let lastError;
    let attempts = 0;
    _logger.logger.info(_logger.LogCategory.API, `Starting retry operation: ${operationName}`);
    for(let attempt = 0; attempt <= config.maxRetries; attempt++){
        attempts = attempt + 1;
        const attemptStart = Date.now();
        try {
            _logger.logger.info(_logger.LogCategory.API, `Retry attempt ${attempts}/${config.maxRetries + 1} for ${operationName}`);
            const result = await operation();
            const attemptDuration = Date.now() - attemptStart;
            const totalDuration = Date.now() - startTime;
            _logger.logger.info(_logger.LogCategory.API, `Retry operation succeeded: ${operationName}`);
            // ✅ NUEVO: Registrar métricas de retry exitoso
            await _metrics.metricsCollector.recordRetry(operationName, attempts, true, totalDuration);
            return {
                success: true,
                data: result,
                attempts,
                totalDuration,
                lastAttemptDuration: attemptDuration
            };
        } catch (error) {
            lastError = error;
            const attemptDuration = Date.now() - attemptStart;
            const errorInfo = extractErrorInfo(lastError);
            const attemptInfo = {
                attempt: attempts,
                maxRetries: config.maxRetries + 1,
                delay: 0,
                error: lastError,
                duration: attemptDuration
            };
            // Log del intento fallido
            _logger.logger.warn(_logger.LogCategory.API, `Retry attempt ${attempts} failed for ${operationName}`);
            // Si es el último intento, no calcular delay
            if (attempt === config.maxRetries) {
                break;
            }
            // Verificar si el error es reintentable
            if (!isRetryableError(lastError, config)) {
                _logger.logger.error(_logger.LogCategory.API, `Non-retryable error for ${operationName}`, lastError);
                break;
            }
            // Calcular delay para el siguiente intento
            const delay = calculateDelay(attempt, config);
            attemptInfo.delay = delay;
            _logger.logger.info(_logger.LogCategory.API, `Retrying ${operationName} in ${delay}ms`);
            // Esperar antes del siguiente intento
            await new Promise((resolve)=>setTimeout(resolve, delay));
        }
    }
    // Todos los intentos fallaron
    const totalDuration = Date.now() - startTime;
    _logger.logger.error(_logger.LogCategory.API, `All retry attempts failed for ${operationName}`, lastError);
    // ✅ NUEVO: Registrar métricas de retry fallido
    await _metrics.metricsCollector.recordRetry(operationName, attempts, false, totalDuration);
    return {
        success: false,
        error: lastError,
        attempts,
        totalDuration,
        lastAttemptDuration: 0
    };
}
async function retryMercadoPagoOperation(operation, operationName, isCritical = true) {
    const config = isCritical ? RETRY_CONFIGS.MERCADOPAGO_CRITICAL : RETRY_CONFIGS.MERCADOPAGO_QUERY;
    return retryWithBackoff(operation, config, `MercadoPago:${operationName}`);
}
async function retryWebhookOperation(operation, operationName) {
    return retryWithBackoff(operation, RETRY_CONFIGS.WEBHOOK_PROCESSING, `Webhook:${operationName}`);
}
function createRetryFunction(config, operationName) {
    return (operation)=>{
        return retryWithBackoff(operation, config, operationName);
    };
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcbGliXFxyZXRyeS1sb2dpYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQSU5URVlBIEUtQ09NTUVSQ0UgLSBSRVRSWSBMT0dJQyBXSVRIIEVYUE9ORU5USUFMIEJBQ0tPRkZcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmltcG9ydCB7IGxvZ2dlciwgTG9nTGV2ZWwsIExvZ0NhdGVnb3J5IH0gZnJvbSAnLi9sb2dnZXInO1xyXG5pbXBvcnQgeyBtZXRyaWNzQ29sbGVjdG9yIH0gZnJvbSAnLi9tZXRyaWNzJztcclxuXHJcbi8vIENvbmZpZ3VyYWNpw7NuIGRlIHJldHJ5XHJcbmV4cG9ydCBpbnRlcmZhY2UgUmV0cnlDb25maWcge1xyXG4gIG1heFJldHJpZXM6IG51bWJlcjsgICAgICAgICAgIC8vIE3DoXhpbW8gbsO6bWVybyBkZSByZWludGVudG9zXHJcbiAgYmFzZURlbGF5TXM6IG51bWJlcjsgICAgICAgICAgLy8gRGVsYXkgYmFzZSBlbiBtaWxpc2VndW5kb3NcclxuICBtYXhEZWxheU1zOiBudW1iZXI7ICAgICAgICAgICAvLyBEZWxheSBtw6F4aW1vIGVuIG1pbGlzZWd1bmRvc1xyXG4gIGJhY2tvZmZNdWx0aXBsaWVyOiBudW1iZXI7ICAgIC8vIE11bHRpcGxpY2Fkb3IgcGFyYSBiYWNrb2ZmIGV4cG9uZW5jaWFsXHJcbiAgaml0dGVyTXM6IG51bWJlcjsgICAgICAgICAgICAgLy8gSml0dGVyIG3DoXhpbW8gZW4gbWlsaXNlZ3VuZG9zXHJcbiAgcmV0cnlhYmxlRXJyb3JzOiBzdHJpbmdbXTsgICAgLy8gQ8OzZGlnb3MgZGUgZXJyb3IgcXVlIHBlcm1pdGVuIHJldHJ5XHJcbiAgbm9uUmV0cnlhYmxlRXJyb3JzOiBzdHJpbmdbXTsgLy8gQ8OzZGlnb3MgZGUgZXJyb3IgcXVlIE5PIHBlcm1pdGVuIHJldHJ5XHJcbn1cclxuXHJcbi8vIENvbmZpZ3VyYWNpb25lcyBwcmVkZWZpbmlkYXNcclxuZXhwb3J0IGNvbnN0IFJFVFJZX0NPTkZJR1M6IFJlY29yZDxzdHJpbmcsIFJldHJ5Q29uZmlnPiA9IHtcclxuICAvLyBQYXJhIGxsYW1hZGFzIGNyw610aWNhcyBhIE1lcmNhZG9QYWdvXHJcbiAgTUVSQ0FET1BBR09fQ1JJVElDQUw6IHtcclxuICAgIG1heFJldHJpZXM6IDMsXHJcbiAgICBiYXNlRGVsYXlNczogMTAwMCwgICAgICAgIC8vIDEgc2VndW5kb1xyXG4gICAgbWF4RGVsYXlNczogMzAwMDAsICAgICAgICAvLyAzMCBzZWd1bmRvc1xyXG4gICAgYmFja29mZk11bHRpcGxpZXI6IDIsXHJcbiAgICBqaXR0ZXJNczogNTAwLFxyXG4gICAgcmV0cnlhYmxlRXJyb3JzOiBbXHJcbiAgICAgICdFQ09OTlJFU0VUJyxcclxuICAgICAgJ0VOT1RGT1VORCcsXHJcbiAgICAgICdFQ09OTlJFRlVTRUQnLFxyXG4gICAgICAnRVRJTUVET1VUJyxcclxuICAgICAgJ05FVFdPUktfRVJST1InLFxyXG4gICAgICAnVElNRU9VVCcsXHJcbiAgICAgICc1MDAnLFxyXG4gICAgICAnNTAyJyxcclxuICAgICAgJzUwMycsXHJcbiAgICAgICc1MDQnLFxyXG4gICAgICAnNDI5JyAgLy8gUmF0ZSBsaW1pdCAtIHJldHJ5IGRlc3B1w6lzIGRlIGRlbGF5XHJcbiAgICBdLFxyXG4gICAgbm9uUmV0cnlhYmxlRXJyb3JzOiBbXHJcbiAgICAgICc0MDAnLCAgLy8gQmFkIFJlcXVlc3RcclxuICAgICAgJzQwMScsICAvLyBVbmF1dGhvcml6ZWRcclxuICAgICAgJzQwMycsICAvLyBGb3JiaWRkZW5cclxuICAgICAgJzQwNCcsICAvLyBOb3QgRm91bmRcclxuICAgICAgJzQyMicsICAvLyBVbnByb2Nlc3NhYmxlIEVudGl0eVxyXG4gICAgICAnSU5WQUxJRF9DUkVERU5USUFMUycsXHJcbiAgICAgICdJTlZBTElEX1JFUVVFU1QnLFxyXG4gICAgICAnUEFZTUVOVF9SRUpFQ1RFRCdcclxuICAgIF1cclxuICB9LFxyXG5cclxuICAvLyBQYXJhIG9wZXJhY2lvbmVzIGRlIGNvbnN1bHRhIG1lbm9zIGNyw610aWNhc1xyXG4gIE1FUkNBRE9QQUdPX1FVRVJZOiB7XHJcbiAgICBtYXhSZXRyaWVzOiAyLFxyXG4gICAgYmFzZURlbGF5TXM6IDUwMCwgICAgICAgICAvLyAwLjUgc2VndW5kb3NcclxuICAgIG1heERlbGF5TXM6IDEwMDAwLCAgICAgICAgLy8gMTAgc2VndW5kb3NcclxuICAgIGJhY2tvZmZNdWx0aXBsaWVyOiAyLFxyXG4gICAgaml0dGVyTXM6IDI1MCxcclxuICAgIHJldHJ5YWJsZUVycm9yczogW1xyXG4gICAgICAnRUNPTk5SRVNFVCcsXHJcbiAgICAgICdFTk9URk9VTkQnLFxyXG4gICAgICAnRVRJTUVET1VUJyxcclxuICAgICAgJzUwMCcsXHJcbiAgICAgICc1MDInLFxyXG4gICAgICAnNTAzJyxcclxuICAgICAgJzUwNCdcclxuICAgIF0sXHJcbiAgICBub25SZXRyeWFibGVFcnJvcnM6IFtcclxuICAgICAgJzQwMCcsXHJcbiAgICAgICc0MDEnLFxyXG4gICAgICAnNDAzJyxcclxuICAgICAgJzQwNCcsXHJcbiAgICAgICc0MjInXHJcbiAgICBdXHJcbiAgfSxcclxuXHJcbiAgLy8gUGFyYSB3ZWJob29rcyAobWVub3MgYWdyZXNpdm8pXHJcbiAgV0VCSE9PS19QUk9DRVNTSU5HOiB7XHJcbiAgICBtYXhSZXRyaWVzOiAxLFxyXG4gICAgYmFzZURlbGF5TXM6IDIwMDAsICAgICAgICAvLyAyIHNlZ3VuZG9zXHJcbiAgICBtYXhEZWxheU1zOiA1MDAwLCAgICAgICAgIC8vIDUgc2VndW5kb3NcclxuICAgIGJhY2tvZmZNdWx0aXBsaWVyOiAxLjUsXHJcbiAgICBqaXR0ZXJNczogMTAwMCxcclxuICAgIHJldHJ5YWJsZUVycm9yczogW1xyXG4gICAgICAnRUNPTk5SRVNFVCcsXHJcbiAgICAgICdFVElNRURPVVQnLFxyXG4gICAgICAnNTAwJyxcclxuICAgICAgJzUwMydcclxuICAgIF0sXHJcbiAgICBub25SZXRyeWFibGVFcnJvcnM6IFtcclxuICAgICAgJzQwMCcsXHJcbiAgICAgICc0MDEnLFxyXG4gICAgICAnNDAzJyxcclxuICAgICAgJzQwNCcsXHJcbiAgICAgICc0MjInLFxyXG4gICAgICAnRFVQTElDQVRFX1dFQkhPT0snXHJcbiAgICBdXHJcbiAgfVxyXG59IGFzIGNvbnN0O1xyXG5cclxuLy8gUmVzdWx0YWRvIGRlbCByZXRyeVxyXG5leHBvcnQgaW50ZXJmYWNlIFJldHJ5UmVzdWx0PFQ+IHtcclxuICBzdWNjZXNzOiBib29sZWFuO1xyXG4gIGRhdGE/OiBUO1xyXG4gIGVycm9yPzogRXJyb3I7XHJcbiAgYXR0ZW1wdHM6IG51bWJlcjtcclxuICB0b3RhbER1cmF0aW9uOiBudW1iZXI7XHJcbiAgbGFzdEF0dGVtcHREdXJhdGlvbjogbnVtYmVyO1xyXG59XHJcblxyXG4vLyBJbmZvcm1hY2nDs24gZGVsIGludGVudG9cclxuZXhwb3J0IGludGVyZmFjZSBBdHRlbXB0SW5mbyB7XHJcbiAgYXR0ZW1wdDogbnVtYmVyO1xyXG4gIG1heFJldHJpZXM6IG51bWJlcjtcclxuICBkZWxheTogbnVtYmVyO1xyXG4gIGVycm9yPzogRXJyb3I7XHJcbiAgZHVyYXRpb246IG51bWJlcjtcclxufVxyXG5cclxuLyoqXHJcbiAqIENhbGN1bGEgZWwgZGVsYXkgcGFyYSBlbCBzaWd1aWVudGUgaW50ZW50byB1c2FuZG8gYmFja29mZiBleHBvbmVuY2lhbCBjb24gaml0dGVyXHJcbiAqL1xyXG5mdW5jdGlvbiBjYWxjdWxhdGVEZWxheShcclxuICBhdHRlbXB0OiBudW1iZXIsIFxyXG4gIGNvbmZpZzogUmV0cnlDb25maWdcclxuKTogbnVtYmVyIHtcclxuICAvLyBCYWNrb2ZmIGV4cG9uZW5jaWFsOiBiYXNlRGVsYXkgKiAobXVsdGlwbGllciBeIGF0dGVtcHQpXHJcbiAgY29uc3QgZXhwb25lbnRpYWxEZWxheSA9IGNvbmZpZy5iYXNlRGVsYXlNcyAqIE1hdGgucG93KGNvbmZpZy5iYWNrb2ZmTXVsdGlwbGllciwgYXR0ZW1wdCk7XHJcbiAgXHJcbiAgLy8gQXBsaWNhciBsw61taXRlIG3DoXhpbW9cclxuICBjb25zdCBjYXBwZWREZWxheSA9IE1hdGgubWluKGV4cG9uZW50aWFsRGVsYXksIGNvbmZpZy5tYXhEZWxheU1zKTtcclxuICBcclxuICAvLyBBZ3JlZ2FyIGppdHRlciBhbGVhdG9yaW8gcGFyYSBldml0YXIgdGh1bmRlcmluZyBoZXJkXHJcbiAgY29uc3Qgaml0dGVyID0gTWF0aC5yYW5kb20oKSAqIGNvbmZpZy5qaXR0ZXJNcztcclxuICBcclxuICByZXR1cm4gTWF0aC5mbG9vcihjYXBwZWREZWxheSArIGppdHRlcik7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEZXRlcm1pbmEgc2kgdW4gZXJyb3IgZXMgcmVpbnRlbnRhYmxlXHJcbiAqL1xyXG5mdW5jdGlvbiBpc1JldHJ5YWJsZUVycm9yKGVycm9yOiBFcnJvciwgY29uZmlnOiBSZXRyeUNvbmZpZyk6IGJvb2xlYW4ge1xyXG4gIGNvbnN0IGVycm9yTWVzc2FnZSA9IChlcnJvci5tZXNzYWdlIHx8ICcnKS50b0xvd2VyQ2FzZSgpO1xyXG4gIGNvbnN0IGVycm9yTmFtZSA9IChlcnJvci5uYW1lIHx8ICcnKS50b0xvd2VyQ2FzZSgpO1xyXG4gIFxyXG4gIC8vIFZlcmlmaWNhciBlcnJvcmVzIG5vIHJlaW50ZW5hYmxlcyBwcmltZXJvICh0aWVuZW4gcHJpb3JpZGFkKVxyXG4gIGZvciAoY29uc3Qgbm9uUmV0cnlhYmxlRXJyb3Igb2YgY29uZmlnLm5vblJldHJ5YWJsZUVycm9ycykge1xyXG4gICAgaWYgKGVycm9yTWVzc2FnZS5pbmNsdWRlcyhub25SZXRyeWFibGVFcnJvci50b0xvd2VyQ2FzZSgpKSB8fFxyXG4gICAgICAgIGVycm9yTmFtZS5pbmNsdWRlcyhub25SZXRyeWFibGVFcnJvci50b0xvd2VyQ2FzZSgpKSkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFZlcmlmaWNhciBlcnJvcmVzIHJlaW50ZW5hYmxlc1xyXG4gIGZvciAoY29uc3QgcmV0cnlhYmxlRXJyb3Igb2YgY29uZmlnLnJldHJ5YWJsZUVycm9ycykge1xyXG4gICAgaWYgKGVycm9yTWVzc2FnZS5pbmNsdWRlcyhyZXRyeWFibGVFcnJvci50b0xvd2VyQ2FzZSgpKSB8fFxyXG4gICAgICAgIGVycm9yTmFtZS5pbmNsdWRlcyhyZXRyeWFibGVFcnJvci50b0xvd2VyQ2FzZSgpKSkge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgLy8gUG9yIGRlZmVjdG8sIG5vIHJlaW50ZW50YXIgZXJyb3JlcyBkZXNjb25vY2lkb3NcclxuICByZXR1cm4gZmFsc2U7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFeHRyYWUgaW5mb3JtYWNpw7NuIGRlbCBlcnJvciBwYXJhIGxvZ2dpbmdcclxuICovXHJcbmZ1bmN0aW9uIGV4dHJhY3RFcnJvckluZm8oZXJyb3I6IEVycm9yKToge1xyXG4gIHR5cGU6IHN0cmluZztcclxuICBjb2RlPzogc3RyaW5nO1xyXG4gIHN0YXR1c0NvZGU/OiBudW1iZXI7XHJcbiAgaXNOZXR3b3JrOiBib29sZWFuO1xyXG59IHtcclxuICBjb25zdCBtZXNzYWdlID0gKGVycm9yLm1lc3NhZ2UgfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcbiAgY29uc3QgbmFtZSA9IChlcnJvci5uYW1lIHx8ICcnKS50b0xvd2VyQ2FzZSgpO1xyXG4gIFxyXG4gIC8vIERldGVjdGFyIGVycm9yZXMgZGUgcmVkXHJcbiAgY29uc3QgbmV0d29ya0Vycm9ycyA9IFsnZWNvbm5yZXNldCcsICdlbm90Zm91bmQnLCAnZWNvbm5yZWZ1c2VkJywgJ2V0aW1lZG91dCddO1xyXG4gIGNvbnN0IGlzTmV0d29yayA9IG5ldHdvcmtFcnJvcnMuc29tZShuZXRFcnJvciA9PiBcclxuICAgIG1lc3NhZ2UuaW5jbHVkZXMobmV0RXJyb3IpIHx8IG5hbWUuaW5jbHVkZXMobmV0RXJyb3IpXHJcbiAgKTtcclxuICBcclxuICAvLyBFeHRyYWVyIGPDs2RpZ28gZGUgZXN0YWRvIEhUVFAgc2kgZXhpc3RlXHJcbiAgY29uc3Qgc3RhdHVzTWF0Y2ggPSBtZXNzYWdlLm1hdGNoKC8oXFxkezN9KS8pO1xyXG4gIGNvbnN0IHN0YXR1c0NvZGUgPSBzdGF0dXNNYXRjaCA/IHBhcnNlSW50KHN0YXR1c01hdGNoWzFdKSA6IHVuZGVmaW5lZDtcclxuICBcclxuICByZXR1cm4ge1xyXG4gICAgdHlwZTogbmFtZSB8fCAndW5rbm93bicsXHJcbiAgICBjb2RlOiBzdGF0dXNDb2RlPy50b1N0cmluZygpLFxyXG4gICAgc3RhdHVzQ29kZSxcclxuICAgIGlzTmV0d29ya1xyXG4gIH07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBGdW5jacOzbiBwcmluY2lwYWwgZGUgcmV0cnkgY29uIGJhY2tvZmYgZXhwb25lbmNpYWxcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXRyeVdpdGhCYWNrb2ZmPFQ+KFxyXG4gIG9wZXJhdGlvbjogKCkgPT4gUHJvbWlzZTxUPixcclxuICBjb25maWc6IFJldHJ5Q29uZmlnLFxyXG4gIG9wZXJhdGlvbk5hbWU6IHN0cmluZyA9ICd1bmtub3duJ1xyXG4pOiBQcm9taXNlPFJldHJ5UmVzdWx0PFQ+PiB7XHJcbiAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcclxuICBsZXQgbGFzdEVycm9yOiBFcnJvciB8IHVuZGVmaW5lZDtcclxuICBsZXQgYXR0ZW1wdHMgPSAwO1xyXG5cclxuICBsb2dnZXIuaW5mbyhMb2dDYXRlZ29yeS5BUEksIGBTdGFydGluZyByZXRyeSBvcGVyYXRpb246ICR7b3BlcmF0aW9uTmFtZX1gKTtcclxuXHJcbiAgZm9yIChsZXQgYXR0ZW1wdCA9IDA7IGF0dGVtcHQgPD0gY29uZmlnLm1heFJldHJpZXM7IGF0dGVtcHQrKykge1xyXG4gICAgYXR0ZW1wdHMgPSBhdHRlbXB0ICsgMTtcclxuICAgIGNvbnN0IGF0dGVtcHRTdGFydCA9IERhdGUubm93KCk7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgbG9nZ2VyLmluZm8oTG9nQ2F0ZWdvcnkuQVBJLCBgUmV0cnkgYXR0ZW1wdCAke2F0dGVtcHRzfS8ke2NvbmZpZy5tYXhSZXRyaWVzICsgMX0gZm9yICR7b3BlcmF0aW9uTmFtZX1gKTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG9wZXJhdGlvbigpO1xyXG4gICAgICBjb25zdCBhdHRlbXB0RHVyYXRpb24gPSBEYXRlLm5vdygpIC0gYXR0ZW1wdFN0YXJ0O1xyXG4gICAgICBjb25zdCB0b3RhbER1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcclxuXHJcbiAgICAgIGxvZ2dlci5pbmZvKExvZ0NhdGVnb3J5LkFQSSwgYFJldHJ5IG9wZXJhdGlvbiBzdWNjZWVkZWQ6ICR7b3BlcmF0aW9uTmFtZX1gKTtcclxuXHJcbiAgICAgIC8vIOKchSBOVUVWTzogUmVnaXN0cmFyIG3DqXRyaWNhcyBkZSByZXRyeSBleGl0b3NvXHJcbiAgICAgIGF3YWl0IG1ldHJpY3NDb2xsZWN0b3IucmVjb3JkUmV0cnkob3BlcmF0aW9uTmFtZSwgYXR0ZW1wdHMsIHRydWUsIHRvdGFsRHVyYXRpb24pO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgIGRhdGE6IHJlc3VsdCxcclxuICAgICAgICBhdHRlbXB0cyxcclxuICAgICAgICB0b3RhbER1cmF0aW9uLFxyXG4gICAgICAgIGxhc3RBdHRlbXB0RHVyYXRpb246IGF0dGVtcHREdXJhdGlvbixcclxuICAgICAgfTtcclxuXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBsYXN0RXJyb3IgPSBlcnJvciBhcyBFcnJvcjtcclxuICAgICAgY29uc3QgYXR0ZW1wdER1cmF0aW9uID0gRGF0ZS5ub3coKSAtIGF0dGVtcHRTdGFydDtcclxuICAgICAgY29uc3QgZXJyb3JJbmZvID0gZXh0cmFjdEVycm9ySW5mbyhsYXN0RXJyb3IpO1xyXG5cclxuICAgICAgY29uc3QgYXR0ZW1wdEluZm86IEF0dGVtcHRJbmZvID0ge1xyXG4gICAgICAgIGF0dGVtcHQ6IGF0dGVtcHRzLFxyXG4gICAgICAgIG1heFJldHJpZXM6IGNvbmZpZy5tYXhSZXRyaWVzICsgMSxcclxuICAgICAgICBkZWxheTogMCxcclxuICAgICAgICBlcnJvcjogbGFzdEVycm9yLFxyXG4gICAgICAgIGR1cmF0aW9uOiBhdHRlbXB0RHVyYXRpb24sXHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyBMb2cgZGVsIGludGVudG8gZmFsbGlkb1xyXG4gICAgICBsb2dnZXIud2FybihMb2dDYXRlZ29yeS5BUEksIGBSZXRyeSBhdHRlbXB0ICR7YXR0ZW1wdHN9IGZhaWxlZCBmb3IgJHtvcGVyYXRpb25OYW1lfWApO1xyXG5cclxuICAgICAgLy8gU2kgZXMgZWwgw7psdGltbyBpbnRlbnRvLCBubyBjYWxjdWxhciBkZWxheVxyXG4gICAgICBpZiAoYXR0ZW1wdCA9PT0gY29uZmlnLm1heFJldHJpZXMpIHtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gVmVyaWZpY2FyIHNpIGVsIGVycm9yIGVzIHJlaW50ZW50YWJsZVxyXG4gICAgICBpZiAoIWlzUmV0cnlhYmxlRXJyb3IobGFzdEVycm9yLCBjb25maWcpKSB7XHJcbiAgICAgICAgbG9nZ2VyLmVycm9yKExvZ0NhdGVnb3J5LkFQSSwgYE5vbi1yZXRyeWFibGUgZXJyb3IgZm9yICR7b3BlcmF0aW9uTmFtZX1gLCBsYXN0RXJyb3IpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBDYWxjdWxhciBkZWxheSBwYXJhIGVsIHNpZ3VpZW50ZSBpbnRlbnRvXHJcbiAgICAgIGNvbnN0IGRlbGF5ID0gY2FsY3VsYXRlRGVsYXkoYXR0ZW1wdCwgY29uZmlnKTtcclxuICAgICAgYXR0ZW1wdEluZm8uZGVsYXkgPSBkZWxheTtcclxuXHJcbiAgICAgIGxvZ2dlci5pbmZvKExvZ0NhdGVnb3J5LkFQSSwgYFJldHJ5aW5nICR7b3BlcmF0aW9uTmFtZX0gaW4gJHtkZWxheX1tc2ApO1xyXG5cclxuICAgICAgLy8gRXNwZXJhciBhbnRlcyBkZWwgc2lndWllbnRlIGludGVudG9cclxuICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGRlbGF5KSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBUb2RvcyBsb3MgaW50ZW50b3MgZmFsbGFyb25cclxuICBjb25zdCB0b3RhbER1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcclxuICBcclxuICBsb2dnZXIuZXJyb3IoTG9nQ2F0ZWdvcnkuQVBJLCBgQWxsIHJldHJ5IGF0dGVtcHRzIGZhaWxlZCBmb3IgJHtvcGVyYXRpb25OYW1lfWAsIGxhc3RFcnJvciEpO1xyXG5cclxuICAvLyDinIUgTlVFVk86IFJlZ2lzdHJhciBtw6l0cmljYXMgZGUgcmV0cnkgZmFsbGlkb1xyXG4gIGF3YWl0IG1ldHJpY3NDb2xsZWN0b3IucmVjb3JkUmV0cnkob3BlcmF0aW9uTmFtZSwgYXR0ZW1wdHMsIGZhbHNlLCB0b3RhbER1cmF0aW9uKTtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgZXJyb3I6IGxhc3RFcnJvcixcclxuICAgIGF0dGVtcHRzLFxyXG4gICAgdG90YWxEdXJhdGlvbixcclxuICAgIGxhc3RBdHRlbXB0RHVyYXRpb246IDAsXHJcbiAgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFdyYXBwZXIgZXNwZWPDrWZpY28gcGFyYSBvcGVyYWNpb25lcyBkZSBNZXJjYWRvUGFnb1xyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJldHJ5TWVyY2Fkb1BhZ29PcGVyYXRpb248VD4oXHJcbiAgb3BlcmF0aW9uOiAoKSA9PiBQcm9taXNlPFQ+LFxyXG4gIG9wZXJhdGlvbk5hbWU6IHN0cmluZyxcclxuICBpc0NyaXRpY2FsOiBib29sZWFuID0gdHJ1ZVxyXG4pOiBQcm9taXNlPFJldHJ5UmVzdWx0PFQ+PiB7XHJcbiAgY29uc3QgY29uZmlnID0gaXNDcml0aWNhbCA/IFJFVFJZX0NPTkZJR1MuTUVSQ0FET1BBR09fQ1JJVElDQUwgOiBSRVRSWV9DT05GSUdTLk1FUkNBRE9QQUdPX1FVRVJZO1xyXG4gIFxyXG4gIHJldHVybiByZXRyeVdpdGhCYWNrb2ZmKG9wZXJhdGlvbiwgY29uZmlnLCBgTWVyY2Fkb1BhZ286JHtvcGVyYXRpb25OYW1lfWApO1xyXG59XHJcblxyXG4vKipcclxuICogV3JhcHBlciBwYXJhIG9wZXJhY2lvbmVzIGRlIHdlYmhvb2tcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXRyeVdlYmhvb2tPcGVyYXRpb248VD4oXHJcbiAgb3BlcmF0aW9uOiAoKSA9PiBQcm9taXNlPFQ+LFxyXG4gIG9wZXJhdGlvbk5hbWU6IHN0cmluZ1xyXG4pOiBQcm9taXNlPFJldHJ5UmVzdWx0PFQ+PiB7XHJcbiAgcmV0dXJuIHJldHJ5V2l0aEJhY2tvZmYob3BlcmF0aW9uLCBSRVRSWV9DT05GSUdTLldFQkhPT0tfUFJPQ0VTU0lORywgYFdlYmhvb2s6JHtvcGVyYXRpb25OYW1lfWApO1xyXG59XHJcblxyXG4vKipcclxuICogRnVuY2nDs24gZGUgdXRpbGlkYWQgcGFyYSBjcmVhciB1biByZXRyeSBwZXJzb25hbGl6YWRvXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUmV0cnlGdW5jdGlvbjxUPihcclxuICBjb25maWc6IFJldHJ5Q29uZmlnLFxyXG4gIG9wZXJhdGlvbk5hbWU6IHN0cmluZ1xyXG4pIHtcclxuICByZXR1cm4gKG9wZXJhdGlvbjogKCkgPT4gUHJvbWlzZTxUPik6IFByb21pc2U8UmV0cnlSZXN1bHQ8VD4+ID0+IHtcclxuICAgIHJldHVybiByZXRyeVdpdGhCYWNrb2ZmKG9wZXJhdGlvbiwgY29uZmlnLCBvcGVyYXRpb25OYW1lKTtcclxuICB9O1xyXG59XHJcbiJdLCJuYW1lcyI6WyJSRVRSWV9DT05GSUdTIiwiY3JlYXRlUmV0cnlGdW5jdGlvbiIsInJldHJ5TWVyY2Fkb1BhZ29PcGVyYXRpb24iLCJyZXRyeVdlYmhvb2tPcGVyYXRpb24iLCJyZXRyeVdpdGhCYWNrb2ZmIiwiTUVSQ0FET1BBR09fQ1JJVElDQUwiLCJtYXhSZXRyaWVzIiwiYmFzZURlbGF5TXMiLCJtYXhEZWxheU1zIiwiYmFja29mZk11bHRpcGxpZXIiLCJqaXR0ZXJNcyIsInJldHJ5YWJsZUVycm9ycyIsIm5vblJldHJ5YWJsZUVycm9ycyIsIk1FUkNBRE9QQUdPX1FVRVJZIiwiV0VCSE9PS19QUk9DRVNTSU5HIiwiY2FsY3VsYXRlRGVsYXkiLCJhdHRlbXB0IiwiY29uZmlnIiwiZXhwb25lbnRpYWxEZWxheSIsIk1hdGgiLCJwb3ciLCJjYXBwZWREZWxheSIsIm1pbiIsImppdHRlciIsInJhbmRvbSIsImZsb29yIiwiaXNSZXRyeWFibGVFcnJvciIsImVycm9yIiwiZXJyb3JNZXNzYWdlIiwibWVzc2FnZSIsInRvTG93ZXJDYXNlIiwiZXJyb3JOYW1lIiwibmFtZSIsIm5vblJldHJ5YWJsZUVycm9yIiwiaW5jbHVkZXMiLCJyZXRyeWFibGVFcnJvciIsImV4dHJhY3RFcnJvckluZm8iLCJuZXR3b3JrRXJyb3JzIiwiaXNOZXR3b3JrIiwic29tZSIsIm5ldEVycm9yIiwic3RhdHVzTWF0Y2giLCJtYXRjaCIsInN0YXR1c0NvZGUiLCJwYXJzZUludCIsInVuZGVmaW5lZCIsInR5cGUiLCJjb2RlIiwidG9TdHJpbmciLCJvcGVyYXRpb24iLCJvcGVyYXRpb25OYW1lIiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsImxhc3RFcnJvciIsImF0dGVtcHRzIiwibG9nZ2VyIiwiaW5mbyIsIkxvZ0NhdGVnb3J5IiwiQVBJIiwiYXR0ZW1wdFN0YXJ0IiwicmVzdWx0IiwiYXR0ZW1wdER1cmF0aW9uIiwidG90YWxEdXJhdGlvbiIsIm1ldHJpY3NDb2xsZWN0b3IiLCJyZWNvcmRSZXRyeSIsInN1Y2Nlc3MiLCJkYXRhIiwibGFzdEF0dGVtcHREdXJhdGlvbiIsImVycm9ySW5mbyIsImF0dGVtcHRJbmZvIiwiZGVsYXkiLCJkdXJhdGlvbiIsIndhcm4iLCJQcm9taXNlIiwicmVzb2x2ZSIsInNldFRpbWVvdXQiLCJpc0NyaXRpY2FsIl0sIm1hcHBpbmdzIjoiQUFBQSxzQ0FBc0M7QUFDdEMsNERBQTREO0FBQzVELHNDQUFzQzs7Ozs7Ozs7Ozs7O1FBaUJ6QkE7ZUFBQUE7O1FBd1NHQztlQUFBQTs7UUF2Qk1DO2VBQUFBOztRQWFBQztlQUFBQTs7UUExR0FDO2VBQUFBOzs7d0JBbk13Qjt5QkFDYjtBQWMxQixNQUFNSixnQkFBNkM7SUFDeEQsdUNBQXVDO0lBQ3ZDSyxzQkFBc0I7UUFDcEJDLFlBQVk7UUFDWkMsYUFBYTtRQUNiQyxZQUFZO1FBQ1pDLG1CQUFtQjtRQUNuQkMsVUFBVTtRQUNWQyxpQkFBaUI7WUFDZjtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBLE1BQU8sc0NBQXNDO1NBQzlDO1FBQ0RDLG9CQUFvQjtZQUNsQjtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1NBQ0Q7SUFDSDtJQUVBLDhDQUE4QztJQUM5Q0MsbUJBQW1CO1FBQ2pCUCxZQUFZO1FBQ1pDLGFBQWE7UUFDYkMsWUFBWTtRQUNaQyxtQkFBbUI7UUFDbkJDLFVBQVU7UUFDVkMsaUJBQWlCO1lBQ2Y7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7U0FDRDtRQUNEQyxvQkFBb0I7WUFDbEI7WUFDQTtZQUNBO1lBQ0E7WUFDQTtTQUNEO0lBQ0g7SUFFQSxpQ0FBaUM7SUFDakNFLG9CQUFvQjtRQUNsQlIsWUFBWTtRQUNaQyxhQUFhO1FBQ2JDLFlBQVk7UUFDWkMsbUJBQW1C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