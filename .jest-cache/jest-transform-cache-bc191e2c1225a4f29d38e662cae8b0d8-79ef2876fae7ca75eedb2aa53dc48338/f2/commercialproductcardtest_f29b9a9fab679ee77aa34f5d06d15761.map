{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\components\\ui\\__tests__\\commercial-product-card.test.tsx"],"sourcesContent":["import React from 'react'\r\nimport { render, screen, fireEvent, waitFor } from '@testing-library/react'\r\nimport { CommercialProductCard } from '../product-card-commercial'\r\n\r\ndescribe('CommercialProductCard', () => {\r\n  const defaultProps = {\r\n    image: '/test-image.jpg',\r\n    title: 'Barniz Campbell 4L',\r\n    brand: 'Petrilac',\r\n    price: 19350,\r\n    originalPrice: 21500,\r\n    discount: '10%',\r\n    stock: 12,\r\n    onAddToCart: jest.fn(),\r\n  }\r\n\r\n  beforeEach(() => {\r\n    jest.clearAllMocks()\r\n  })\r\n\r\n  it('renders correctly with all props', () => {\r\n    render(<CommercialProductCard {...defaultProps} />)\r\n    \r\n    expect(screen.getByTestId('commercial-product-card')).toBeInTheDocument()\r\n    expect(screen.getByText('Barniz Campbell 4L')).toBeInTheDocument()\r\n    expect(screen.getByText('Petrilac')).toBeInTheDocument()\r\n    expect(screen.getByText('$19.350')).toBeInTheDocument()\r\n    expect(screen.getByText('$21.500')).toBeInTheDocument()\r\n  })\r\n\r\n  it('shows \"Nuevo\" badge when isNew is true', () => {\r\n    render(<CommercialProductCard {...defaultProps} isNew={true} />)\r\n    \r\n    expect(screen.getByText('Nuevo')).toBeInTheDocument()\r\n  })\r\n\r\n  it('shows discount badge when discount is provided', () => {\r\n    render(<CommercialProductCard {...defaultProps} />)\r\n\r\n    expect(screen.getByText('10%')).toBeInTheDocument()\r\n    expect(screen.getByText('Descuento')).toBeInTheDocument()\r\n    expect(screen.getByText('especial')).toBeInTheDocument()\r\n  })\r\n\r\n  it('shows installments information when provided', () => {\r\n    const installments = {\r\n      quantity: 3,\r\n      amount: 6450,\r\n      interestFree: true\r\n    }\r\n    \r\n    render(\r\n      <CommercialProductCard \r\n        {...defaultProps} \r\n        installments={installments}\r\n      />\r\n    )\r\n    \r\n    expect(screen.getByText('3x de $6.450 sin interés')).toBeInTheDocument()\r\n  })\r\n\r\n  it('shows free shipping when freeShipping is true', () => {\r\n    render(\r\n      <CommercialProductCard\r\n        {...defaultProps}\r\n        freeShipping={true}\r\n      />\r\n    )\r\n\r\n    expect(screen.getByAltText('Envío gratis')).toBeInTheDocument()\r\n  })\r\n\r\n  it('shows free shipping automatically for prices >= 15000', () => {\r\n    render(\r\n      <CommercialProductCard\r\n        {...defaultProps}\r\n        price={20000}\r\n      />\r\n    )\r\n\r\n    expect(screen.getByAltText('Envío gratis')).toBeInTheDocument()\r\n  })\r\n\r\n  it('shows delivery location when provided', () => {\r\n    render(\r\n      <CommercialProductCard\r\n        {...defaultProps}\r\n        freeShipping={true}\r\n        deliveryLocation=\"Llega gratis hoy en Córdoba Capital\"\r\n      />\r\n    )\r\n\r\n    // Ahora solo muestra el ícono, no el texto de ubicación\r\n    expect(screen.getByAltText('Envío gratis')).toBeInTheDocument()\r\n  })\r\n\r\n  it('calls onAddToCart when button is clicked', () => {\r\n    render(<CommercialProductCard {...defaultProps} />)\r\n    \r\n    const button = screen.getByTestId('add-to-cart-btn')\r\n    fireEvent.click(button)\r\n    \r\n    expect(defaultProps.onAddToCart).toHaveBeenCalledTimes(1)\r\n  })\r\n\r\n  it('shows loading state when adding to cart', async () => {\r\n    render(<CommercialProductCard {...defaultProps} showCartAnimation={true} />)\r\n\r\n    const button = screen.getByTestId('add-to-cart-btn')\r\n    fireEvent.click(button)\r\n\r\n    // Verificar que el botón está deshabilitado durante la carga\r\n    expect(button).toBeDisabled()\r\n\r\n    // Verificar que aparece el texto \"Agregando...\" (puede estar oculto en mobile)\r\n    await waitFor(() => {\r\n      const loadingTexts = screen.getAllByText(/Agregando|\\.\\.\\./)\r\n      expect(loadingTexts.length).toBeGreaterThan(0)\r\n    }, { timeout: 100 })\r\n\r\n    // Verificar que después de 1 segundo el botón vuelve a estar habilitado\r\n    await waitFor(() => {\r\n      expect(button).not.toBeDisabled()\r\n    }, { timeout: 1200 })\r\n  })\r\n\r\n  it('disables button when stock is 0', () => {\r\n    render(<CommercialProductCard {...defaultProps} stock={0} />)\r\n    \r\n    const button = screen.getByTestId('add-to-cart-btn')\r\n    expect(button).toBeDisabled()\r\n    expect(screen.getByText('Sin stock')).toBeInTheDocument()\r\n  })\r\n\r\n  it('shows placeholder when no image is provided', () => {\r\n    render(<CommercialProductCard {...defaultProps} image={undefined} />)\r\n    \r\n    const placeholder = screen.getByAltText('Sin imagen')\r\n    expect(placeholder).toBeInTheDocument()\r\n  })\r\n\r\n  it('handles image error by showing placeholder', () => {\r\n    render(<CommercialProductCard {...defaultProps} />)\r\n    \r\n    const image = screen.getByAltText('Barniz Campbell 4L')\r\n    fireEvent.error(image)\r\n    \r\n    expect(image).toHaveAttribute('src', '/images/products/placeholder.svg')\r\n  })\r\n\r\n  it('applies custom className', () => {\r\n    render(<CommercialProductCard {...defaultProps} className=\"custom-class\" />)\r\n    \r\n    const card = screen.getByTestId('commercial-product-card')\r\n    expect(card).toHaveClass('custom-class')\r\n  })\r\n\r\n  it('renders without brand when not provided', () => {\r\n    render(<CommercialProductCard {...defaultProps} brand={undefined} />)\r\n    \r\n    expect(screen.queryByText('Petrilac')).not.toBeInTheDocument()\r\n  })\r\n\r\n  it('renders without original price when not provided', () => {\r\n    render(<CommercialProductCard {...defaultProps} originalPrice={undefined} />)\r\n    \r\n    expect(screen.queryByText('$21.500')).not.toBeInTheDocument()\r\n  })\r\n\r\n  it('renders without discount badge when not provided', () => {\r\n    render(<CommercialProductCard {...defaultProps} discount={undefined} />)\r\n\r\n    expect(screen.queryByText('10%')).not.toBeInTheDocument()\r\n    expect(screen.queryByText('Descuento')).not.toBeInTheDocument()\r\n    expect(screen.queryByText('especial')).not.toBeInTheDocument()\r\n  })\r\n\r\n  it('uses custom CTA text', () => {\r\n    render(<CommercialProductCard {...defaultProps} cta=\"Comprar ahora\" />)\r\n    \r\n    expect(screen.getByText('Comprar ahora')).toBeInTheDocument()\r\n  })\r\n\r\n  it('renders children when provided', () => {\r\n    render(\r\n      <CommercialProductCard {...defaultProps}>\r\n        <div data-testid=\"custom-child\">Custom content</div>\r\n      </CommercialProductCard>\r\n    )\r\n    \r\n    expect(screen.getByTestId('custom-child')).toBeInTheDocument()\r\n    expect(screen.getByText('Custom content')).toBeInTheDocument()\r\n  })\r\n\r\n  it('handles zero price correctly', () => {\r\n    render(<CommercialProductCard {...defaultProps} price={0} />)\r\n    \r\n    expect(screen.getByText('$0')).toBeInTheDocument()\r\n  })\r\n\r\n  it('formats large prices correctly', () => {\r\n    render(<CommercialProductCard {...defaultProps} price={123456} />)\r\n    \r\n    expect(screen.getByText('$123.456')).toBeInTheDocument()\r\n  })\r\n})\r\n"],"names":["describe","defaultProps","image","title","brand","price","originalPrice","discount","stock","onAddToCart","jest","fn","beforeEach","clearAllMocks","it","render","CommercialProductCard","expect","screen","getByTestId","toBeInTheDocument","getByText","isNew","installments","quantity","amount","interestFree","freeShipping","getByAltText","deliveryLocation","button","fireEvent","click","toHaveBeenCalledTimes","showCartAnimation","toBeDisabled","waitFor","loadingTexts","getAllByText","length","toBeGreaterThan","timeout","not","undefined","placeholder","error","toHaveAttribute","className","card","toHaveClass","queryByText","cta","div","data-testid"],"mappings":"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"}