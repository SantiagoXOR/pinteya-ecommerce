f22a84d975ad40b1afd4a8cb91ff68ac
/**
 * Protección CSRF y Validación de Origen
 * Implementa validaciones para prevenir ataques Cross-Site Request Forgery
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    generateCSRFToken: function() {
        return generateCSRFToken;
    },
    validateCSRFToken: function() {
        return validateCSRFToken;
    },
    validateRequestOrigin: function() {
        return validateRequestOrigin;
    },
    withAdminCSRFProtection: function() {
        return withAdminCSRFProtection;
    },
    withCSRFProtection: function() {
        return withCSRFProtection;
    }
});
const _crypto = /*#__PURE__*/ _interop_require_default(require("crypto"));
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
// =====================================================
// CONFIGURACIÓN DE SEGURIDAD
// =====================================================
const CSRF_CONFIG = {
    allowedOrigins: [
        process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000',
        'https://pinteya-ecommerce.vercel.app',
        'https://pinteya.com',
        'https://www.pinteya.com'
    ],
    allowedMethods: [
        'GET',
        'POST',
        'PUT',
        'PATCH',
        'DELETE'
    ],
    requireReferer: true,
    requireOrigin: true,
    strictMode: process.env.NODE_ENV === 'production',
    developmentMode: process.env.NODE_ENV === 'development'
};
async function validateRequestOrigin(request) {
    try {
        const method = request.method || 'GET';
        const origin = getHeader(request, 'origin');
        const referer = getHeader(request, 'referer');
        const userAgent = getHeader(request, 'user-agent');
        // En desarrollo, ser más permisivo
        if (CSRF_CONFIG.developmentMode && !CSRF_CONFIG.strictMode) {
            return {
                valid: true,
                details: {
                    origin,
                    referer,
                    userAgent,
                    method,
                    expectedOrigins: CSRF_CONFIG.allowedOrigins
                }
            };
        }
        // Validar método HTTP
        if (!CSRF_CONFIG.allowedMethods.includes(method)) {
            return {
                valid: false,
                error: `Método HTTP no permitido: ${method}`,
                code: 'INVALID_HTTP_METHOD',
                severity: 'medium'
            };
        }
        // Para métodos seguros (GET), validación menos estricta
        if (method === 'GET') {
            return validateGetRequest(origin, referer, userAgent);
        }
        // Para métodos que modifican datos, validación estricta
        return validateMutatingRequest(origin, referer, userAgent, method);
    } catch (error) {
        console.error('[CSRF] Error en validación de origen:', error);
        return {
            valid: false,
            error: 'Error interno en validación de origen',
            code: 'ORIGIN_VALIDATION_ERROR',
            severity: 'critical'
        };
    }
}
/**
 * Valida requests GET (menos estricto)
 */ function validateGetRequest(origin, referer, userAgent) {
    // Para GET, solo verificar que no sea obviamente malicioso
    if (userAgent && isSuspiciousUserAgent(userAgent)) {
        return {
            valid: false,
            error: 'User-Agent sospechoso detectado',
            code: 'SUSPICIOUS_USER_AGENT',
            severity: 'medium'
        };
    }
    return {
        valid: true,
        details: {
            origin,
            referer,
            userAgent,
            method: 'GET'
        }
    };
}
/**
 * Valida requests que modifican datos (estricto)
 */ function validateMutatingRequest(origin, referer, userAgent, method) {
    // Verificar Origin header
    if (CSRF_CONFIG.requireOrigin && !origin) {
        return {
            valid: false,
            error: 'Header Origin requerido para operaciones que modifican datos',
            code: 'MISSING_ORIGIN_HEADER',
            severity: 'high'
        };
    }
    if (origin && !isAllowedOrigin(origin)) {
        return {
            valid: false,
            error: `Origen no permitido: ${origin}`,
            code: 'INVALID_ORIGIN',
            severity: 'critical',
            details: {
                origin,
                expectedOrigins: CSRF_CONFIG.allowedOrigins
            }
        };
    }
    // Verificar Referer header
    if (CSRF_CONFIG.requireReferer && !referer) {
        return {
            valid: false,
            error: 'Header Referer requerido para operaciones que modifican datos',
            code: 'MISSING_REFERER_HEADER',
            severity: 'high'
        };
    }
    if (referer && !isAllowedReferer(referer)) {
        return {
            valid: false,
            error: `Referer no permitido: ${referer}`,
            code: 'INVALID_REFERER',
            severity: 'high'
        };
    }
    // Verificar User-Agent
    if (userAgent && isSuspiciousUserAgent(userAgent)) {
        return {
            valid: false,
            error: 'User-Agent sospechoso detectado',
            code: 'SUSPICIOUS_USER_AGENT',
            severity: 'medium'
        };
    }
    return {
        valid: true,
        details: {
            origin,
            referer,
            userAgent,
            method,
            expectedOrigins: CSRF_CONFIG.allowedOrigins
        }
    };
}
/**
 * Verifica si un origen está permitido
 */ function isAllowedOrigin(origin) {
    try {
        const originUrl = new URL(origin);
        return CSRF_CONFIG.allowedOrigins.some((allowedOrigin)=>{
            try {
                const allowedUrl = new URL(allowedOrigin);
                return originUrl.hostname === allowedUrl.hostname && originUrl.protocol === allowedUrl.protocol;
            } catch  {
                return false;
            }
        });
    } catch  {
        return false;
    }
}
/**
 * Verifica si un referer está permitido
 */ function isAllowedReferer(referer) {
    try {
        const refererUrl = new URL(referer);
        return CSRF_CONFIG.allowedOrigins.some((allowedOrigin)=>{
            try {
                const allowedUrl = new URL(allowedOrigin);
                return refererUrl.hostname === allowedUrl.hostname;
            } catch  {
                return false;
            }
        });
    } catch  {
        return false;
    }
}
/**
 * Detecta User-Agents sospechosos
 */ function isSuspiciousUserAgent(userAgent) {
    const suspiciousPatterns = [
        /bot/i,
        /crawler/i,
        /spider/i,
        /scraper/i,
        /curl/i,
        /wget/i,
        /python/i,
        /postman/i,
        /insomnia/i,
        /^$/,
        /^.{0,10}$/,
        /^.{500,}$/ // User-Agent muy largo
    ];
    return suspiciousPatterns.some((pattern)=>pattern.test(userAgent));
}
/**
 * Obtiene un header de manera compatible con ambos tipos de request
 */ function getHeader(request, headerName) {
    if ('headers' in request && typeof request.headers.get === 'function') {
        // NextRequest
        return request.headers.get(headerName);
    } else if ('headers' in request) {
        // NextApiRequest
        const header = request.headers[headerName];
        return Array.isArray(header) ? header[0] : header || null;
    }
    return null;
}
function generateCSRFToken() {
    return _crypto.default.randomBytes(32).toString('hex');
}
function validateCSRFToken(providedToken, expectedToken) {
    if (!providedToken || !expectedToken) {
        return false;
    }
    // Comparación segura para prevenir timing attacks
    return _crypto.default.timingSafeEqual(Buffer.from(providedToken, 'hex'), Buffer.from(expectedToken, 'hex'));
}
function withCSRFProtection(options = {}) {
    const config = {
        ...CSRF_CONFIG,
        ...options
    };
    return function(handler) {
        return async (request, ...args)=>{
            try {
                // Validar origen de la request
                const originValidation = await validateRequestOrigin(request);
                if (!originValidation.valid) {
                    const errorResponse = {
                        success: false,
                        error: originValidation.error,
                        code: originValidation.code,
                        severity: originValidation.severity,
                        csrfProtection: true
                    };
                    if ('query' in request) {
                        // Pages Router
                        const res = args[0];
                        return res.status(403).json(errorResponse);
                    } else {
                        // App Router
                        return new Response(JSON.stringify(errorResponse), {
                            status: 403,
                            headers: {
                                'Content-Type': 'application/json'
                            }
                        });
                    }
                }
                // Añadir información de validación al request
                request.csrfValidation = originValidation;
                return handler(request, ...args);
            } catch (error) {
                console.error('[CSRF] Error en middleware de protección:', error);
                const errorResponse = {
                    success: false,
                    error: 'Error interno en protección CSRF',
                    code: 'CSRF_MIDDLEWARE_ERROR'
                };
                if ('query' in request) {
                    // Pages Router
                    const res = args[0];
                    return res.status(500).json(errorResponse);
                } else {
                    // App Router
                    return new Response(JSON.stringify(errorResponse), {
                        status: 500,
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    });
                }
            }
        };
    };
}
function withAdminCSRFProtection() {
    return withCSRFProtection({
        strictMode: true,
        requireReferer: true,
        requireOrigin: true
    });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcbGliXFxhdXRoXFxjc3JmLXByb3RlY3Rpb24udHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBQcm90ZWNjacOzbiBDU1JGIHkgVmFsaWRhY2nDs24gZGUgT3JpZ2VuXG4gKiBJbXBsZW1lbnRhIHZhbGlkYWNpb25lcyBwYXJhIHByZXZlbmlyIGF0YXF1ZXMgQ3Jvc3MtU2l0ZSBSZXF1ZXN0IEZvcmdlcnlcbiAqL1xuXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QgfSBmcm9tICduZXh0JztcbmltcG9ydCBjcnlwdG8gZnJvbSAnY3J5cHRvJztcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFRJUE9TIFkgSU5URVJGQUNFU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGludGVyZmFjZSBDU1JGVmFsaWRhdGlvblJlc3VsdCB7XG4gIHZhbGlkOiBib29sZWFuO1xuICBlcnJvcj86IHN0cmluZztcbiAgY29kZT86IHN0cmluZztcbiAgc2V2ZXJpdHk/OiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHwgJ2NyaXRpY2FsJztcbiAgZGV0YWlscz86IHtcbiAgICBvcmlnaW4/OiBzdHJpbmc7XG4gICAgcmVmZXJlcj86IHN0cmluZztcbiAgICB1c2VyQWdlbnQ/OiBzdHJpbmc7XG4gICAgbWV0aG9kPzogc3RyaW5nO1xuICAgIGV4cGVjdGVkT3JpZ2lucz86IHN0cmluZ1tdO1xuICAgIGNzcmZUb2tlbj86IHN0cmluZztcbiAgfTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBPcmlnaW5WYWxpZGF0aW9uQ29uZmlnIHtcbiAgYWxsb3dlZE9yaWdpbnM6IHN0cmluZ1tdO1xuICBhbGxvd2VkTWV0aG9kczogc3RyaW5nW107XG4gIHJlcXVpcmVSZWZlcmVyOiBib29sZWFuO1xuICByZXF1aXJlT3JpZ2luOiBib29sZWFuO1xuICBzdHJpY3RNb2RlOiBib29sZWFuO1xuICBkZXZlbG9wbWVudE1vZGU6IGJvb2xlYW47XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBDT05GSUdVUkFDScOTTiBERSBTRUdVUklEQURcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmNvbnN0IENTUkZfQ09ORklHOiBPcmlnaW5WYWxpZGF0aW9uQ29uZmlnID0ge1xuICBhbGxvd2VkT3JpZ2luczogW1xuICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0FQUF9VUkwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCcsXG4gICAgJ2h0dHBzOi8vcGludGV5YS1lY29tbWVyY2UudmVyY2VsLmFwcCcsXG4gICAgJ2h0dHBzOi8vcGludGV5YS5jb20nLFxuICAgICdodHRwczovL3d3dy5waW50ZXlhLmNvbSdcbiAgXSxcbiAgYWxsb3dlZE1ldGhvZHM6IFsnR0VUJywgJ1BPU1QnLCAnUFVUJywgJ1BBVENIJywgJ0RFTEVURSddLFxuICByZXF1aXJlUmVmZXJlcjogdHJ1ZSxcbiAgcmVxdWlyZU9yaWdpbjogdHJ1ZSxcbiAgc3RyaWN0TW9kZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyxcbiAgZGV2ZWxvcG1lbnRNb2RlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50J1xufTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEZVTkNJT05FUyBERSBWQUxJREFDScOTTiBERSBPUklHRU5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogVmFsaWRhIGVsIG9yaWdlbiBkZSBsYSByZXF1ZXN0IHBhcmEgcHJldmVuaXIgQ1NSRlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmFsaWRhdGVSZXF1ZXN0T3JpZ2luKFxuICByZXF1ZXN0OiBOZXh0UmVxdWVzdCB8IE5leHRBcGlSZXF1ZXN0XG4pOiBQcm9taXNlPENTUkZWYWxpZGF0aW9uUmVzdWx0PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgbWV0aG9kID0gcmVxdWVzdC5tZXRob2QgfHwgJ0dFVCc7XG4gICAgY29uc3Qgb3JpZ2luID0gZ2V0SGVhZGVyKHJlcXVlc3QsICdvcmlnaW4nKTtcbiAgICBjb25zdCByZWZlcmVyID0gZ2V0SGVhZGVyKHJlcXVlc3QsICdyZWZlcmVyJyk7XG4gICAgY29uc3QgdXNlckFnZW50ID0gZ2V0SGVhZGVyKHJlcXVlc3QsICd1c2VyLWFnZW50Jyk7XG5cbiAgICAvLyBFbiBkZXNhcnJvbGxvLCBzZXIgbcOhcyBwZXJtaXNpdm9cbiAgICBpZiAoQ1NSRl9DT05GSUcuZGV2ZWxvcG1lbnRNb2RlICYmICFDU1JGX0NPTkZJRy5zdHJpY3RNb2RlKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWxpZDogdHJ1ZSxcbiAgICAgICAgZGV0YWlsczoge1xuICAgICAgICAgIG9yaWdpbixcbiAgICAgICAgICByZWZlcmVyLFxuICAgICAgICAgIHVzZXJBZ2VudCxcbiAgICAgICAgICBtZXRob2QsXG4gICAgICAgICAgZXhwZWN0ZWRPcmlnaW5zOiBDU1JGX0NPTkZJRy5hbGxvd2VkT3JpZ2luc1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIFZhbGlkYXIgbcOpdG9kbyBIVFRQXG4gICAgaWYgKCFDU1JGX0NPTkZJRy5hbGxvd2VkTWV0aG9kcy5pbmNsdWRlcyhtZXRob2QpKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yOiBgTcOpdG9kbyBIVFRQIG5vIHBlcm1pdGlkbzogJHttZXRob2R9YCxcbiAgICAgICAgY29kZTogJ0lOVkFMSURfSFRUUF9NRVRIT0QnLFxuICAgICAgICBzZXZlcml0eTogJ21lZGl1bSdcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gUGFyYSBtw6l0b2RvcyBzZWd1cm9zIChHRVQpLCB2YWxpZGFjacOzbiBtZW5vcyBlc3RyaWN0YVxuICAgIGlmIChtZXRob2QgPT09ICdHRVQnKSB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVHZXRSZXF1ZXN0KG9yaWdpbiwgcmVmZXJlciwgdXNlckFnZW50KTtcbiAgICB9XG5cbiAgICAvLyBQYXJhIG3DqXRvZG9zIHF1ZSBtb2RpZmljYW4gZGF0b3MsIHZhbGlkYWNpw7NuIGVzdHJpY3RhXG4gICAgcmV0dXJuIHZhbGlkYXRlTXV0YXRpbmdSZXF1ZXN0KG9yaWdpbiwgcmVmZXJlciwgdXNlckFnZW50LCBtZXRob2QpO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW0NTUkZdIEVycm9yIGVuIHZhbGlkYWNpw7NuIGRlIG9yaWdlbjonLCBlcnJvcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnRXJyb3IgaW50ZXJubyBlbiB2YWxpZGFjacOzbiBkZSBvcmlnZW4nLFxuICAgICAgY29kZTogJ09SSUdJTl9WQUxJREFUSU9OX0VSUk9SJyxcbiAgICAgIHNldmVyaXR5OiAnY3JpdGljYWwnXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIFZhbGlkYSByZXF1ZXN0cyBHRVQgKG1lbm9zIGVzdHJpY3RvKVxuICovXG5mdW5jdGlvbiB2YWxpZGF0ZUdldFJlcXVlc3QoXG4gIG9yaWdpbjogc3RyaW5nIHwgbnVsbCxcbiAgcmVmZXJlcjogc3RyaW5nIHwgbnVsbCxcbiAgdXNlckFnZW50OiBzdHJpbmcgfCBudWxsXG4pOiBDU1JGVmFsaWRhdGlvblJlc3VsdCB7XG4gIC8vIFBhcmEgR0VULCBzb2xvIHZlcmlmaWNhciBxdWUgbm8gc2VhIG9idmlhbWVudGUgbWFsaWNpb3NvXG4gIGlmICh1c2VyQWdlbnQgJiYgaXNTdXNwaWNpb3VzVXNlckFnZW50KHVzZXJBZ2VudCkpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdVc2VyLUFnZW50IHNvc3BlY2hvc28gZGV0ZWN0YWRvJyxcbiAgICAgIGNvZGU6ICdTVVNQSUNJT1VTX1VTRVJfQUdFTlQnLFxuICAgICAgc2V2ZXJpdHk6ICdtZWRpdW0nXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdmFsaWQ6IHRydWUsXG4gICAgZGV0YWlsczoge1xuICAgICAgb3JpZ2luLFxuICAgICAgcmVmZXJlcixcbiAgICAgIHVzZXJBZ2VudCxcbiAgICAgIG1ldGhvZDogJ0dFVCdcbiAgICB9XG4gIH07XG59XG5cbi8qKlxuICogVmFsaWRhIHJlcXVlc3RzIHF1ZSBtb2RpZmljYW4gZGF0b3MgKGVzdHJpY3RvKVxuICovXG5mdW5jdGlvbiB2YWxpZGF0ZU11dGF0aW5nUmVxdWVzdChcbiAgb3JpZ2luOiBzdHJpbmcgfCBudWxsLFxuICByZWZlcmVyOiBzdHJpbmcgfCBudWxsLFxuICB1c2VyQWdlbnQ6IHN0cmluZyB8IG51bGwsXG4gIG1ldGhvZDogc3RyaW5nXG4pOiBDU1JGVmFsaWRhdGlvblJlc3VsdCB7XG4gIC8vIFZlcmlmaWNhciBPcmlnaW4gaGVhZGVyXG4gIGlmIChDU1JGX0NPTkZJRy5yZXF1aXJlT3JpZ2luICYmICFvcmlnaW4pIHtcbiAgICByZXR1cm4ge1xuICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdIZWFkZXIgT3JpZ2luIHJlcXVlcmlkbyBwYXJhIG9wZXJhY2lvbmVzIHF1ZSBtb2RpZmljYW4gZGF0b3MnLFxuICAgICAgY29kZTogJ01JU1NJTkdfT1JJR0lOX0hFQURFUicsXG4gICAgICBzZXZlcml0eTogJ2hpZ2gnXG4gICAgfTtcbiAgfVxuXG4gIGlmIChvcmlnaW4gJiYgIWlzQWxsb3dlZE9yaWdpbihvcmlnaW4pKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgIGVycm9yOiBgT3JpZ2VuIG5vIHBlcm1pdGlkbzogJHtvcmlnaW59YCxcbiAgICAgIGNvZGU6ICdJTlZBTElEX09SSUdJTicsXG4gICAgICBzZXZlcml0eTogJ2NyaXRpY2FsJyxcbiAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgb3JpZ2luLFxuICAgICAgICBleHBlY3RlZE9yaWdpbnM6IENTUkZfQ09ORklHLmFsbG93ZWRPcmlnaW5zXG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIC8vIFZlcmlmaWNhciBSZWZlcmVyIGhlYWRlclxuICBpZiAoQ1NSRl9DT05GSUcucmVxdWlyZVJlZmVyZXIgJiYgIXJlZmVyZXIpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdIZWFkZXIgUmVmZXJlciByZXF1ZXJpZG8gcGFyYSBvcGVyYWNpb25lcyBxdWUgbW9kaWZpY2FuIGRhdG9zJyxcbiAgICAgIGNvZGU6ICdNSVNTSU5HX1JFRkVSRVJfSEVBREVSJyxcbiAgICAgIHNldmVyaXR5OiAnaGlnaCdcbiAgICB9O1xuICB9XG5cbiAgaWYgKHJlZmVyZXIgJiYgIWlzQWxsb3dlZFJlZmVyZXIocmVmZXJlcikpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgZXJyb3I6IGBSZWZlcmVyIG5vIHBlcm1pdGlkbzogJHtyZWZlcmVyfWAsXG4gICAgICBjb2RlOiAnSU5WQUxJRF9SRUZFUkVSJyxcbiAgICAgIHNldmVyaXR5OiAnaGlnaCdcbiAgICB9O1xuICB9XG5cbiAgLy8gVmVyaWZpY2FyIFVzZXItQWdlbnRcbiAgaWYgKHVzZXJBZ2VudCAmJiBpc1N1c3BpY2lvdXNVc2VyQWdlbnQodXNlckFnZW50KSkge1xuICAgIHJldHVybiB7XG4gICAgICB2YWxpZDogZmFsc2UsXG4gICAgICBlcnJvcjogJ1VzZXItQWdlbnQgc29zcGVjaG9zbyBkZXRlY3RhZG8nLFxuICAgICAgY29kZTogJ1NVU1BJQ0lPVVNfVVNFUl9BR0VOVCcsXG4gICAgICBzZXZlcml0eTogJ21lZGl1bSdcbiAgICB9O1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB2YWxpZDogdHJ1ZSxcbiAgICBkZXRhaWxzOiB7XG4gICAgICBvcmlnaW4sXG4gICAgICByZWZlcmVyLFxuICAgICAgdXNlckFnZW50LFxuICAgICAgbWV0aG9kLFxuICAgICAgZXhwZWN0ZWRPcmlnaW5zOiBDU1JGX0NPTkZJRy5hbGxvd2VkT3JpZ2luc1xuICAgIH1cbiAgfTtcbn1cblxuLyoqXG4gKiBWZXJpZmljYSBzaSB1biBvcmlnZW4gZXN0w6EgcGVybWl0aWRvXG4gKi9cbmZ1bmN0aW9uIGlzQWxsb3dlZE9yaWdpbihvcmlnaW46IHN0cmluZyk6IGJvb2xlYW4ge1xuICB0cnkge1xuICAgIGNvbnN0IG9yaWdpblVybCA9IG5ldyBVUkwob3JpZ2luKTtcbiAgICBcbiAgICByZXR1cm4gQ1NSRl9DT05GSUcuYWxsb3dlZE9yaWdpbnMuc29tZShhbGxvd2VkT3JpZ2luID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGFsbG93ZWRVcmwgPSBuZXcgVVJMKGFsbG93ZWRPcmlnaW4pO1xuICAgICAgICByZXR1cm4gb3JpZ2luVXJsLmhvc3RuYW1lID09PSBhbGxvd2VkVXJsLmhvc3RuYW1lICYmXG4gICAgICAgICAgICAgICBvcmlnaW5VcmwucHJvdG9jb2wgPT09IGFsbG93ZWRVcmwucHJvdG9jb2w7XG4gICAgICB9IGNhdGNoIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH0pO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuLyoqXG4gKiBWZXJpZmljYSBzaSB1biByZWZlcmVyIGVzdMOhIHBlcm1pdGlkb1xuICovXG5mdW5jdGlvbiBpc0FsbG93ZWRSZWZlcmVyKHJlZmVyZXI6IHN0cmluZyk6IGJvb2xlYW4ge1xuICB0cnkge1xuICAgIGNvbnN0IHJlZmVyZXJVcmwgPSBuZXcgVVJMKHJlZmVyZXIpO1xuICAgIFxuICAgIHJldHVybiBDU1JGX0NPTkZJRy5hbGxvd2VkT3JpZ2lucy5zb21lKGFsbG93ZWRPcmlnaW4gPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgYWxsb3dlZFVybCA9IG5ldyBVUkwoYWxsb3dlZE9yaWdpbik7XG4gICAgICAgIHJldHVybiByZWZlcmVyVXJsLmhvc3RuYW1lID09PSBhbGxvd2VkVXJsLmhvc3RuYW1lO1xuICAgICAgfSBjYXRjaCB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbi8qKlxuICogRGV0ZWN0YSBVc2VyLUFnZW50cyBzb3NwZWNob3Nvc1xuICovXG5mdW5jdGlvbiBpc1N1c3BpY2lvdXNVc2VyQWdlbnQodXNlckFnZW50OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgY29uc3Qgc3VzcGljaW91c1BhdHRlcm5zID0gW1xuICAgIC9ib3QvaSxcbiAgICAvY3Jhd2xlci9pLFxuICAgIC9zcGlkZXIvaSxcbiAgICAvc2NyYXBlci9pLFxuICAgIC9jdXJsL2ksXG4gICAgL3dnZXQvaSxcbiAgICAvcHl0aG9uL2ksXG4gICAgL3Bvc3RtYW4vaSxcbiAgICAvaW5zb21uaWEvaSxcbiAgICAvXiQvLCAgLy8gVXNlci1BZ2VudCB2YWPDrW9cbiAgICAvXi57MCwxMH0kLywgIC8vIFVzZXItQWdlbnQgbXV5IGNvcnRvXG4gICAgL14uezUwMCx9JC8gICAvLyBVc2VyLUFnZW50IG11eSBsYXJnb1xuICBdO1xuXG4gIHJldHVybiBzdXNwaWNpb3VzUGF0dGVybnMuc29tZShwYXR0ZXJuID0+IHBhdHRlcm4udGVzdCh1c2VyQWdlbnQpKTtcbn1cblxuLyoqXG4gKiBPYnRpZW5lIHVuIGhlYWRlciBkZSBtYW5lcmEgY29tcGF0aWJsZSBjb24gYW1ib3MgdGlwb3MgZGUgcmVxdWVzdFxuICovXG5mdW5jdGlvbiBnZXRIZWFkZXIoXG4gIHJlcXVlc3Q6IE5leHRSZXF1ZXN0IHwgTmV4dEFwaVJlcXVlc3QsXG4gIGhlYWRlck5hbWU6IHN0cmluZ1xuKTogc3RyaW5nIHwgbnVsbCB7XG4gIGlmICgnaGVhZGVycycgaW4gcmVxdWVzdCAmJiB0eXBlb2YgcmVxdWVzdC5oZWFkZXJzLmdldCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIC8vIE5leHRSZXF1ZXN0XG4gICAgcmV0dXJuIChyZXF1ZXN0IGFzIE5leHRSZXF1ZXN0KS5oZWFkZXJzLmdldChoZWFkZXJOYW1lKTtcbiAgfSBlbHNlIGlmICgnaGVhZGVycycgaW4gcmVxdWVzdCkge1xuICAgIC8vIE5leHRBcGlSZXF1ZXN0XG4gICAgY29uc3QgaGVhZGVyID0gKHJlcXVlc3QgYXMgTmV4dEFwaVJlcXVlc3QpLmhlYWRlcnNbaGVhZGVyTmFtZV07XG4gICAgcmV0dXJuIEFycmF5LmlzQXJyYXkoaGVhZGVyKSA/IGhlYWRlclswXSA6IGhlYWRlciB8fCBudWxsO1xuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gR0VORVJBQ0nDk04gWSBWQUxJREFDScOTTiBERSBUT0tFTlMgQ1NSRlxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBHZW5lcmEgdW4gdG9rZW4gQ1NSRiDDum5pY29cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlQ1NSRlRva2VuKCk6IHN0cmluZyB7XG4gIHJldHVybiBjcnlwdG8ucmFuZG9tQnl0ZXMoMzIpLnRvU3RyaW5nKCdoZXgnKTtcbn1cblxuLyoqXG4gKiBWYWxpZGEgdW4gdG9rZW4gQ1NSRlxuICovXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVDU1JGVG9rZW4oXG4gIHByb3ZpZGVkVG9rZW46IHN0cmluZyxcbiAgZXhwZWN0ZWRUb2tlbjogc3RyaW5nXG4pOiBib29sZWFuIHtcbiAgaWYgKCFwcm92aWRlZFRva2VuIHx8ICFleHBlY3RlZFRva2VuKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLy8gQ29tcGFyYWNpw7NuIHNlZ3VyYSBwYXJhIHByZXZlbmlyIHRpbWluZyBhdHRhY2tzXG4gIHJldHVybiBjcnlwdG8udGltaW5nU2FmZUVxdWFsKFxuICAgIEJ1ZmZlci5mcm9tKHByb3ZpZGVkVG9rZW4sICdoZXgnKSxcbiAgICBCdWZmZXIuZnJvbShleHBlY3RlZFRva2VuLCAnaGV4JylcbiAgKTtcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIE1JRERMRVdBUkUgREUgUFJPVEVDQ0nDk04gQ1NSRlxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBNaWRkbGV3YXJlIHBhcmEgcHJvdGVjY2nDs24gYXV0b23DoXRpY2EgY29udHJhIENTUkZcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhDU1JGUHJvdGVjdGlvbihcbiAgb3B0aW9uczogUGFydGlhbDxPcmlnaW5WYWxpZGF0aW9uQ29uZmlnPiA9IHt9XG4pIHtcbiAgY29uc3QgY29uZmlnID0geyAuLi5DU1JGX0NPTkZJRywgLi4ub3B0aW9ucyB9O1xuXG4gIHJldHVybiBmdW5jdGlvbiAoaGFuZGxlcjogRnVuY3Rpb24pIHtcbiAgICByZXR1cm4gYXN5bmMgKHJlcXVlc3Q6IE5leHRSZXF1ZXN0IHwgTmV4dEFwaVJlcXVlc3QsIC4uLmFyZ3M6IGFueVtdKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICAvLyBWYWxpZGFyIG9yaWdlbiBkZSBsYSByZXF1ZXN0XG4gICAgICAgIGNvbnN0IG9yaWdpblZhbGlkYXRpb24gPSBhd2FpdCB2YWxpZGF0ZVJlcXVlc3RPcmlnaW4ocmVxdWVzdCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIW9yaWdpblZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICBjb25zdCBlcnJvclJlc3BvbnNlID0ge1xuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICBlcnJvcjogb3JpZ2luVmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgIGNvZGU6IG9yaWdpblZhbGlkYXRpb24uY29kZSxcbiAgICAgICAgICAgIHNldmVyaXR5OiBvcmlnaW5WYWxpZGF0aW9uLnNldmVyaXR5LFxuICAgICAgICAgICAgY3NyZlByb3RlY3Rpb246IHRydWVcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgaWYgKCdxdWVyeScgaW4gcmVxdWVzdCkge1xuICAgICAgICAgICAgLy8gUGFnZXMgUm91dGVyXG4gICAgICAgICAgICBjb25zdCByZXMgPSBhcmdzWzBdIGFzIGFueTtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMykuanNvbihlcnJvclJlc3BvbnNlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gQXBwIFJvdXRlclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShKU09OLnN0cmluZ2lmeShlcnJvclJlc3BvbnNlKSwge1xuICAgICAgICAgICAgICBzdGF0dXM6IDQwMyxcbiAgICAgICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEHDsWFkaXIgaW5mb3JtYWNpw7NuIGRlIHZhbGlkYWNpw7NuIGFsIHJlcXVlc3RcbiAgICAgICAgKHJlcXVlc3QgYXMgYW55KS5jc3JmVmFsaWRhdGlvbiA9IG9yaWdpblZhbGlkYXRpb247XG5cbiAgICAgICAgcmV0dXJuIGhhbmRsZXIocmVxdWVzdCwgLi4uYXJncyk7XG5cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tDU1JGXSBFcnJvciBlbiBtaWRkbGV3YXJlIGRlIHByb3RlY2Npw7NuOicsIGVycm9yKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGVycm9yUmVzcG9uc2UgPSB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6ICdFcnJvciBpbnRlcm5vIGVuIHByb3RlY2Npw7NuIENTUkYnLFxuICAgICAgICAgIGNvZGU6ICdDU1JGX01JRERMRVdBUkVfRVJST1InXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKCdxdWVyeScgaW4gcmVxdWVzdCkge1xuICAgICAgICAgIC8vIFBhZ2VzIFJvdXRlclxuICAgICAgICAgIGNvbnN0IHJlcyA9IGFyZ3NbMF0gYXMgYW55O1xuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbihlcnJvclJlc3BvbnNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBBcHAgUm91dGVyXG4gICAgICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShKU09OLnN0cmluZ2lmeShlcnJvclJlc3BvbnNlKSwge1xuICAgICAgICAgICAgc3RhdHVzOiA1MDAsXG4gICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfTtcbn1cblxuLyoqXG4gKiBNaWRkbGV3YXJlIGVzcGVjw61maWNvIHBhcmEgQVBJcyBhZG1pbiBjb24gcHJvdGVjY2nDs24gQ1NSRiBlc3RyaWN0YVxuICovXG5leHBvcnQgZnVuY3Rpb24gd2l0aEFkbWluQ1NSRlByb3RlY3Rpb24oKSB7XG4gIHJldHVybiB3aXRoQ1NSRlByb3RlY3Rpb24oe1xuICAgIHN0cmljdE1vZGU6IHRydWUsXG4gICAgcmVxdWlyZVJlZmVyZXI6IHRydWUsXG4gICAgcmVxdWlyZU9yaWdpbjogdHJ1ZVxuICB9KTtcbn1cbiJdLCJuYW1lcyI6WyJnZW5lcmF0ZUNTUkZUb2tlbiIsInZhbGlkYXRlQ1NSRlRva2VuIiwidmFsaWRhdGVSZXF1ZXN0T3JpZ2luIiwid2l0aEFkbWluQ1NSRlByb3RlY3Rpb24iLCJ3aXRoQ1NSRlByb3RlY3Rpb24iLCJDU1JGX0NPTkZJRyIsImFsbG93ZWRPcmlnaW5zIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX0FQUF9VUkwiLCJhbGxvd2VkTWV0aG9kcyIsInJlcXVpcmVSZWZlcmVyIiwicmVxdWlyZU9yaWdpbiIsInN0cmljdE1vZGUiLCJOT0RFX0VOViIsImRldmVsb3BtZW50TW9kZSIsInJlcXVlc3QiLCJtZXRob2QiLCJvcmlnaW4iLCJnZXRIZWFkZXIiLCJyZWZlcmVyIiwidXNlckFnZW50IiwidmFsaWQiLCJkZXRhaWxzIiwiZXhwZWN0ZWRPcmlnaW5zIiwiaW5jbHVkZXMiLCJlcnJvciIsImNvZGUiLCJzZXZlcml0eSIsInZhbGlkYXRlR2V0UmVxdWVzdCIsInZhbGlkYXRlTXV0YXRpbmdSZXF1ZXN0IiwiY29uc29sZSIsImlzU3VzcGljaW91c1VzZXJBZ2VudCIsImlzQWxsb3dlZE9yaWdpbiIsImlzQWxsb3dlZFJlZmVyZXIiLCJvcmlnaW5VcmwiLCJVUkwiLCJzb21lIiwiYWxsb3dlZE9yaWdpbiIsImFsbG93ZWRVcmwiLCJob3N0bmFtZSIsInByb3RvY29sIiwicmVmZXJlclVybCIsInN1c3BpY2lvdXNQYXR0ZXJucyIsInBhdHRlcm4iLCJ0ZXN0IiwiaGVhZGVyTmFtZSIsImhlYWRlcnMiLCJnZXQiLCJoZWFkZXIiLCJBcnJheSIsImlzQXJyYXkiLCJjcnlwdG8iLCJyYW5kb21CeXRlcyIsInRvU3RyaW5nIiwicHJvdmlkZWRUb2tlbiIsImV4cGVjdGVkVG9rZW4iLCJ0aW1pbmdTYWZlRXF1YWwiLCJCdWZmZXIiLCJmcm9tIiwib3B0aW9ucyIsImNvbmZpZyIsImhhbmRsZXIiLCJhcmdzIiwib3JpZ2luVmFsaWRhdGlvbiIsImVycm9yUmVzcG9uc2UiLCJzdWNjZXNzIiwiY3NyZlByb3RlY3Rpb24iLCJyZXMiLCJzdGF0dXMiLCJqc29uIiwiUmVzcG9uc2UiLCJKU09OIiwic3RyaW5naWZ5IiwiY3NyZlZhbGlkYXRpb24iXSwibWFwcGluZ3MiOiJBQUFBOzs7Q0FHQzs7Ozs7Ozs7Ozs7SUE2U2VBLGlCQUFpQjtlQUFqQkE7O0lBT0FDLGlCQUFpQjtlQUFqQkE7O0lBelBNQyxxQkFBcUI7ZUFBckJBOztJQWlWTkMsdUJBQXVCO2VBQXZCQTs7SUFsRUFDLGtCQUFrQjtlQUFsQkE7OzsrREF0VUc7Ozs7OztBQThCbkIsd0RBQXdEO0FBQ3hELDZCQUE2QjtBQUM3Qix3REFBd0Q7QUFFeEQsTUFBTUMsY0FBc0M7SUFDMUNDLGdCQUFnQjtRQUNkQyxRQUFRQyxHQUFHLENBQUNDLG1CQUFtQixJQUFJO1FBQ25DO1FBQ0E7UUFDQTtLQUNEO0lBQ0RDLGdCQUFnQjtRQUFDO1FBQU87UUFBUTtRQUFPO1FBQVM7S0FBUztJQUN6REMsZ0JBQWdCO0lBQ2hCQyxlQUFlO0lBQ2ZDLFlBQVlOLFFBQVFDLEdBQUcsQ0FBQ00sUUFBUSxLQUFLO0lBQ3JDQyxpQkFBaUJSLFFBQVFDLEdBQUcsQ0FBQ00sUUFBUSxLQUFLO0FBQzVDO0FBU08sZUFBZVosc0JBQ3BCYyxPQUFxQztJQUVyQyxJQUFJO1FBQ0YsTUFBTUMsU0FBU0QsUUFBUUMsTUFBTSxJQUFJO1FBQ2pDLE1BQU1DLFNBQVNDLFVBQVVILFNBQVM7UUFDbEMsTUFBTUksVUFBVUQsVUFBVUgsU0FBUztRQUNuQyxNQUFNSyxZQUFZRixVQUFVSCxTQUFTO1FBRXJDLG1DQUFtQztRQUNuQyxJQUFJWCxZQUFZVSxlQUFlLElBQUksQ0FBQ1YsWUFBWVEsVUFBVSxFQUFFO1lBQzFELE9BQU87Z0JBQ0xTLE9BQU87Z0JBQ1BDLFNBQVM7b0JBQ1BMO29CQUNBRTtvQkFDQUM7b0JBQ0FKO29CQUNBTyxpQkFBaUJuQixZQUFZQyxjQUFjO2dCQUM3QztZQUNGO1FB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