20fd3ac591b04513490fcdf940654944
// ===================================
// PINTEYA E-COMMERCE - API DE PRODUCTOS
// ===================================
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    GET: function() {
        return GET;
    },
    POST: function() {
        return POST;
    }
});
const _server = require("next/server");
const _supabase = require("../../../lib/supabase");
const _validations = require("../../../lib/validations");
async function GET(request) {
    try {
        const { searchParams } = new URL(request.url);
        // Extraer parámetros de query
        const queryParams = {
            category: searchParams.get('category') || undefined,
            categories: searchParams.get('categories')?.split(',').filter(Boolean) || undefined,
            brand: searchParams.get('brand') || undefined,
            brands: searchParams.get('brands')?.split(',').filter(Boolean) || undefined,
            paintType: searchParams.get('paintType') || undefined,
            paintTypes: searchParams.get('paintTypes')?.split(',').filter(Boolean) || undefined,
            priceMin: searchParams.get('priceMin') ? Number(searchParams.get('priceMin')) : undefined,
            priceMax: searchParams.get('priceMax') ? Number(searchParams.get('priceMax')) : undefined,
            search: searchParams.get('search') || undefined,
            page: searchParams.get('page') ? Number(searchParams.get('page')) : 1,
            limit: searchParams.get('limit') ? Number(searchParams.get('limit')) : 12,
            sortBy: searchParams.get('sortBy') || 'created_at',
            sortOrder: searchParams.get('sortOrder') || 'desc'
        };
        // Validar parámetros de manera segura
        const validationResult = (0, _validations.safeValidateData)(_validations.ProductFiltersSchema, queryParams);
        if (!validationResult.success) {
            console.error('Error de validación en GET /api/products:', validationResult.error);
            const errorResponse = {
                data: null,
                success: false,
                error: `Parámetros inválidos: ${validationResult.error}`
            };
            return _server.NextResponse.json(errorResponse, {
                status: 400
            });
        }
        const filters = validationResult.data;
        const supabase = (0, _supabase.getSupabaseClient)();
        // Verificar que el cliente de Supabase esté disponible
        if (!supabase) {
            console.error('Cliente de Supabase no disponible en GET /api/products');
            const errorResponse = {
                data: null,
                success: false,
                error: 'Servicio de base de datos no disponible'
            };
            return _server.NextResponse.json(errorResponse, {
                status: 503
            });
        }
        // Construir query base optimizada (solo campos necesarios)
        let query = supabase.from('products').select(`
        id, name, slug, price, discounted_price, brand, stock, images,
        category:categories(id, name, slug)
      `, {
            count: 'exact'
        });
        // Aplicar filtros
        if (filters.category) {
            // Primero obtener el ID de la categoría por su slug
            const { data: categoryData } = await supabase.from('categories').select('id').eq('slug', filters.category).single();
            if (categoryData) {
                query = query.eq('category_id', categoryData.id);
            }
        }
        // Filtro por múltiples categorías (nuevo)
        if (filters.categories && filters.categories.length > 0) {
            const { data: categoriesData } = await supabase.from('categories').select('id').in('slug', filters.categories);
            if (categoriesData && categoriesData.length > 0) {
                const categoryIds = categoriesData.map((cat)=>cat.id);
                query = query.in('category_id', categoryIds);
            }
        }
        if (filters.brand) {
            query = query.eq('brand', filters.brand);
        }
        // Filtro por múltiples marcas (nuevo)
        if (filters.brands && filters.brands.length > 0) {
            query = query.in('brand', filters.brands);
        }
        // Filtro por tipo de pintura (nuevo)
        if (filters.paintType) {
            query = query.eq('paint_type', filters.paintType);
        }
        // Filtro por múltiples tipos de pintura (nuevo)
        if (filters.paintTypes && filters.paintTypes.length > 0) {
            query = query.in('paint_type', filters.paintTypes);
        }
        if (filters.priceMin) {
            query = query.gte('price', filters.priceMin);
        }
        if (filters.priceMax) {
            query = query.lte('price', filters.priceMax);
        }
        if (filters.search) {
            query = query.or(`name.ilike.%${filters.search}%,description.ilike.%${filters.search}%,brand.ilike.%${filters.search}%`);
        }
        // Solo productos con stock (temporalmente comentado para testing)
        // query = query.gt('stock', 0);
        // Ordenamiento
        const orderColumn = filters.sortBy === 'created_at' ? 'created_at' : filters.sortBy === 'brand' ? 'brand' : filters.sortBy || 'created_at';
        query = query.order(orderColumn, {
            ascending: filters.sortOrder === 'asc'
        });
        // Paginación
        const page = filters.page || 1;
        const limit = filters.limit || 10;
        const from = (page - 1) * limit;
        const to = from + limit - 1;
        query = query.range(from, to);
        // Ejecutar query
        const { data: products, error, count } = await query;
        if (error) {
            console.error('Error en GET /api/products - Supabase:', error);
            const errorResponse = {
                data: null,
                success: false,
                error: error.message || 'Error obteniendo productos de la base de datos'
            };
            return _server.NextResponse.json(errorResponse, {
                status: 500
            });
        }
        // Calcular información de paginación
        const totalPages = Math.ceil((count || 0) / limit);
        const response = {
            data: products || [],
            pagination: {
                page,
                limit,
                total: count || 0,
                totalPages
            },
            success: true,
            message: `${products?.length || 0} productos encontrados`
        };
        // Agregar headers de cache para mejorar performance
        return _server.NextResponse.json(response, {
            headers: {
                'Cache-Control': 'public, s-maxage=60, stale-while-revalidate=300',
                'Content-Type': 'application/json'
            }
        });
    } catch (error) {
        console.error('Error en GET /api/products:', error);
        const errorResponse = {
            data: null,
            success: false,
            error: error.message || 'Error interno del servidor'
        };
        return _server.NextResponse.json(errorResponse, {
            status: 500
        });
    }
}
async function POST(request) {
    try {
        // TODO: Verificar permisos de administrador
        // const { userId } = auth();
        // if (!userId || !isAdmin(userId)) {
        //   return NextResponse.json({ error: 'No autorizado' }, { status: 401 });
        // }
        const body = await request.json();
        // Validar datos del producto
        const productData = (0, _validations.validateData)(_validations.ProductSchema, body);
        const supabase = (0, _supabase.getSupabaseClient)(true); // Usar cliente admin
        // Verificar que el cliente administrativo esté disponible
        if (!supabase) {
            console.error('Cliente administrativo de Supabase no disponible en POST /api/products');
            const errorResponse = {
                data: null,
                success: false,
                error: 'Servicio administrativo no disponible'
            };
            return _server.NextResponse.json(errorResponse, {
                status: 503
            });
        }
        // Crear slug si no se proporciona
        if (!productData.slug) {
            productData.slug = productData.name.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)/g, '');
        }
        // Insertar producto
        const { data: product, error } = await supabase.from('products').insert(productData).select(`
        *,
        category:categories(id, name, slug)
      `).single();
        if (error) {
            (0, _supabase.handleSupabaseError)(error, 'POST /api/products');
        }
        const response = {
            data: product,
            success: true,
            message: 'Producto creado exitosamente'
        };
        return _server.NextResponse.json(response, {
            status: 201
        });
    } catch (error) {
        console.error('Error en POST /api/products:', error);
        const errorResponse = {
            data: null,
            success: false,
            error: error.message || 'Error interno del servidor'
        };
        return _server.NextResponse.json(errorResponse, {
            status: 500
        });
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcYXBwXFxhcGlcXHByb2R1Y3RzXFxyb3V0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQSU5URVlBIEUtQ09NTUVSQ0UgLSBBUEkgREUgUFJPRFVDVE9TXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xyXG5pbXBvcnQgeyBnZXRTdXBhYmFzZUNsaWVudCwgaGFuZGxlU3VwYWJhc2VFcnJvciB9IGZyb20gJ0AvbGliL3N1cGFiYXNlJztcclxuaW1wb3J0IHsgdmFsaWRhdGVEYXRhLCBzYWZlVmFsaWRhdGVEYXRhLCBQcm9kdWN0RmlsdGVyc1NjaGVtYSwgUHJvZHVjdFNjaGVtYSB9IGZyb20gJ0AvbGliL3ZhbGlkYXRpb25zJztcclxuaW1wb3J0IHsgQXBpUmVzcG9uc2UsIFBhZ2luYXRlZFJlc3BvbnNlLCBQcm9kdWN0V2l0aENhdGVnb3J5IH0gZnJvbSAnQC90eXBlcy9hcGknO1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gR0VUIC9hcGkvcHJvZHVjdHMgLSBPYnRlbmVyIHByb2R1Y3RvcyBjb24gZmlsdHJvc1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgc2VhcmNoUGFyYW1zIH0gPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcclxuICAgIFxyXG4gICAgLy8gRXh0cmFlciBwYXLDoW1ldHJvcyBkZSBxdWVyeVxyXG4gICAgY29uc3QgcXVlcnlQYXJhbXMgPSB7XHJcbiAgICAgIGNhdGVnb3J5OiBzZWFyY2hQYXJhbXMuZ2V0KCdjYXRlZ29yeScpIHx8IHVuZGVmaW5lZCxcclxuICAgICAgY2F0ZWdvcmllczogc2VhcmNoUGFyYW1zLmdldCgnY2F0ZWdvcmllcycpPy5zcGxpdCgnLCcpLmZpbHRlcihCb29sZWFuKSB8fCB1bmRlZmluZWQsXHJcbiAgICAgIGJyYW5kOiBzZWFyY2hQYXJhbXMuZ2V0KCdicmFuZCcpIHx8IHVuZGVmaW5lZCxcclxuICAgICAgYnJhbmRzOiBzZWFyY2hQYXJhbXMuZ2V0KCdicmFuZHMnKT8uc3BsaXQoJywnKS5maWx0ZXIoQm9vbGVhbikgfHwgdW5kZWZpbmVkLFxyXG4gICAgICBwYWludFR5cGU6IHNlYXJjaFBhcmFtcy5nZXQoJ3BhaW50VHlwZScpIHx8IHVuZGVmaW5lZCxcclxuICAgICAgcGFpbnRUeXBlczogc2VhcmNoUGFyYW1zLmdldCgncGFpbnRUeXBlcycpPy5zcGxpdCgnLCcpLmZpbHRlcihCb29sZWFuKSB8fCB1bmRlZmluZWQsXHJcbiAgICAgIHByaWNlTWluOiBzZWFyY2hQYXJhbXMuZ2V0KCdwcmljZU1pbicpID8gTnVtYmVyKHNlYXJjaFBhcmFtcy5nZXQoJ3ByaWNlTWluJykpIDogdW5kZWZpbmVkLFxyXG4gICAgICBwcmljZU1heDogc2VhcmNoUGFyYW1zLmdldCgncHJpY2VNYXgnKSA/IE51bWJlcihzZWFyY2hQYXJhbXMuZ2V0KCdwcmljZU1heCcpKSA6IHVuZGVmaW5lZCxcclxuICAgICAgc2VhcmNoOiBzZWFyY2hQYXJhbXMuZ2V0KCdzZWFyY2gnKSB8fCB1bmRlZmluZWQsXHJcbiAgICAgIHBhZ2U6IHNlYXJjaFBhcmFtcy5nZXQoJ3BhZ2UnKSA/IE51bWJlcihzZWFyY2hQYXJhbXMuZ2V0KCdwYWdlJykpIDogMSxcclxuICAgICAgbGltaXQ6IHNlYXJjaFBhcmFtcy5nZXQoJ2xpbWl0JykgPyBOdW1iZXIoc2VhcmNoUGFyYW1zLmdldCgnbGltaXQnKSkgOiAxMixcclxuICAgICAgc29ydEJ5OiBzZWFyY2hQYXJhbXMuZ2V0KCdzb3J0QnknKSBhcyAncHJpY2UnIHwgJ25hbWUnIHwgJ2NyZWF0ZWRfYXQnIHwgJ2JyYW5kJyB8fCAnY3JlYXRlZF9hdCcsXHJcbiAgICAgIHNvcnRPcmRlcjogc2VhcmNoUGFyYW1zLmdldCgnc29ydE9yZGVyJykgYXMgJ2FzYycgfCAnZGVzYycgfHwgJ2Rlc2MnLFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBWYWxpZGFyIHBhcsOhbWV0cm9zIGRlIG1hbmVyYSBzZWd1cmFcclxuICAgIGNvbnN0IHZhbGlkYXRpb25SZXN1bHQgPSBzYWZlVmFsaWRhdGVEYXRhKFByb2R1Y3RGaWx0ZXJzU2NoZW1hLCBxdWVyeVBhcmFtcyk7XHJcblxyXG4gICAgaWYgKCF2YWxpZGF0aW9uUmVzdWx0LnN1Y2Nlc3MpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGUgdmFsaWRhY2nDs24gZW4gR0VUIC9hcGkvcHJvZHVjdHM6JywgdmFsaWRhdGlvblJlc3VsdC5lcnJvcik7XHJcbiAgICAgIGNvbnN0IGVycm9yUmVzcG9uc2U6IEFwaVJlc3BvbnNlPG51bGw+ID0ge1xyXG4gICAgICAgIGRhdGE6IG51bGwsXHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6IGBQYXLDoW1ldHJvcyBpbnbDoWxpZG9zOiAke3ZhbGlkYXRpb25SZXN1bHQuZXJyb3J9YCxcclxuICAgICAgfTtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKGVycm9yUmVzcG9uc2UsIHsgc3RhdHVzOiA0MDAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZmlsdGVycyA9IHZhbGlkYXRpb25SZXN1bHQuZGF0YSE7XHJcbiAgICBcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VDbGllbnQoKTtcclxuXHJcbiAgICAvLyBWZXJpZmljYXIgcXVlIGVsIGNsaWVudGUgZGUgU3VwYWJhc2UgZXN0w6kgZGlzcG9uaWJsZVxyXG4gICAgaWYgKCFzdXBhYmFzZSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdDbGllbnRlIGRlIFN1cGFiYXNlIG5vIGRpc3BvbmlibGUgZW4gR0VUIC9hcGkvcHJvZHVjdHMnKTtcclxuICAgICAgY29uc3QgZXJyb3JSZXNwb25zZTogQXBpUmVzcG9uc2U8bnVsbD4gPSB7XHJcbiAgICAgICAgZGF0YTogbnVsbCxcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ1NlcnZpY2lvIGRlIGJhc2UgZGUgZGF0b3Mgbm8gZGlzcG9uaWJsZScsXHJcbiAgICAgIH07XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihlcnJvclJlc3BvbnNlLCB7IHN0YXR1czogNTAzIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENvbnN0cnVpciBxdWVyeSBiYXNlIG9wdGltaXphZGEgKHNvbG8gY2FtcG9zIG5lY2VzYXJpb3MpXHJcbiAgICBsZXQgcXVlcnkgPSBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgncHJvZHVjdHMnKVxyXG4gICAgICAuc2VsZWN0KGBcclxuICAgICAgICBpZCwgbmFtZSwgc2x1ZywgcHJpY2UsIGRpc2NvdW50ZWRfcHJpY2UsIGJyYW5kLCBzdG9jaywgaW1hZ2VzLFxyXG4gICAgICAgIGNhdGVnb3J5OmNhdGVnb3JpZXMoaWQsIG5hbWUsIHNsdWcpXHJcbiAgICAgIGAsIHsgY291bnQ6ICdleGFjdCcgfSk7XHJcblxyXG4gICAgLy8gQXBsaWNhciBmaWx0cm9zXHJcbiAgICBpZiAoZmlsdGVycy5jYXRlZ29yeSkge1xyXG4gICAgICAvLyBQcmltZXJvIG9idGVuZXIgZWwgSUQgZGUgbGEgY2F0ZWdvcsOtYSBwb3Igc3Ugc2x1Z1xyXG4gICAgICBjb25zdCB7IGRhdGE6IGNhdGVnb3J5RGF0YSB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgnY2F0ZWdvcmllcycpXHJcbiAgICAgICAgLnNlbGVjdCgnaWQnKVxyXG4gICAgICAgIC5lcSgnc2x1ZycsIGZpbHRlcnMuY2F0ZWdvcnkpXHJcbiAgICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgICAgaWYgKGNhdGVnb3J5RGF0YSkge1xyXG4gICAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ2NhdGVnb3J5X2lkJywgY2F0ZWdvcnlEYXRhLmlkKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEZpbHRybyBwb3IgbcO6bHRpcGxlcyBjYXRlZ29yw61hcyAobnVldm8pXHJcbiAgICBpZiAoZmlsdGVycy5jYXRlZ29yaWVzICYmIGZpbHRlcnMuY2F0ZWdvcmllcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGNvbnN0IHsgZGF0YTogY2F0ZWdvcmllc0RhdGEgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgLmZyb20oJ2NhdGVnb3JpZXMnKVxyXG4gICAgICAgIC5zZWxlY3QoJ2lkJylcclxuICAgICAgICAuaW4oJ3NsdWcnLCBmaWx0ZXJzLmNhdGVnb3JpZXMpO1xyXG5cclxuICAgICAgaWYgKGNhdGVnb3JpZXNEYXRhICYmIGNhdGVnb3JpZXNEYXRhLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBjb25zdCBjYXRlZ29yeUlkcyA9IGNhdGVnb3JpZXNEYXRhLm1hcChjYXQgPT4gY2F0LmlkKTtcclxuICAgICAgICBxdWVyeSA9IHF1ZXJ5LmluKCdjYXRlZ29yeV9pZCcsIGNhdGVnb3J5SWRzKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChmaWx0ZXJzLmJyYW5kKSB7XHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ2JyYW5kJywgZmlsdGVycy5icmFuZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRmlsdHJvIHBvciBtw7psdGlwbGVzIG1hcmNhcyAobnVldm8pXHJcbiAgICBpZiAoZmlsdGVycy5icmFuZHMgJiYgZmlsdGVycy5icmFuZHMubGVuZ3RoID4gMCkge1xyXG4gICAgICBxdWVyeSA9IHF1ZXJ5LmluKCdicmFuZCcsIGZpbHRlcnMuYnJhbmRzKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBGaWx0cm8gcG9yIHRpcG8gZGUgcGludHVyYSAobnVldm8pXHJcbiAgICBpZiAoZmlsdGVycy5wYWludFR5cGUpIHtcclxuICAgICAgcXVlcnkgPSBxdWVyeS5lcSgncGFpbnRfdHlwZScsIGZpbHRlcnMucGFpbnRUeXBlKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBGaWx0cm8gcG9yIG3Dumx0aXBsZXMgdGlwb3MgZGUgcGludHVyYSAobnVldm8pXHJcbiAgICBpZiAoZmlsdGVycy5wYWludFR5cGVzICYmIGZpbHRlcnMucGFpbnRUeXBlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuaW4oJ3BhaW50X3R5cGUnLCBmaWx0ZXJzLnBhaW50VHlwZXMpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChmaWx0ZXJzLnByaWNlTWluKSB7XHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZ3RlKCdwcmljZScsIGZpbHRlcnMucHJpY2VNaW4pO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChmaWx0ZXJzLnByaWNlTWF4KSB7XHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkubHRlKCdwcmljZScsIGZpbHRlcnMucHJpY2VNYXgpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChmaWx0ZXJzLnNlYXJjaCkge1xyXG4gICAgICBxdWVyeSA9IHF1ZXJ5Lm9yKGBuYW1lLmlsaWtlLiUke2ZpbHRlcnMuc2VhcmNofSUsZGVzY3JpcHRpb24uaWxpa2UuJSR7ZmlsdGVycy5zZWFyY2h9JSxicmFuZC5pbGlrZS4lJHtmaWx0ZXJzLnNlYXJjaH0lYCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU29sbyBwcm9kdWN0b3MgY29uIHN0b2NrICh0ZW1wb3JhbG1lbnRlIGNvbWVudGFkbyBwYXJhIHRlc3RpbmcpXHJcbiAgICAvLyBxdWVyeSA9IHF1ZXJ5Lmd0KCdzdG9jaycsIDApO1xyXG5cclxuICAgIC8vIE9yZGVuYW1pZW50b1xyXG4gICAgY29uc3Qgb3JkZXJDb2x1bW4gPSBmaWx0ZXJzLnNvcnRCeSA9PT0gJ2NyZWF0ZWRfYXQnID8gJ2NyZWF0ZWRfYXQnIDpcclxuICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJzLnNvcnRCeSA9PT0gJ2JyYW5kJyA/ICdicmFuZCcgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgIChmaWx0ZXJzLnNvcnRCeSB8fCAnY3JlYXRlZF9hdCcpO1xyXG4gICAgcXVlcnkgPSBxdWVyeS5vcmRlcihvcmRlckNvbHVtbiwgeyBhc2NlbmRpbmc6IGZpbHRlcnMuc29ydE9yZGVyID09PSAnYXNjJyB9KTtcclxuXHJcbiAgICAvLyBQYWdpbmFjacOzblxyXG4gICAgY29uc3QgcGFnZSA9IGZpbHRlcnMucGFnZSB8fCAxO1xyXG4gICAgY29uc3QgbGltaXQgPSBmaWx0ZXJzLmxpbWl0IHx8IDEwO1xyXG4gICAgY29uc3QgZnJvbSA9IChwYWdlIC0gMSkgKiBsaW1pdDtcclxuICAgIGNvbnN0IHRvID0gZnJvbSArIGxpbWl0IC0gMTtcclxuICAgIHF1ZXJ5ID0gcXVlcnkucmFuZ2UoZnJvbSwgdG8pO1xyXG5cclxuICAgIC8vIEVqZWN1dGFyIHF1ZXJ5XHJcbiAgICBjb25zdCB7IGRhdGE6IHByb2R1Y3RzLCBlcnJvciwgY291bnQgfSA9IGF3YWl0IHF1ZXJ5O1xyXG5cclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBlbiBHRVQgL2FwaS9wcm9kdWN0cyAtIFN1cGFiYXNlOicsIGVycm9yKTtcclxuICAgICAgY29uc3QgZXJyb3JSZXNwb25zZTogQXBpUmVzcG9uc2U8bnVsbD4gPSB7XHJcbiAgICAgICAgZGF0YTogbnVsbCxcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSB8fCAnRXJyb3Igb2J0ZW5pZW5kbyBwcm9kdWN0b3MgZGUgbGEgYmFzZSBkZSBkYXRvcycsXHJcbiAgICAgIH07XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihlcnJvclJlc3BvbnNlLCB7IHN0YXR1czogNTAwIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENhbGN1bGFyIGluZm9ybWFjacOzbiBkZSBwYWdpbmFjacOzblxyXG4gICAgY29uc3QgdG90YWxQYWdlcyA9IE1hdGguY2VpbCgoY291bnQgfHwgMCkgLyBsaW1pdCk7XHJcblxyXG4gICAgY29uc3QgcmVzcG9uc2U6IFBhZ2luYXRlZFJlc3BvbnNlPFByb2R1Y3RXaXRoQ2F0ZWdvcnk+ID0ge1xyXG4gICAgICBkYXRhOiBwcm9kdWN0cyB8fCBbXSxcclxuICAgICAgcGFnaW5hdGlvbjoge1xyXG4gICAgICAgIHBhZ2UsXHJcbiAgICAgICAgbGltaXQsXHJcbiAgICAgICAgdG90YWw6IGNvdW50IHx8IDAsXHJcbiAgICAgICAgdG90YWxQYWdlcyxcclxuICAgICAgfSxcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgbWVzc2FnZTogYCR7cHJvZHVjdHM/Lmxlbmd0aCB8fCAwfSBwcm9kdWN0b3MgZW5jb250cmFkb3NgLFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBBZ3JlZ2FyIGhlYWRlcnMgZGUgY2FjaGUgcGFyYSBtZWpvcmFyIHBlcmZvcm1hbmNlXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVzcG9uc2UsIHtcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICdDYWNoZS1Db250cm9sJzogJ3B1YmxpYywgcy1tYXhhZ2U9NjAsIHN0YWxlLXdoaWxlLXJldmFsaWRhdGU9MzAwJyxcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBlbiBHRVQgL2FwaS9wcm9kdWN0czonLCBlcnJvcik7XHJcbiAgICBcclxuICAgIGNvbnN0IGVycm9yUmVzcG9uc2U6IEFwaVJlc3BvbnNlPG51bGw+ID0ge1xyXG4gICAgICBkYXRhOiBudWxsLFxyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfHwgJ0Vycm9yIGludGVybm8gZGVsIHNlcnZpZG9yJyxcclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKGVycm9yUmVzcG9uc2UsIHsgc3RhdHVzOiA1MDAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQT1NUIC9hcGkvcHJvZHVjdHMgLSBDcmVhciBwcm9kdWN0byAoQWRtaW4pXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIFRPRE86IFZlcmlmaWNhciBwZXJtaXNvcyBkZSBhZG1pbmlzdHJhZG9yXHJcbiAgICAvLyBjb25zdCB7IHVzZXJJZCB9ID0gYXV0aCgpO1xyXG4gICAgLy8gaWYgKCF1c2VySWQgfHwgIWlzQWRtaW4odXNlcklkKSkge1xyXG4gICAgLy8gICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ05vIGF1dG9yaXphZG8nIH0sIHsgc3RhdHVzOiA0MDEgfSk7XHJcbiAgICAvLyB9XHJcblxyXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xyXG4gICAgXHJcbiAgICAvLyBWYWxpZGFyIGRhdG9zIGRlbCBwcm9kdWN0b1xyXG4gICAgY29uc3QgcHJvZHVjdERhdGEgPSB2YWxpZGF0ZURhdGEoUHJvZHVjdFNjaGVtYSwgYm9keSk7XHJcbiAgICBcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VDbGllbnQodHJ1ZSk7IC8vIFVzYXIgY2xpZW50ZSBhZG1pblxyXG5cclxuICAgIC8vIFZlcmlmaWNhciBxdWUgZWwgY2xpZW50ZSBhZG1pbmlzdHJhdGl2byBlc3TDqSBkaXNwb25pYmxlXHJcbiAgICBpZiAoIXN1cGFiYXNlKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0NsaWVudGUgYWRtaW5pc3RyYXRpdm8gZGUgU3VwYWJhc2Ugbm8gZGlzcG9uaWJsZSBlbiBQT1NUIC9hcGkvcHJvZHVjdHMnKTtcclxuICAgICAgY29uc3QgZXJyb3JSZXNwb25zZTogQXBpUmVzcG9uc2U8bnVsbD4gPSB7XHJcbiAgICAgICAgZGF0YTogbnVsbCxcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ1NlcnZpY2lvIGFkbWluaXN0cmF0aXZvIG5vIGRpc3BvbmlibGUnLFxyXG4gICAgICB9O1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oZXJyb3JSZXNwb25zZSwgeyBzdGF0dXM6IDUwMyB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDcmVhciBzbHVnIHNpIG5vIHNlIHByb3BvcmNpb25hXHJcbiAgICBpZiAoIXByb2R1Y3REYXRhLnNsdWcpIHtcclxuICAgICAgcHJvZHVjdERhdGEuc2x1ZyA9IHByb2R1Y3REYXRhLm5hbWVcclxuICAgICAgICAudG9Mb3dlckNhc2UoKVxyXG4gICAgICAgIC5yZXBsYWNlKC9bXmEtejAtOV0rL2csICctJylcclxuICAgICAgICAucmVwbGFjZSgvKF4tfC0kKS9nLCAnJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSW5zZXJ0YXIgcHJvZHVjdG9cclxuICAgIGNvbnN0IHsgZGF0YTogcHJvZHVjdCwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdwcm9kdWN0cycpXHJcbiAgICAgIC5pbnNlcnQocHJvZHVjdERhdGEpXHJcbiAgICAgIC5zZWxlY3QoYFxyXG4gICAgICAgICosXHJcbiAgICAgICAgY2F0ZWdvcnk6Y2F0ZWdvcmllcyhpZCwgbmFtZSwgc2x1ZylcclxuICAgICAgYClcclxuICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICBoYW5kbGVTdXBhYmFzZUVycm9yKGVycm9yLCAnUE9TVCAvYXBpL3Byb2R1Y3RzJyk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcmVzcG9uc2U6IEFwaVJlc3BvbnNlPFByb2R1Y3RXaXRoQ2F0ZWdvcnk+ID0ge1xyXG4gICAgICBkYXRhOiBwcm9kdWN0LFxyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBtZXNzYWdlOiAnUHJvZHVjdG8gY3JlYWRvIGV4aXRvc2FtZW50ZScsXHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihyZXNwb25zZSwgeyBzdGF0dXM6IDIwMSB9KTtcclxuXHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZW4gUE9TVCAvYXBpL3Byb2R1Y3RzOicsIGVycm9yKTtcclxuICAgIFxyXG4gICAgY29uc3QgZXJyb3JSZXNwb25zZTogQXBpUmVzcG9uc2U8bnVsbD4gPSB7XHJcbiAgICAgIGRhdGE6IG51bGwsXHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSB8fCAnRXJyb3IgaW50ZXJubyBkZWwgc2Vydmlkb3InLFxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oZXJyb3JSZXNwb25zZSwgeyBzdGF0dXM6IDUwMCB9KTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkdFVCIsIlBPU1QiLCJyZXF1ZXN0Iiwic2VhcmNoUGFyYW1zIiwiVVJMIiwidXJsIiwicXVlcnlQYXJhbXMiLCJjYXRlZ29yeSIsImdldCIsInVuZGVmaW5lZCIsImNhdGVnb3JpZXMiLCJzcGxpdCIsImZpbHRlciIsIkJvb2xlYW4iLCJicmFuZCIsImJyYW5kcyIsInBhaW50VHlwZSIsInBhaW50VHlwZXMiLCJwcmljZU1pbiIsIk51bWJlciIsInByaWNlTWF4Iiwic2VhcmNoIiwicGFnZSIsImxpbWl0Iiwic29ydEJ5Iiwic29ydE9yZGVyIiwidmFsaWRhdGlvblJlc3VsdCIsInNhZmVWYWxpZGF0ZURhdGEiLCJQcm9kdWN0RmlsdGVyc1NjaGVtYSIsInN1Y2Nlc3MiLCJjb25zb2xlIiwiZXJyb3IiLCJlcnJvclJlc3BvbnNlIiwiZGF0YSIsIk5leHRSZXNwb25zZSIsImpzb24iLCJzdGF0dXMiLCJmaWx0ZXJzIiwic3VwYWJhc2UiLCJnZXRTdXBhYmFzZUNsaWVudCIsInF1ZXJ5IiwiZnJvbSIsInNlbGVjdCIsImNvdW50IiwiY2F0ZWdvcnlEYXRhIiwiZXEiLCJzaW5nbGUiLCJpZCIsImxlbmd0aCIsImNhdGVnb3JpZXNEYXRhIiwiaW4iLCJjYXRlZ29yeUlkcyIsIm1hcCIsImNhdCIsImd0ZSIsImx0ZSIsIm9yIiwib3JkZXJDb2x1bW4iLCJvcmRlciIsImFzY2VuZGluZyIsInRvIiwicmFuZ2UiLCJwcm9kdWN0cyIsIm1lc3NhZ2UiLCJ0b3RhbFBhZ2VzIiwiTWF0aCIsImNlaWwiLCJyZXNwb25zZSIsInBhZ2luYXRpb24iLCJ0b3RhbCIsImhlYWRlcnMiLCJib2R5IiwicHJvZHVjdERhdGEiLCJ2YWxpZGF0ZURhdGEiLCJQcm9kdWN0U2NoZW1hIiwic2x1ZyIsIm5hbWUiLCJ0b0xvd2VyQ2FzZSIsInJlcGxhY2UiLCJwcm9kdWN0IiwiaW5zZXJ0IiwiaGFuZGxlU3VwYWJhc2VFcnJvciJdLCJtYXBwaW5ncyI6IkFBQUEsc0NBQXNDO0FBQ3RDLHdDQUF3QztBQUN4QyxzQ0FBc0M7Ozs7Ozs7Ozs7OztJQVVoQkEsR0FBRztlQUFIQTs7SUF1TEFDLElBQUk7ZUFBSkE7Ozt3QkEvTG9COzBCQUNhOzZCQUM2QjtBQU03RSxlQUFlRCxJQUFJRSxPQUFvQjtJQUM1QyxJQUFJO1FBQ0YsTUFBTSxFQUFFQyxZQUFZLEVBQUUsR0FBRyxJQUFJQyxJQUFJRixRQUFRRyxHQUFHO1FBRTVDLDhCQUE4QjtRQUM5QixNQUFN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