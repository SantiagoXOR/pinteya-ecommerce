cdd2d3f486c4000d0141b48be319f3f4
// ===================================
// PINTEYA E-COMMERCE - ORDERS API TESTS
// ===================================
"use strict";
// ===================================
// SETUP MOCKS
// ===================================
// Mock Next.js
jest.mock('next/server', ()=>({
        NextRequest: jest.fn(),
        NextResponse: {
            json: jest.fn((data, options)=>({
                    json: ()=>Promise.resolve(data),
                    status: options?.status || 200,
                    headers: new Map()
                }))
        }
    }));
// Mock Supabase
jest.mock('@/lib/supabase', ()=>({
        supabaseAdmin: (0, _ordersmocks.createMockSupabaseAdmin)()
    }));
jest.mock('@clerk/nextjs/server', ()=>({
        auth: mockAuth,
        currentUser: mockCurrentUser
    }));
jest.mock('@/lib/rate-limiter', ()=>({
        checkRateLimit: mockCheckRateLimit,
        addRateLimitHeaders: mockAddRateLimitHeaders,
        RATE_LIMIT_CONFIGS: {
            admin: {
                requests: 100,
                window: 3600000
            }
        }
    }));
jest.mock('@/lib/logger', ()=>({
        logger: mockLogger,
        LogLevel: {
            INFO: 'info',
            ERROR: 'error',
            WARN: 'warn'
        },
        LogCategory: {
            API: 'api',
            DATABASE: 'database',
            AUTH: 'auth'
        }
    }));
jest.mock('@/lib/metrics', ()=>({
        metricsCollector: mockMetricsCollector
    }));
// Mock Zod
jest.mock('zod', ()=>({
        z: {
            object: jest.fn().mockReturnValue({
                safeParse: jest.fn().mockReturnValue({
                    success: true,
                    data: {
                        page: 1,
                        limit: 20,
                        sort_by: 'created_at',
                        sort_order: 'desc'
                    }
                })
            }),
            coerce: {
                number: jest.fn().mockReturnValue({
                    min: jest.fn().mockReturnThis(),
                    max: jest.fn().mockReturnThis(),
                    default: jest.fn().mockReturnThis()
                })
            },
            string: jest.fn().mockReturnValue({
                optional: jest.fn().mockReturnThis(),
                min: jest.fn().mockReturnThis(),
                max: jest.fn().mockReturnThis(),
                uuid: jest.fn().mockReturnThis()
            }),
            enum: jest.fn().mockReturnValue({
                default: jest.fn().mockReturnThis()
            }),
            array: jest.fn().mockReturnValue({
                min: jest.fn().mockReturnThis()
            }),
            number: jest.fn().mockReturnValue({
                min: jest.fn().mockReturnThis(),
                max: jest.fn().mockReturnThis()
            })
        }
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _route = require("../../../app/api/admin/orders/route");
const _ordersmocks = require("../../setup/orders-mocks.js");
// Mock Clerk
const { mockAuth, mockCurrentUser } = (0, _ordersmocks.createMockClerkAuth)(true);
// Mock Rate Limiter
const { mockCheckRateLimit, mockAddRateLimitHeaders } = (0, _ordersmocks.createMockRateLimiter)();
// Mock Logger
const mockLogger = (0, _ordersmocks.createMockLogger)();
// Mock Metrics
const mockMetricsCollector = (0, _ordersmocks.createMockMetricsCollector)();
// ===================================
// TESTS GET /api/admin/orders
// ===================================
describe('GET /api/admin/orders', ()=>{
    beforeEach(()=>{
        (0, _ordersmocks.resetAllMocks)();
    });
    test('should return orders list successfully', async ()=>{
        // Arrange
        const mockRequest = {
            url: 'http://localhost:3000/api/admin/orders?page=1&limit=20'
        };
        // Act
        const response = await (0, _route.GET)(mockRequest);
        const data = await response.json();
        // Assert
        expect(response.status).toBe(200);
        expect(data.success).toBe(true);
        expect(data.data.orders).toEqual(_ordersmocks.mockOrders);
        expect(data.data.pagination).toBeDefined();
        expect(data.data.pagination.page).toBe(1);
        expect(data.data.pagination.limit).toBe(20);
        expect(data.data.pagination.total).toBe(_ordersmocks.mockOrders.length);
        // Verify mocks were called
        expect(mockAuth).toHaveBeenCalled();
        expect(mockCurrentUser).toHaveBeenCalled();
        expect(mockCheckRateLimit).toHaveBeenCalled();
        expect(mockMetricsCollector.recordApiCall).toHaveBeenCalledWith('admin-orders-list', expect.any(Number), 200);
    });
    test('should handle authentication failure', async ()=>{
        // Arrange
        mockAuth.mockResolvedValueOnce({
            userId: null
        });
        const mockRequest = {
            url: 'http://localhost:3000/api/admin/orders'
        };
        // Act
        const response = await (0, _route.GET)(mockRequest);
        const data = await response.json();
        // Assert
        expect(response.status).toBe(401);
        expect(data.error).toBe('Usuario no autenticado');
    });
    test('should handle non-admin user', async ()=>{
        // Arrange
        mockCurrentUser.mockResolvedValueOnce({
            emailAddresses: [
                {
                    emailAddress: 'user@example.com'
                }
            ]
        });
        const mockRequest = {
            url: 'http://localhost:3000/api/admin/orders'
        };
        // Act
        const response = await (0, _route.GET)(mockRequest);
        const data = await response.json();
        // Assert
        expect(response.status).toBe(403);
        expect(data.error).toBe('Acceso denegado - Se requieren permisos de administrador');
    });
    test('should handle rate limiting', async ()=>{
        // Arrange
        mockCheckRateLimit.mockResolvedValueOnce({
            success: false,
            remaining: 0,
            reset: Date.now() + 3600000
        });
        const mockRequest = {
            url: 'http://localhost:3000/api/admin/orders'
        };
        // Act
        const response = await (0, _route.GET)(mockRequest);
        const data = await response.json();
        // Assert
        expect(response.status).toBe(429);
        expect(data.error).toBe('Demasiadas solicitudes');
        expect(mockAddRateLimitHeaders).toHaveBeenCalled();
    });
    test('should handle filters correctly', async ()=>{
        // Arrange
        const mockRequest = {
            url: 'http://localhost:3000/api/admin/orders?status=pending&search=test&page=2'
        };
        // Act
        const response = await (0, _route.GET)(mockRequest);
        const data = await response.json();
        // Assert
        expect(response.status).toBe(200);
        expect(data.success).toBe(true);
        expect(data.data.filters).toBeDefined();
    });
    test('should handle database errors', async ()=>{
        // Arrange
        const mockSupabase = require('@/lib/supabase').supabaseAdmin;
        mockSupabase.from().select().range.mockImplementationOnce(()=>Promise.resolve({
                data: null,
                error: {
                    message: 'Database error'
                }
            }));
        const mockRequest = {
            url: 'http://localhost:3000/api/admin/orders'
        };
        // Act
        const response = await (0, _route.GET)(mockRequest);
        const data = await response.json();
        // Assert
        expect(response.status).toBe(500);
        expect(data.error).toBe('Error al obtener órdenes');
        expect(mockLogger.log).toHaveBeenCalledWith('error', 'database', 'Error al obtener órdenes admin', expect.any(Object));
    });
});
// ===================================
// TESTS POST /api/admin/orders
// ===================================
describe('POST /api/admin/orders', ()=>{
    beforeEach(()=>{
        (0, _ordersmocks.resetAllMocks)();
    });
    test('should create order successfully', async ()=>{
        // Arrange
        const orderData = {
            user_id: 'test-user-id',
            items: [
                {
                    product_id: 1,
                    quantity: 2,
                    unit_price: 15000
                }
            ],
            shipping_address: {
                street_name: 'Av. Corrientes',
                street_number: '1234',
                zip_code: '1000',
                city_name: 'Buenos Aires',
                state_name: 'CABA'
            },
            notes: 'Test order'
        };
        const mockRequest = {
            json: ()=>Promise.resolve(orderData)
        };
        // Act
        const response = await (0, _route.POST)(mockRequest);
        const data = await response.json();
        // Assert
        expect(response.status).toBe(201);
        expect(data.success).toBe(true);
        expect(data.data).toBeDefined();
        expect(data.data.order_number).toMatch(/^ORD-\d+-[A-Z0-9]+$/);
        // Verify database calls
        const mockSupabase = require('@/lib/supabase').supabaseAdmin;
        expect(mockSupabase.from).toHaveBeenCalledWith('orders');
        expect(mockSupabase.from).toHaveBeenCalledWith('order_items');
        // Verify metrics
        expect(mockMetricsCollector.recordApiCall).toHaveBeenCalledWith('admin-orders-create', expect.any(Number), 201);
    });
    test('should handle validation errors', async ()=>{
        // Arrange
        const invalidOrderData = {
            user_id: 'invalid-uuid',
            items: [] // Empty items array should fail validation
        };
        // Mock Zod validation failure
        const mockZod = require('zod');
        mockZod.z.object().safeParse.mockReturnValueOnce({
            success: false,
            error: {
                errors: [
                    {
                        message: 'Invalid UUID',
                        path: [
                            'user_id'
                        ]
                    },
                    {
                        message: 'At least one item required',
                        path: [
                            'items'
                        ]
                    }
                ]
            }
        });
        const mockRequest = {
            json: ()=>Promise.resolve(invalidOrderData)
        };
        // Act
        const response = await (0, _route.POST)(mockRequest);
        const data = await response.json();
        // Assert
        expect(response.status).toBe(400);
        expect(data.error).toBe('Datos de orden inválidos');
        expect(data.details).toBeDefined();
    });
    test('should handle order creation database error', async ()=>{
        // Arrange
        const orderData = {
            user_id: 'test-user-id',
            items: [
                {
                    product_id: 1,
                    quantity: 1,
                    unit_price: 15000
                }
            ]
        };
        const mockSupabase = require('@/lib/supabase').supabaseAdmin;
        mockSupabase.from().insert().select().single.mockImplementationOnce(()=>Promise.resolve({
                data: null,
                error: {
                    message: 'Insert failed'
                }
            }));
        const mockRequest = {
            json: ()=>Promise.resolve(orderData)
        };
        // Act
        const response = await (0, _route.POST)(mockRequest);
        const data = await response.json();
        // Assert
        expect(response.status).toBe(500);
        expect(data.error).toBe('Error al crear orden');
    });
    test('should handle order items creation error with rollback', async ()=>{
        // Arrange
        const orderData = {
            user_id: 'test-user-id',
            items: [
                {
                    product_id: 1,
                    quantity: 1,
                    unit_price: 15000
                }
            ]
        };
        const mockSupabase = require('@/lib/supabase').supabaseAdmin;
        // Order creation succeeds
        mockSupabase.from().insert().select().single.mockImplementationOnce(()=>Promise.resolve({
                data: {
                    id: 'new-order-id'
                },
                error: null
            }));
        // Order items creation fails
        mockSupabase.from().insert.mockImplementationOnce(()=>Promise.resolve({
                data: null,
                error: {
                    message: 'Items insert failed'
                }
            }));
        const mockRequest = {
            json: ()=>Promise.resolve(orderData)
        };
        // Act
        const response = await (0, _route.POST)(mockRequest);
        const data = await response.json();
        // Assert
        expect(response.status).toBe(500);
        expect(data.error).toBe('Error al crear items de orden');
        // Verify rollback was attempted
        expect(mockSupabase.from).toHaveBeenCalledWith('orders');
    });
    test('should calculate total amount correctly', async ()=>{
        // Arrange
        const orderData = {
            user_id: 'test-user-id',
            items: [
                {
                    product_id: 1,
                    quantity: 2,
                    unit_price: 15000
                },
                {
                    product_id: 2,
                    quantity: 1,
                    unit_price: 2500
                } // 2500
            ]
        };
        const mockRequest = {
            json: ()=>Promise.resolve(orderData)
        };
        // Act
        const response = await (0, _route.POST)(mockRequest);
        const data = await response.json();
        // Assert
        expect(response.status).toBe(201);
        expect(data.success).toBe(true);
        // Verify total calculation in the insert call
        const mockSupabase = require('@/lib/supabase').supabaseAdmin;
        const insertCall = mockSupabase.from().insert.mock.calls[0][0];
        expect(insertCall.total_amount).toBe(32500);
    });
});
// ===================================
// INTEGRATION TESTS
// ===================================
describe('Orders API Integration', ()=>{
    beforeEach(()=>{
        (0, _ordersmocks.resetAllMocks)();
    });
    test('should handle complete order lifecycle', async ()=>{
        // Test creating an order and then retrieving it
        // 1. Create order
        const orderData = {
            user_id: 'test-user-id',
            items: [
                {
                    product_id: 1,
                    quantity: 1,
                    unit_price: 15000
                }
            ]
        };
        const createRequest = {
            json: ()=>Promise.resolve(orderData)
        };
        const createResponse = await (0, _route.POST)(createRequest);
        const createData = await createResponse.json();
        expect(createResponse.status).toBe(201);
        expect(createData.success).toBe(true);
        // 2. Retrieve orders list
        const getRequest = {
            url: 'http://localhost:3000/api/admin/orders'
        };
        const getResponse = await (0, _route.GET)(getRequest);
        const getData = await getResponse.json();
        expect(getResponse.status).toBe(200);
        expect(getData.success).toBe(true);
        expect(getData.data.orders).toBeDefined();
    });
    test('should maintain data consistency across operations', async ()=>{
        // Verify that all related data is properly linked
        const mockRequest = {
            url: 'http://localhost:3000/api/admin/orders'
        };
        const response = await (0, _route.GET)(mockRequest);
        const data = await response.json();
        expect(response.status).toBe(200);
        // Verify order structure
        const order = data.data.orders[0];
        expect(order.id).toBeDefined();
        expect(order.order_number).toBeDefined();
        expect(order.user_profiles).toBeDefined();
        expect(order.order_items).toBeDefined();
        expect(Array.isArray(order.order_items)).toBe(true);
        // Verify order items have product data
        if (order.order_items.length > 0) {
            expect(order.order_items[0].products).toBeDefined();
        }
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcX190ZXN0c19fXFxhcGlcXGFkbWluXFxvcmRlcnMudGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUElOVEVZQSBFLUNPTU1FUkNFIC0gT1JERVJTIEFQSSBURVNUU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuaW1wb3J0IHsgR0VULCBQT1NUIH0gZnJvbSAnQC9hcHAvYXBpL2FkbWluL29yZGVycy9yb3V0ZSc7XG5pbXBvcnQgeyBcbiAgY3JlYXRlTW9ja1N1cGFiYXNlQWRtaW4sXG4gIGNyZWF0ZU1vY2tDbGVya0F1dGgsXG4gIGNyZWF0ZU1vY2tSYXRlTGltaXRlcixcbiAgY3JlYXRlTW9ja0xvZ2dlcixcbiAgY3JlYXRlTW9ja01ldHJpY3NDb2xsZWN0b3IsXG4gIG1vY2tPcmRlcnMsXG4gIG1vY2tPcmRlckl0ZW1zLFxuICByZXNldEFsbE1vY2tzXG59IGZyb20gJy4uLy4uL3NldHVwL29yZGVycy1tb2Nrcyc7XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBTRVRVUCBNT0NLU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLy8gTW9jayBOZXh0LmpzXG5qZXN0Lm1vY2soJ25leHQvc2VydmVyJywgKCkgPT4gKHtcbiAgTmV4dFJlcXVlc3Q6IGplc3QuZm4oKSxcbiAgTmV4dFJlc3BvbnNlOiB7XG4gICAganNvbjogamVzdC5mbigoZGF0YSwgb3B0aW9ucykgPT4gKHtcbiAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZShkYXRhKSxcbiAgICAgIHN0YXR1czogb3B0aW9ucz8uc3RhdHVzIHx8IDIwMCxcbiAgICAgIGhlYWRlcnM6IG5ldyBNYXAoKVxuICAgIH0pKVxuICB9XG59KSk7XG5cbi8vIE1vY2sgU3VwYWJhc2Vcbmplc3QubW9jaygnQC9saWIvc3VwYWJhc2UnLCAoKSA9PiAoe1xuICBzdXBhYmFzZUFkbWluOiBjcmVhdGVNb2NrU3VwYWJhc2VBZG1pbigpXG59KSk7XG5cbi8vIE1vY2sgQ2xlcmtcbmNvbnN0IHsgbW9ja0F1dGgsIG1vY2tDdXJyZW50VXNlciB9ID0gY3JlYXRlTW9ja0NsZXJrQXV0aCh0cnVlKTtcbmplc3QubW9jaygnQGNsZXJrL25leHRqcy9zZXJ2ZXInLCAoKSA9PiAoe1xuICBhdXRoOiBtb2NrQXV0aCxcbiAgY3VycmVudFVzZXI6IG1vY2tDdXJyZW50VXNlclxufSkpO1xuXG4vLyBNb2NrIFJhdGUgTGltaXRlclxuY29uc3QgeyBtb2NrQ2hlY2tSYXRlTGltaXQsIG1vY2tBZGRSYXRlTGltaXRIZWFkZXJzIH0gPSBjcmVhdGVNb2NrUmF0ZUxpbWl0ZXIoKTtcbmplc3QubW9jaygnQC9saWIvcmF0ZS1saW1pdGVyJywgKCkgPT4gKHtcbiAgY2hlY2tSYXRlTGltaXQ6IG1vY2tDaGVja1JhdGVMaW1pdCxcbiAgYWRkUmF0ZUxpbWl0SGVhZGVyczogbW9ja0FkZFJhdGVMaW1pdEhlYWRlcnMsXG4gIFJBVEVfTElNSVRfQ09ORklHUzoge1xuICAgIGFkbWluOiB7IHJlcXVlc3RzOiAxMDAsIHdpbmRvdzogMzYwMDAwMCB9XG4gIH1cbn0pKTtcblxuLy8gTW9jayBMb2dnZXJcbmNvbnN0IG1vY2tMb2dnZXIgPSBjcmVhdGVNb2NrTG9nZ2VyKCk7XG5qZXN0Lm1vY2soJ0AvbGliL2xvZ2dlcicsICgpID0+ICh7XG4gIGxvZ2dlcjogbW9ja0xvZ2dlcixcbiAgTG9nTGV2ZWw6IHsgSU5GTzogJ2luZm8nLCBFUlJPUjogJ2Vycm9yJywgV0FSTjogJ3dhcm4nIH0sXG4gIExvZ0NhdGVnb3J5OiB7IEFQSTogJ2FwaScsIERBVEFCQVNFOiAnZGF0YWJhc2UnLCBBVVRIOiAnYXV0aCcgfVxufSkpO1xuXG4vLyBNb2NrIE1ldHJpY3NcbmNvbnN0IG1vY2tNZXRyaWNzQ29sbGVjdG9yID0gY3JlYXRlTW9ja01ldHJpY3NDb2xsZWN0b3IoKTtcbmplc3QubW9jaygnQC9saWIvbWV0cmljcycsICgpID0+ICh7XG4gIG1ldHJpY3NDb2xsZWN0b3I6IG1vY2tNZXRyaWNzQ29sbGVjdG9yXG59KSk7XG5cbi8vIE1vY2sgWm9kXG5qZXN0Lm1vY2soJ3pvZCcsICgpID0+ICh7XG4gIHo6IHtcbiAgICBvYmplY3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgc2FmZVBhcnNlOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHBhZ2U6IDEsXG4gICAgICAgICAgbGltaXQ6IDIwLFxuICAgICAgICAgIHNvcnRfYnk6ICdjcmVhdGVkX2F0JyxcbiAgICAgICAgICBzb3J0X29yZGVyOiAnZGVzYydcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9KSxcbiAgICBjb2VyY2U6IHtcbiAgICAgIG51bWJlcjogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIG1pbjogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICAgIG1heDogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICAgIGRlZmF1bHQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpXG4gICAgICB9KVxuICAgIH0sXG4gICAgc3RyaW5nOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgIG9wdGlvbmFsOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICAgIG1pbjogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICBtYXg6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgICAgdXVpZDogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKClcbiAgICB9KSxcbiAgICBlbnVtOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgIGRlZmF1bHQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpXG4gICAgfSksXG4gICAgYXJyYXk6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgbWluOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKVxuICAgIH0pLFxuICAgIG51bWJlcjogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICBtaW46IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgICAgbWF4OiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKVxuICAgIH0pXG4gIH1cbn0pKTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFRFU1RTIEdFVCAvYXBpL2FkbWluL29yZGVyc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZGVzY3JpYmUoJ0dFVCAvYXBpL2FkbWluL29yZGVycycsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgcmVzZXRBbGxNb2NrcygpO1xuICB9KTtcblxuICB0ZXN0KCdzaG91bGQgcmV0dXJuIG9yZGVycyBsaXN0IHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAvLyBBcnJhbmdlXG4gICAgY29uc3QgbW9ja1JlcXVlc3QgPSB7XG4gICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2FkbWluL29yZGVycz9wYWdlPTEmbGltaXQ9MjAnXG4gICAgfTtcblxuICAgIC8vIEFjdFxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgR0VUKG1vY2tSZXF1ZXN0KTtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgLy8gQXNzZXJ0XG4gICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgIGV4cGVjdChkYXRhLnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgZXhwZWN0KGRhdGEuZGF0YS5vcmRlcnMpLnRvRXF1YWwobW9ja09yZGVycyk7XG4gICAgZXhwZWN0KGRhdGEuZGF0YS5wYWdpbmF0aW9uKS50b0JlRGVmaW5lZCgpO1xuICAgIGV4cGVjdChkYXRhLmRhdGEucGFnaW5hdGlvbi5wYWdlKS50b0JlKDEpO1xuICAgIGV4cGVjdChkYXRhLmRhdGEucGFnaW5hdGlvbi5saW1pdCkudG9CZSgyMCk7XG4gICAgZXhwZWN0KGRhdGEuZGF0YS5wYWdpbmF0aW9uLnRvdGFsKS50b0JlKG1vY2tPcmRlcnMubGVuZ3RoKTtcblxuICAgIC8vIFZlcmlmeSBtb2NrcyB3ZXJlIGNhbGxlZFxuICAgIGV4cGVjdChtb2NrQXV0aCkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIGV4cGVjdChtb2NrQ3VycmVudFVzZXIpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICBleHBlY3QobW9ja0NoZWNrUmF0ZUxpbWl0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgZXhwZWN0KG1vY2tNZXRyaWNzQ29sbGVjdG9yLnJlY29yZEFwaUNhbGwpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgJ2FkbWluLW9yZGVycy1saXN0JyxcbiAgICAgIGV4cGVjdC5hbnkoTnVtYmVyKSxcbiAgICAgIDIwMFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Nob3VsZCBoYW5kbGUgYXV0aGVudGljYXRpb24gZmFpbHVyZScsIGFzeW5jICgpID0+IHtcbiAgICAvLyBBcnJhbmdlXG4gICAgbW9ja0F1dGgubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHsgdXNlcklkOiBudWxsIH0pO1xuICAgIGNvbnN0IG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hZG1pbi9vcmRlcnMnXG4gICAgfTtcblxuICAgIC8vIEFjdFxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgR0VUKG1vY2tSZXF1ZXN0KTtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgLy8gQXNzZXJ0XG4gICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDEpO1xuICAgIGV4cGVjdChkYXRhLmVycm9yKS50b0JlKCdVc3VhcmlvIG5vIGF1dGVudGljYWRvJyk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Nob3VsZCBoYW5kbGUgbm9uLWFkbWluIHVzZXInLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gQXJyYW5nZVxuICAgIG1vY2tDdXJyZW50VXNlci5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgZW1haWxBZGRyZXNzZXM6IFt7IGVtYWlsQWRkcmVzczogJ3VzZXJAZXhhbXBsZS5jb20nIH1dXG4gICAgfSk7XG4gICAgY29uc3QgbW9ja1JlcXVlc3QgPSB7XG4gICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2FkbWluL29yZGVycydcbiAgICB9O1xuXG4gICAgLy8gQWN0XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBHRVQobW9ja1JlcXVlc3QpO1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAvLyBBc3NlcnRcbiAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDQwMyk7XG4gICAgZXhwZWN0KGRhdGEuZXJyb3IpLnRvQmUoJ0FjY2VzbyBkZW5lZ2FkbyAtIFNlIHJlcXVpZXJlbiBwZXJtaXNvcyBkZSBhZG1pbmlzdHJhZG9yJyk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Nob3VsZCBoYW5kbGUgcmF0ZSBsaW1pdGluZycsIGFzeW5jICgpID0+IHtcbiAgICAvLyBBcnJhbmdlXG4gICAgbW9ja0NoZWNrUmF0ZUxpbWl0Lm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIHJlbWFpbmluZzogMCxcbiAgICAgIHJlc2V0OiBEYXRlLm5vdygpICsgMzYwMDAwMFxuICAgIH0pO1xuICAgIGNvbnN0IG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hZG1pbi9vcmRlcnMnXG4gICAgfTtcblxuICAgIC8vIEFjdFxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgR0VUKG1vY2tSZXF1ZXN0KTtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgLy8gQXNzZXJ0XG4gICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MjkpO1xuICAgIGV4cGVjdChkYXRhLmVycm9yKS50b0JlKCdEZW1hc2lhZGFzIHNvbGljaXR1ZGVzJyk7XG4gICAgZXhwZWN0KG1vY2tBZGRSYXRlTGltaXRIZWFkZXJzKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Nob3VsZCBoYW5kbGUgZmlsdGVycyBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gQXJyYW5nZVxuICAgIGNvbnN0IG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hZG1pbi9vcmRlcnM/c3RhdHVzPXBlbmRpbmcmc2VhcmNoPXRlc3QmcGFnZT0yJ1xuICAgIH07XG5cbiAgICAvLyBBY3RcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IEdFVChtb2NrUmVxdWVzdCk7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgIC8vIEFzc2VydFxuICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICBleHBlY3QoZGF0YS5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdChkYXRhLmRhdGEuZmlsdGVycykudG9CZURlZmluZWQoKTtcbiAgfSk7XG5cbiAgdGVzdCgnc2hvdWxkIGhhbmRsZSBkYXRhYmFzZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gQXJyYW5nZVxuICAgIGNvbnN0IG1vY2tTdXBhYmFzZSA9IHJlcXVpcmUoJ0AvbGliL3N1cGFiYXNlJykuc3VwYWJhc2VBZG1pbjtcbiAgICBtb2NrU3VwYWJhc2UuZnJvbSgpLnNlbGVjdCgpLnJhbmdlLm1vY2tJbXBsZW1lbnRhdGlvbk9uY2UoKCkgPT4gXG4gICAgICBQcm9taXNlLnJlc29sdmUoeyBkYXRhOiBudWxsLCBlcnJvcjogeyBtZXNzYWdlOiAnRGF0YWJhc2UgZXJyb3InIH0gfSlcbiAgICApO1xuICAgIFxuICAgIGNvbnN0IG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hZG1pbi9vcmRlcnMnXG4gICAgfTtcblxuICAgIC8vIEFjdFxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgR0VUKG1vY2tSZXF1ZXN0KTtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgLy8gQXNzZXJ0XG4gICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg1MDApO1xuICAgIGV4cGVjdChkYXRhLmVycm9yKS50b0JlKCdFcnJvciBhbCBvYnRlbmVyIMOzcmRlbmVzJyk7XG4gICAgZXhwZWN0KG1vY2tMb2dnZXIubG9nKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICdlcnJvcicsXG4gICAgICAnZGF0YWJhc2UnLFxuICAgICAgJ0Vycm9yIGFsIG9idGVuZXIgw7NyZGVuZXMgYWRtaW4nLFxuICAgICAgZXhwZWN0LmFueShPYmplY3QpXG4gICAgKTtcbiAgfSk7XG59KTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFRFU1RTIFBPU1QgL2FwaS9hZG1pbi9vcmRlcnNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmRlc2NyaWJlKCdQT1NUIC9hcGkvYWRtaW4vb3JkZXJzJywgKCkgPT4ge1xuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICByZXNldEFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Nob3VsZCBjcmVhdGUgb3JkZXIgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgIC8vIEFycmFuZ2VcbiAgICBjb25zdCBvcmRlckRhdGEgPSB7XG4gICAgICB1c2VyX2lkOiAndGVzdC11c2VyLWlkJyxcbiAgICAgIGl0ZW1zOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBwcm9kdWN0X2lkOiAxLFxuICAgICAgICAgIHF1YW50aXR5OiAyLFxuICAgICAgICAgIHVuaXRfcHJpY2U6IDE1MDAwXG4gICAgICAgIH1cbiAgICAgIF0sXG4gICAgICBzaGlwcGluZ19hZGRyZXNzOiB7XG4gICAgICAgIHN0cmVldF9uYW1lOiAnQXYuIENvcnJpZW50ZXMnLFxuICAgICAgICBzdHJlZXRfbnVtYmVyOiAnMTIzNCcsXG4gICAgICAgIHppcF9jb2RlOiAnMTAwMCcsXG4gICAgICAgIGNpdHlfbmFtZTogJ0J1ZW5vcyBBaXJlcycsXG4gICAgICAgIHN0YXRlX25hbWU6ICdDQUJBJ1xuICAgICAgfSxcbiAgICAgIG5vdGVzOiAnVGVzdCBvcmRlcidcbiAgICB9O1xuXG4gICAgY29uc3QgbW9ja1JlcXVlc3QgPSB7XG4gICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUob3JkZXJEYXRhKVxuICAgIH07XG5cbiAgICAvLyBBY3RcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IFBPU1QobW9ja1JlcXVlc3QpO1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAvLyBBc3NlcnRcbiAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMSk7XG4gICAgZXhwZWN0KGRhdGEuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICBleHBlY3QoZGF0YS5kYXRhKS50b0JlRGVmaW5lZCgpO1xuICAgIGV4cGVjdChkYXRhLmRhdGEub3JkZXJfbnVtYmVyKS50b01hdGNoKC9eT1JELVxcZCstW0EtWjAtOV0rJC8pO1xuXG4gICAgLy8gVmVyaWZ5IGRhdGFiYXNlIGNhbGxzXG4gICAgY29uc3QgbW9ja1N1cGFiYXNlID0gcmVxdWlyZSgnQC9saWIvc3VwYWJhc2UnKS5zdXBhYmFzZUFkbWluO1xuICAgIGV4cGVjdChtb2NrU3VwYWJhc2UuZnJvbSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ29yZGVycycpO1xuICAgIGV4cGVjdChtb2NrU3VwYWJhc2UuZnJvbSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ29yZGVyX2l0ZW1zJyk7XG5cbiAgICAvLyBWZXJpZnkgbWV0cmljc1xuICAgIGV4cGVjdChtb2NrTWV0cmljc0NvbGxlY3Rvci5yZWNvcmRBcGlDYWxsKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICdhZG1pbi1vcmRlcnMtY3JlYXRlJyxcbiAgICAgIGV4cGVjdC5hbnkoTnVtYmVyKSxcbiAgICAgIDIwMVxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Nob3VsZCBoYW5kbGUgdmFsaWRhdGlvbiBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gQXJyYW5nZVxuICAgIGNvbnN0IGludmFsaWRPcmRlckRhdGEgPSB7XG4gICAgICB1c2VyX2lkOiAnaW52YWxpZC11dWlkJyxcbiAgICAgIGl0ZW1zOiBbXSAvLyBFbXB0eSBpdGVtcyBhcnJheSBzaG91bGQgZmFpbCB2YWxpZGF0aW9uXG4gICAgfTtcblxuICAgIC8vIE1vY2sgWm9kIHZhbGlkYXRpb24gZmFpbHVyZVxuICAgIGNvbnN0IG1vY2tab2QgPSByZXF1aXJlKCd6b2QnKTtcbiAgICBtb2NrWm9kLnoub2JqZWN0KCkuc2FmZVBhcnNlLm1vY2tSZXR1cm5WYWx1ZU9uY2Uoe1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBlcnJvcnM6IFtcbiAgICAgICAgICB7IG1lc3NhZ2U6ICdJbnZhbGlkIFVVSUQnLCBwYXRoOiBbJ3VzZXJfaWQnXSB9LFxuICAgICAgICAgIHsgbWVzc2FnZTogJ0F0IGxlYXN0IG9uZSBpdGVtIHJlcXVpcmVkJywgcGF0aDogWydpdGVtcyddIH1cbiAgICAgICAgXVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgbW9ja1JlcXVlc3QgPSB7XG4gICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoaW52YWxpZE9yZGVyRGF0YSlcbiAgICB9O1xuXG4gICAgLy8gQWN0XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBQT1NUKG1vY2tSZXF1ZXN0KTtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgLy8gQXNzZXJ0XG4gICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDApO1xuICAgIGV4cGVjdChkYXRhLmVycm9yKS50b0JlKCdEYXRvcyBkZSBvcmRlbiBpbnbDoWxpZG9zJyk7XG4gICAgZXhwZWN0KGRhdGEuZGV0YWlscykudG9CZURlZmluZWQoKTtcbiAgfSk7XG5cbiAgdGVzdCgnc2hvdWxkIGhhbmRsZSBvcmRlciBjcmVhdGlvbiBkYXRhYmFzZSBlcnJvcicsIGFzeW5jICgpID0+IHtcbiAgICAvLyBBcnJhbmdlXG4gICAgY29uc3Qgb3JkZXJEYXRhID0ge1xuICAgICAgdXNlcl9pZDogJ3Rlc3QtdXNlci1pZCcsXG4gICAgICBpdGVtczogW3sgcHJvZHVjdF9pZDogMSwgcXVhbnRpdHk6IDEsIHVuaXRfcHJpY2U6IDE1MDAwIH1dXG4gICAgfTtcblxuICAgIGNvbnN0IG1vY2tTdXBhYmFzZSA9IHJlcXVpcmUoJ0AvbGliL3N1cGFiYXNlJykuc3VwYWJhc2VBZG1pbjtcbiAgICBtb2NrU3VwYWJhc2UuZnJvbSgpLmluc2VydCgpLnNlbGVjdCgpLnNpbmdsZS5tb2NrSW1wbGVtZW50YXRpb25PbmNlKCgpID0+IFxuICAgICAgUHJvbWlzZS5yZXNvbHZlKHsgZGF0YTogbnVsbCwgZXJyb3I6IHsgbWVzc2FnZTogJ0luc2VydCBmYWlsZWQnIH0gfSlcbiAgICApO1xuXG4gICAgY29uc3QgbW9ja1JlcXVlc3QgPSB7XG4gICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUob3JkZXJEYXRhKVxuICAgIH07XG5cbiAgICAvLyBBY3RcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IFBPU1QobW9ja1JlcXVlc3QpO1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAvLyBBc3NlcnRcbiAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDUwMCk7XG4gICAgZXhwZWN0KGRhdGEuZXJyb3IpLnRvQmUoJ0Vycm9yIGFsIGNyZWFyIG9yZGVuJyk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Nob3VsZCBoYW5kbGUgb3JkZXIgaXRlbXMgY3JlYXRpb24gZXJyb3Igd2l0aCByb2xsYmFjaycsIGFzeW5jICgpID0+IHtcbiAgICAvLyBBcnJhbmdlXG4gICAgY29uc3Qgb3JkZXJEYXRhID0ge1xuICAgICAgdXNlcl9pZDogJ3Rlc3QtdXNlci1pZCcsXG4gICAgICBpdGVtczogW3sgcHJvZHVjdF9pZDogMSwgcXVhbnRpdHk6IDEsIHVuaXRfcHJpY2U6IDE1MDAwIH1dXG4gICAgfTtcblxuICAgIGNvbnN0IG1vY2tTdXBhYmFzZSA9IHJlcXVpcmUoJ0AvbGliL3N1cGFiYXNlJykuc3VwYWJhc2VBZG1pbjtcbiAgICBcbiAgICAvLyBPcmRlciBjcmVhdGlvbiBzdWNjZWVkc1xuICAgIG1vY2tTdXBhYmFzZS5mcm9tKCkuaW5zZXJ0KCkuc2VsZWN0KCkuc2luZ2xlLm1vY2tJbXBsZW1lbnRhdGlvbk9uY2UoKCkgPT4gXG4gICAgICBQcm9taXNlLnJlc29sdmUoeyBkYXRhOiB7IGlkOiAnbmV3LW9yZGVyLWlkJyB9LCBlcnJvcjogbnVsbCB9KVxuICAgICk7XG4gICAgXG4gICAgLy8gT3JkZXIgaXRlbXMgY3JlYXRpb24gZmFpbHNcbiAgICBtb2NrU3VwYWJhc2UuZnJvbSgpLmluc2VydC5tb2NrSW1wbGVtZW50YXRpb25PbmNlKCgpID0+IFxuICAgICAgUHJvbWlzZS5yZXNvbHZlKHsgZGF0YTogbnVsbCwgZXJyb3I6IHsgbWVzc2FnZTogJ0l0ZW1zIGluc2VydCBmYWlsZWQnIH0gfSlcbiAgICApO1xuXG4gICAgY29uc3QgbW9ja1JlcXVlc3QgPSB7XG4gICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUob3JkZXJEYXRhKVxuICAgIH07XG5cbiAgICAvLyBBY3RcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IFBPU1QobW9ja1JlcXVlc3QpO1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAvLyBBc3NlcnRcbiAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDUwMCk7XG4gICAgZXhwZWN0KGRhdGEuZXJyb3IpLnRvQmUoJ0Vycm9yIGFsIGNyZWFyIGl0ZW1zIGRlIG9yZGVuJyk7XG4gICAgXG4gICAgLy8gVmVyaWZ5IHJvbGxiYWNrIHdhcyBhdHRlbXB0ZWRcbiAgICBleHBlY3QobW9ja1N1cGFiYXNlLmZyb20pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdvcmRlcnMnKTtcbiAgfSk7XG5cbiAgdGVzdCgnc2hvdWxkIGNhbGN1bGF0ZSB0b3RhbCBhbW91bnQgY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xuICAgIC8vIEFycmFuZ2VcbiAgICBjb25zdCBvcmRlckRhdGEgPSB7XG4gICAgICB1c2VyX2lkOiAndGVzdC11c2VyLWlkJyxcbiAgICAgIGl0ZW1zOiBbXG4gICAgICAgIHsgcHJvZHVjdF9pZDogMSwgcXVhbnRpdHk6IDIsIHVuaXRfcHJpY2U6IDE1MDAwIH0sIC8vIDMwMDAwXG4gICAgICAgIHsgcHJvZHVjdF9pZDogMiwgcXVhbnRpdHk6IDEsIHVuaXRfcHJpY2U6IDI1MDAgfSAgIC8vIDI1MDBcbiAgICAgIF1cbiAgICAgIC8vIFRvdGFsIHNob3VsZCBiZSAzMjUwMFxuICAgIH07XG5cbiAgICBjb25zdCBtb2NrUmVxdWVzdCA9IHtcbiAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZShvcmRlckRhdGEpXG4gICAgfTtcblxuICAgIC8vIEFjdFxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgUE9TVChtb2NrUmVxdWVzdCk7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgIC8vIEFzc2VydFxuICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAxKTtcbiAgICBleHBlY3QoZGF0YS5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgIFxuICAgIC8vIFZlcmlmeSB0b3RhbCBjYWxjdWxhdGlvbiBpbiB0aGUgaW5zZXJ0IGNhbGxcbiAgICBjb25zdCBtb2NrU3VwYWJhc2UgPSByZXF1aXJlKCdAL2xpYi9zdXBhYmFzZScpLnN1cGFiYXNlQWRtaW47XG4gICAgY29uc3QgaW5zZXJ0Q2FsbCA9IG1vY2tTdXBhYmFzZS5mcm9tKCkuaW5zZXJ0Lm1vY2suY2FsbHNbMF1bMF07XG4gICAgZXhwZWN0KGluc2VydENhbGwudG90YWxfYW1vdW50KS50b0JlKDMyNTAwKTtcbiAgfSk7XG59KTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIElOVEVHUkFUSU9OIFRFU1RTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5kZXNjcmliZSgnT3JkZXJzIEFQSSBJbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgcmVzZXRBbGxNb2NrcygpO1xuICB9KTtcblxuICB0ZXN0KCdzaG91bGQgaGFuZGxlIGNvbXBsZXRlIG9yZGVyIGxpZmVjeWNsZScsIGFzeW5jICgpID0+IHtcbiAgICAvLyBUZXN0IGNyZWF0aW5nIGFuIG9yZGVyIGFuZCB0aGVuIHJldHJpZXZpbmcgaXRcbiAgICBcbiAgICAvLyAxLiBDcmVhdGUgb3JkZXJcbiAgICBjb25zdCBvcmRlckRhdGEgPSB7XG4gICAgICB1c2VyX2lkOiAndGVzdC11c2VyLWlkJyxcbiAgICAgIGl0ZW1zOiBbeyBwcm9kdWN0X2lkOiAxLCBxdWFudGl0eTogMSwgdW5pdF9wcmljZTogMTUwMDAgfV1cbiAgICB9O1xuXG4gICAgY29uc3QgY3JlYXRlUmVxdWVzdCA9IHtcbiAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZShvcmRlckRhdGEpXG4gICAgfTtcblxuICAgIGNvbnN0IGNyZWF0ZVJlc3BvbnNlID0gYXdhaXQgUE9TVChjcmVhdGVSZXF1ZXN0KTtcbiAgICBjb25zdCBjcmVhdGVEYXRhID0gYXdhaXQgY3JlYXRlUmVzcG9uc2UuanNvbigpO1xuXG4gICAgZXhwZWN0KGNyZWF0ZVJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDEpO1xuICAgIGV4cGVjdChjcmVhdGVEYXRhLnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG5cbiAgICAvLyAyLiBSZXRyaWV2ZSBvcmRlcnMgbGlzdFxuICAgIGNvbnN0IGdldFJlcXVlc3QgPSB7XG4gICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2FkbWluL29yZGVycydcbiAgICB9O1xuXG4gICAgY29uc3QgZ2V0UmVzcG9uc2UgPSBhd2FpdCBHRVQoZ2V0UmVxdWVzdCk7XG4gICAgY29uc3QgZ2V0RGF0YSA9IGF3YWl0IGdldFJlc3BvbnNlLmpzb24oKTtcblxuICAgIGV4cGVjdChnZXRSZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICBleHBlY3QoZ2V0RGF0YS5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdChnZXREYXRhLmRhdGEub3JkZXJzKS50b0JlRGVmaW5lZCgpO1xuICB9KTtcblxuICB0ZXN0KCdzaG91bGQgbWFpbnRhaW4gZGF0YSBjb25zaXN0ZW5jeSBhY3Jvc3Mgb3BlcmF0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAvLyBWZXJpZnkgdGhhdCBhbGwgcmVsYXRlZCBkYXRhIGlzIHByb3Blcmx5IGxpbmtlZFxuICAgIGNvbnN0IG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hZG1pbi9vcmRlcnMnXG4gICAgfTtcblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgR0VUKG1vY2tSZXF1ZXN0KTtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgIFxuICAgIC8vIFZlcmlmeSBvcmRlciBzdHJ1Y3R1cmVcbiAgICBjb25zdCBvcmRlciA9IGRhdGEuZGF0YS5vcmRlcnNbMF07XG4gICAgZXhwZWN0KG9yZGVyLmlkKS50b0JlRGVmaW5lZCgpO1xuICAgIGV4cGVjdChvcmRlci5vcmRlcl9udW1iZXIpLnRvQmVEZWZpbmVkKCk7XG4gICAgZXhwZWN0KG9yZGVyLnVzZXJfcHJvZmlsZXMpLnRvQmVEZWZpbmVkKCk7XG4gICAgZXhwZWN0KG9yZGVyLm9yZGVyX2l0ZW1zKS50b0JlRGVmaW5lZCgpO1xuICAgIGV4cGVjdChBcnJheS5pc0FycmF5KG9yZGVyLm9yZGVyX2l0ZW1zKSkudG9CZSh0cnVlKTtcbiAgICBcbiAgICAvLyBWZXJpZnkgb3JkZXIgaXRlbXMgaGF2ZSBwcm9kdWN0IGRhdGFcbiAgICBpZiAob3JkZXIub3JkZXJfaXRlbXMubGVuZ3RoID4gMCkge1xuICAgICAgZXhwZWN0KG9yZGVyLm9yZGVyX2l0ZW1zWzBdLnByb2R1Y3RzKS50b0JlRGVmaW5lZCgpO1xuICAgIH1cbiAgfSk7XG59KTtcbiJdLCJuYW1lcyI6WyJqZXN0IiwibW9jayIsIk5leHRSZXF1ZXN0IiwiZm4iLCJOZXh0UmVzcG9uc2UiLCJqc29uIiwiZGF0YSIsIm9wdGlvbnMiLCJQcm9taXNlIiwicmVzb2x2ZSIsInN0YXR1cyIsImhlYWRlcnMiLCJNYXAiLCJzdXBhYmFzZUFkbWluIiwiY3JlYXRlTW9ja1N1cGFiYXNlQWRtaW4iLCJhdXRoIiwibW9ja0F1dGgiLCJjdXJyZW50VXNlciIsIm1vY2tDdXJyZW50VXNlciIsImNoZWNrUmF0ZUxpbWl0IiwibW9ja0NoZWNrUmF0ZUxpbWl0IiwiYWRkUmF0ZUxpbWl0SGVhZGVycyIsIm1vY2tBZGRSYXRlTGltaXRIZWFkZXJzIiwiUkFURV9MSU1JVF9DT05GSUdTIiwiYWRtaW4iLCJyZXF1ZXN0cyIsIndpbmRvdyIsImxvZ2dlciIsIm1vY2tMb2dnZXIiLCJMb2dMZXZlbCIsIklORk8iLCJFUlJPUiIsIldBUk4iLCJMb2dDYXRlZ29yeSIsIkFQSSIsIkRBVEFCQVNFIiwiQVVUSCIsIm1ldHJpY3NDb2xsZWN0b3IiLCJtb2NrTWV0cmljc0NvbGxlY3RvciIsInoiLCJvYmplY3QiLCJtb2NrUmV0dXJuVmFsdWUiLCJzYWZlUGFyc2UiLCJzdWNjZXNzIiwicGFnZSIsImxpbWl0Iiwic29ydF9ieSIsInNvcnRfb3JkZXIiLCJjb2VyY2UiLCJudW1iZXIiLCJtaW4iLCJtb2NrUmV0dXJuVGhpcyIsIm1heCIsImRlZmF1bHQiLCJzdHJpbmciLCJvcHRpb25hbCIsInV1aWQiLCJlbnVtIiwiYXJyYXkiLCJjcmVhdGVNb2NrQ2xlcmtBdXRoIiwiY3JlYXRlTW9ja1JhdGVMaW1pdGVyIiwiY3JlYXRlTW9ja0xvZ2dlciIsImNyZWF0ZU1vY2tNZXRyaWNzQ29sbGVjdG9yIiwiZGVzY3JpYmUiLCJiZWZvcmVFYWNoIiwicmVzZXRBbGxNb2NrcyIsInRlc3QiLCJtb2NrUmVxdWVzdCIsInVybCIsInJlc3BvbnNlIiwiR0VUIiwiZXhwZWN0IiwidG9CZSIsIm9yZGVycyIsInRvRXF1YWwiLCJtb2NrT3JkZXJzIiwicGFnaW5hdGlvbiIsInRvQmVEZWZpbmVkIiwidG90YWwiLCJsZW5ndGgiLCJ0b0hhdmVCZWVuQ2FsbGVkIiwicmVjb3JkQXBpQ2FsbCIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIiwiYW55IiwiTnVtYmVyIiwibW9ja1Jlc29sdmVkVmFsdWVPbmNlIiwidXNlcklkIiwiZXJyb3IiLCJlbWFpbEFkZHJlc3NlcyIsImVtYWlsQWRkcmVzcyIsInJlbWFpbmluZyIsInJlc2V0IiwiRGF0ZSIsIm5vdyIsImZpbHRlcnMiLCJtb2NrU3VwYWJhc2UiLCJyZXF1aXJlIiwiZnJvbSIsInNlbGVjdCIsInJhbmdlIiwibW9ja0ltcGxlbWVudGF0aW9uT25jZSIsIm1lc3NhZ2UiLCJsb2ciLCJPYmplY3QiLCJvcmRlckRhdGEiLCJ1c2VyX2lkIiwiaXRlbXMiLCJwcm9kdWN0X2lkIiwicXVhbnRpdHkiLCJ1bml0X3ByaWNlIiwic2hpcHBpbmdfYWRkcmVzcyIsInN0cmVldF9uYW1lIiwic3RyZWV0X251bWJlciIsInppcF9jb2RlIiwiY2l0eV9uYW1lIiwic3RhdGVfbmFtZSIsIm5vdGVzIiwiUE9TVCIsIm9yZGVyX251bWJlciIsInRvTWF0Y2giLCJpbnZhbGlkT3JkZXJEYXRhIiwibW9ja1pvZCIsIm1vY2tSZXR1cm5WYWx1ZU9uY2UiLCJlcnJvcnMiLCJwYXRoIiwiZGV0YWlscyIsImluc2VydCIsInNpbmdsZSIsImlkIiwiaW5zZXJ0Q2FsbCIsImNhbGxzIiwidG90YWxfYW1vdW50IiwiY3JlYXRlUmVxdWVzdCIsImNyZWF0ZVJlc3BvbnNlIiwiY3JlYXRlRGF0YSIsImdldFJlcXVlc3QiLCJnZXRSZXNwb25zZSIsImdldERhdGEiLCJvcmRlciIsInVzZXJfcHJvZmlsZXMiLCJvcmRlcl9pdGVtcyIsIkFycmF5IiwiaXNBcnJheSIsInByb2R1Y3RzIl0sIm1hcHBpbmdzIjoiQUFBQSxzQ0FBc0M7QUFDdEMsd0NBQXdDO0FBQ3hDLHNDQUFzQzs7QUFjdEMsc0NBQXNDO0FBQ3RDLGNBQWM7QUFDZCxzQ0FBc0M7QUFFdEMsZUFBZTtBQUNmQSxLQUFLQyxJQUFJLENBQUMsZUFBZSxJQUFPLENBQUE7UUFDOUJDLGFBQWFGLEtBQUtHLEVBQUU7UUFDcEJDLGNBQWM7WUFDWkMsTUFBTUwsS0FBS0csRUFBRSxDQUFDLENBQUNHLE1BQU1DLFVBQWEsQ0FBQTtvQkFDaENGLE1BQU0sSUFBTUcsUUFBUUMsT0FBTyxDQUFDSDtvQkFDNUJJLFFBQVFILFNBQVNHLFVBQVU7b0JBQzNCQyxTQUFTLElBQUlDO2dCQUNmLENBQUE7UUFDRjtJQUNGLENBQUE7QUFFQSxnQkFBZ0I7QUFDaEJaLEtBQUtDLElBQUksQ0FBQyxrQkFBa0IsSUFBTyxDQUFBO1FBQ2pDWSxlQUFlQyxJQUFBQSxv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