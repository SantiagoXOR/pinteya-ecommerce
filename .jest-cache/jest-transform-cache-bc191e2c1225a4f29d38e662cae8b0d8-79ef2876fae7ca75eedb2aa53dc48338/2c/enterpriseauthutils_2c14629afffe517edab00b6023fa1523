550572b123828bb18340572058c3e92e
/**
 * Utilidades de Autenticación Enterprise
 * Sistema centralizado que combina Clerk + Supabase con patrones enterprise
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get getEnterpriseAuthContext () {
        return getEnterpriseAuthContext;
    },
    get requireAdminAuth () {
        return requireAdminAuth;
    },
    get requireBasicAuth () {
        return requireBasicAuth;
    },
    get requireCriticalAuth () {
        return requireCriticalAuth;
    },
    get requireHighAuth () {
        return requireHighAuth;
    },
    get requireMediumAuth () {
        return requireMediumAuth;
    },
    get requirePaymentAuth () {
        return requirePaymentAuth;
    },
    get withAdminAuth () {
        return withAdminAuth;
    },
    get withBasicAuth () {
        return withBasicAuth;
    },
    get withCriticalAuth () {
        return withCriticalAuth;
    },
    get withEnterpriseAuth () {
        return withEnterpriseAuth;
    },
    get withHighAuth () {
        return withHighAuth;
    },
    get withMediumAuth () {
        return withMediumAuth;
    },
    get withPaymentAuth () {
        return withPaymentAuth;
    }
});
const _auth = require("../../auth");
const _supabase = require("../supabase");
const _jwtvalidation = require("./jwt-validation");
const _csrfprotection = require("./csrf-protection");
const _ratelimiting = require("./rate-limiting");
const _securityaudit = require("./security-audit");
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
// =====================================================
// CONFIGURACIONES ENTERPRISE
// =====================================================
const ENTERPRISE_CONFIGS = {
    // Configuración para operaciones críticas (admin, pagos)
    critical: {
        requiredRole: 'admin',
        securityLevel: 'critical',
        enableRateLimit: true,
        enableCSRFProtection: true,
        enableJWTValidation: true,
        rateLimitType: 'admin',
        requiredPermissions: [
            'admin_access'
        ]
    },
    // Configuración para operaciones de alto nivel (gestión de contenido)
    high: {
        requiredRole: 'admin',
        securityLevel: 'high',
        enableRateLimit: true,
        enableCSRFProtection: true,
        enableJWTValidation: true,
        rateLimitType: 'admin'
    },
    // Configuración para operaciones moderadas (APIs de productos)
    medium: {
        securityLevel: 'medium',
        enableRateLimit: true,
        enableCSRFProtection: false,
        enableJWTValidation: false,
        rateLimitType: 'products'
    },
    // Configuración para operaciones básicas (consultas públicas)
    low: {
        securityLevel: 'low',
        enableRateLimit: true,
        enableCSRFProtection: false,
        enableJWTValidation: false,
        rateLimitType: 'general'
    }
};
async function getEnterpriseAuthContext(request, options = {}) {
    try {
        // BYPASS TEMPORAL PARA DESARROLLO
        if (process.env.NODE_ENV === 'development' && process.env.BYPASS_AUTH === 'true') {
            return {
                success: true,
                context: {
                    userId: 'dev-admin',
                    sessionId: 'dev-session',
                    email: 'santiago@xor.com.ar',
                    role: 'admin',
                    permissions: [
                        'admin_access',
                        'products_read',
                        'products_write',
                        'orders_read',
                        'orders_write'
                    ],
                    sessionValid: true,
                    securityLevel: 'critical',
                    supabase: _supabase.supabaseAdmin,
                    validations: {
                        jwtValid: true,
                        csrfValid: true,
                        rateLimitPassed: true,
                        originValid: true
                    }
                },
                user: {
                    id: 'dev-admin',
                    email: 'santiago@xor.com.ar',
                    name: 'Dev Admin'
                },
                supabase: _supabase.supabaseAdmin
            };
        }
        const startTime = Date.now();
        // Aplicar configuración predefinida si se especifica nivel de seguridad
        const config = options.securityLevel ? {
            ...ENTERPRISE_CONFIGS[options.securityLevel],
            ...options
        } : options;
        // 1. VALIDACIÓN DE RATE LIMITING
        if (config.enableRateLimit && config.rateLimitType) {
            const rateLimitResult = await (0, _ratelimiting.checkRateLimit)(request, _ratelimiting.RATE_LIMIT_CONFIGS[config.rateLimitType], `enterprise_${config.rateLimitType}`);
            if (!rateLimitResult.allowed) {
                await (0, _securityaudit.logAuthFailure)('unknown', `Rate limit exceeded: ${rateLimitResult.error}`, request);
                return {
                    success: false,
                    error: rateLimitResult.error || 'Rate limit exceeded',
                    code: 'RATE_LIMIT_EXCEEDED',
                    status: 429,
                    retryAfter: rateLimitResult.retryAfter
                };
            }
        }
        // 2. VALIDACIÓN CSRF
        let csrfValid = true;
        if (config.enableCSRFProtection) {
            const csrfResult = await (0, _csrfprotection.validateRequestOrigin)(request);
            csrfValid = csrfResult.valid;
            if (!csrfValid) {
                await (0, _securityaudit.logAuthFailure)('unknown', `CSRF validation failed: ${csrfResult.error}`, request);
                return {
                    success: false,
                    error: csrfResult.error || 'Invalid request origin',
                    code: 'CSRF_VALIDATION_FAILED',
                    status: 403
                };
            }
        }
        // 3. AUTENTICACIÓN BÁSICA CON CLERK
        let userId;
        let sessionId;
        let userEmail;
        if (request && 'query' in request) {
            // Pages Router - NextAuth.js
            // TODO: Implementar autenticación para Pages Router con NextAuth.js
            return {
                success: false,
                error: 'Pages Router no soportado con NextAuth.js',
                code: 'NOT_SUPPORTED',
                status: 401
            };
        } else {
            // App Router - NextAuth.js
            const session = await (0, _auth.auth)();
            if (!session?.user?.id) {
                return {
                    success: false,
                    error: 'Usuario no autenticado',
                    code: 'NOT_AUTHENTICATED',
                    status: 401
                };
            }
            userId = session.user.id;
            sessionId = session.user.id; // NextAuth.js no tiene sessionId separado
            userEmail = session.user.email;
        }
        // 4. VALIDACIÓN JWT
        let jwtValid = true;
        if (config.enableJWTValidation) {
            const jwtResult = await (0, _jwtvalidation.validateJWTIntegrity)(request);
            jwtValid = jwtResult.valid;
            if (!jwtValid) {
                await (0, _securityaudit.logAuthFailure)(userId, `JWT validation failed: ${jwtResult.error}`, request);
                return {
                    success: false,
                    error: jwtResult.error || 'Invalid JWT token',
                    code: 'JWT_VALIDATION_FAILED',
                    status: 401
                };
            }
            // Validar permisos específicos si se requieren
            if (config.requiredRole || config.requiredPermissions) {
                const permissionResult = await (0, _jwtvalidation.validateJWTPermissions)(config.requiredRole || '', config.requiredPermissions || [], request);
                if (!permissionResult.valid) {
                    await (0, _securityaudit.logPermissionDenied)(userId, `Permission validation failed: ${permissionResult.error}`, request);
                    return {
                        success: false,
                        error: permissionResult.error || 'Insufficient permissions',
                        code: 'INSUFFICIENT_PERMISSIONS',
                        status: 403
                    };
                }
            }
        }
        // 5. OBTENER INFORMACIÓN DEL USUARIO DESDE SUPABASE
        const { data: userProfile, error: userError } = await _supabase.supabaseAdmin.from('user_profiles').select('*').eq('clerk_user_id', userId).single();
        if (userError && userError.code !== 'PGRST116') {
            console.error('[ENTERPRISE_AUTH] Error obteniendo perfil de usuario:', userError);
        }
        // 6. DETERMINAR ROL Y PERMISOS
        const userRole = userProfile?.role || 'user';
        const userPermissions = userProfile?.permissions || [];
        // Validar rol requerido
        if (config.requiredRole && userRole !== config.requiredRole) {
            await (0, _securityaudit.logPermissionDenied)(userId, `Role validation failed: required ${config.requiredRole}, got ${userRole}`, request);
            return {
                success: false,
                error: `Rol requerido: ${config.requiredRole}`,
                code: 'INSUFFICIENT_ROLE',
                status: 403
            };
        }
        // Validar permisos requeridos
        if (config.requiredPermissions && config.requiredPermissions.length > 0) {
            const hasAllPermissions = config.requiredPermissions.every((permission)=>userPermissions.includes(permission));
            if (!hasAllPermissions) {
                await (0, _securityaudit.logPermissionDenied)(userId, `Permission validation failed: missing ${config.requiredPermissions.join(', ')}`, request);
                return {
                    success: false,
                    error: `Permisos insuficientes: ${config.requiredPermissions.join(', ')}`,
                    code: 'INSUFFICIENT_PERMISSIONS',
                    status: 403
                };
            }
        }
        // 7. OBTENER INFORMACIÓN ADICIONAL
        const ipAddress = getClientIP(request);
        const userAgent = getHeader(request, 'user-agent') || 'unknown';
        // 8. CREAR CONTEXTO ENTERPRISE
        const context = {
            userId,
            sessionId,
            email: userProfile?.email || userEmail,
            role: userRole,
            permissions: userPermissions,
            sessionValid: !!sessionId,
            sessionMetadata: userProfile?.metadata,
            securityLevel: config.securityLevel || 'medium',
            ipAddress,
            userAgent,
            supabase: _supabase.supabaseAdmin,
            validations: {
                jwtValid,
                csrfValid,
                rateLimitPassed: true,
                originValid: csrfValid
            }
        };
        // 9. LOG DE ÉXITO
        await (0, _securityaudit.logAuthSuccess)(userId, {
            ip_address: ipAddress,
            user_agent: userAgent,
            session_id: sessionId,
            security_level: config.securityLevel || 'medium',
            permissions: userPermissions,
            role: userRole
        }, request);
        const duration = Date.now() - startTime;
        console.log(`[ENTERPRISE_AUTH] Autenticación exitosa para ${userId} en ${duration}ms`);
        return {
            success: true,
            context
        };
    } catch (error) {
        console.error('[ENTERPRISE_AUTH] Error en autenticación enterprise:', error);
        await (0, _securityaudit.logAuthFailure)('unknown', `Enterprise auth error: ${error.message}`, request);
        return {
            success: false,
            error: 'Error interno de autenticación',
            code: 'INTERNAL_AUTH_ERROR',
            status: 500
        };
    }
}
// =====================================================
// FUNCIONES AUXILIARES
// =====================================================
/**
 * Obtiene la IP del cliente
 */ function getClientIP(request) {
    if ('ip' in request && request.ip) {
        return request.ip;
    }
    const forwarded = getHeader(request, 'x-forwarded-for');
    const realIP = getHeader(request, 'x-real-ip');
    const cfIP = getHeader(request, 'cf-connecting-ip');
    return forwarded?.split(',')[0] || realIP || cfIP || 'unknown';
}
/**
 * Obtiene un header de manera compatible
 */ function getHeader(request, headerName) {
    if ('headers' in request && typeof request.headers.get === 'function') {
        return request.headers.get(headerName);
    } else if ('headers' in request) {
        const header = request.headers[headerName];
        return Array.isArray(header) ? header[0] : header || null;
    }
    return null;
}
async function requireCriticalAuth(request) {
    return getEnterpriseAuthContext(request, {
        securityLevel: 'critical'
    });
}
async function requireHighAuth(request, requiredPermissions) {
    return getEnterpriseAuthContext(request, {
        securityLevel: 'high',
        requiredPermissions
    });
}
async function requireMediumAuth(request) {
    return getEnterpriseAuthContext(request, {
        securityLevel: 'medium'
    });
}
async function requireBasicAuth(request) {
    return getEnterpriseAuthContext(request, {
        securityLevel: 'low'
    });
}
async function requireAdminAuth(request, requiredPermissions = [
    'admin_access'
]) {
    // BYPASS TEMPORAL PARA DESARROLLO
    if (process.env.NODE_ENV === 'development' && process.env.BYPASS_AUTH === 'true') {
        console.log('[Enterprise Auth] BYPASS AUTH ENABLED - requireAdminAuth');
        const { createClient } = await Promise.resolve().then(()=>/*#__PURE__*/ _interop_require_wildcard(require("@supabase/supabase-js")));
        const supabase = createClient(process.env.NEXT_PUBLIC_SUPABASE_URL, process.env.SUPABASE_SERVICE_ROLE_KEY);
        return {
            success: true,
            user: {
                id: 'dev-admin',
                email: 'santiago@xor.com.ar',
                role: 'admin'
            },
            supabase,
            context: {
                user: {
                    id: 'dev-admin',
                    email: 'santiago@xor.com.ar',
                    role: 'admin'
                },
                permissions: requiredPermissions,
                metadata: {
                    bypass: true
                }
            }
        };
    }
    return getEnterpriseAuthContext(request, {
        requiredRole: 'admin',
        requiredPermissions,
        securityLevel: 'critical',
        enableRateLimit: true,
        enableCSRFProtection: true,
        enableJWTValidation: true,
        rateLimitType: 'admin'
    });
}
async function requirePaymentAuth(request) {
    return getEnterpriseAuthContext(request, {
        securityLevel: 'critical',
        enableRateLimit: true,
        enableCSRFProtection: true,
        enableJWTValidation: true,
        rateLimitType: 'payments',
        requiredPermissions: [
            'payment_access'
        ]
    });
}
function withEnterpriseAuth(authFunction) {
    return function(handler) {
        return async (request, ...args)=>{
            try {
                const authResult = await authFunction(request);
                if (!authResult.success) {
                    const errorResponse = {
                        success: false,
                        error: authResult.error,
                        code: authResult.code,
                        timestamp: new Date().toISOString(),
                        enterprise: true
                    };
                    const headers = {
                        'Content-Type': 'application/json'
                    };
                    if (authResult.retryAfter) {
                        headers['Retry-After'] = authResult.retryAfter.toString();
                    }
                    if ('query' in request) {
                        // Pages Router
                        const res = args[0];
                        Object.entries(headers).forEach(([key, value])=>{
                            res.setHeader(key, value);
                        });
                        return res.status(authResult.status || 401).json(errorResponse);
                    } else {
                        // App Router
                        return new Response(JSON.stringify(errorResponse), {
                            status: authResult.status || 401,
                            headers
                        });
                    }
                }
                // Añadir contexto enterprise al request
                request.enterpriseAuth = authResult.context;
                return handler(request, ...args);
            } catch (error) {
                console.error('[ENTERPRISE_AUTH] Error en middleware:', error);
                const errorResponse = {
                    success: false,
                    error: 'Error interno de autenticación enterprise',
                    code: 'ENTERPRISE_AUTH_ERROR',
                    timestamp: new Date().toISOString()
                };
                if ('query' in request) {
                    // Pages Router
                    const res = args[0];
                    return res.status(500).json(errorResponse);
                } else {
                    // App Router
                    return new Response(JSON.stringify(errorResponse), {
                        status: 500,
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    });
                }
            }
        };
    };
}
const withCriticalAuth = ()=>withEnterpriseAuth(requireCriticalAuth);
const withHighAuth = (requiredPermissions)=>withEnterpriseAuth((req)=>requireHighAuth(req, requiredPermissions));
const withMediumAuth = ()=>withEnterpriseAuth(requireMediumAuth);
const withBasicAuth = ()=>withEnterpriseAuth(requireBasicAuth);
const withAdminAuth = (requiredPermissions)=>withEnterpriseAuth((req)=>requireAdminAuth(req, requiredPermissions));
const withPaymentAuth = ()=>withEnterpriseAuth(requirePaymentAuth);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcbGliXFxhdXRoXFxlbnRlcnByaXNlLWF1dGgtdXRpbHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBVdGlsaWRhZGVzIGRlIEF1dGVudGljYWNpw7NuIEVudGVycHJpc2VcbiAqIFNpc3RlbWEgY2VudHJhbGl6YWRvIHF1ZSBjb21iaW5hIENsZXJrICsgU3VwYWJhc2UgY29uIHBhdHJvbmVzIGVudGVycHJpc2VcbiAqL1xuXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QgfSBmcm9tICduZXh0JztcbmltcG9ydCB7IGF1dGggfSBmcm9tICdAL2F1dGgnO1xuaW1wb3J0IHsgc3VwYWJhc2VBZG1pbiB9IGZyb20gJ0AvbGliL3N1cGFiYXNlJztcbmltcG9ydCB7IHZhbGlkYXRlSldUSW50ZWdyaXR5LCB2YWxpZGF0ZUpXVFBlcm1pc3Npb25zIH0gZnJvbSAnLi9qd3QtdmFsaWRhdGlvbic7XG5pbXBvcnQgeyB2YWxpZGF0ZVJlcXVlc3RPcmlnaW4gfSBmcm9tICcuL2NzcmYtcHJvdGVjdGlvbic7XG5pbXBvcnQgeyBjaGVja1JhdGVMaW1pdCwgUkFURV9MSU1JVF9DT05GSUdTIH0gZnJvbSAnLi9yYXRlLWxpbWl0aW5nJztcbmltcG9ydCB7IGxvZ0F1dGhTdWNjZXNzLCBsb2dBdXRoRmFpbHVyZSwgbG9nUGVybWlzc2lvbkRlbmllZCB9IGZyb20gJy4vc2VjdXJpdHktYXVkaXQnO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gVElQT1MgWSBJTlRFUkZBQ0VTIEVOVEVSUFJJU0Vcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW50ZXJwcmlzZUF1dGhDb250ZXh0IHtcbiAgLy8gSW5mb3JtYWNpw7NuIGRlbCB1c3VhcmlvXG4gIHVzZXJJZDogc3RyaW5nO1xuICBzZXNzaW9uSWQ/OiBzdHJpbmc7XG4gIGVtYWlsPzogc3RyaW5nO1xuICByb2xlOiAnYWRtaW4nIHwgJ3VzZXInIHwgJ21vZGVyYXRvcic7XG4gIHBlcm1pc3Npb25zOiBzdHJpbmdbXTtcbiAgXG4gIC8vIEluZm9ybWFjacOzbiBkZSBsYSBzZXNpw7NuXG4gIHNlc3Npb25WYWxpZDogYm9vbGVhbjtcbiAgc2Vzc2lvbk1ldGFkYXRhPzogYW55O1xuICBcbiAgLy8gSW5mb3JtYWNpw7NuIGRlIHNlZ3VyaWRhZFxuICBzZWN1cml0eUxldmVsOiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHwgJ2NyaXRpY2FsJztcbiAgaXBBZGRyZXNzPzogc3RyaW5nO1xuICB1c2VyQWdlbnQ/OiBzdHJpbmc7XG4gIFxuICAvLyBDbGllbnRlcyBkZSBiYXNlIGRlIGRhdG9zXG4gIHN1cGFiYXNlOiB0eXBlb2Ygc3VwYWJhc2VBZG1pbjtcbiAgXG4gIC8vIEluZm9ybWFjacOzbiBkZSB2YWxpZGFjaW9uZXNcbiAgdmFsaWRhdGlvbnM6IHtcbiAgICBqd3RWYWxpZDogYm9vbGVhbjtcbiAgICBjc3JmVmFsaWQ6IGJvb2xlYW47XG4gICAgcmF0ZUxpbWl0UGFzc2VkOiBib29sZWFuO1xuICAgIG9yaWdpblZhbGlkOiBib29sZWFuO1xuICB9O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEVudGVycHJpc2VBdXRoUmVzdWx0IHtcbiAgc3VjY2VzczogYm9vbGVhbjtcbiAgY29udGV4dD86IEVudGVycHJpc2VBdXRoQ29udGV4dDtcbiAgZXJyb3I/OiBzdHJpbmc7XG4gIGNvZGU/OiBzdHJpbmc7XG4gIHN0YXR1cz86IG51bWJlcjtcbiAgcmV0cnlBZnRlcj86IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFbnRlcnByaXNlQXV0aE9wdGlvbnMge1xuICByZXF1aXJlZFJvbGU/OiAnYWRtaW4nIHwgJ3VzZXInIHwgJ21vZGVyYXRvcic7XG4gIHJlcXVpcmVkUGVybWlzc2lvbnM/OiBzdHJpbmdbXTtcbiAgc2VjdXJpdHlMZXZlbD86ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCcgfCAnY3JpdGljYWwnO1xuICBlbmFibGVSYXRlTGltaXQ/OiBib29sZWFuO1xuICBlbmFibGVDU1JGUHJvdGVjdGlvbj86IGJvb2xlYW47XG4gIGVuYWJsZUpXVFZhbGlkYXRpb24/OiBib29sZWFuO1xuICByYXRlTGltaXRUeXBlPzoga2V5b2YgdHlwZW9mIFJBVEVfTElNSVRfQ09ORklHUztcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIENPTkZJR1VSQUNJT05FUyBFTlRFUlBSSVNFXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5jb25zdCBFTlRFUlBSSVNFX0NPTkZJR1MgPSB7XG4gIC8vIENvbmZpZ3VyYWNpw7NuIHBhcmEgb3BlcmFjaW9uZXMgY3LDrXRpY2FzIChhZG1pbiwgcGFnb3MpXG4gIGNyaXRpY2FsOiB7XG4gICAgcmVxdWlyZWRSb2xlOiAnYWRtaW4nIGFzIGNvbnN0LFxuICAgIHNlY3VyaXR5TGV2ZWw6ICdjcml0aWNhbCcgYXMgY29uc3QsXG4gICAgZW5hYmxlUmF0ZUxpbWl0OiB0cnVlLFxuICAgIGVuYWJsZUNTUkZQcm90ZWN0aW9uOiB0cnVlLFxuICAgIGVuYWJsZUpXVFZhbGlkYXRpb246IHRydWUsXG4gICAgcmF0ZUxpbWl0VHlwZTogJ2FkbWluJyBhcyBjb25zdCxcbiAgICByZXF1aXJlZFBlcm1pc3Npb25zOiBbJ2FkbWluX2FjY2VzcyddXG4gIH0sXG4gIFxuICAvLyBDb25maWd1cmFjacOzbiBwYXJhIG9wZXJhY2lvbmVzIGRlIGFsdG8gbml2ZWwgKGdlc3Rpw7NuIGRlIGNvbnRlbmlkbylcbiAgaGlnaDoge1xuICAgIHJlcXVpcmVkUm9sZTogJ2FkbWluJyBhcyBjb25zdCxcbiAgICBzZWN1cml0eUxldmVsOiAnaGlnaCcgYXMgY29uc3QsXG4gICAgZW5hYmxlUmF0ZUxpbWl0OiB0cnVlLFxuICAgIGVuYWJsZUNTUkZQcm90ZWN0aW9uOiB0cnVlLFxuICAgIGVuYWJsZUpXVFZhbGlkYXRpb246IHRydWUsXG4gICAgcmF0ZUxpbWl0VHlwZTogJ2FkbWluJyBhcyBjb25zdFxuICB9LFxuICBcbiAgLy8gQ29uZmlndXJhY2nDs24gcGFyYSBvcGVyYWNpb25lcyBtb2RlcmFkYXMgKEFQSXMgZGUgcHJvZHVjdG9zKVxuICBtZWRpdW06IHtcbiAgICBzZWN1cml0eUxldmVsOiAnbWVkaXVtJyBhcyBjb25zdCxcbiAgICBlbmFibGVSYXRlTGltaXQ6IHRydWUsXG4gICAgZW5hYmxlQ1NSRlByb3RlY3Rpb246IGZhbHNlLFxuICAgIGVuYWJsZUpXVFZhbGlkYXRpb246IGZhbHNlLFxuICAgIHJhdGVMaW1pdFR5cGU6ICdwcm9kdWN0cycgYXMgY29uc3RcbiAgfSxcbiAgXG4gIC8vIENvbmZpZ3VyYWNpw7NuIHBhcmEgb3BlcmFjaW9uZXMgYsOhc2ljYXMgKGNvbnN1bHRhcyBww7pibGljYXMpXG4gIGxvdzoge1xuICAgIHNlY3VyaXR5TGV2ZWw6ICdsb3cnIGFzIGNvbnN0LFxuICAgIGVuYWJsZVJhdGVMaW1pdDogdHJ1ZSxcbiAgICBlbmFibGVDU1JGUHJvdGVjdGlvbjogZmFsc2UsXG4gICAgZW5hYmxlSldUVmFsaWRhdGlvbjogZmFsc2UsXG4gICAgcmF0ZUxpbWl0VHlwZTogJ2dlbmVyYWwnIGFzIGNvbnN0XG4gIH1cbn07XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBGVU5DSU9ORVMgUFJJTkNJUEFMRVMgRU5URVJQUklTRVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBGdW5jacOzbiBwcmluY2lwYWwgZGUgYXV0ZW50aWNhY2nDs24gZW50ZXJwcmlzZVxuICogQ29tYmluYSB0b2RhcyBsYXMgdmFsaWRhY2lvbmVzIHkgcmV0b3JuYSBjb250ZXh0byBjb21wbGV0b1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RW50ZXJwcmlzZUF1dGhDb250ZXh0KFxuICByZXF1ZXN0OiBOZXh0UmVxdWVzdCB8IE5leHRBcGlSZXF1ZXN0LFxuICBvcHRpb25zOiBFbnRlcnByaXNlQXV0aE9wdGlvbnMgPSB7fVxuKTogUHJvbWlzZTxFbnRlcnByaXNlQXV0aFJlc3VsdD4ge1xuICB0cnkge1xuICAgIC8vIEJZUEFTUyBURU1QT1JBTCBQQVJBIERFU0FSUk9MTE9cbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgJiYgcHJvY2Vzcy5lbnYuQllQQVNTX0FVVEggPT09ICd0cnVlJykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgY29udGV4dDoge1xuICAgICAgICAgIHVzZXJJZDogJ2Rldi1hZG1pbicsXG4gICAgICAgICAgc2Vzc2lvbklkOiAnZGV2LXNlc3Npb24nLFxuICAgICAgICAgIGVtYWlsOiAnc2FudGlhZ29AeG9yLmNvbS5hcicsXG4gICAgICAgICAgcm9sZTogJ2FkbWluJyxcbiAgICAgICAgICBwZXJtaXNzaW9uczogWydhZG1pbl9hY2Nlc3MnLCAncHJvZHVjdHNfcmVhZCcsICdwcm9kdWN0c193cml0ZScsICdvcmRlcnNfcmVhZCcsICdvcmRlcnNfd3JpdGUnXSxcbiAgICAgICAgICBzZXNzaW9uVmFsaWQ6IHRydWUsXG4gICAgICAgICAgc2VjdXJpdHlMZXZlbDogJ2NyaXRpY2FsJyxcbiAgICAgICAgICBzdXBhYmFzZTogc3VwYWJhc2VBZG1pbixcbiAgICAgICAgICB2YWxpZGF0aW9uczoge1xuICAgICAgICAgICAgand0VmFsaWQ6IHRydWUsXG4gICAgICAgICAgICBjc3JmVmFsaWQ6IHRydWUsXG4gICAgICAgICAgICByYXRlTGltaXRQYXNzZWQ6IHRydWUsXG4gICAgICAgICAgICBvcmlnaW5WYWxpZDogdHJ1ZVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiAnZGV2LWFkbWluJyxcbiAgICAgICAgICBlbWFpbDogJ3NhbnRpYWdvQHhvci5jb20uYXInLFxuICAgICAgICAgIG5hbWU6ICdEZXYgQWRtaW4nXG4gICAgICAgIH0sXG4gICAgICAgIHN1cGFiYXNlOiBzdXBhYmFzZUFkbWluXG4gICAgICB9O1xuICAgIH1cblxuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG5cbiAgICAvLyBBcGxpY2FyIGNvbmZpZ3VyYWNpw7NuIHByZWRlZmluaWRhIHNpIHNlIGVzcGVjaWZpY2Egbml2ZWwgZGUgc2VndXJpZGFkXG4gICAgY29uc3QgY29uZmlnID0gb3B0aW9ucy5zZWN1cml0eUxldmVsXG4gICAgICA/IHsgLi4uRU5URVJQUklTRV9DT05GSUdTW29wdGlvbnMuc2VjdXJpdHlMZXZlbF0sIC4uLm9wdGlvbnMgfVxuICAgICAgOiBvcHRpb25zO1xuXG4gICAgLy8gMS4gVkFMSURBQ0nDk04gREUgUkFURSBMSU1JVElOR1xuICAgIGlmIChjb25maWcuZW5hYmxlUmF0ZUxpbWl0ICYmIGNvbmZpZy5yYXRlTGltaXRUeXBlKSB7XG4gICAgICBjb25zdCByYXRlTGltaXRSZXN1bHQgPSBhd2FpdCBjaGVja1JhdGVMaW1pdChcbiAgICAgICAgcmVxdWVzdCxcbiAgICAgICAgUkFURV9MSU1JVF9DT05GSUdTW2NvbmZpZy5yYXRlTGltaXRUeXBlXSxcbiAgICAgICAgYGVudGVycHJpc2VfJHtjb25maWcucmF0ZUxpbWl0VHlwZX1gXG4gICAgICApO1xuXG4gICAgICBpZiAoIXJhdGVMaW1pdFJlc3VsdC5hbGxvd2VkKSB7XG4gICAgICAgIGF3YWl0IGxvZ0F1dGhGYWlsdXJlKFxuICAgICAgICAgICd1bmtub3duJyxcbiAgICAgICAgICBgUmF0ZSBsaW1pdCBleGNlZWRlZDogJHtyYXRlTGltaXRSZXN1bHQuZXJyb3J9YCxcbiAgICAgICAgICByZXF1ZXN0XG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiByYXRlTGltaXRSZXN1bHQuZXJyb3IgfHwgJ1JhdGUgbGltaXQgZXhjZWVkZWQnLFxuICAgICAgICAgIGNvZGU6ICdSQVRFX0xJTUlUX0VYQ0VFREVEJyxcbiAgICAgICAgICBzdGF0dXM6IDQyOSxcbiAgICAgICAgICByZXRyeUFmdGVyOiByYXRlTGltaXRSZXN1bHQucmV0cnlBZnRlclxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIDIuIFZBTElEQUNJw5NOIENTUkZcbiAgICBsZXQgY3NyZlZhbGlkID0gdHJ1ZTtcbiAgICBpZiAoY29uZmlnLmVuYWJsZUNTUkZQcm90ZWN0aW9uKSB7XG4gICAgICBjb25zdCBjc3JmUmVzdWx0ID0gYXdhaXQgdmFsaWRhdGVSZXF1ZXN0T3JpZ2luKHJlcXVlc3QpO1xuICAgICAgY3NyZlZhbGlkID0gY3NyZlJlc3VsdC52YWxpZDtcbiAgICAgIFxuICAgICAgaWYgKCFjc3JmVmFsaWQpIHtcbiAgICAgICAgYXdhaXQgbG9nQXV0aEZhaWx1cmUoXG4gICAgICAgICAgJ3Vua25vd24nLFxuICAgICAgICAgIGBDU1JGIHZhbGlkYXRpb24gZmFpbGVkOiAke2NzcmZSZXN1bHQuZXJyb3J9YCxcbiAgICAgICAgICByZXF1ZXN0XG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiBjc3JmUmVzdWx0LmVycm9yIHx8ICdJbnZhbGlkIHJlcXVlc3Qgb3JpZ2luJyxcbiAgICAgICAgICBjb2RlOiAnQ1NSRl9WQUxJREFUSU9OX0ZBSUxFRCcsXG4gICAgICAgICAgc3RhdHVzOiA0MDNcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyAzLiBBVVRFTlRJQ0FDScOTTiBCw4FTSUNBIENPTiBDTEVSS1xuICAgIGxldCB1c2VySWQ6IHN0cmluZztcbiAgICBsZXQgc2Vzc2lvbklkOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gICAgbGV0IHVzZXJFbWFpbDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG4gICAgaWYgKHJlcXVlc3QgJiYgJ3F1ZXJ5JyBpbiByZXF1ZXN0KSB7XG4gICAgICAvLyBQYWdlcyBSb3V0ZXIgLSBOZXh0QXV0aC5qc1xuICAgICAgLy8gVE9ETzogSW1wbGVtZW50YXIgYXV0ZW50aWNhY2nDs24gcGFyYSBQYWdlcyBSb3V0ZXIgY29uIE5leHRBdXRoLmpzXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6ICdQYWdlcyBSb3V0ZXIgbm8gc29wb3J0YWRvIGNvbiBOZXh0QXV0aC5qcycsXG4gICAgICAgIGNvZGU6ICdOT1RfU1VQUE9SVEVEJyxcbiAgICAgICAgICBzdGF0dXM6IDQwMVxuICAgICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBBcHAgUm91dGVyIC0gTmV4dEF1dGguanNcbiAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBhdXRoKCk7XG4gICAgICBpZiAoIXNlc3Npb24/LnVzZXI/LmlkKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6ICdVc3VhcmlvIG5vIGF1dGVudGljYWRvJyxcbiAgICAgICAgICBjb2RlOiAnTk9UX0FVVEhFTlRJQ0FURUQnLFxuICAgICAgICAgIHN0YXR1czogNDAxXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICB1c2VySWQgPSBzZXNzaW9uLnVzZXIuaWQ7XG4gICAgICBzZXNzaW9uSWQgPSBzZXNzaW9uLnVzZXIuaWQ7IC8vIE5leHRBdXRoLmpzIG5vIHRpZW5lIHNlc3Npb25JZCBzZXBhcmFkb1xuICAgICAgdXNlckVtYWlsID0gc2Vzc2lvbi51c2VyLmVtYWlsO1xuICAgIH1cblxuICAgIC8vIDQuIFZBTElEQUNJw5NOIEpXVFxuICAgIGxldCBqd3RWYWxpZCA9IHRydWU7XG4gICAgaWYgKGNvbmZpZy5lbmFibGVKV1RWYWxpZGF0aW9uKSB7XG4gICAgICBjb25zdCBqd3RSZXN1bHQgPSBhd2FpdCB2YWxpZGF0ZUpXVEludGVncml0eShyZXF1ZXN0KTtcbiAgICAgIGp3dFZhbGlkID0gand0UmVzdWx0LnZhbGlkO1xuICAgICAgXG4gICAgICBpZiAoIWp3dFZhbGlkKSB7XG4gICAgICAgIGF3YWl0IGxvZ0F1dGhGYWlsdXJlKFxuICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICBgSldUIHZhbGlkYXRpb24gZmFpbGVkOiAke2p3dFJlc3VsdC5lcnJvcn1gLFxuICAgICAgICAgIHJlcXVlc3RcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IGp3dFJlc3VsdC5lcnJvciB8fCAnSW52YWxpZCBKV1QgdG9rZW4nLFxuICAgICAgICAgIGNvZGU6ICdKV1RfVkFMSURBVElPTl9GQUlMRUQnLFxuICAgICAgICAgIHN0YXR1czogNDAxXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIFZhbGlkYXIgcGVybWlzb3MgZXNwZWPDrWZpY29zIHNpIHNlIHJlcXVpZXJlblxuICAgICAgaWYgKGNvbmZpZy5yZXF1aXJlZFJvbGUgfHwgY29uZmlnLnJlcXVpcmVkUGVybWlzc2lvbnMpIHtcbiAgICAgICAgY29uc3QgcGVybWlzc2lvblJlc3VsdCA9IGF3YWl0IHZhbGlkYXRlSldUUGVybWlzc2lvbnMoXG4gICAgICAgICAgY29uZmlnLnJlcXVpcmVkUm9sZSB8fCAnJyxcbiAgICAgICAgICBjb25maWcucmVxdWlyZWRQZXJtaXNzaW9ucyB8fCBbXSxcbiAgICAgICAgICByZXF1ZXN0XG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIXBlcm1pc3Npb25SZXN1bHQudmFsaWQpIHtcbiAgICAgICAgICBhd2FpdCBsb2dQZXJtaXNzaW9uRGVuaWVkKFxuICAgICAgICAgICAgdXNlcklkLFxuICAgICAgICAgICAgYFBlcm1pc3Npb24gdmFsaWRhdGlvbiBmYWlsZWQ6ICR7cGVybWlzc2lvblJlc3VsdC5lcnJvcn1gLFxuICAgICAgICAgICAgcmVxdWVzdFxuICAgICAgICAgICk7XG4gICAgICAgICAgXG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgZXJyb3I6IHBlcm1pc3Npb25SZXN1bHQuZXJyb3IgfHwgJ0luc3VmZmljaWVudCBwZXJtaXNzaW9ucycsXG4gICAgICAgICAgICBjb2RlOiAnSU5TVUZGSUNJRU5UX1BFUk1JU1NJT05TJyxcbiAgICAgICAgICAgIHN0YXR1czogNDAzXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIDUuIE9CVEVORVIgSU5GT1JNQUNJw5NOIERFTCBVU1VBUklPIERFU0RFIFNVUEFCQVNFXG4gICAgY29uc3QgeyBkYXRhOiB1c2VyUHJvZmlsZSwgZXJyb3I6IHVzZXJFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgICAgLmZyb20oJ3VzZXJfcHJvZmlsZXMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ2NsZXJrX3VzZXJfaWQnLCB1c2VySWQpXG4gICAgICAuc2luZ2xlKCk7XG5cbiAgICBpZiAodXNlckVycm9yICYmIHVzZXJFcnJvci5jb2RlICE9PSAnUEdSU1QxMTYnKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbRU5URVJQUklTRV9BVVRIXSBFcnJvciBvYnRlbmllbmRvIHBlcmZpbCBkZSB1c3VhcmlvOicsIHVzZXJFcnJvcik7XG4gICAgfVxuXG4gICAgLy8gNi4gREVURVJNSU5BUiBST0wgWSBQRVJNSVNPU1xuICAgIGNvbnN0IHVzZXJSb2xlID0gdXNlclByb2ZpbGU/LnJvbGUgfHwgJ3VzZXInO1xuICAgIGNvbnN0IHVzZXJQZXJtaXNzaW9ucyA9IHVzZXJQcm9maWxlPy5wZXJtaXNzaW9ucyB8fCBbXTtcblxuICAgIC8vIFZhbGlkYXIgcm9sIHJlcXVlcmlkb1xuICAgIGlmIChjb25maWcucmVxdWlyZWRSb2xlICYmIHVzZXJSb2xlICE9PSBjb25maWcucmVxdWlyZWRSb2xlKSB7XG4gICAgICBhd2FpdCBsb2dQZXJtaXNzaW9uRGVuaWVkKFxuICAgICAgICB1c2VySWQsXG4gICAgICAgIGBSb2xlIHZhbGlkYXRpb24gZmFpbGVkOiByZXF1aXJlZCAke2NvbmZpZy5yZXF1aXJlZFJvbGV9LCBnb3QgJHt1c2VyUm9sZX1gLFxuICAgICAgICByZXF1ZXN0XG4gICAgICApO1xuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IGBSb2wgcmVxdWVyaWRvOiAke2NvbmZpZy5yZXF1aXJlZFJvbGV9YCxcbiAgICAgICAgY29kZTogJ0lOU1VGRklDSUVOVF9ST0xFJyxcbiAgICAgICAgc3RhdHVzOiA0MDNcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gVmFsaWRhciBwZXJtaXNvcyByZXF1ZXJpZG9zXG4gICAgaWYgKGNvbmZpZy5yZXF1aXJlZFBlcm1pc3Npb25zICYmIGNvbmZpZy5yZXF1aXJlZFBlcm1pc3Npb25zLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IGhhc0FsbFBlcm1pc3Npb25zID0gY29uZmlnLnJlcXVpcmVkUGVybWlzc2lvbnMuZXZlcnkoXG4gICAgICAgIHBlcm1pc3Npb24gPT4gdXNlclBlcm1pc3Npb25zLmluY2x1ZGVzKHBlcm1pc3Npb24pXG4gICAgICApO1xuICAgICAgXG4gICAgICBpZiAoIWhhc0FsbFBlcm1pc3Npb25zKSB7XG4gICAgICAgIGF3YWl0IGxvZ1Blcm1pc3Npb25EZW5pZWQoXG4gICAgICAgICAgdXNlcklkLFxuICAgICAgICAgIGBQZXJtaXNzaW9uIHZhbGlkYXRpb24gZmFpbGVkOiBtaXNzaW5nICR7Y29uZmlnLnJlcXVpcmVkUGVybWlzc2lvbnMuam9pbignLCAnKX1gLFxuICAgICAgICAgIHJlcXVlc3RcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IGBQZXJtaXNvcyBpbnN1ZmljaWVudGVzOiAke2NvbmZpZy5yZXF1aXJlZFBlcm1pc3Npb25zLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICBjb2RlOiAnSU5TVUZGSUNJRU5UX1BFUk1JU1NJT05TJyxcbiAgICAgICAgICBzdGF0dXM6IDQwM1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIDcuIE9CVEVORVIgSU5GT1JNQUNJw5NOIEFESUNJT05BTFxuICAgIGNvbnN0IGlwQWRkcmVzcyA9IGdldENsaWVudElQKHJlcXVlc3QpO1xuICAgIGNvbnN0IHVzZXJBZ2VudCA9IGdldEhlYWRlcihyZXF1ZXN0LCAndXNlci1hZ2VudCcpIHx8ICd1bmtub3duJztcblxuICAgIC8vIDguIENSRUFSIENPTlRFWFRPIEVOVEVSUFJJU0VcbiAgICBjb25zdCBjb250ZXh0OiBFbnRlcnByaXNlQXV0aENvbnRleHQgPSB7XG4gICAgICB1c2VySWQsXG4gICAgICBzZXNzaW9uSWQsXG4gICAgICBlbWFpbDogdXNlclByb2ZpbGU/LmVtYWlsIHx8IHVzZXJFbWFpbCxcbiAgICAgIHJvbGU6IHVzZXJSb2xlIGFzICdhZG1pbicgfCAndXNlcicgfCAnbW9kZXJhdG9yJyxcbiAgICAgIHBlcm1pc3Npb25zOiB1c2VyUGVybWlzc2lvbnMsXG4gICAgICBzZXNzaW9uVmFsaWQ6ICEhc2Vzc2lvbklkLFxuICAgICAgc2Vzc2lvbk1ldGFkYXRhOiB1c2VyUHJvZmlsZT8ubWV0YWRhdGEsXG4gICAgICBzZWN1cml0eUxldmVsOiBjb25maWcuc2VjdXJpdHlMZXZlbCB8fCAnbWVkaXVtJyxcbiAgICAgIGlwQWRkcmVzcyxcbiAgICAgIHVzZXJBZ2VudCxcbiAgICAgIHN1cGFiYXNlOiBzdXBhYmFzZUFkbWluLFxuICAgICAgdmFsaWRhdGlvbnM6IHtcbiAgICAgICAgand0VmFsaWQsXG4gICAgICAgIGNzcmZWYWxpZCxcbiAgICAgICAgcmF0ZUxpbWl0UGFzc2VkOiB0cnVlLFxuICAgICAgICBvcmlnaW5WYWxpZDogY3NyZlZhbGlkXG4gICAgICB9XG4gICAgfTtcblxuICAgIC8vIDkuIExPRyBERSDDiVhJVE9cbiAgICBhd2FpdCBsb2dBdXRoU3VjY2Vzcyh1c2VySWQsIHtcbiAgICAgIGlwX2FkZHJlc3M6IGlwQWRkcmVzcyxcbiAgICAgIHVzZXJfYWdlbnQ6IHVzZXJBZ2VudCxcbiAgICAgIHNlc3Npb25faWQ6IHNlc3Npb25JZCxcbiAgICAgIHNlY3VyaXR5X2xldmVsOiBjb25maWcuc2VjdXJpdHlMZXZlbCB8fCAnbWVkaXVtJyxcbiAgICAgIHBlcm1pc3Npb25zOiB1c2VyUGVybWlzc2lvbnMsXG4gICAgICByb2xlOiB1c2VyUm9sZVxuICAgIH0sIHJlcXVlc3QpO1xuXG4gICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgIGNvbnNvbGUubG9nKGBbRU5URVJQUklTRV9BVVRIXSBBdXRlbnRpY2FjacOzbiBleGl0b3NhIHBhcmEgJHt1c2VySWR9IGVuICR7ZHVyYXRpb259bXNgKTtcblxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgY29udGV4dFxuICAgIH07XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbRU5URVJQUklTRV9BVVRIXSBFcnJvciBlbiBhdXRlbnRpY2FjacOzbiBlbnRlcnByaXNlOicsIGVycm9yKTtcbiAgICBcbiAgICBhd2FpdCBsb2dBdXRoRmFpbHVyZShcbiAgICAgICd1bmtub3duJyxcbiAgICAgIGBFbnRlcnByaXNlIGF1dGggZXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gLFxuICAgICAgcmVxdWVzdFxuICAgICk7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdFcnJvciBpbnRlcm5vIGRlIGF1dGVudGljYWNpw7NuJyxcbiAgICAgIGNvZGU6ICdJTlRFUk5BTF9BVVRIX0VSUk9SJyxcbiAgICAgIHN0YXR1czogNTAwXG4gICAgfTtcbiAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRlVOQ0lPTkVTIEFVWElMSUFSRVNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogT2J0aWVuZSBsYSBJUCBkZWwgY2xpZW50ZVxuICovXG5mdW5jdGlvbiBnZXRDbGllbnRJUChyZXF1ZXN0OiBOZXh0UmVxdWVzdCB8IE5leHRBcGlSZXF1ZXN0KTogc3RyaW5nIHtcbiAgaWYgKCdpcCcgaW4gcmVxdWVzdCAmJiByZXF1ZXN0LmlwKSB7XG4gICAgcmV0dXJuIHJlcXVlc3QuaXA7XG4gIH1cbiAgXG4gIGNvbnN0IGZvcndhcmRlZCA9IGdldEhlYWRlcihyZXF1ZXN0LCAneC1mb3J3YXJkZWQtZm9yJyk7XG4gIGNvbnN0IHJlYWxJUCA9IGdldEhlYWRlcihyZXF1ZXN0LCAneC1yZWFsLWlwJyk7XG4gIGNvbnN0IGNmSVAgPSBnZXRIZWFkZXIocmVxdWVzdCwgJ2NmLWNvbm5lY3RpbmctaXAnKTtcbiAgXG4gIHJldHVybiBmb3J3YXJkZWQ/LnNwbGl0KCcsJylbMF0gfHwgcmVhbElQIHx8IGNmSVAgfHwgJ3Vua25vd24nO1xufVxuXG4vKipcbiAqIE9idGllbmUgdW4gaGVhZGVyIGRlIG1hbmVyYSBjb21wYXRpYmxlXG4gKi9cbmZ1bmN0aW9uIGdldEhlYWRlcihyZXF1ZXN0OiBOZXh0UmVxdWVzdCB8IE5leHRBcGlSZXF1ZXN0LCBoZWFkZXJOYW1lOiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcbiAgaWYgKCdoZWFkZXJzJyBpbiByZXF1ZXN0ICYmIHR5cGVvZiByZXF1ZXN0LmhlYWRlcnMuZ2V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgcmV0dXJuIChyZXF1ZXN0IGFzIE5leHRSZXF1ZXN0KS5oZWFkZXJzLmdldChoZWFkZXJOYW1lKTtcbiAgfSBlbHNlIGlmICgnaGVhZGVycycgaW4gcmVxdWVzdCkge1xuICAgIGNvbnN0IGhlYWRlciA9IChyZXF1ZXN0IGFzIE5leHRBcGlSZXF1ZXN0KS5oZWFkZXJzW2hlYWRlck5hbWVdO1xuICAgIHJldHVybiBBcnJheS5pc0FycmF5KGhlYWRlcikgPyBoZWFkZXJbMF0gOiBoZWFkZXIgfHwgbnVsbDtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEZVTkNJT05FUyBERSBDT05WRU5JRU5DSUEgRU5URVJQUklTRVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBBdXRlbnRpY2FjacOzbiBwYXJhIG9wZXJhY2lvbmVzIGNyw610aWNhcyAoYWRtaW4sIHBhZ29zKVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZUNyaXRpY2FsQXV0aChcbiAgcmVxdWVzdDogTmV4dFJlcXVlc3QgfCBOZXh0QXBpUmVxdWVzdFxuKTogUHJvbWlzZTxFbnRlcnByaXNlQXV0aFJlc3VsdD4ge1xuICByZXR1cm4gZ2V0RW50ZXJwcmlzZUF1dGhDb250ZXh0KHJlcXVlc3QsIHsgc2VjdXJpdHlMZXZlbDogJ2NyaXRpY2FsJyB9KTtcbn1cblxuLyoqXG4gKiBBdXRlbnRpY2FjacOzbiBwYXJhIG9wZXJhY2lvbmVzIGRlIGFsdG8gbml2ZWwgKGdlc3Rpw7NuIGRlIGNvbnRlbmlkbylcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcXVpcmVIaWdoQXV0aChcbiAgcmVxdWVzdDogTmV4dFJlcXVlc3QgfCBOZXh0QXBpUmVxdWVzdCxcbiAgcmVxdWlyZWRQZXJtaXNzaW9ucz86IHN0cmluZ1tdXG4pOiBQcm9taXNlPEVudGVycHJpc2VBdXRoUmVzdWx0PiB7XG4gIHJldHVybiBnZXRFbnRlcnByaXNlQXV0aENvbnRleHQocmVxdWVzdCwge1xuICAgIHNlY3VyaXR5TGV2ZWw6ICdoaWdoJyxcbiAgICByZXF1aXJlZFBlcm1pc3Npb25zXG4gIH0pO1xufVxuXG4vKipcbiAqIEF1dGVudGljYWNpw7NuIHBhcmEgb3BlcmFjaW9uZXMgbW9kZXJhZGFzIChBUElzIGRlIHByb2R1Y3RvcylcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcXVpcmVNZWRpdW1BdXRoKFxuICByZXF1ZXN0OiBOZXh0UmVxdWVzdCB8IE5leHRBcGlSZXF1ZXN0XG4pOiBQcm9taXNlPEVudGVycHJpc2VBdXRoUmVzdWx0PiB7XG4gIHJldHVybiBnZXRFbnRlcnByaXNlQXV0aENvbnRleHQocmVxdWVzdCwgeyBzZWN1cml0eUxldmVsOiAnbWVkaXVtJyB9KTtcbn1cblxuLyoqXG4gKiBBdXRlbnRpY2FjacOzbiBiw6FzaWNhIHBhcmEgb3BlcmFjaW9uZXMgcMO6YmxpY2FzIGNvbiByYXRlIGxpbWl0aW5nXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlQmFzaWNBdXRoKFxuICByZXF1ZXN0OiBOZXh0UmVxdWVzdCB8IE5leHRBcGlSZXF1ZXN0XG4pOiBQcm9taXNlPEVudGVycHJpc2VBdXRoUmVzdWx0PiB7XG4gIHJldHVybiBnZXRFbnRlcnByaXNlQXV0aENvbnRleHQocmVxdWVzdCwgeyBzZWN1cml0eUxldmVsOiAnbG93JyB9KTtcbn1cblxuLyoqXG4gKiBBdXRlbnRpY2FjacOzbiBlc3BlY8OtZmljYSBwYXJhIGFkbWluIGNvbiBwZXJtaXNvcyBwZXJzb25hbGl6YWRvc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZUFkbWluQXV0aChcbiAgcmVxdWVzdDogTmV4dFJlcXVlc3QgfCBOZXh0QXBpUmVxdWVzdCxcbiAgcmVxdWlyZWRQZXJtaXNzaW9uczogc3RyaW5nW10gPSBbJ2FkbWluX2FjY2VzcyddXG4pOiBQcm9taXNlPEVudGVycHJpc2VBdXRoUmVzdWx0PiB7XG4gIC8vIEJZUEFTUyBURU1QT1JBTCBQQVJBIERFU0FSUk9MTE9cbiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnICYmIHByb2Nlc3MuZW52LkJZUEFTU19BVVRIID09PSAndHJ1ZScpIHtcbiAgICBjb25zb2xlLmxvZygnW0VudGVycHJpc2UgQXV0aF0gQllQQVNTIEFVVEggRU5BQkxFRCAtIHJlcXVpcmVBZG1pbkF1dGgnKTtcblxuICAgIGNvbnN0IHsgY3JlYXRlQ2xpZW50IH0gPSBhd2FpdCBpbXBvcnQoJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcycpO1xuICAgIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KFxuICAgICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMISxcbiAgICAgIHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkhXG4gICAgKTtcblxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgdXNlcjoge1xuICAgICAgICBpZDogJ2Rldi1hZG1pbicsXG4gICAgICAgIGVtYWlsOiAnc2FudGlhZ29AeG9yLmNvbS5hcicsXG4gICAgICAgIHJvbGU6ICdhZG1pbidcbiAgICAgIH0sXG4gICAgICBzdXBhYmFzZSxcbiAgICAgIGNvbnRleHQ6IHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiAnZGV2LWFkbWluJyxcbiAgICAgICAgICBlbWFpbDogJ3NhbnRpYWdvQHhvci5jb20uYXInLFxuICAgICAgICAgIHJvbGU6ICdhZG1pbidcbiAgICAgICAgfSxcbiAgICAgICAgcGVybWlzc2lvbnM6IHJlcXVpcmVkUGVybWlzc2lvbnMsXG4gICAgICAgIG1ldGFkYXRhOiB7IGJ5cGFzczogdHJ1ZSB9XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiBnZXRFbnRlcnByaXNlQXV0aENvbnRleHQocmVxdWVzdCwge1xuICAgIHJlcXVpcmVkUm9sZTogJ2FkbWluJyxcbiAgICByZXF1aXJlZFBlcm1pc3Npb25zLFxuICAgIHNlY3VyaXR5TGV2ZWw6ICdjcml0aWNhbCcsXG4gICAgZW5hYmxlUmF0ZUxpbWl0OiB0cnVlLFxuICAgIGVuYWJsZUNTUkZQcm90ZWN0aW9uOiB0cnVlLFxuICAgIGVuYWJsZUpXVFZhbGlkYXRpb246IHRydWUsXG4gICAgcmF0ZUxpbWl0VHlwZTogJ2FkbWluJ1xuICB9KTtcbn1cblxuLyoqXG4gKiBBdXRlbnRpY2FjacOzbiBwYXJhIEFQSXMgZGUgcGFnb3MgY29uIG3DoXhpbWEgc2VndXJpZGFkXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlUGF5bWVudEF1dGgoXG4gIHJlcXVlc3Q6IE5leHRSZXF1ZXN0IHwgTmV4dEFwaVJlcXVlc3Rcbik6IFByb21pc2U8RW50ZXJwcmlzZUF1dGhSZXN1bHQ+IHtcbiAgcmV0dXJuIGdldEVudGVycHJpc2VBdXRoQ29udGV4dChyZXF1ZXN0LCB7XG4gICAgc2VjdXJpdHlMZXZlbDogJ2NyaXRpY2FsJyxcbiAgICBlbmFibGVSYXRlTGltaXQ6IHRydWUsXG4gICAgZW5hYmxlQ1NSRlByb3RlY3Rpb246IHRydWUsXG4gICAgZW5hYmxlSldUVmFsaWRhdGlvbjogdHJ1ZSxcbiAgICByYXRlTGltaXRUeXBlOiAncGF5bWVudHMnLFxuICAgIHJlcXVpcmVkUGVybWlzc2lvbnM6IFsncGF5bWVudF9hY2Nlc3MnXVxuICB9KTtcbn1cblxuLyoqXG4gKiBNaWRkbGV3YXJlIGVudGVycHJpc2UgcXVlIG1hbmVqYSBhdXRvbcOhdGljYW1lbnRlIGVycm9yZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhFbnRlcnByaXNlQXV0aChcbiAgYXV0aEZ1bmN0aW9uOiAocmVxdWVzdDogTmV4dFJlcXVlc3QgfCBOZXh0QXBpUmVxdWVzdCkgPT4gUHJvbWlzZTxFbnRlcnByaXNlQXV0aFJlc3VsdD5cbikge1xuICByZXR1cm4gZnVuY3Rpb24gKGhhbmRsZXI6IEZ1bmN0aW9uKSB7XG4gICAgcmV0dXJuIGFzeW5jIChyZXF1ZXN0OiBOZXh0UmVxdWVzdCB8IE5leHRBcGlSZXF1ZXN0LCAuLi5hcmdzOiBhbnlbXSkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgYXV0aFJlc3VsdCA9IGF3YWl0IGF1dGhGdW5jdGlvbihyZXF1ZXN0KTtcblxuICAgICAgICBpZiAoIWF1dGhSZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgIGNvbnN0IGVycm9yUmVzcG9uc2UgPSB7XG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIGVycm9yOiBhdXRoUmVzdWx0LmVycm9yLFxuICAgICAgICAgICAgY29kZTogYXV0aFJlc3VsdC5jb2RlLFxuICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICBlbnRlcnByaXNlOiB0cnVlXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGNvbnN0IGhlYWRlcnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGlmIChhdXRoUmVzdWx0LnJldHJ5QWZ0ZXIpIHtcbiAgICAgICAgICAgIGhlYWRlcnNbJ1JldHJ5LUFmdGVyJ10gPSBhdXRoUmVzdWx0LnJldHJ5QWZ0ZXIudG9TdHJpbmcoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoJ3F1ZXJ5JyBpbiByZXF1ZXN0KSB7XG4gICAgICAgICAgICAvLyBQYWdlcyBSb3V0ZXJcbiAgICAgICAgICAgIGNvbnN0IHJlcyA9IGFyZ3NbMF0gYXMgYW55O1xuICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMoaGVhZGVycykuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgICAgICAgIHJlcy5zZXRIZWFkZXIoa2V5LCB2YWx1ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKGF1dGhSZXN1bHQuc3RhdHVzIHx8IDQwMSkuanNvbihlcnJvclJlc3BvbnNlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gQXBwIFJvdXRlclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShKU09OLnN0cmluZ2lmeShlcnJvclJlc3BvbnNlKSwge1xuICAgICAgICAgICAgICBzdGF0dXM6IGF1dGhSZXN1bHQuc3RhdHVzIHx8IDQwMSxcbiAgICAgICAgICAgICAgaGVhZGVyc1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQcOxYWRpciBjb250ZXh0byBlbnRlcnByaXNlIGFsIHJlcXVlc3RcbiAgICAgICAgKHJlcXVlc3QgYXMgYW55KS5lbnRlcnByaXNlQXV0aCA9IGF1dGhSZXN1bHQuY29udGV4dDtcblxuICAgICAgICByZXR1cm4gaGFuZGxlcihyZXF1ZXN0LCAuLi5hcmdzKTtcblxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignW0VOVEVSUFJJU0VfQVVUSF0gRXJyb3IgZW4gbWlkZGxld2FyZTonLCBlcnJvcik7XG5cbiAgICAgICAgY29uc3QgZXJyb3JSZXNwb25zZSA9IHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogJ0Vycm9yIGludGVybm8gZGUgYXV0ZW50aWNhY2nDs24gZW50ZXJwcmlzZScsXG4gICAgICAgICAgY29kZTogJ0VOVEVSUFJJU0VfQVVUSF9FUlJPUicsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoJ3F1ZXJ5JyBpbiByZXF1ZXN0KSB7XG4gICAgICAgICAgLy8gUGFnZXMgUm91dGVyXG4gICAgICAgICAgY29uc3QgcmVzID0gYXJnc1swXSBhcyBhbnk7XG4gICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKGVycm9yUmVzcG9uc2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIEFwcCBSb3V0ZXJcbiAgICAgICAgICByZXR1cm4gbmV3IFJlc3BvbnNlKEpTT04uc3RyaW5naWZ5KGVycm9yUmVzcG9uc2UpLCB7XG4gICAgICAgICAgICBzdGF0dXM6IDUwMCxcbiAgICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICB9O1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gTUlERExFV0FSRVMgUFJFREVGSU5JRE9TIEVOVEVSUFJJU0Vcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogTWlkZGxld2FyZSBwYXJhIG9wZXJhY2lvbmVzIGNyw610aWNhc1xuICovXG5leHBvcnQgY29uc3Qgd2l0aENyaXRpY2FsQXV0aCA9ICgpID0+IHdpdGhFbnRlcnByaXNlQXV0aChyZXF1aXJlQ3JpdGljYWxBdXRoKTtcblxuLyoqXG4gKiBNaWRkbGV3YXJlIHBhcmEgb3BlcmFjaW9uZXMgZGUgYWx0byBuaXZlbFxuICovXG5leHBvcnQgY29uc3Qgd2l0aEhpZ2hBdXRoID0gKHJlcXVpcmVkUGVybWlzc2lvbnM/OiBzdHJpbmdbXSkgPT5cbiAgd2l0aEVudGVycHJpc2VBdXRoKChyZXEpID0+IHJlcXVpcmVIaWdoQXV0aChyZXEsIHJlcXVpcmVkUGVybWlzc2lvbnMpKTtcblxuLyoqXG4gKiBNaWRkbGV3YXJlIHBhcmEgb3BlcmFjaW9uZXMgbW9kZXJhZGFzXG4gKi9cbmV4cG9ydCBjb25zdCB3aXRoTWVkaXVtQXV0aCA9ICgpID0+IHdpdGhFbnRlcnByaXNlQXV0aChyZXF1aXJlTWVkaXVtQXV0aCk7XG5cbi8qKlxuICogTWlkZGxld2FyZSBwYXJhIG9wZXJhY2lvbmVzIGLDoXNpY2FzXG4gKi9cbmV4cG9ydCBjb25zdCB3aXRoQmFzaWNBdXRoID0gKCkgPT4gd2l0aEVudGVycHJpc2VBdXRoKHJlcXVpcmVCYXNpY0F1dGgpO1xuXG4vKipcbiAqIE1pZGRsZXdhcmUgcGFyYSBhZG1pblxuICovXG5leHBvcnQgY29uc3Qgd2l0aEFkbWluQXV0aCA9IChyZXF1aXJlZFBlcm1pc3Npb25zPzogc3RyaW5nW10pID0+XG4gIHdpdGhFbnRlcnByaXNlQXV0aCgocmVxKSA9PiByZXF1aXJlQWRtaW5BdXRoKHJlcSwgcmVxdWlyZWRQZXJtaXNzaW9ucykpO1xuXG4vKipcbiAqIE1pZGRsZXdhcmUgcGFyYSBwYWdvc1xuICovXG5leHBvcnQgY29uc3Qgd2l0aFBheW1lbnRBdXRoID0gKCkgPT4gd2l0aEVudGVycHJpc2VBdXRoKHJlcXVpcmVQYXltZW50QXV0aCk7XG4iXSwibmFtZXMiOlsiZ2V0RW50ZXJwcmlzZUF1dGhDb250ZXh0IiwicmVxdWlyZUFkbWluQXV0aCIsInJlcXVpcmVCYXNpY0F1dGgiLCJyZXF1aXJlQ3JpdGljYWxBdXRoIiwicmVxdWlyZUhpZ2hBdXRoIiwicmVxdWlyZU1lZGl1bUF1dGgiLCJyZXF1aXJlUGF5bWVudEF1dGgiLCJ3aXRoQWRtaW5BdXRoIiwid2l0aEJhc2ljQXV0aCIsIndpdGhDcml0aWNhbEF1dGgiLCJ3aXRoRW50ZXJwcmlzZUF1dGgiLCJ3aXRoSGlnaEF1dGgiLCJ3aXRoTWVkaXVtQXV0aCIsIndpdGhQYXltZW50QXV0aCIsIkVOVEVSUFJJU0VfQ09ORklHUyIsImNyaXRpY2FsIiwicmVxdWlyZWRSb2xlIiwic2VjdXJpdHlMZXZlbCIsImVuYWJsZVJhdGVMaW1pdCIsImVuYWJsZUNTUkZQcm90ZWN0aW9uIiwiZW5hYmxlSldUVmFsaWRhdGlvbiIsInJhdGVMaW1pdFR5cGUiLCJyZXF1aXJlZFBlcm1pc3Npb25zIiwiaGlnaCIsIm1lZGl1bSIsImxvdyIsInJlcXVlc3QiLCJvcHRpb25zIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwiQllQQVNTX0FVVEgiLCJzdWNjZXNzIiwiY29udGV4dCIsInVzZXJJZCIsInNlc3Npb25JZCIsImVtYWlsIiwicm9sZSIsInBlcm1pc3Npb25zIiwic2Vzc2lvblZhbGlkIiwic3VwYWJhc2UiLCJzdXBhYmFzZUFkbWluIiwidmFsaWRhdGlvbnMiLCJqd3RWYWxpZCIsImNzcmZWYWxpZCIsInJhdGVMaW1pdFBhc3NlZCIsIm9yaWdpblZhbGlkIiwidXNlciIsImlkIiwibmFtZSIsInN0YXJ0VGltZSIsIkRhdGUiLCJub3ciLCJjb25maWciLCJyYXRlTGltaXRSZXN1bHQiLCJjaGVja1JhdGVMaW1pdCIsIlJBVEVfTElNSVRfQ09ORklHUyIsImFsbG93ZWQiLCJsb2dBdXRoRmFpbHVyZSIsImVycm9yIiwiY29kZSIsInN0YXR1cyIsInJldHJ5QWZ0ZXIiLCJjc3JmUmVzdWx0IiwidmFsaWRhdGVSZXF1ZXN0T3JpZ2luIiwidmFsaWQiLCJ1c2VyRW1haWwiLCJzZXNzaW9uIiwiYXV0aCIsImp3dFJlc3VsdCIsInZhbGlkYXRlSldUSW50ZWdyaXR5IiwicGVybWlzc2lvblJlc3VsdCIsInZhbGlkYXRlSldUUGVybWlzc2lvbnMiLCJsb2dQZXJtaXNzaW9uRGVuaWVkIiwiZGF0YSIsInVzZXJQcm9maWxlIiwidXNlckVycm9yIiwiZnJvbSIsInNlbGVjdCIsImVxIiwic2luZ2xlIiwiY29uc29sZSIsInVzZXJSb2xlIiwidXNlclBlcm1pc3Npb25zIiwibGVuZ3RoIiwiaGFzQWxsUGVybWlzc2lvbnMiLCJldmVyeSIsInBlcm1pc3Npb24iLCJpbmNsdWRlcyIsImpvaW4iLCJpcEFkZHJlc3MiLCJnZXRDbGllbnRJUCIsInVzZXJBZ2VudCIsImdldEhlYWRlciIsInNlc3Npb25NZXRhZGF0YSIsIm1ldGFkYXRhIiwibG9nQXV0aFN1Y2Nlc3MiLCJpcF9hZGRyZXNzIiwidXNlcl9hZ2VudCIsInNlc3Npb25faWQiLCJzZWN1cml0eV9sZXZlbCIsImR1cmF0aW9uIiwibG9nIiwibWVzc2FnZSIsImlwIiwiZm9yd2FyZGVkIiwicmVhbElQIiwiY2ZJUCIsInNwbGl0IiwiaGVhZGVyTmFtZSIsImhlYWRlcnMiLCJnZXQiLCJoZWFkZXIiLCJBcnJheSIsImlzQXJyYXkiLCJjcmVhdGVDbGllbnQiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiYnlwYXNzIiwiYXV0aEZ1bmN0aW9uIiwiaGFuZGxlciIsImFyZ3MiLCJhdXRoUmVzdWx0IiwiZXJyb3JSZXNwb25zZSIsInRpbWVzdGFtcCIsInRvSVNPU3RyaW5nIiwiZW50ZXJwcmlzZSIsInRvU3RyaW5nIiwicmVzIiwiT2JqZWN0IiwiZW50cmllcyIsImZvckVhY2giLCJrZXkiLCJ2YWx1ZSIsInNldEhlYWRlciIsImpzb24iLCJSZXNwb25zZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlbnRlcnByaXNlQXV0aCIsInJlcSJdLCJtYXBwaW5ncyI6IkFBQUE7OztDQUdDOzs7Ozs7Ozs7OztRQW9IcUJBO2VBQUFBOztRQXFXQUM7ZUFBQUE7O1FBVEFDO2VBQUFBOztRQS9CQUM7ZUFBQUE7O1FBU0FDO2VBQUFBOztRQWFBQztlQUFBQTs7UUFrRUFDO2VBQUFBOztRQW9IVEM7ZUFBQUE7O1FBTEFDO2VBQUFBOztRQWhCQUM7ZUFBQUE7O1FBL0VHQztlQUFBQTs7UUFvRkhDO2VBQUFBOztRQU1BQztlQUFBQTs7UUFnQkFDO2VBQUFBOzs7c0JBL25CUTswQkFDUzsrQkFDK0I7Z0NBQ3ZCOzhCQUNhOytCQUNpQjs7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