3b8c077e87f07f28cfd23077e1a67efc
// ===================================
// TESTS PARA HOOK DE AUTENTICACIÓN
// Tests unitarios e integración para useAuth
// ===================================
"use strict";
// Mocks
jest.mock('next-auth/react');
jest.mock('sonner', ()=>({
        toast: {
            success: jest.fn(),
            error: jest.fn(),
            loading: jest.fn()
        }
    }));
jest.mock('next/navigation', ()=>({
        useRouter: jest.fn()
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("@testing-library/react");
const _reactquery = require("@tanstack/react-query");
const _useAuth = require("../../hooks/useAuth");
const _react1 = require("next-auth/react");
const _navigation = require("next/navigation");
const _react2 = /*#__PURE__*/ _interop_require_default(require("react"));
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
const mockRouter = {
    push: jest.fn(),
    replace: jest.fn(),
    refresh: jest.fn()
};
// Wrapper para React Query
const createWrapper = ()=>{
    const queryClient = new _reactquery.QueryClient({
        defaultOptions: {
            queries: {
                retry: false
            }
        }
    });
    return ({ children })=>/*#__PURE__*/ (0, _jsxruntime.jsx)(_reactquery.QueryClientProvider, {
            client: queryClient,
            children: children
        });
};
describe('useAuth Hook', ()=>{
    beforeEach(()=>{
        jest.clearAllMocks();
        _navigation.useRouter.mockReturnValue(mockRouter);
        // Mock default NextAuth session
        _react1.useSession.mockReturnValue({
            data: {
                user: {
                    id: 'test-user-id',
                    email: 'test@example.com',
                    name: 'Test User',
                    image: 'https://example.com/avatar.jpg'
                },
                expires: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString()
            },
            status: 'authenticated'
        });
    });
    describe('Autenticación con NextAuth', ()=>{
        it('debe iniciar sesión exitosamente', async ()=>{
            _react1.signIn.mockResolvedValue({
                ok: true,
                error: null
            });
            const { result } = (0, _react.renderHook)(()=>(0, _useAuth.useAuth)(), {
                wrapper: createWrapper()
            });
            await (0, _react.act)(async ()=>{
                await result.current.signIn('google', {
                    callbackUrl: '/dashboard'
                });
            });
            expect(_react1.signIn).toHaveBeenCalledWith('google', {
                callbackUrl: '/dashboard'
            });
        });
        it('debe cerrar sesión exitosamente', async ()=>{
            _react1.signOut.mockResolvedValue({
                url: '/api/auth/signin'
            });
            const { result } = (0, _react.renderHook)(()=>(0, _useAuth.useAuth)(), {
                wrapper: createWrapper()
            });
            await (0, _react.act)(async ()=>{
                await result.current.signOut({
                    callbackUrl: '/'
                });
            });
            expect(_react1.signOut).toHaveBeenCalledWith({
                callbackUrl: '/'
            });
        });
        it('debe retornar información del usuario autenticado', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _useAuth.useAuth)(), {
                wrapper: createWrapper()
            });
            expect(result.current.user).toEqual({
                id: 'test-user-id',
                email: 'test@example.com',
                name: 'Test User',
                image: 'https://example.com/avatar.jpg'
            });
            expect(result.current.isSignedIn).toBe(true);
            expect(result.current.isLoaded).toBe(true);
        });
        it('debe manejar estado de carga', ()=>{
            _react1.useSession.mockReturnValue({
                data: null,
                status: 'loading'
            });
            const { result } = (0, _react.renderHook)(()=>(0, _useAuth.useAuth)(), {
                wrapper: createWrapper()
            });
            expect(result.current.isLoaded).toBe(false);
            expect(result.current.isSignedIn).toBe(false);
            expect(result.current.user).toBeNull();
        });
        it('debe manejar estado no autenticado', ()=>{
            _react1.useSession.mockReturnValue({
                data: null,
                status: 'unauthenticated'
            });
            const { result } = (0, _react.renderHook)(()=>(0, _useAuth.useAuth)(), {
                wrapper: createWrapper()
            });
            expect(result.current.isLoaded).toBe(true);
            expect(result.current.isSignedIn).toBe(false);
            expect(result.current.user).toBeNull();
        });
    });
    describe('Hooks de utilidad', ()=>{
        it('useIsAdmin debe retornar false para usuario normal', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _useAuth.useAuth)(), {
                wrapper: createWrapper()
            });
            // useIsAdmin está incluido en el hook useAuth
            expect(result.current.user?.email).toBe('test@example.com');
        });
        it('useRequireAuth debe redirigir si no está autenticado', async ()=>{
            _react1.useSession.mockReturnValue({
                data: null,
                status: 'unauthenticated'
            });
            const { result } = (0, _react.renderHook)(()=>(0, _useAuth.useAuth)(), {
                wrapper: createWrapper()
            });
            expect(result.current.isSignedIn).toBe(false);
        });
    });
    describe('Manejo de errores', ()=>{
        it('debe manejar error en signIn', async ()=>{
            _react1.signIn.mockResolvedValue({
                ok: false,
                error: 'Authentication failed'
            });
            const { result } = (0, _react.renderHook)(()=>(0, _useAuth.useAuth)(), {
                wrapper: createWrapper()
            });
            await (0, _react.act)(async ()=>{
                await result.current.signIn('google');
            });
            expect(_react1.signIn).toHaveBeenCalledWith('google', {
                callbackUrl: '/'
            });
        });
        it('debe manejar error en signOut', async ()=>{
            _react1.signOut.mockRejectedValue(new Error('Sign out failed'));
            const { result } = (0, _react.renderHook)(()=>(0, _useAuth.useAuth)(), {
                wrapper: createWrapper()
            });
            await (0, _react.act)(async ()=>{
                try {
                    await result.current.signOut();
                } catch (error) {
                    expect(error).toBeInstanceOf(Error);
                }
            });
            expect(_react1.signOut).toHaveBeenCalled();
        });
    });
    describe('Integración con Router', ()=>{
        it('debe usar el router correctamente', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _useAuth.useAuth)(), {
                wrapper: createWrapper()
            });
            // El hook debe tener acceso al router
            expect(result.current).toBeDefined();
            expect(typeof result.current.signIn).toBe('function');
            expect(typeof result.current.signOut).toBe('function');
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcX190ZXN0c19fXFxob29rc1xcdXNlQXV0aC50ZXN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gVEVTVFMgUEFSQSBIT09LIERFIEFVVEVOVElDQUNJw5NOXG4vLyBUZXN0cyB1bml0YXJpb3MgZSBpbnRlZ3JhY2nDs24gcGFyYSB1c2VBdXRoXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgeyByZW5kZXJIb29rLCBhY3QsIHdhaXRGb3IgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0JztcbmltcG9ydCB7IFF1ZXJ5Q2xpZW50LCBRdWVyeUNsaWVudFByb3ZpZGVyIH0gZnJvbSAnQHRhbnN0YWNrL3JlYWN0LXF1ZXJ5JztcbmltcG9ydCB7IHVzZUF1dGggfSBmcm9tICdAL2hvb2tzL3VzZUF1dGgnO1xuaW1wb3J0IHsgdXNlU2Vzc2lvbiwgc2lnbkluLCBzaWduT3V0IH0gZnJvbSAnbmV4dC1hdXRoL3JlYWN0JztcbmltcG9ydCB7IHRvYXN0IH0gZnJvbSAnc29ubmVyJztcbmltcG9ydCB7IHVzZVJvdXRlciB9IGZyb20gJ25leHQvbmF2aWdhdGlvbic7XG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG4vLyBNb2Nrc1xuamVzdC5tb2NrKCduZXh0LWF1dGgvcmVhY3QnKTtcbmplc3QubW9jaygnc29ubmVyJywgKCkgPT4gKHtcbiAgdG9hc3Q6IHtcbiAgICBzdWNjZXNzOiBqZXN0LmZuKCksXG4gICAgZXJyb3I6IGplc3QuZm4oKSxcbiAgICBsb2FkaW5nOiBqZXN0LmZuKClcbiAgfVxufSkpO1xuXG5qZXN0Lm1vY2soJ25leHQvbmF2aWdhdGlvbicsICgpID0+ICh7XG4gIHVzZVJvdXRlcjogamVzdC5mbigpXG59KSk7XG5cbmNvbnN0IG1vY2tSb3V0ZXIgPSB7XG4gIHB1c2g6IGplc3QuZm4oKSxcbiAgcmVwbGFjZTogamVzdC5mbigpLFxuICByZWZyZXNoOiBqZXN0LmZuKClcbn07XG5cbi8vIFdyYXBwZXIgcGFyYSBSZWFjdCBRdWVyeVxuY29uc3QgY3JlYXRlV3JhcHBlciA9ICgpID0+IHtcbiAgY29uc3QgcXVlcnlDbGllbnQgPSBuZXcgUXVlcnlDbGllbnQoe1xuICAgIGRlZmF1bHRPcHRpb25zOiB7XG4gICAgICBxdWVyaWVzOiB7XG4gICAgICAgIHJldHJ5OiBmYWxzZSxcbiAgICAgIH0sXG4gICAgfSxcbiAgfSk7XG4gIFxuICByZXR1cm4gKHsgY2hpbGRyZW4gfTogeyBjaGlsZHJlbjogUmVhY3QuUmVhY3ROb2RlIH0pID0+IChcbiAgICA8UXVlcnlDbGllbnRQcm92aWRlciBjbGllbnQ9e3F1ZXJ5Q2xpZW50fT57Y2hpbGRyZW59PC9RdWVyeUNsaWVudFByb3ZpZGVyPlxuICApO1xufTtcblxuZGVzY3JpYmUoJ3VzZUF1dGggSG9vaycsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgKHVzZVJvdXRlciBhcyBqZXN0Lk1vY2spLm1vY2tSZXR1cm5WYWx1ZShtb2NrUm91dGVyKTtcbiAgICBcbiAgICAvLyBNb2NrIGRlZmF1bHQgTmV4dEF1dGggc2Vzc2lvblxuICAgICh1c2VTZXNzaW9uIGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlKHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiAndGVzdC11c2VyLWlkJyxcbiAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICAgIG5hbWU6ICdUZXN0IFVzZXInLFxuICAgICAgICAgIGltYWdlOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS9hdmF0YXIuanBnJyxcbiAgICAgICAgfSxcbiAgICAgICAgZXhwaXJlczogbmV3IERhdGUoRGF0ZS5ub3coKSArIDI0ICogNjAgKiA2MCAqIDEwMDApLnRvSVNPU3RyaW5nKCksXG4gICAgICB9LFxuICAgICAgc3RhdHVzOiAnYXV0aGVudGljYXRlZCcsXG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdBdXRlbnRpY2FjacOzbiBjb24gTmV4dEF1dGgnLCAoKSA9PiB7XG4gICAgaXQoJ2RlYmUgaW5pY2lhciBzZXNpw7NuIGV4aXRvc2FtZW50ZScsIGFzeW5jICgpID0+IHtcbiAgICAgIChzaWduSW4gYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IG9rOiB0cnVlLCBlcnJvcjogbnVsbCB9KTtcblxuICAgICAgY29uc3QgeyByZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT4gdXNlQXV0aCgpLCB7XG4gICAgICAgIHdyYXBwZXI6IGNyZWF0ZVdyYXBwZXIoKVxuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IGFjdChhc3luYyAoKSA9PiB7XG4gICAgICAgIGF3YWl0IHJlc3VsdC5jdXJyZW50LnNpZ25JbignZ29vZ2xlJywgeyBjYWxsYmFja1VybDogJy9kYXNoYm9hcmQnIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChzaWduSW4pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdnb29nbGUnLCB7XG4gICAgICAgIGNhbGxiYWNrVXJsOiAnL2Rhc2hib2FyZCcsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdkZWJlIGNlcnJhciBzZXNpw7NuIGV4aXRvc2FtZW50ZScsIGFzeW5jICgpID0+IHtcbiAgICAgIChzaWduT3V0IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoeyB1cmw6ICcvYXBpL2F1dGgvc2lnbmluJyB9KTtcblxuICAgICAgY29uc3QgeyByZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT4gdXNlQXV0aCgpLCB7XG4gICAgICAgIHdyYXBwZXI6IGNyZWF0ZVdyYXBwZXIoKVxuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IGFjdChhc3luYyAoKSA9PiB7XG4gICAgICAgIGF3YWl0IHJlc3VsdC5jdXJyZW50LnNpZ25PdXQoeyBjYWxsYmFja1VybDogJy8nIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChzaWduT3V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGNhbGxiYWNrVXJsOiAnLycsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdkZWJlIHJldG9ybmFyIGluZm9ybWFjacOzbiBkZWwgdXN1YXJpbyBhdXRlbnRpY2FkbycsICgpID0+IHtcbiAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZUF1dGgoKSwge1xuICAgICAgICB3cmFwcGVyOiBjcmVhdGVXcmFwcGVyKClcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQudXNlcikudG9FcXVhbCh7XG4gICAgICAgIGlkOiAndGVzdC11c2VyLWlkJyxcbiAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgbmFtZTogJ1Rlc3QgVXNlcicsXG4gICAgICAgIGltYWdlOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS9hdmF0YXIuanBnJyxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LmlzU2lnbmVkSW4pLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQuaXNMb2FkZWQpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGViZSBtYW5lamFyIGVzdGFkbyBkZSBjYXJnYScsICgpID0+IHtcbiAgICAgICh1c2VTZXNzaW9uIGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgc3RhdHVzOiAnbG9hZGluZycsXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgeyByZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT4gdXNlQXV0aCgpLCB7XG4gICAgICAgIHdyYXBwZXI6IGNyZWF0ZVdyYXBwZXIoKVxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5pc0xvYWRlZCkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQuaXNTaWduZWRJbikudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQudXNlcikudG9CZU51bGwoKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZWJlIG1hbmVqYXIgZXN0YWRvIG5vIGF1dGVudGljYWRvJywgKCkgPT4ge1xuICAgICAgKHVzZVNlc3Npb24gYXMgamVzdC5Nb2NrKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICBzdGF0dXM6ICd1bmF1dGhlbnRpY2F0ZWQnLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZUF1dGgoKSwge1xuICAgICAgICB3cmFwcGVyOiBjcmVhdGVXcmFwcGVyKClcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQuaXNMb2FkZWQpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQuaXNTaWduZWRJbikudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQudXNlcikudG9CZU51bGwoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0hvb2tzIGRlIHV0aWxpZGFkJywgKCkgPT4ge1xuICAgIGl0KCd1c2VJc0FkbWluIGRlYmUgcmV0b3JuYXIgZmFsc2UgcGFyYSB1c3VhcmlvIG5vcm1hbCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZUF1dGgoKSwge1xuICAgICAgICB3cmFwcGVyOiBjcmVhdGVXcmFwcGVyKClcbiAgICAgIH0pO1xuXG4gICAgICAvLyB1c2VJc0FkbWluIGVzdMOhIGluY2x1aWRvIGVuIGVsIGhvb2sgdXNlQXV0aFxuICAgICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LnVzZXI/LmVtYWlsKS50b0JlKCd0ZXN0QGV4YW1wbGUuY29tJyk7XG4gICAgfSk7XG5cbiAgICBpdCgndXNlUmVxdWlyZUF1dGggZGViZSByZWRpcmlnaXIgc2kgbm8gZXN0w6EgYXV0ZW50aWNhZG8nLCBhc3luYyAoKSA9PiB7XG4gICAgICAodXNlU2Vzc2lvbiBhcyBqZXN0Lk1vY2spLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgIHN0YXR1czogJ3VuYXV0aGVudGljYXRlZCcsXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgeyByZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT4gdXNlQXV0aCgpLCB7XG4gICAgICAgIHdyYXBwZXI6IGNyZWF0ZVdyYXBwZXIoKVxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5pc1NpZ25lZEluKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ01hbmVqbyBkZSBlcnJvcmVzJywgKCkgPT4ge1xuICAgIGl0KCdkZWJlIG1hbmVqYXIgZXJyb3IgZW4gc2lnbkluJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKHNpZ25JbiBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHsgb2s6IGZhbHNlLCBlcnJvcjogJ0F1dGhlbnRpY2F0aW9uIGZhaWxlZCcgfSk7XG5cbiAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZUF1dGgoKSwge1xuICAgICAgICB3cmFwcGVyOiBjcmVhdGVXcmFwcGVyKClcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBhY3QoYXN5bmMgKCkgPT4ge1xuICAgICAgICBhd2FpdCByZXN1bHQuY3VycmVudC5zaWduSW4oJ2dvb2dsZScpO1xuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChzaWduSW4pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdnb29nbGUnLCB7XG4gICAgICAgIGNhbGxiYWNrVXJsOiAnLycsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdkZWJlIG1hbmVqYXIgZXJyb3IgZW4gc2lnbk91dCcsIGFzeW5jICgpID0+IHtcbiAgICAgIChzaWduT3V0IGFzIGplc3QuTW9jaykubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdTaWduIG91dCBmYWlsZWQnKSk7XG5cbiAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZUF1dGgoKSwge1xuICAgICAgICB3cmFwcGVyOiBjcmVhdGVXcmFwcGVyKClcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBhY3QoYXN5bmMgKCkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IHJlc3VsdC5jdXJyZW50LnNpZ25PdXQoKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBleHBlY3QoZXJyb3IpLnRvQmVJbnN0YW5jZU9mKEVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChzaWduT3V0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdJbnRlZ3JhY2nDs24gY29uIFJvdXRlcicsICgpID0+IHtcbiAgICBpdCgnZGViZSB1c2FyIGVsIHJvdXRlciBjb3JyZWN0YW1lbnRlJywgKCkgPT4ge1xuICAgICAgY29uc3QgeyByZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT4gdXNlQXV0aCgpLCB7XG4gICAgICAgIHdyYXBwZXI6IGNyZWF0ZVdyYXBwZXIoKVxuICAgICAgfSk7XG5cbiAgICAgIC8vIEVsIGhvb2sgZGViZSB0ZW5lciBhY2Nlc28gYWwgcm91dGVyXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodHlwZW9mIHJlc3VsdC5jdXJyZW50LnNpZ25JbikudG9CZSgnZnVuY3Rpb24nKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgcmVzdWx0LmN1cnJlbnQuc2lnbk91dCkudG9CZSgnZnVuY3Rpb24nKTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwibmFtZXMiOlsiamVzdCIsIm1vY2siLCJ0b2FzdCIsInN1Y2Nlc3MiLCJmbiIsImVycm9yIiwibG9hZGluZyIsInVzZVJvdXRlciIsIm1vY2tSb3V0ZXIiLCJwdXNoIiwicmVwbGFjZSIsInJlZnJlc2giLCJjcmVhdGVXcmFwcGVyIiwicXVlcnlDbGllbnQiLCJRdWVyeUNsaWVudCIsImRlZmF1bHRPcHRpb25zIiwicXVlcmllcyIsInJldHJ5IiwiY2hpbGRyZW4iLCJRdWVyeUNsaWVudFByb3ZpZGVyIiwiY2xpZW50IiwiZGVzY3JpYmUiLCJiZWZvcmVFYWNoIiwiY2xlYXJBbGxNb2NrcyIsIm1vY2tSZXR1cm5WYWx1ZSIsInVzZVNlc3Npb24iLCJkYXRhIiwidXNlciIsImlkIiwiZW1haWwiLCJuYW1lIiwiaW1hZ2UiLCJleHBpcmVzIiwiRGF0ZSIsIm5vdyIsInRvSVNPU3RyaW5nIiwic3RhdHVzIiwiaXQiLCJzaWduSW4iLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsIm9rIiwicmVzdWx0IiwicmVuZGVySG9vayIsInVzZUF1dGgiLCJ3cmFwcGVyIiwiYWN0IiwiY3VycmVudCIsImNhbGxiYWNrVXJsIiwiZXhwZWN0IiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJzaWduT3V0IiwidXJsIiwidG9FcXVhbCIsImlzU2lnbmVkSW4iLCJ0b0JlIiwiaXNMb2FkZWQiLCJ0b0JlTnVsbCIsIm1vY2tSZWplY3RlZFZhbHVlIiwiRXJyb3IiLCJ0b0JlSW5zdGFuY2VPZiIsInRvSGF2ZUJlZW5DYWxsZWQiLCJ0b0JlRGVmaW5lZCJdLCJtYXBwaW5ncyI6IkFBQUEsc0NBQXNDO0FBQ3RDLG1DQUFtQztBQUNuQyw2Q0FBNkM7QUFDN0Msc0NBQXNDOztBQVV0QyxRQUFRO0FBQ1JBLEtBQUtDLElBQUksQ0FBQztBQUNWRCxLQUFLQyxJQUFJLENB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