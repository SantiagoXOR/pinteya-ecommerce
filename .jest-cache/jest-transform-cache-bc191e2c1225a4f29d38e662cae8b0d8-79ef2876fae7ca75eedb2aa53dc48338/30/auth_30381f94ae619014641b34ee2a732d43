0b1342295e5a34752d31b6d26973fc42
/**
 * NextAuth.js v5 Configuration for Pinteya E-commerce
 * Configuración optimizada para producción con Google OAuth
 * Migración completa desde Clerk a NextAuth.js
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get auth () {
        return auth;
    },
    get handlers () {
        return handlers;
    },
    get signIn () {
        return signIn;
    },
    get signOut () {
        return signOut;
    }
});
const _nextauth = /*#__PURE__*/ _interop_require_default(require("next-auth"));
const _google = /*#__PURE__*/ _interop_require_default(require("next-auth/providers/google"));
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
const { handlers, auth, signIn, signOut } = (0, _nextauth.default)({
    // Configuración de providers con validación
    providers: [
        (0, _google.default)({
            clientId: process.env.AUTH_GOOGLE_ID,
            clientSecret: process.env.AUTH_GOOGLE_SECRET,
            authorization: {
                params: {
                    prompt: "consent",
                    access_type: "offline",
                    response_type: "code"
                }
            }
        })
    ],
    // Usar JWT strategy en lugar de adaptador de base de datos
    // adapter: SupabaseAdapter({
    //   url: process.env.NEXT_PUBLIC_SUPABASE_URL!,
    //   secret: process.env.SUPABASE_SERVICE_ROLE_KEY!,
    // }),
    // Configuración de páginas personalizadas
    pages: {
        signIn: "/auth/signin",
        error: "/auth/error"
    },
    // Configuración de base URL para producción
    basePath: "/api/auth",
    // Configuración de callbacks
    callbacks: {
        // Callback de sesión - JWT strategy simplificado
        async session ({ session, token }) {
            // Agregar información adicional del usuario desde el token
            if (token.sub) {
                session.user.id = token.sub;
            }
            return session;
        },
        // Callback de JWT
        async jwt ({ token, user, account }) {
            if (user) {
                token.sub = user.id;
                token.email = user.email;
            }
            return token;
        },
        // Callback de autorización
        async signIn ({ user, account, profile }) {
            // Permitir todos los sign-ins por ahora
            // Aquí se pueden agregar validaciones adicionales
            return true;
        }
    },
    // Configuración de eventos
    events: {
        async signIn ({ user, account, profile, isNewUser }) {
            console.log(`[NextAuth] Usuario autenticado: ${user.email}`);
            // Si es un nuevo usuario, crear entrada en tabla pública
            if (isNewUser) {
                console.log(`[NextAuth] Nuevo usuario registrado: ${user.email}`);
            }
        },
        async signOut ({ session, token }) {
            console.log(`[NextAuth] Usuario desconectado`);
        }
    },
    // Configuración de sesión con JWT
    session: {
        strategy: "jwt",
        maxAge: 30 * 24 * 60 * 60,
        updateAge: 24 * 60 * 60
    },
    // Configuración de JWT para evitar problemas con Edge Runtime
    jwt: {
        maxAge: 30 * 24 * 60 * 60
    },
    // Configuración de debug
    debug: process.env.NODE_ENV === "development",
    // Configuración de trusted hosts para desarrollo y producción
    trustHost: true,
    // Configuración de cookies para producción
    cookies: {
        sessionToken: {
            name: `${process.env.NODE_ENV === "production" ? "__Secure-" : ""}next-auth.session-token`,
            options: {
                httpOnly: true,
                sameSite: "lax",
                path: "/",
                secure: process.env.NODE_ENV === "production"
            }
        }
    },
    // Configuración de secret para producción
    secret: process.env.NEXTAUTH_SECRET
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcYXV0aC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIE5leHRBdXRoLmpzIHY1IENvbmZpZ3VyYXRpb24gZm9yIFBpbnRleWEgRS1jb21tZXJjZVxuICogQ29uZmlndXJhY2nDs24gb3B0aW1pemFkYSBwYXJhIHByb2R1Y2Npw7NuIGNvbiBHb29nbGUgT0F1dGhcbiAqIE1pZ3JhY2nDs24gY29tcGxldGEgZGVzZGUgQ2xlcmsgYSBOZXh0QXV0aC5qc1xuICovXG5cbmltcG9ydCBOZXh0QXV0aCBmcm9tIFwibmV4dC1hdXRoXCJcbmltcG9ydCBHb29nbGVQcm92aWRlciBmcm9tIFwibmV4dC1hdXRoL3Byb3ZpZGVycy9nb29nbGVcIlxuXG4vLyBDb25maWd1cmFjacOzbiBkZSBOZXh0QXV0aC5qcyB2NSBvcHRpbWl6YWRhIHBhcmEgcHJvZHVjY2nDs25cbmV4cG9ydCBjb25zdCB7IGhhbmRsZXJzLCBhdXRoLCBzaWduSW4sIHNpZ25PdXQgfSA9IE5leHRBdXRoKHtcbiAgLy8gQ29uZmlndXJhY2nDs24gZGUgcHJvdmlkZXJzIGNvbiB2YWxpZGFjacOzblxuICBwcm92aWRlcnM6IFtcbiAgICBHb29nbGVQcm92aWRlcih7XG4gICAgICBjbGllbnRJZDogcHJvY2Vzcy5lbnYuQVVUSF9HT09HTEVfSUQhLFxuICAgICAgY2xpZW50U2VjcmV0OiBwcm9jZXNzLmVudi5BVVRIX0dPT0dMRV9TRUNSRVQhLFxuICAgICAgYXV0aG9yaXphdGlvbjoge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBwcm9tcHQ6IFwiY29uc2VudFwiLFxuICAgICAgICAgIGFjY2Vzc190eXBlOiBcIm9mZmxpbmVcIixcbiAgICAgICAgICByZXNwb25zZV90eXBlOiBcImNvZGVcIlxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSksXG4gIF0sXG5cbiAgLy8gVXNhciBKV1Qgc3RyYXRlZ3kgZW4gbHVnYXIgZGUgYWRhcHRhZG9yIGRlIGJhc2UgZGUgZGF0b3NcbiAgLy8gYWRhcHRlcjogU3VwYWJhc2VBZGFwdGVyKHtcbiAgLy8gICB1cmw6IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXG4gIC8vICAgc2VjcmV0OiBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZISxcbiAgLy8gfSksXG5cbiAgLy8gQ29uZmlndXJhY2nDs24gZGUgcMOhZ2luYXMgcGVyc29uYWxpemFkYXNcbiAgcGFnZXM6IHtcbiAgICBzaWduSW46IFwiL2F1dGgvc2lnbmluXCIsXG4gICAgZXJyb3I6IFwiL2F1dGgvZXJyb3JcIixcbiAgfSxcblxuICAvLyBDb25maWd1cmFjacOzbiBkZSBiYXNlIFVSTCBwYXJhIHByb2R1Y2Npw7NuXG4gIGJhc2VQYXRoOiBcIi9hcGkvYXV0aFwiLFxuXG4gIC8vIENvbmZpZ3VyYWNpw7NuIGRlIGNhbGxiYWNrc1xuICBjYWxsYmFja3M6IHtcbiAgICAvLyBDYWxsYmFjayBkZSBzZXNpw7NuIC0gSldUIHN0cmF0ZWd5IHNpbXBsaWZpY2Fkb1xuICAgIGFzeW5jIHNlc3Npb24oeyBzZXNzaW9uLCB0b2tlbiB9KSB7XG4gICAgICAvLyBBZ3JlZ2FyIGluZm9ybWFjacOzbiBhZGljaW9uYWwgZGVsIHVzdWFyaW8gZGVzZGUgZWwgdG9rZW5cbiAgICAgIGlmICh0b2tlbi5zdWIpIHtcbiAgICAgICAgc2Vzc2lvbi51c2VyLmlkID0gdG9rZW4uc3ViXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzZXNzaW9uXG4gICAgfSxcblxuICAgIC8vIENhbGxiYWNrIGRlIEpXVFxuICAgIGFzeW5jIGp3dCh7IHRva2VuLCB1c2VyLCBhY2NvdW50IH0pIHtcbiAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgIHRva2VuLnN1YiA9IHVzZXIuaWRcbiAgICAgICAgdG9rZW4uZW1haWwgPSB1c2VyLmVtYWlsXG4gICAgICB9XG4gICAgICByZXR1cm4gdG9rZW5cbiAgICB9LFxuXG4gICAgLy8gQ2FsbGJhY2sgZGUgYXV0b3JpemFjacOzblxuICAgIGFzeW5jIHNpZ25Jbih7IHVzZXIsIGFjY291bnQsIHByb2ZpbGUgfSkge1xuICAgICAgLy8gUGVybWl0aXIgdG9kb3MgbG9zIHNpZ24taW5zIHBvciBhaG9yYVxuICAgICAgLy8gQXF1w60gc2UgcHVlZGVuIGFncmVnYXIgdmFsaWRhY2lvbmVzIGFkaWNpb25hbGVzXG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH0sXG4gIH0sXG5cbiAgLy8gQ29uZmlndXJhY2nDs24gZGUgZXZlbnRvc1xuICBldmVudHM6IHtcbiAgICBhc3luYyBzaWduSW4oeyB1c2VyLCBhY2NvdW50LCBwcm9maWxlLCBpc05ld1VzZXIgfSkge1xuICAgICAgY29uc29sZS5sb2coYFtOZXh0QXV0aF0gVXN1YXJpbyBhdXRlbnRpY2FkbzogJHt1c2VyLmVtYWlsfWApXG4gICAgICBcbiAgICAgIC8vIFNpIGVzIHVuIG51ZXZvIHVzdWFyaW8sIGNyZWFyIGVudHJhZGEgZW4gdGFibGEgcMO6YmxpY2FcbiAgICAgIGlmIChpc05ld1VzZXIpIHtcbiAgICAgICAgY29uc29sZS5sb2coYFtOZXh0QXV0aF0gTnVldm8gdXN1YXJpbyByZWdpc3RyYWRvOiAke3VzZXIuZW1haWx9YClcbiAgICAgIH1cbiAgICB9LFxuICAgIFxuICAgIGFzeW5jIHNpZ25PdXQoeyBzZXNzaW9uLCB0b2tlbiB9KSB7XG4gICAgICBjb25zb2xlLmxvZyhgW05leHRBdXRoXSBVc3VhcmlvIGRlc2NvbmVjdGFkb2ApXG4gICAgfSxcbiAgfSxcblxuICAvLyBDb25maWd1cmFjacOzbiBkZSBzZXNpw7NuIGNvbiBKV1RcbiAgc2Vzc2lvbjoge1xuICAgIHN0cmF0ZWd5OiBcImp3dFwiLFxuICAgIG1heEFnZTogMzAgKiAyNCAqIDYwICogNjAsIC8vIDMwIGTDrWFzXG4gICAgdXBkYXRlQWdlOiAyNCAqIDYwICogNjAsIC8vIDI0IGhvcmFzXG4gIH0sXG5cbiAgLy8gQ29uZmlndXJhY2nDs24gZGUgSldUIHBhcmEgZXZpdGFyIHByb2JsZW1hcyBjb24gRWRnZSBSdW50aW1lXG4gIGp3dDoge1xuICAgIG1heEFnZTogMzAgKiAyNCAqIDYwICogNjAsIC8vIDMwIGTDrWFzXG4gIH0sXG5cbiAgLy8gQ29uZmlndXJhY2nDs24gZGUgZGVidWdcbiAgZGVidWc6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcImRldmVsb3BtZW50XCIsXG5cbiAgLy8gQ29uZmlndXJhY2nDs24gZGUgdHJ1c3RlZCBob3N0cyBwYXJhIGRlc2Fycm9sbG8geSBwcm9kdWNjacOzblxuICB0cnVzdEhvc3Q6IHRydWUsXG5cbiAgLy8gQ29uZmlndXJhY2nDs24gZGUgY29va2llcyBwYXJhIHByb2R1Y2Npw7NuXG4gIGNvb2tpZXM6IHtcbiAgICBzZXNzaW9uVG9rZW46IHtcbiAgICAgIG5hbWU6IGAke3Byb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcInByb2R1Y3Rpb25cIiA/IFwiX19TZWN1cmUtXCIgOiBcIlwifW5leHQtYXV0aC5zZXNzaW9uLXRva2VuYCxcbiAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgaHR0cE9ubHk6IHRydWUsXG4gICAgICAgIHNhbWVTaXRlOiBcImxheFwiLFxuICAgICAgICBwYXRoOiBcIi9cIixcbiAgICAgICAgc2VjdXJlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gXCJwcm9kdWN0aW9uXCIsXG4gICAgICB9LFxuICAgIH0sXG4gIH0sXG5cbiAgLy8gQ29uZmlndXJhY2nDs24gZGUgc2VjcmV0IHBhcmEgcHJvZHVjY2nDs25cbiAgc2VjcmV0OiBwcm9jZXNzLmVudi5ORVhUQVVUSF9TRUNSRVQsXG59KVxuXG4vLyBUaXBvcyBUeXBlU2NyaXB0IHBhcmEgZXh0ZW5kZXIgbGEgc2VzacOzblxuZGVjbGFyZSBtb2R1bGUgXCJuZXh0LWF1dGhcIiB7XG4gIGludGVyZmFjZSBTZXNzaW9uIHtcbiAgICBzdXBhYmFzZUFjY2Vzc1Rva2VuPzogc3RyaW5nXG4gICAgdXNlcjoge1xuICAgICAgaWQ6IHN0cmluZ1xuICAgICAgbmFtZT86IHN0cmluZyB8IG51bGxcbiAgICAgIGVtYWlsPzogc3RyaW5nIHwgbnVsbFxuICAgICAgaW1hZ2U/OiBzdHJpbmcgfCBudWxsXG4gICAgfVxuICB9XG59XG5cbmRlY2xhcmUgbW9kdWxlIFwibmV4dC1hdXRoL2p3dFwiIHtcbiAgaW50ZXJmYWNlIEpXVCB7XG4gICAgc3ViOiBzdHJpbmdcbiAgfVxufVxuIl0sIm5hbWVzIjpbImF1dGgiLCJoYW5kbGVycyIsInNpZ25JbiIsInNpZ25PdXQiLCJOZXh0QXV0aCIsInByb3ZpZGVycyIsIkdvb2dsZVByb3ZpZGVyIiwiY2xpZW50SWQiLCJwcm9jZXNzIiwiZW52IiwiQVVUSF9HT09HTEVfSUQiLCJjbGllbnRTZWNyZXQiLCJBVVRIX0dPT0dMRV9TRUNSRVQiLCJhdXRob3JpemF0aW9uIiwicGFyYW1zIiwicHJvbXB0IiwiYWNjZXNzX3R5cGUiLCJyZXNwb25zZV90eXBlIiwicGFnZXMiLCJlcnJvciIsImJhc2VQYXRoIiwiY2FsbGJhY2tzIiwic2Vzc2lvbiIsInRva2VuIiwic3ViIiwidXNlciIsImlkIiwiand0IiwiYWNjb3VudCIsImVtYWlsIiwicHJvZmlsZSIsImV2ZW50cyIsImlzTmV3VXNlciIsImNvbnNvbGUiLCJsb2ciLCJzdHJhdGVneSIsIm1heEFnZSIsInVwZGF0ZUFnZSIsImRlYnVnIiwiTk9ERV9FTlYiLCJ0cnVzdEhvc3QiLCJjb29raWVzIiwic2Vzc2lvblRva2VuIiwibmFtZSIsIm9wdGlvbnMiLCJodHRwT25seSIsInNhbWVTaXRlIiwicGF0aCIsInNlY3VyZSIsInNlY3JldCIsIk5FWFRBVVRIX1NFQ1JFVCJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Q0FJQzs7Ozs7Ozs7Ozs7UUFNd0JBO2VBQUFBOztRQUFWQztlQUFBQTs7UUFBZ0JDO2VBQUFBOztRQUFRQztlQUFBQTs7O2lFQUpsQjsrREFDTTs7Ozs7O0FBR3BCLE1BQU0sRUFBRUYsUUFB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