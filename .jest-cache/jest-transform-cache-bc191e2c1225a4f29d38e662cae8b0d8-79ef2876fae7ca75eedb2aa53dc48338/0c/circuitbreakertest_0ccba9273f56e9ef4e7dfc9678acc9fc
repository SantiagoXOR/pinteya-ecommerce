07ec992b4b88524436b1b93906988c23
// ===================================
// PINTEYA E-COMMERCE - CIRCUIT BREAKER TESTS
// ===================================
"use strict";
// Mock logger
jest.mock('@/lib/logger', ()=>({
        logger: {
            debug: jest.fn(),
            info: jest.fn(),
            warn: jest.fn(),
            error: jest.fn()
        },
        LogLevel: {
            DEBUG: 'debug',
            INFO: 'info',
            WARN: 'warn',
            ERROR: 'error'
        },
        LogCategory: {
            SYSTEM: 'system'
        }
    }));
// Mock metrics collector
jest.mock('@/lib/metrics', ()=>({
        metricsCollector: {
            recordMetric: jest.fn().mockResolvedValue(undefined)
        }
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _circuitbreaker = require("../../lib/mercadopago/circuit-breaker");
describe('Circuit Breaker Enterprise', ()=>{
    let circuitBreaker;
    beforeEach(()=>{
        jest.clearAllMocks();
        circuitBreaker = new _circuitbreaker.CircuitBreaker('test', {
            failureThreshold: 3,
            recoveryTimeout: 1000,
            monitoringWindow: 5000,
            halfOpenMaxCalls: 2,
            successThreshold: 1
        });
    });
    describe('Estado CLOSED', ()=>{
        test('debe ejecutar operaciones exitosas normalmente', async ()=>{
            const mockOperation = jest.fn().mockResolvedValue('success');
            const result = await circuitBreaker.execute(mockOperation);
            expect(result.success).toBe(true);
            expect(result.data).toBe('success');
            expect(result.state).toBe(_circuitbreaker.CircuitBreakerState.CLOSED);
            expect(result.wasRejected).toBe(false);
            expect(mockOperation).toHaveBeenCalledTimes(1);
        });
        test('debe manejar fallos sin cambiar de estado si no alcanza el umbral', async ()=>{
            const mockOperation = jest.fn().mockRejectedValue(new Error('Test error'));
            // Primer fallo
            const result1 = await circuitBreaker.execute(mockOperation);
            expect(result1.success).toBe(false);
            expect(result1.state).toBe(_circuitbreaker.CircuitBreakerState.CLOSED);
            // Segundo fallo
            const result2 = await circuitBreaker.execute(mockOperation);
            expect(result2.success).toBe(false);
            expect(result2.state).toBe(_circuitbreaker.CircuitBreakerState.CLOSED);
            expect(mockOperation).toHaveBeenCalledTimes(2);
        });
        test('debe cambiar a OPEN cuando alcanza el umbral de fallos', async ()=>{
            const mockOperation = jest.fn().mockRejectedValue(new Error('Test error'));
            // Ejecutar hasta alcanzar el umbral (3 fallos)
            await circuitBreaker.execute(mockOperation);
            await circuitBreaker.execute(mockOperation);
            const result = await circuitBreaker.execute(mockOperation);
            expect(result.success).toBe(false);
            expect(result.state).toBe(_circuitbreaker.CircuitBreakerState.OPEN);
            expect(mockOperation).toHaveBeenCalledTimes(3);
        });
    });
    describe('Estado OPEN', ()=>{
        beforeEach(async ()=>{
            // Forzar el circuit breaker a estado OPEN
            const mockOperation = jest.fn().mockRejectedValue(new Error('Test error'));
            await circuitBreaker.execute(mockOperation);
            await circuitBreaker.execute(mockOperation);
            await circuitBreaker.execute(mockOperation);
        });
        test('debe rechazar operaciones inmediatamente', async ()=>{
            const mockOperation = jest.fn().mockResolvedValue('success');
            const result = await circuitBreaker.execute(mockOperation);
            expect(result.success).toBe(false);
            expect(result.wasRejected).toBe(true);
            expect(result.state).toBe(_circuitbreaker.CircuitBreakerState.OPEN);
            expect(mockOperation).not.toHaveBeenCalled();
        });
        test('debe transicionar a HALF_OPEN después del timeout de recuperación', async ()=>{
            const mockOperation = jest.fn().mockResolvedValue('success');
            // Esperar el timeout de recuperación
            await new Promise((resolve)=>setTimeout(resolve, 1100));
            const result = await circuitBreaker.execute(mockOperation);
            expect(result.success).toBe(true);
            expect(result.state).toBe(_circuitbreaker.CircuitBreakerState.HALF_OPEN);
            expect(mockOperation).toHaveBeenCalledTimes(1);
        });
    });
    describe('Estado HALF_OPEN', ()=>{
        beforeEach(async ()=>{
            // Forzar a estado OPEN y luego esperar timeout
            const mockOperation = jest.fn().mockRejectedValue(new Error('Test error'));
            await circuitBreaker.execute(mockOperation);
            await circuitBreaker.execute(mockOperation);
            await circuitBreaker.execute(mockOperation);
            // Esperar timeout de recuperación
            await new Promise((resolve)=>setTimeout(resolve, 1100));
        });
        test('debe permitir llamadas limitadas', async ()=>{
            const mockOperation = jest.fn().mockResolvedValue('success');
            // Primera llamada exitosa
            const result1 = await circuitBreaker.execute(mockOperation);
            expect(result1.success).toBe(true);
            expect(result1.state).toBe(_circuitbreaker.CircuitBreakerState.CLOSED); // Se cierra inmediatamente con 1 éxito
            expect(mockOperation).toHaveBeenCalledTimes(1);
        });
        test('debe volver a OPEN si falla una operación', async ()=>{
            const mockOperation = jest.fn().mockRejectedValue(new Error('Test error'));
            const result = await circuitBreaker.execute(mockOperation);
            expect(result.success).toBe(false);
            expect(result.state).toBe(_circuitbreaker.CircuitBreakerState.OPEN);
            expect(mockOperation).toHaveBeenCalledTimes(1);
        });
        test('debe rechazar llamadas que excedan el límite', async ()=>{
            const mockOperation = jest.fn().mockResolvedValue('success');
            // Primera llamada exitosa (cierra el circuito)
            await circuitBreaker.execute(mockOperation);
            // Forzar de vuelta a HALF_OPEN para probar límite
            circuitBreaker.reset();
            const failOperation = jest.fn().mockRejectedValue(new Error('Test error'));
            await circuitBreaker.execute(failOperation);
            await circuitBreaker.execute(failOperation);
            await circuitBreaker.execute(failOperation);
            await new Promise((resolve)=>setTimeout(resolve, 1100));
            // Ahora en HALF_OPEN, probar límite de llamadas
            await circuitBreaker.execute(mockOperation); // 1ra llamada
            await circuitBreaker.execute(mockOperation); // 2da llamada (límite)
            const result = await circuitBreaker.execute(mockOperation); // 3ra llamada (rechazada)
            expect(result.wasRejected).toBe(true);
        });
    });
    describe('Métricas', ()=>{
        test('debe registrar métricas correctamente', async ()=>{
            const mockOperation = jest.fn().mockResolvedValue('success');
            await circuitBreaker.execute(mockOperation);
            const metrics = circuitBreaker.getMetrics();
            expect(metrics.totalCalls).toBe(1);
            expect(metrics.successfulCalls).toBe(1);
            expect(metrics.failedCalls).toBe(0);
            expect(metrics.rejectedCalls).toBe(0);
        });
        test('debe actualizar métricas en fallos', async ()=>{
            const mockOperation = jest.fn().mockRejectedValue(new Error('Test error'));
            await circuitBreaker.execute(mockOperation);
            const metrics = circuitBreaker.getMetrics();
            expect(metrics.totalCalls).toBe(1);
            expect(metrics.successfulCalls).toBe(0);
            expect(metrics.failedCalls).toBe(1);
            expect(metrics.rejectedCalls).toBe(0);
        });
    });
    describe('Configuraciones predefinidas', ()=>{
        test('debe tener configuración para MercadoPago crítico', ()=>{
            const config = _circuitbreaker.CIRCUIT_BREAKER_CONFIGS.MERCADOPAGO_CRITICAL;
            expect(config.failureThreshold).toBe(5);
            expect(config.recoveryTimeout).toBe(60000);
            expect(config.monitoringWindow).toBe(120000);
            expect(config.halfOpenMaxCalls).toBe(3);
            expect(config.successThreshold).toBe(2);
        });
        test('debe tener configuración para MercadoPago estándar', ()=>{
            const config = _circuitbreaker.CIRCUIT_BREAKER_CONFIGS.MERCADOPAGO_STANDARD;
            expect(config.failureThreshold).toBe(3);
            expect(config.recoveryTimeout).toBe(30000);
            expect(config.monitoringWindow).toBe(60000);
            expect(config.halfOpenMaxCalls).toBe(2);
            expect(config.successThreshold).toBe(1);
        });
        test('debe tener configuración para procesamiento de webhooks', ()=>{
            const config = _circuitbreaker.CIRCUIT_BREAKER_CONFIGS.WEBHOOK_PROCESSING;
            expect(config.failureThreshold).toBe(10);
            expect(config.recoveryTimeout).toBe(15000);
            expect(config.monitoringWindow).toBe(30000);
            expect(config.halfOpenMaxCalls).toBe(5);
            expect(config.successThreshold).toBe(3);
        });
    });
    describe('Wrappers de conveniencia', ()=>{
        test('executeMercadoPagoCritical debe usar el circuit breaker correcto', async ()=>{
            const mockOperation = jest.fn().mockResolvedValue('critical success');
            const result = await (0, _circuitbreaker.executeMercadoPagoCritical)(mockOperation);
            expect(result.success).toBe(true);
            expect(result.data).toBe('critical success');
            expect(mockOperation).toHaveBeenCalledTimes(1);
        });
        test('executeMercadoPagoStandard debe usar el circuit breaker correcto', async ()=>{
            const mockOperation = jest.fn().mockResolvedValue('standard success');
            const result = await (0, _circuitbreaker.executeMercadoPagoStandard)(mockOperation);
            expect(result.success).toBe(true);
            expect(result.data).toBe('standard success');
            expect(mockOperation).toHaveBeenCalledTimes(1);
        });
    });
    describe('Reset manual', ()=>{
        test('debe resetear el circuit breaker a estado CLOSED', async ()=>{
            // Forzar a estado OPEN
            const mockOperation = jest.fn().mockRejectedValue(new Error('Test error'));
            await circuitBreaker.execute(mockOperation);
            await circuitBreaker.execute(mockOperation);
            await circuitBreaker.execute(mockOperation);
            expect(circuitBreaker.getState()).toBe(_circuitbreaker.CircuitBreakerState.OPEN);
            // Reset manual
            circuitBreaker.reset();
            expect(circuitBreaker.getState()).toBe(_circuitbreaker.CircuitBreakerState.CLOSED);
            const metrics = circuitBreaker.getMetrics();
            expect(metrics.lastFailureTime).toBe(0);
            expect(metrics.lastSuccessTime).toBe(0);
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcX190ZXN0c19fXFxsaWJcXGNpcmN1aXQtYnJlYWtlci50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQSU5URVlBIEUtQ09NTUVSQ0UgLSBDSVJDVUlUIEJSRUFLRVIgVEVTVFNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCB7IFxuICBDaXJjdWl0QnJlYWtlciwgXG4gIENpcmN1aXRCcmVha2VyU3RhdGUsIFxuICBDSVJDVUlUX0JSRUFLRVJfQ09ORklHUyxcbiAgZXhlY3V0ZU1lcmNhZG9QYWdvQ3JpdGljYWwsXG4gIGV4ZWN1dGVNZXJjYWRvUGFnb1N0YW5kYXJkIFxufSBmcm9tICdAL2xpYi9tZXJjYWRvcGFnby9jaXJjdWl0LWJyZWFrZXInO1xuXG4vLyBNb2NrIGxvZ2dlclxuamVzdC5tb2NrKCdAL2xpYi9sb2dnZXInLCAoKSA9PiAoe1xuICBsb2dnZXI6IHtcbiAgICBkZWJ1ZzogamVzdC5mbigpLFxuICAgIGluZm86IGplc3QuZm4oKSxcbiAgICB3YXJuOiBqZXN0LmZuKCksXG4gICAgZXJyb3I6IGplc3QuZm4oKSxcbiAgfSxcbiAgTG9nTGV2ZWw6IHtcbiAgICBERUJVRzogJ2RlYnVnJyxcbiAgICBJTkZPOiAnaW5mbycsXG4gICAgV0FSTjogJ3dhcm4nLFxuICAgIEVSUk9SOiAnZXJyb3InLFxuICB9LFxuICBMb2dDYXRlZ29yeToge1xuICAgIFNZU1RFTTogJ3N5c3RlbScsXG4gIH0sXG59KSk7XG5cbi8vIE1vY2sgbWV0cmljcyBjb2xsZWN0b3Jcbmplc3QubW9jaygnQC9saWIvbWV0cmljcycsICgpID0+ICh7XG4gIG1ldHJpY3NDb2xsZWN0b3I6IHtcbiAgICByZWNvcmRNZXRyaWM6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpLFxuICB9LFxufSkpO1xuXG5kZXNjcmliZSgnQ2lyY3VpdCBCcmVha2VyIEVudGVycHJpc2UnLCAoKSA9PiB7XG4gIGxldCBjaXJjdWl0QnJlYWtlcjogQ2lyY3VpdEJyZWFrZXI7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgY2lyY3VpdEJyZWFrZXIgPSBuZXcgQ2lyY3VpdEJyZWFrZXIoJ3Rlc3QnLCB7XG4gICAgICBmYWlsdXJlVGhyZXNob2xkOiAzLFxuICAgICAgcmVjb3ZlcnlUaW1lb3V0OiAxMDAwLFxuICAgICAgbW9uaXRvcmluZ1dpbmRvdzogNTAwMCxcbiAgICAgIGhhbGZPcGVuTWF4Q2FsbHM6IDIsXG4gICAgICBzdWNjZXNzVGhyZXNob2xkOiAxXG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdFc3RhZG8gQ0xPU0VEJywgKCkgPT4ge1xuICAgIHRlc3QoJ2RlYmUgZWplY3V0YXIgb3BlcmFjaW9uZXMgZXhpdG9zYXMgbm9ybWFsbWVudGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrT3BlcmF0aW9uID0gamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKCdzdWNjZXNzJyk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNpcmN1aXRCcmVha2VyLmV4ZWN1dGUobW9ja09wZXJhdGlvbik7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZGF0YSkudG9CZSgnc3VjY2VzcycpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zdGF0ZSkudG9CZShDaXJjdWl0QnJlYWtlclN0YXRlLkNMT1NFRCk7XG4gICAgICBleHBlY3QocmVzdWx0Lndhc1JlamVjdGVkKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChtb2NrT3BlcmF0aW9uKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdkZWJlIG1hbmVqYXIgZmFsbG9zIHNpbiBjYW1iaWFyIGRlIGVzdGFkbyBzaSBubyBhbGNhbnphIGVsIHVtYnJhbCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tPcGVyYXRpb24gPSBqZXN0LmZuKCkubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdUZXN0IGVycm9yJykpO1xuICAgICAgXG4gICAgICAvLyBQcmltZXIgZmFsbG9cbiAgICAgIGNvbnN0IHJlc3VsdDEgPSBhd2FpdCBjaXJjdWl0QnJlYWtlci5leGVjdXRlKG1vY2tPcGVyYXRpb24pO1xuICAgICAgZXhwZWN0KHJlc3VsdDEuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0MS5zdGF0ZSkudG9CZShDaXJjdWl0QnJlYWtlclN0YXRlLkNMT1NFRCk7XG4gICAgICBcbiAgICAgIC8vIFNlZ3VuZG8gZmFsbG9cbiAgICAgIGNvbnN0IHJlc3VsdDIgPSBhd2FpdCBjaXJjdWl0QnJlYWtlci5leGVjdXRlKG1vY2tPcGVyYXRpb24pO1xuICAgICAgZXhwZWN0KHJlc3VsdDIuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0Mi5zdGF0ZSkudG9CZShDaXJjdWl0QnJlYWtlclN0YXRlLkNMT1NFRCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChtb2NrT3BlcmF0aW9uKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMik7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdkZWJlIGNhbWJpYXIgYSBPUEVOIGN1YW5kbyBhbGNhbnphIGVsIHVtYnJhbCBkZSBmYWxsb3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrT3BlcmF0aW9uID0gamVzdC5mbigpLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignVGVzdCBlcnJvcicpKTtcbiAgICAgIFxuICAgICAgLy8gRWplY3V0YXIgaGFzdGEgYWxjYW56YXIgZWwgdW1icmFsICgzIGZhbGxvcylcbiAgICAgIGF3YWl0IGNpcmN1aXRCcmVha2VyLmV4ZWN1dGUobW9ja09wZXJhdGlvbik7XG4gICAgICBhd2FpdCBjaXJjdWl0QnJlYWtlci5leGVjdXRlKG1vY2tPcGVyYXRpb24pO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2lyY3VpdEJyZWFrZXIuZXhlY3V0ZShtb2NrT3BlcmF0aW9uKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3RhdGUpLnRvQmUoQ2lyY3VpdEJyZWFrZXJTdGF0ZS5PUEVOKTtcbiAgICAgIGV4cGVjdChtb2NrT3BlcmF0aW9uKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdFc3RhZG8gT1BFTicsICgpID0+IHtcbiAgICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEZvcnphciBlbCBjaXJjdWl0IGJyZWFrZXIgYSBlc3RhZG8gT1BFTlxuICAgICAgY29uc3QgbW9ja09wZXJhdGlvbiA9IGplc3QuZm4oKS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ1Rlc3QgZXJyb3InKSk7XG4gICAgICBhd2FpdCBjaXJjdWl0QnJlYWtlci5leGVjdXRlKG1vY2tPcGVyYXRpb24pO1xuICAgICAgYXdhaXQgY2lyY3VpdEJyZWFrZXIuZXhlY3V0ZShtb2NrT3BlcmF0aW9uKTtcbiAgICAgIGF3YWl0IGNpcmN1aXRCcmVha2VyLmV4ZWN1dGUobW9ja09wZXJhdGlvbik7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdkZWJlIHJlY2hhemFyIG9wZXJhY2lvbmVzIGlubWVkaWF0YW1lbnRlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja09wZXJhdGlvbiA9IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgnc3VjY2VzcycpO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjaXJjdWl0QnJlYWtlci5leGVjdXRlKG1vY2tPcGVyYXRpb24pO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KHJlc3VsdC53YXNSZWplY3RlZCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3RhdGUpLnRvQmUoQ2lyY3VpdEJyZWFrZXJTdGF0ZS5PUEVOKTtcbiAgICAgIGV4cGVjdChtb2NrT3BlcmF0aW9uKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnZGViZSB0cmFuc2ljaW9uYXIgYSBIQUxGX09QRU4gZGVzcHXDqXMgZGVsIHRpbWVvdXQgZGUgcmVjdXBlcmFjacOzbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tPcGVyYXRpb24gPSBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoJ3N1Y2Nlc3MnKTtcbiAgICAgIFxuICAgICAgLy8gRXNwZXJhciBlbCB0aW1lb3V0IGRlIHJlY3VwZXJhY2nDs25cbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMTAwKSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNpcmN1aXRCcmVha2VyLmV4ZWN1dGUobW9ja09wZXJhdGlvbik7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3RhdGUpLnRvQmUoQ2lyY3VpdEJyZWFrZXJTdGF0ZS5IQUxGX09QRU4pO1xuICAgICAgZXhwZWN0KG1vY2tPcGVyYXRpb24pLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0VzdGFkbyBIQUxGX09QRU4nLCAoKSA9PiB7XG4gICAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgICAvLyBGb3J6YXIgYSBlc3RhZG8gT1BFTiB5IGx1ZWdvIGVzcGVyYXIgdGltZW91dFxuICAgICAgY29uc3QgbW9ja09wZXJhdGlvbiA9IGplc3QuZm4oKS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ1Rlc3QgZXJyb3InKSk7XG4gICAgICBhd2FpdCBjaXJjdWl0QnJlYWtlci5leGVjdXRlKG1vY2tPcGVyYXRpb24pO1xuICAgICAgYXdhaXQgY2lyY3VpdEJyZWFrZXIuZXhlY3V0ZShtb2NrT3BlcmF0aW9uKTtcbiAgICAgIGF3YWl0IGNpcmN1aXRCcmVha2VyLmV4ZWN1dGUobW9ja09wZXJhdGlvbik7XG4gICAgICBcbiAgICAgIC8vIEVzcGVyYXIgdGltZW91dCBkZSByZWN1cGVyYWNpw7NuXG4gICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTEwMCkpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnZGViZSBwZXJtaXRpciBsbGFtYWRhcyBsaW1pdGFkYXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrT3BlcmF0aW9uID0gamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKCdzdWNjZXNzJyk7XG4gICAgICBcbiAgICAgIC8vIFByaW1lcmEgbGxhbWFkYSBleGl0b3NhXG4gICAgICBjb25zdCByZXN1bHQxID0gYXdhaXQgY2lyY3VpdEJyZWFrZXIuZXhlY3V0ZShtb2NrT3BlcmF0aW9uKTtcbiAgICAgIGV4cGVjdChyZXN1bHQxLnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0MS5zdGF0ZSkudG9CZShDaXJjdWl0QnJlYWtlclN0YXRlLkNMT1NFRCk7IC8vIFNlIGNpZXJyYSBpbm1lZGlhdGFtZW50ZSBjb24gMSDDqXhpdG9cbiAgICAgIFxuICAgICAgZXhwZWN0KG1vY2tPcGVyYXRpb24pLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ2RlYmUgdm9sdmVyIGEgT1BFTiBzaSBmYWxsYSB1bmEgb3BlcmFjacOzbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tPcGVyYXRpb24gPSBqZXN0LmZuKCkubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdUZXN0IGVycm9yJykpO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjaXJjdWl0QnJlYWtlci5leGVjdXRlKG1vY2tPcGVyYXRpb24pO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zdGF0ZSkudG9CZShDaXJjdWl0QnJlYWtlclN0YXRlLk9QRU4pO1xuICAgICAgZXhwZWN0KG1vY2tPcGVyYXRpb24pLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ2RlYmUgcmVjaGF6YXIgbGxhbWFkYXMgcXVlIGV4Y2VkYW4gZWwgbMOtbWl0ZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tPcGVyYXRpb24gPSBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoJ3N1Y2Nlc3MnKTtcbiAgICAgIFxuICAgICAgLy8gUHJpbWVyYSBsbGFtYWRhIGV4aXRvc2EgKGNpZXJyYSBlbCBjaXJjdWl0bylcbiAgICAgIGF3YWl0IGNpcmN1aXRCcmVha2VyLmV4ZWN1dGUobW9ja09wZXJhdGlvbik7XG4gICAgICBcbiAgICAgIC8vIEZvcnphciBkZSB2dWVsdGEgYSBIQUxGX09QRU4gcGFyYSBwcm9iYXIgbMOtbWl0ZVxuICAgICAgY2lyY3VpdEJyZWFrZXIucmVzZXQoKTtcbiAgICAgIGNvbnN0IGZhaWxPcGVyYXRpb24gPSBqZXN0LmZuKCkubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdUZXN0IGVycm9yJykpO1xuICAgICAgYXdhaXQgY2lyY3VpdEJyZWFrZXIuZXhlY3V0ZShmYWlsT3BlcmF0aW9uKTtcbiAgICAgIGF3YWl0IGNpcmN1aXRCcmVha2VyLmV4ZWN1dGUoZmFpbE9wZXJhdGlvbik7XG4gICAgICBhd2FpdCBjaXJjdWl0QnJlYWtlci5leGVjdXRlKGZhaWxPcGVyYXRpb24pO1xuICAgICAgXG4gICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTEwMCkpO1xuICAgICAgXG4gICAgICAvLyBBaG9yYSBlbiBIQUxGX09QRU4sIHByb2JhciBsw61taXRlIGRlIGxsYW1hZGFzXG4gICAgICBhd2FpdCBjaXJjdWl0QnJlYWtlci5leGVjdXRlKG1vY2tPcGVyYXRpb24pOyAvLyAxcmEgbGxhbWFkYVxuICAgICAgYXdhaXQgY2lyY3VpdEJyZWFrZXIuZXhlY3V0ZShtb2NrT3BlcmF0aW9uKTsgLy8gMmRhIGxsYW1hZGEgKGzDrW1pdGUpXG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNpcmN1aXRCcmVha2VyLmV4ZWN1dGUobW9ja09wZXJhdGlvbik7IC8vIDNyYSBsbGFtYWRhIChyZWNoYXphZGEpXG4gICAgICBleHBlY3QocmVzdWx0Lndhc1JlamVjdGVkKS50b0JlKHRydWUpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnTcOpdHJpY2FzJywgKCkgPT4ge1xuICAgIHRlc3QoJ2RlYmUgcmVnaXN0cmFyIG3DqXRyaWNhcyBjb3JyZWN0YW1lbnRlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja09wZXJhdGlvbiA9IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgnc3VjY2VzcycpO1xuICAgICAgXG4gICAgICBhd2FpdCBjaXJjdWl0QnJlYWtlci5leGVjdXRlKG1vY2tPcGVyYXRpb24pO1xuICAgICAgXG4gICAgICBjb25zdCBtZXRyaWNzID0gY2lyY3VpdEJyZWFrZXIuZ2V0TWV0cmljcygpO1xuICAgICAgZXhwZWN0KG1ldHJpY3MudG90YWxDYWxscykudG9CZSgxKTtcbiAgICAgIGV4cGVjdChtZXRyaWNzLnN1Y2Nlc3NmdWxDYWxscykudG9CZSgxKTtcbiAgICAgIGV4cGVjdChtZXRyaWNzLmZhaWxlZENhbGxzKS50b0JlKDApO1xuICAgICAgZXhwZWN0KG1ldHJpY3MucmVqZWN0ZWRDYWxscykudG9CZSgwKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ2RlYmUgYWN0dWFsaXphciBtw6l0cmljYXMgZW4gZmFsbG9zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja09wZXJhdGlvbiA9IGplc3QuZm4oKS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ1Rlc3QgZXJyb3InKSk7XG4gICAgICBcbiAgICAgIGF3YWl0IGNpcmN1aXRCcmVha2VyLmV4ZWN1dGUobW9ja09wZXJhdGlvbik7XG4gICAgICBcbiAgICAgIGNvbnN0IG1ldHJpY3MgPSBjaXJjdWl0QnJlYWtlci5nZXRNZXRyaWNzKCk7XG4gICAgICBleHBlY3QobWV0cmljcy50b3RhbENhbGxzKS50b0JlKDEpO1xuICAgICAgZXhwZWN0KG1ldHJpY3Muc3VjY2Vzc2Z1bENhbGxzKS50b0JlKDApO1xuICAgICAgZXhwZWN0KG1ldHJpY3MuZmFpbGVkQ2FsbHMpLnRvQmUoMSk7XG4gICAgICBleHBlY3QobWV0cmljcy5yZWplY3RlZENhbGxzKS50b0JlKDApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQ29uZmlndXJhY2lvbmVzIHByZWRlZmluaWRhcycsICgpID0+IHtcbiAgICB0ZXN0KCdkZWJlIHRlbmVyIGNvbmZpZ3VyYWNpw7NuIHBhcmEgTWVyY2Fkb1BhZ28gY3LDrXRpY28nLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb25maWcgPSBDSVJDVUlUX0JSRUFLRVJfQ09ORklHUy5NRVJDQURPUEFHT19DUklUSUNBTDtcbiAgICAgIFxuICAgICAgZXhwZWN0KGNvbmZpZy5mYWlsdXJlVGhyZXNob2xkKS50b0JlKDUpO1xuICAgICAgZXhwZWN0KGNvbmZpZy5yZWNvdmVyeVRpbWVvdXQpLnRvQmUoNjAwMDApO1xuICAgICAgZXhwZWN0KGNvbmZpZy5tb25pdG9yaW5nV2luZG93KS50b0JlKDEyMDAwMCk7XG4gICAgICBleHBlY3QoY29uZmlnLmhhbGZPcGVuTWF4Q2FsbHMpLnRvQmUoMyk7XG4gICAgICBleHBlY3QoY29uZmlnLnN1Y2Nlc3NUaHJlc2hvbGQpLnRvQmUoMik7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdkZWJlIHRlbmVyIGNvbmZpZ3VyYWNpw7NuIHBhcmEgTWVyY2Fkb1BhZ28gZXN0w6FuZGFyJywgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmlnID0gQ0lSQ1VJVF9CUkVBS0VSX0NPTkZJR1MuTUVSQ0FET1BBR09fU1RBTkRBUkQ7XG4gICAgICBcbiAgICAgIGV4cGVjdChjb25maWcuZmFpbHVyZVRocmVzaG9sZCkudG9CZSgzKTtcbiAgICAgIGV4cGVjdChjb25maWcucmVjb3ZlcnlUaW1lb3V0KS50b0JlKDMwMDAwKTtcbiAgICAgIGV4cGVjdChjb25maWcubW9uaXRvcmluZ1dpbmRvdykudG9CZSg2MDAwMCk7XG4gICAgICBleHBlY3QoY29uZmlnLmhhbGZPcGVuTWF4Q2FsbHMpLnRvQmUoMik7XG4gICAgICBleHBlY3QoY29uZmlnLnN1Y2Nlc3NUaHJlc2hvbGQpLnRvQmUoMSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdkZWJlIHRlbmVyIGNvbmZpZ3VyYWNpw7NuIHBhcmEgcHJvY2VzYW1pZW50byBkZSB3ZWJob29rcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IENJUkNVSVRfQlJFQUtFUl9DT05GSUdTLldFQkhPT0tfUFJPQ0VTU0lORztcbiAgICAgIFxuICAgICAgZXhwZWN0KGNvbmZpZy5mYWlsdXJlVGhyZXNob2xkKS50b0JlKDEwKTtcbiAgICAgIGV4cGVjdChjb25maWcucmVjb3ZlcnlUaW1lb3V0KS50b0JlKDE1MDAwKTtcbiAgICAgIGV4cGVjdChjb25maWcubW9uaXRvcmluZ1dpbmRvdykudG9CZSgzMDAwMCk7XG4gICAgICBleHBlY3QoY29uZmlnLmhhbGZPcGVuTWF4Q2FsbHMpLnRvQmUoNSk7XG4gICAgICBleHBlY3QoY29uZmlnLnN1Y2Nlc3NUaHJlc2hvbGQpLnRvQmUoMyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdXcmFwcGVycyBkZSBjb252ZW5pZW5jaWEnLCAoKSA9PiB7XG4gICAgdGVzdCgnZXhlY3V0ZU1lcmNhZG9QYWdvQ3JpdGljYWwgZGViZSB1c2FyIGVsIGNpcmN1aXQgYnJlYWtlciBjb3JyZWN0bycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tPcGVyYXRpb24gPSBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoJ2NyaXRpY2FsIHN1Y2Nlc3MnKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZXhlY3V0ZU1lcmNhZG9QYWdvQ3JpdGljYWwobW9ja09wZXJhdGlvbik7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZGF0YSkudG9CZSgnY3JpdGljYWwgc3VjY2VzcycpO1xuICAgICAgZXhwZWN0KG1vY2tPcGVyYXRpb24pLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ2V4ZWN1dGVNZXJjYWRvUGFnb1N0YW5kYXJkIGRlYmUgdXNhciBlbCBjaXJjdWl0IGJyZWFrZXIgY29ycmVjdG8nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrT3BlcmF0aW9uID0gamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKCdzdGFuZGFyZCBzdWNjZXNzJyk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGV4ZWN1dGVNZXJjYWRvUGFnb1N0YW5kYXJkKG1vY2tPcGVyYXRpb24pO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmRhdGEpLnRvQmUoJ3N0YW5kYXJkIHN1Y2Nlc3MnKTtcbiAgICAgIGV4cGVjdChtb2NrT3BlcmF0aW9uKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSZXNldCBtYW51YWwnLCAoKSA9PiB7XG4gICAgdGVzdCgnZGViZSByZXNldGVhciBlbCBjaXJjdWl0IGJyZWFrZXIgYSBlc3RhZG8gQ0xPU0VEJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gRm9yemFyIGEgZXN0YWRvIE9QRU5cbiAgICAgIGNvbnN0IG1vY2tPcGVyYXRpb24gPSBqZXN0LmZuKCkubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdUZXN0IGVycm9yJykpO1xuICAgICAgYXdhaXQgY2lyY3VpdEJyZWFrZXIuZXhlY3V0ZShtb2NrT3BlcmF0aW9uKTtcbiAgICAgIGF3YWl0IGNpcmN1aXRCcmVha2VyLmV4ZWN1dGUobW9ja09wZXJhdGlvbik7XG4gICAgICBhd2FpdCBjaXJjdWl0QnJlYWtlci5leGVjdXRlKG1vY2tPcGVyYXRpb24pO1xuICAgICAgXG4gICAgICBleHBlY3QoY2lyY3VpdEJyZWFrZXIuZ2V0U3RhdGUoKSkudG9CZShDaXJjdWl0QnJlYWtlclN0YXRlLk9QRU4pO1xuICAgICAgXG4gICAgICAvLyBSZXNldCBtYW51YWxcbiAgICAgIGNpcmN1aXRCcmVha2VyLnJlc2V0KCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChjaXJjdWl0QnJlYWtlci5nZXRTdGF0ZSgpKS50b0JlKENpcmN1aXRCcmVha2VyU3RhdGUuQ0xPU0VEKTtcbiAgICAgIFxuICAgICAgY29uc3QgbWV0cmljcyA9IGNpcmN1aXRCcmVha2VyLmdldE1ldHJpY3MoKTtcbiAgICAgIGV4cGVjdChtZXRyaWNzLmxhc3RGYWlsdXJlVGltZSkudG9CZSgwKTtcbiAgICAgIGV4cGVjdChtZXRyaWNzLmxhc3RTdWNjZXNzVGltZSkudG9CZSgwKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJuYW1lcyI6WyJqZXN0IiwibW9jayIsImxvZ2dlciIsImRlYnVnIiwiZm4iLCJpbmZvIiwid2FybiIsImVycm9yIiwiTG9nTGV2ZWwiLCJERUJVRyIsIklORk8iLCJXQVJOIiwiRVJST1IiLCJMb2dDYXRlZ29yeSIsIlNZU1RFTSIsIm1ldHJpY3NDb2xsZWN0b3IiLCJyZWNvcmRNZXRyaWMiLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsInVuZGVmaW5lZCIsImRlc2NyaWJlIiwiY2lyY3VpdEJyZWFrZXIiLCJiZWZvcmVFYWNoIiwiY2xlYXJBbGxNb2NrcyIsIkNpcmN1aXRCcmVha2VyIiwiZmFpbHVyZVRocmVzaG9sZCIsInJlY292ZXJ5VGltZW91dCIsIm1vbml0b3JpbmdXaW5kb3ciLCJoYWxmT3Blbk1heENhbGxzIiwic3VjY2Vzc1RocmVzaG9sZCIsInRlc3QiLCJtb2NrT3BlcmF0aW9uIiwicmVzdWx0IiwiZXhlY3V0ZSIsImV4cGVjdCIsInN1Y2Nlc3MiLCJ0b0JlIiwiZGF0YSIsInN0YXRlIiwiQ2lyY3VpdEJyZWFrZXJTdGF0ZSIsIkNMT1NFRCIsIndhc1JlamVjdGVkIiwidG9IYXZlQmVlbkNhbGxlZFRpbWVzIiwibW9ja1JlamVjdGVkVmFsdWUiLCJFcnJvciIsInJlc3VsdDEiLCJyZXN1bHQyIiwiT1BFTiIsIm5vdCIsInRvSGF2ZUJlZW5DYWxsZWQiLCJQcm9taXNlIiwicmVzb2x2ZSIsInNldFRpbWVvdXQiLCJIQUxGX09QRU4iLCJyZXNldCIsImZhaWxPcGVyYXRpb24iLCJtZXRyaWNzIiwiZ2V0TWV0cmljcyIsInRvdGFsQ2FsbHMiLCJzdWNjZXNzZnVsQ2FsbHMiLCJmYWlsZWRDYWxscyIsInJlamVjdGVkQ2FsbHMiLCJjb25maWciLCJDSVJDVUlUX0JSRUFLRVJfQ09ORklHUyIsIk1FUkNBRE9QQUdPX0NSSVRJQ0FMIiwiTUVSQ0FET1BBR09fU1RBTkRBUkQiLCJXRUJIT09LX1BST0NFU1NJTkciLCJleGVjdXRlTWVyY2Fkb1BhZ29Dcml0aWNhbCIsImV4ZWN1dGVNZXJjYWRvUGFnb1N0YW5kYXJkIiwiZ2V0U3RhdGUiLCJsYXN0RmFpbHVyZVRpbWUiLCJsYXN0U3VjY2Vzc1RpbWUiXSwibWFwcGluZ3MiOiJBQUFB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