f45c7de905de9b5883c54565b1d9d588
// ===================================
// PINTEYA E-COMMERCE - FUNCIONES DE API PARA PRODUCTOS
// ===================================
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    calculateDiscountPercentage: function() {
        return calculateDiscountPercentage;
    },
    convertLegacyProduct: function() {
        return convertLegacyProduct;
    },
    formatPrice: function() {
        return formatPrice;
    },
    getDiscountedProducts: function() {
        return getDiscountedProducts;
    },
    getProductById: function() {
        return getProductById;
    },
    getProductMainImage: function() {
        return getProductMainImage;
    },
    getProducts: function() {
        return getProducts;
    },
    getProductsByBrand: function() {
        return getProductsByBrand;
    },
    getProductsByCategory: function() {
        return getProductsByCategory;
    },
    getRelatedProducts: function() {
        return getRelatedProducts;
    },
    isProductInStock: function() {
        return isProductInStock;
    },
    searchProducts: function() {
        return searchProducts;
    }
});
async function getProducts(filters) {
    try {
        const searchParams = new URLSearchParams();
        if (filters) {
            Object.entries(filters).forEach(([key, value])=>{
                if (value !== undefined && value !== null) {
                    searchParams.append(key, value.toString());
                }
            });
        }
        const response = await fetch(`/api/products?${searchParams.toString()}`, {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json'
            }
        });
        if (!response.ok) {
            throw new Error(`Error ${response.status}: ${response.statusText}`);
        }
        return await response.json();
    } catch (error) {
        console.error('Error obteniendo productos:', error);
        throw error;
    }
}
async function getProductById(id) {
    try {
        const response = await fetch(`/api/products/${id}`, {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json'
            }
        });
        if (!response.ok) {
            throw new Error(`Error ${response.status}: ${response.statusText}`);
        }
        return await response.json();
    } catch (error) {
        console.error(`Error obteniendo producto ${id}:`, error);
        throw error;
    }
}
async function searchProducts(searchTerm, limit = 12) {
    return getProducts({
        search: searchTerm,
        limit,
        page: 1
    });
}
async function getProductsByCategory(categorySlug, page = 1, limit = 12) {
    return getProducts({
        category: categorySlug,
        page,
        limit
    });
}
async function getDiscountedProducts(page = 1, limit = 12) {
    // Nota: Esto requeriría un filtro adicional en la API
    // Por ahora, obtenemos todos los productos y filtramos en el frontend
    const response = await getProducts({
        page,
        limit
    });
    // Filtrar productos con descuento
    const discountedProducts = response.data.filter((product)=>product.discounted_price && product.discounted_price < product.price);
    return {
        ...response,
        data: discountedProducts
    };
}
async function getProductsByBrand(brandName, page = 1, limit = 12) {
    return getProducts({
        brand: brandName,
        page,
        limit
    });
}
async function getRelatedProducts(productId, categoryId, limit = 4) {
    try {
        // Obtener productos de la misma categoría
        const response = await fetch(`/api/products?category_id=${categoryId}&limit=${limit + 1}`, {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json'
            }
        });
        if (!response.ok) {
            throw new Error(`Error ${response.status}: ${response.statusText}`);
        }
        const data = await response.json();
        // Filtrar el producto actual y limitar resultados
        return data.data.filter((product)=>product.id !== productId).slice(0, limit);
    } catch (error) {
        console.error('Error obteniendo productos relacionados:', error);
        return [];
    }
}
function convertLegacyProduct(oldProduct) {
    return {
        id: oldProduct.id,
        name: oldProduct.title,
        brand: oldProduct.brand || null,
        slug: oldProduct.title.toLowerCase().replace(/[^a-z0-9]+/g, '-'),
        description: `Producto ${oldProduct.title}`,
        price: oldProduct.price,
        discounted_price: oldProduct.discountedPrice,
        stock: 50,
        category_id: 1,
        images: oldProduct.imgs,
        created_at: new Date().toISOString(),
        updated_at: null
    };
}
function calculateDiscountPercentage(originalPrice, discountedPrice) {
    if (!discountedPrice || discountedPrice >= originalPrice) {
        return 0;
    }
    return Math.round((originalPrice - discountedPrice) / originalPrice * 100);
}
function formatPrice(price, currency = 'ARS') {
    return new Intl.NumberFormat('es-AR', {
        style: 'currency',
        currency,
        minimumFractionDigits: 0,
        maximumFractionDigits: 2
    }).format(price);
}
function isProductInStock(product) {
    return product.stock > 0;
}
function getProductMainImage(product) {
    if (product.images?.previews?.[0]) {
        return product.images.previews[0];
    }
    if (product.images?.thumbnails?.[0]) {
        return product.images.thumbnails[0];
    }
    return '/images/products/placeholder.jpg';
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcbGliXFxhcGlcXHByb2R1Y3RzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBJTlRFWUEgRS1DT01NRVJDRSAtIEZVTkNJT05FUyBERSBBUEkgUEFSQSBQUk9EVUNUT1NcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmltcG9ydCB7IFByb2R1Y3RGaWx0ZXJzLCBQcm9kdWN0V2l0aENhdGVnb3J5LCBBcGlSZXNwb25zZSwgUGFnaW5hdGVkUmVzcG9uc2UgfSBmcm9tICdAL3R5cGVzL2FwaSc7XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBGVU5DSU9ORVMgUEFSQSBFTCBGUk9OVEVORFxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIE9idGllbmUgcHJvZHVjdG9zIGNvbiBmaWx0cm9zIGRlc2RlIGxhIEFQSVxyXG4gKiBAcGFyYW0gZmlsdGVycyAtIEZpbHRyb3MgZGUgcHJvZHVjdG9zXHJcbiAqIEByZXR1cm5zIFByb21pc2U8UGFnaW5hdGVkUmVzcG9uc2U8UHJvZHVjdFdpdGhDYXRlZ29yeT4+XHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJvZHVjdHMoZmlsdGVycz86IFByb2R1Y3RGaWx0ZXJzKTogUHJvbWlzZTxQYWdpbmF0ZWRSZXNwb25zZTxQcm9kdWN0V2l0aENhdGVnb3J5Pj4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBzZWFyY2hQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XHJcblxyXG4gICAgaWYgKGZpbHRlcnMpIHtcclxuICAgICAgT2JqZWN0LmVudHJpZXMoZmlsdGVycykuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XHJcbiAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgIHNlYXJjaFBhcmFtcy5hcHBlbmQoa2V5LCB2YWx1ZS50b1N0cmluZygpKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYC9hcGkvcHJvZHVjdHM/JHtzZWFyY2hQYXJhbXMudG9TdHJpbmcoKX1gLCB7XHJcbiAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yICR7cmVzcG9uc2Uuc3RhdHVzfTogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIG9idGVuaWVuZG8gcHJvZHVjdG9zOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIE9idGllbmUgdW4gcHJvZHVjdG8gcG9yIElEIGRlc2RlIGxhIEFQSVxyXG4gKiBAcGFyYW0gaWQgLSBJRCBkZWwgcHJvZHVjdG9cclxuICogQHJldHVybnMgUHJvbWlzZTxBcGlSZXNwb25zZTxQcm9kdWN0V2l0aENhdGVnb3J5Pj5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0QnlJZChpZDogbnVtYmVyKTogUHJvbWlzZTxBcGlSZXNwb25zZTxQcm9kdWN0V2l0aENhdGVnb3J5Pj4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAvYXBpL3Byb2R1Y3RzLyR7aWR9YCwge1xyXG4gICAgICBtZXRob2Q6ICdHRVQnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciAke3Jlc3BvbnNlLnN0YXR1c306ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBFcnJvciBvYnRlbmllbmRvIHByb2R1Y3RvICR7aWR9OmAsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEJ1c2NhIHByb2R1Y3RvcyBwb3IgdMOpcm1pbm8gZGUgYsO6c3F1ZWRhXHJcbiAqIEBwYXJhbSBzZWFyY2hUZXJtIC0gVMOpcm1pbm8gZGUgYsO6c3F1ZWRhXHJcbiAqIEBwYXJhbSBsaW1pdCAtIEzDrW1pdGUgZGUgcmVzdWx0YWRvc1xyXG4gKiBAcmV0dXJucyBQcm9taXNlPFBhZ2luYXRlZFJlc3BvbnNlPFByb2R1Y3RXaXRoQ2F0ZWdvcnk+PlxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlYXJjaFByb2R1Y3RzKFxyXG4gIHNlYXJjaFRlcm06IHN0cmluZywgXHJcbiAgbGltaXQ6IG51bWJlciA9IDEyXHJcbik6IFByb21pc2U8UGFnaW5hdGVkUmVzcG9uc2U8UHJvZHVjdFdpdGhDYXRlZ29yeT4+IHtcclxuICByZXR1cm4gZ2V0UHJvZHVjdHMoe1xyXG4gICAgc2VhcmNoOiBzZWFyY2hUZXJtLFxyXG4gICAgbGltaXQsXHJcbiAgICBwYWdlOiAxLFxyXG4gIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogT2J0aWVuZSBwcm9kdWN0b3MgcG9yIGNhdGVnb3LDrWFcclxuICogQHBhcmFtIGNhdGVnb3J5U2x1ZyAtIFNsdWcgZGUgbGEgY2F0ZWdvcsOtYVxyXG4gKiBAcGFyYW0gcGFnZSAtIFDDoWdpbmFcclxuICogQHBhcmFtIGxpbWl0IC0gTMOtbWl0ZSBkZSByZXN1bHRhZG9zXHJcbiAqIEByZXR1cm5zIFByb21pc2U8UGFnaW5hdGVkUmVzcG9uc2U8UHJvZHVjdFdpdGhDYXRlZ29yeT4+XHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJvZHVjdHNCeUNhdGVnb3J5KFxyXG4gIGNhdGVnb3J5U2x1Zzogc3RyaW5nLFxyXG4gIHBhZ2U6IG51bWJlciA9IDEsXHJcbiAgbGltaXQ6IG51bWJlciA9IDEyXHJcbik6IFByb21pc2U8UGFnaW5hdGVkUmVzcG9uc2U8UHJvZHVjdFdpdGhDYXRlZ29yeT4+IHtcclxuICByZXR1cm4gZ2V0UHJvZHVjdHMoe1xyXG4gICAgY2F0ZWdvcnk6IGNhdGVnb3J5U2x1ZyxcclxuICAgIHBhZ2UsXHJcbiAgICBsaW1pdCxcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIE9idGllbmUgcHJvZHVjdG9zIGNvbiBkZXNjdWVudG9cclxuICogQHBhcmFtIHBhZ2UgLSBQw6FnaW5hXHJcbiAqIEBwYXJhbSBsaW1pdCAtIEzDrW1pdGUgZGUgcmVzdWx0YWRvc1xyXG4gKiBAcmV0dXJucyBQcm9taXNlPFBhZ2luYXRlZFJlc3BvbnNlPFByb2R1Y3RXaXRoQ2F0ZWdvcnk+PlxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldERpc2NvdW50ZWRQcm9kdWN0cyhcclxuICBwYWdlOiBudW1iZXIgPSAxLFxyXG4gIGxpbWl0OiBudW1iZXIgPSAxMlxyXG4pOiBQcm9taXNlPFBhZ2luYXRlZFJlc3BvbnNlPFByb2R1Y3RXaXRoQ2F0ZWdvcnk+PiB7XHJcbiAgLy8gTm90YTogRXN0byByZXF1ZXJpcsOtYSB1biBmaWx0cm8gYWRpY2lvbmFsIGVuIGxhIEFQSVxyXG4gIC8vIFBvciBhaG9yYSwgb2J0ZW5lbW9zIHRvZG9zIGxvcyBwcm9kdWN0b3MgeSBmaWx0cmFtb3MgZW4gZWwgZnJvbnRlbmRcclxuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdldFByb2R1Y3RzKHsgcGFnZSwgbGltaXQgfSk7XHJcblxyXG4gIC8vIEZpbHRyYXIgcHJvZHVjdG9zIGNvbiBkZXNjdWVudG9cclxuICBjb25zdCBkaXNjb3VudGVkUHJvZHVjdHMgPSByZXNwb25zZS5kYXRhLmZpbHRlcihcclxuICAgIHByb2R1Y3QgPT4gcHJvZHVjdC5kaXNjb3VudGVkX3ByaWNlICYmIHByb2R1Y3QuZGlzY291bnRlZF9wcmljZSA8IHByb2R1Y3QucHJpY2VcclxuICApO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgLi4ucmVzcG9uc2UsXHJcbiAgICBkYXRhOiBkaXNjb3VudGVkUHJvZHVjdHMsXHJcbiAgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIE9idGllbmUgcHJvZHVjdG9zIHBvciBtYXJjYVxyXG4gKiBAcGFyYW0gYnJhbmROYW1lIC0gTm9tYnJlIGRlIGxhIG1hcmNhXHJcbiAqIEBwYXJhbSBwYWdlIC0gUMOhZ2luYVxyXG4gKiBAcGFyYW0gbGltaXQgLSBMw61taXRlIGRlIHJlc3VsdGFkb3NcclxuICogQHJldHVybnMgUHJvbWlzZTxQYWdpbmF0ZWRSZXNwb25zZTxQcm9kdWN0V2l0aENhdGVnb3J5Pj5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0c0J5QnJhbmQoXHJcbiAgYnJhbmROYW1lOiBzdHJpbmcsXHJcbiAgcGFnZTogbnVtYmVyID0gMSxcclxuICBsaW1pdDogbnVtYmVyID0gMTJcclxuKTogUHJvbWlzZTxQYWdpbmF0ZWRSZXNwb25zZTxQcm9kdWN0V2l0aENhdGVnb3J5Pj4ge1xyXG4gIHJldHVybiBnZXRQcm9kdWN0cyh7XHJcbiAgICBicmFuZDogYnJhbmROYW1lLFxyXG4gICAgcGFnZSxcclxuICAgIGxpbWl0LFxyXG4gIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogT2J0aWVuZSBwcm9kdWN0b3MgcmVsYWNpb25hZG9zIChtaXNtYSBjYXRlZ29yw61hKVxyXG4gKiBAcGFyYW0gcHJvZHVjdElkIC0gSUQgZGVsIHByb2R1Y3RvIGFjdHVhbFxyXG4gKiBAcGFyYW0gY2F0ZWdvcnlJZCAtIElEIGRlIGxhIGNhdGVnb3LDrWFcclxuICogQHBhcmFtIGxpbWl0IC0gTMOtbWl0ZSBkZSByZXN1bHRhZG9zXHJcbiAqIEByZXR1cm5zIFByb21pc2U8UHJvZHVjdFdpdGhDYXRlZ29yeVtdPlxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFJlbGF0ZWRQcm9kdWN0cyhcclxuICBwcm9kdWN0SWQ6IG51bWJlcixcclxuICBjYXRlZ29yeUlkOiBudW1iZXIsXHJcbiAgbGltaXQ6IG51bWJlciA9IDRcclxuKTogUHJvbWlzZTxQcm9kdWN0V2l0aENhdGVnb3J5W10+IHtcclxuICB0cnkge1xyXG4gICAgLy8gT2J0ZW5lciBwcm9kdWN0b3MgZGUgbGEgbWlzbWEgY2F0ZWdvcsOtYVxyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgL2FwaS9wcm9kdWN0cz9jYXRlZ29yeV9pZD0ke2NhdGVnb3J5SWR9JmxpbWl0PSR7bGltaXQgKyAxfWAsIHtcclxuICAgICAgbWV0aG9kOiAnR0VUJyxcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3IgJHtyZXNwb25zZS5zdGF0dXN9OiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZGF0YTogUGFnaW5hdGVkUmVzcG9uc2U8UHJvZHVjdFdpdGhDYXRlZ29yeT4gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcbiAgICBcclxuICAgIC8vIEZpbHRyYXIgZWwgcHJvZHVjdG8gYWN0dWFsIHkgbGltaXRhciByZXN1bHRhZG9zXHJcbiAgICByZXR1cm4gZGF0YS5kYXRhXHJcbiAgICAgIC5maWx0ZXIocHJvZHVjdCA9PiBwcm9kdWN0LmlkICE9PSBwcm9kdWN0SWQpXHJcbiAgICAgIC5zbGljZSgwLCBsaW1pdCk7XHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBvYnRlbmllbmRvIHByb2R1Y3RvcyByZWxhY2lvbmFkb3M6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gRlVOQ0lPTkVTIEFVWElMSUFSRVNcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBDb252aWVydGUgdW4gcHJvZHVjdG8gZGVsIGZvcm1hdG8gYW50aWd1byBhbCBudWV2b1xyXG4gKiBAcGFyYW0gb2xkUHJvZHVjdCAtIFByb2R1Y3RvIGVuIGZvcm1hdG8gYW50aWd1b1xyXG4gKiBAcmV0dXJucyBQcm9kdWN0V2l0aENhdGVnb3J5XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY29udmVydExlZ2FjeVByb2R1Y3Qob2xkUHJvZHVjdDogYW55KTogUHJvZHVjdFdpdGhDYXRlZ29yeSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIGlkOiBvbGRQcm9kdWN0LmlkLFxyXG4gICAgbmFtZTogb2xkUHJvZHVjdC50aXRsZSxcclxuICAgIGJyYW5kOiBvbGRQcm9kdWN0LmJyYW5kIHx8IG51bGwsIC8vIE1hcmNhIGRlbCBwcm9kdWN0byBsZWdhY3lcclxuICAgIHNsdWc6IG9sZFByb2R1Y3QudGl0bGUudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bXmEtejAtOV0rL2csICctJyksXHJcbiAgICBkZXNjcmlwdGlvbjogYFByb2R1Y3RvICR7b2xkUHJvZHVjdC50aXRsZX1gLFxyXG4gICAgcHJpY2U6IG9sZFByb2R1Y3QucHJpY2UsXHJcbiAgICBkaXNjb3VudGVkX3ByaWNlOiBvbGRQcm9kdWN0LmRpc2NvdW50ZWRQcmljZSxcclxuICAgIHN0b2NrOiA1MCwgLy8gU3RvY2sgcG9yIGRlZmVjdG9cclxuICAgIGNhdGVnb3J5X2lkOiAxLCAvLyBDYXRlZ29yw61hIHBvciBkZWZlY3RvXHJcbiAgICBpbWFnZXM6IG9sZFByb2R1Y3QuaW1ncyxcclxuICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgIHVwZGF0ZWRfYXQ6IG51bGwsIC8vIENhbXBvIHJlcXVlcmlkbyBwb3IgZWwgdGlwb1xyXG4gIH07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDYWxjdWxhIGVsIHBvcmNlbnRhamUgZGUgZGVzY3VlbnRvXHJcbiAqIEBwYXJhbSBvcmlnaW5hbFByaWNlIC0gUHJlY2lvIG9yaWdpbmFsXHJcbiAqIEBwYXJhbSBkaXNjb3VudGVkUHJpY2UgLSBQcmVjaW8gY29uIGRlc2N1ZW50b1xyXG4gKiBAcmV0dXJucyBudW1iZXJcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjYWxjdWxhdGVEaXNjb3VudFBlcmNlbnRhZ2UoXHJcbiAgb3JpZ2luYWxQcmljZTogbnVtYmVyLFxyXG4gIGRpc2NvdW50ZWRQcmljZTogbnVtYmVyXHJcbik6IG51bWJlciB7XHJcbiAgaWYgKCFkaXNjb3VudGVkUHJpY2UgfHwgZGlzY291bnRlZFByaWNlID49IG9yaWdpbmFsUHJpY2UpIHtcclxuICAgIHJldHVybiAwO1xyXG4gIH1cclxuICBcclxuICByZXR1cm4gTWF0aC5yb3VuZCgoKG9yaWdpbmFsUHJpY2UgLSBkaXNjb3VudGVkUHJpY2UpIC8gb3JpZ2luYWxQcmljZSkgKiAxMDApO1xyXG59XHJcblxyXG4vKipcclxuICogRm9ybWF0ZWEgZWwgcHJlY2lvIHBhcmEgbW9zdHJhclxyXG4gKiBAcGFyYW0gcHJpY2UgLSBQcmVjaW9cclxuICogQHBhcmFtIGN1cnJlbmN5IC0gTW9uZWRhXHJcbiAqIEByZXR1cm5zIHN0cmluZ1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdFByaWNlKHByaWNlOiBudW1iZXIsIGN1cnJlbmN5OiBzdHJpbmcgPSAnQVJTJyk6IHN0cmluZyB7XHJcbiAgcmV0dXJuIG5ldyBJbnRsLk51bWJlckZvcm1hdCgnZXMtQVInLCB7XHJcbiAgICBzdHlsZTogJ2N1cnJlbmN5JyxcclxuICAgIGN1cnJlbmN5LFxyXG4gICAgbWluaW11bUZyYWN0aW9uRGlnaXRzOiAwLFxyXG4gICAgbWF4aW11bUZyYWN0aW9uRGlnaXRzOiAyLFxyXG4gIH0pLmZvcm1hdChwcmljZSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBWZXJpZmljYSBzaSB1biBwcm9kdWN0byBlc3TDoSBlbiBzdG9ja1xyXG4gKiBAcGFyYW0gcHJvZHVjdCAtIFByb2R1Y3RvXHJcbiAqIEByZXR1cm5zIGJvb2xlYW5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1Byb2R1Y3RJblN0b2NrKHByb2R1Y3Q6IFByb2R1Y3RXaXRoQ2F0ZWdvcnkpOiBib29sZWFuIHtcclxuICByZXR1cm4gcHJvZHVjdC5zdG9jayA+IDA7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBPYnRpZW5lIGxhIFVSTCBkZSBsYSBpbWFnZW4gcHJpbmNpcGFsIGRlbCBwcm9kdWN0b1xyXG4gKiBAcGFyYW0gcHJvZHVjdCAtIFByb2R1Y3RvXHJcbiAqIEByZXR1cm5zIHN0cmluZ1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFByb2R1Y3RNYWluSW1hZ2UocHJvZHVjdDogUHJvZHVjdFdpdGhDYXRlZ29yeSk6IHN0cmluZyB7XHJcbiAgaWYgKHByb2R1Y3QuaW1hZ2VzPy5wcmV2aWV3cz8uWzBdKSB7XHJcbiAgICByZXR1cm4gcHJvZHVjdC5pbWFnZXMucHJldmlld3NbMF07XHJcbiAgfVxyXG4gIFxyXG4gIGlmIChwcm9kdWN0LmltYWdlcz8udGh1bWJuYWlscz8uWzBdKSB7XHJcbiAgICByZXR1cm4gcHJvZHVjdC5pbWFnZXMudGh1bWJuYWlsc1swXTtcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuICcvaW1hZ2VzL3Byb2R1Y3RzL3BsYWNlaG9sZGVyLmpwZyc7XHJcbn1cclxuIl0sIm5hbWVzIjpbImNhbGN1bGF0ZURpc2NvdW50UGVyY2VudGFnZSIsImNvbnZlcnRMZWdhY3lQcm9kdWN0IiwiZm9ybWF0UHJpY2UiLCJnZXREaXNjb3VudGVkUHJvZHVjdHMiLCJnZXRQcm9kdWN0QnlJZCIsImdldFByb2R1Y3RNYWluSW1hZ2UiLCJnZXRQcm9kdWN0cyIsImdldFByb2R1Y3RzQnlCcmFuZCIsImdldFByb2R1Y3RzQnlDYXRlZ29yeSIsImdldFJlbGF0ZWRQcm9kdWN0cyIsImlzUHJvZHVjdEluU3RvY2siLCJzZWFyY2hQcm9kdWN0cyIsImZpbHRlcnMiLCJzZWFyY2hQYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJPYmplY3QiLCJlbnRyaWVzIiwiZm9yRWFjaCIsImtleSIsInZhbHVlIiwidW5kZWZpbmVkIiwiYXBwZW5kIiwidG9TdHJpbmciLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsIm9rIiwiRXJyb3IiLCJzdGF0dXMiLCJzdGF0dXNUZXh0IiwianNvbiIsImVycm9yIiwiY29uc29sZSIsImlkIiwic2VhcmNoVGVybSIsImxpbWl0Iiwic2VhcmNoIiwicGFnZSIsImNhdGVnb3J5U2x1ZyIsImNhdGVnb3J5IiwiZGlzY291bnRlZFByb2R1Y3RzIiwiZGF0YSIsImZpbHRlciIsInByb2R1Y3QiLCJkaXNjb3VudGVkX3ByaWNlIiwicHJpY2UiLCJicmFuZE5hbWUiLCJicmFuZCIsInByb2R1Y3RJZCIsImNhdGVnb3J5SWQiLCJzbGljZSIsIm9sZFByb2R1Y3QiLCJuYW1lIiwidGl0bGUiLCJzbHVnIiwidG9Mb3dlckNhc2UiLCJyZXBsYWNlIiwiZGVzY3JpcHRpb24iLCJkaXNjb3VudGVkUHJpY2UiLCJzdG9jayIsImNhdGVnb3J5X2lkIiwiaW1hZ2VzIiwiaW1ncyIsImNyZWF0ZWRfYXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJ1cGRhdGVkX2F0Iiwib3JpZ2luYWxQcmljZSIsIk1hdGgiLCJyb3VuZCIsImN1cnJlbmN5IiwiSW50bCIsIk51bWJlckZvcm1hdCIsInN0eWxlIiwibWluaW11bUZyYWN0aW9uRGlnaXRzIiwibWF4aW11bUZyYWN0aW9uRGlnaXRzIiwiZm9ybWF0IiwicHJldmlld3MiLCJ0aHVtYm5haWxzIl0sIm1hcHBpbmdzIjoiQUFBQSxzQ0FBc0M7QUFDdEMsdURBQXVEO0FBQ3ZELHNDQUFzQzs7Ozs7Ozs7Ozs7O0lBME50QkEsMkJBQTJCO2VBQTNCQTs7SUF2QkFDLG9CQUFvQjtlQUFwQkE7O0lBd0NBQyxXQUFXO2VBQVhBOztJQTdITUMscUJBQXFCO2VBQXJCQTs7SUE5REFDLGNBQWM7ZUFBZEE7O0lBa05OQyxtQkFBbUI7ZUFBbkJBOztJQXJQTUMsV0FBVztlQUFYQTs7SUEySEFDLGtCQUFrQjtlQUFsQkE7O0lBNUNBQyxxQkFBcUI7ZUFBckJBOztJQStEQUMsa0JBQWtCO2VBQWxCQTs7SUE4Rk5DLGdCQUFnQjtlQUFoQkE7O0lBL0tNQyxjQUFjO2VBQWRBOzs7QUE3RGYsZUFBZUwsWUFBWU0sT0FBd0I7SUFDeEQsSUFBSTtRQUNGLE1BQU1DLGVBQWUsSUFBSUM7UUFFekIsSUFBSUYsU0FBUztZQUNYRyxPQUFPQyxPQUFPLENBQUNKLFNBQVNLLE9BQU8sQ0FBQyxDQUFDLENBQUNDLEtBQUtDLE1BQU07Z0JBQzNDLElBQUlBLFVBQVVDLGFBQWFELFVBQVUsTUFBTTtvQkFDekNOLGFBQWFRLE1BQU0sQ0FBQ0gsS0FBS0MsTUFBTUcsUUFBUTtnQkFDekM7WUFDRjtRQUNGO1FBRUEsTUFBTUMsV0FBVyxNQUFNQyxNQUFNLENBQUMsY0FBYyxFQUFFWCxhQUFhUyxRQUFRLElBQUksRUFBRTtZQUN2RUcsUUFB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