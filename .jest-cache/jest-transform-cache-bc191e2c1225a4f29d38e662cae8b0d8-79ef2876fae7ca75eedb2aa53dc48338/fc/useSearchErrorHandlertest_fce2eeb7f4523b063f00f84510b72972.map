{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\__tests__\\hooks\\useSearchErrorHandler.test.tsx"],"sourcesContent":["// ===================================\r\n// TESTS: useSearchErrorHandler Hook - Manejo robusto de errores\r\n// ===================================\r\n\r\nimport { renderHook, act, waitFor } from '@testing-library/react';\r\nimport { useSearchErrorHandler } from '@/hooks/useSearchErrorHandler';\r\n\r\n// ===================================\r\n// SETUP\r\n// ===================================\r\n\r\nbeforeEach(() => {\r\n  jest.clearAllMocks();\r\n  jest.useFakeTimers();\r\n  // Mock console methods to reduce noise\r\n  jest.spyOn(console, 'warn').mockImplementation(() => {});\r\n  jest.spyOn(console, 'error').mockImplementation(() => {});\r\n});\r\n\r\nafterEach(() => {\r\n  jest.useRealTimers();\r\n  jest.restoreAllMocks();\r\n});\r\n\r\n// ===================================\r\n// TESTS BÁSICOS\r\n// ===================================\r\n\r\ndescribe('useSearchErrorHandler Hook', () => {\r\n  it('should initialize with default state', () => {\r\n    const { result } = renderHook(() => useSearchErrorHandler());\r\n\r\n    expect(result.current.currentError).toBe(null);\r\n    expect(result.current.retryCount).toBe(0);\r\n    expect(result.current.isRetrying).toBe(false);\r\n    expect(result.current.hasError).toBe(false);\r\n  });\r\n\r\n  it('should accept custom retry configuration', () => {\r\n    const { result } = renderHook(() => \r\n      useSearchErrorHandler({\r\n        retryConfig: {\r\n          maxRetries: 5,\r\n          baseDelay: 500,\r\n        }\r\n      })\r\n    );\r\n\r\n    expect(result.current.retryConfig.maxRetries).toBe(5);\r\n    expect(result.current.retryConfig.baseDelay).toBe(500);\r\n  });\r\n});\r\n\r\n// ===================================\r\n// TESTS DE CLASIFICACIÓN DE ERRORES\r\n// ===================================\r\n\r\ndescribe('useSearchErrorHandler - Error Classification', () => {\r\n  it('should classify network errors correctly', () => {\r\n    const { result } = renderHook(() => useSearchErrorHandler());\r\n\r\n    const networkError = new TypeError('fetch failed');\r\n    networkError.name = 'TypeError';\r\n\r\n    act(() => {\r\n      const error = result.current.handleError(networkError);\r\n      expect(error.type).toBe('network');\r\n      expect(error.retryable).toBe(true);\r\n      expect(error.message).toContain('conexión');\r\n    });\r\n  });\r\n\r\n  it('should classify timeout errors correctly', () => {\r\n    const { result } = renderHook(() => useSearchErrorHandler());\r\n\r\n    const timeoutError = new Error('timeout');\r\n    timeoutError.name = 'AbortError';\r\n\r\n    act(() => {\r\n      const error = result.current.handleError(timeoutError);\r\n      expect(error.type).toBe('timeout');\r\n      expect(error.retryable).toBe(true);\r\n      expect(error.message).toContain('tardó demasiado');\r\n    });\r\n  });\r\n\r\n  it('should classify server errors correctly', () => {\r\n    const { result } = renderHook(() => useSearchErrorHandler());\r\n\r\n    const serverError = { status: 500, message: 'Internal Server Error' };\r\n\r\n    act(() => {\r\n      const error = result.current.handleError(serverError);\r\n      expect(error.type).toBe('server');\r\n      expect(error.retryable).toBe(true);\r\n      expect(error.code).toBe('500');\r\n    });\r\n  });\r\n\r\n  it('should classify validation errors correctly', () => {\r\n    const { result } = renderHook(() => useSearchErrorHandler());\r\n\r\n    const validationError = { status: 400, message: 'Bad Request' };\r\n\r\n    act(() => {\r\n      const error = result.current.handleError(validationError);\r\n      expect(error.type).toBe('validation');\r\n      expect(error.retryable).toBe(false);\r\n      expect(error.code).toBe('400');\r\n    });\r\n  });\r\n});\r\n\r\n// ===================================\r\n// TESTS DE RETRY AUTOMÁTICO\r\n// ===================================\r\n\r\ndescribe('useSearchErrorHandler - Retry Logic', () => {\r\n  it('should retry failed operations with exponential backoff', async () => {\r\n    const { result } = renderHook(() => \r\n      useSearchErrorHandler({\r\n        retryConfig: {\r\n          maxRetries: 3,\r\n          baseDelay: 100,\r\n          backoffFactor: 2,\r\n        }\r\n      })\r\n    );\r\n\r\n    let callCount = 0;\r\n    const failingOperation = jest.fn().mockImplementation(() => {\r\n      callCount++;\r\n      if (callCount < 3) {\r\n        throw new Error('Network error');\r\n      }\r\n      return Promise.resolve('success');\r\n    });\r\n\r\n    let executePromise: Promise<any>;\r\n\r\n    await act(async () => {\r\n      executePromise = result.current.executeWithRetry(failingOperation, 'test operation');\r\n    });\r\n\r\n    // Avanzar timers para los retries\r\n    await act(async () => {\r\n      jest.advanceTimersByTime(100); // Primer retry\r\n      await Promise.resolve();\r\n      jest.advanceTimersByTime(200); // Segundo retry\r\n      await Promise.resolve();\r\n    });\r\n\r\n    const result_value = await executePromise!;\r\n\r\n    expect(result_value).toBe('success');\r\n    expect(failingOperation).toHaveBeenCalledTimes(3);\r\n  });\r\n\r\n  it('should not retry non-retryable errors', async () => {\r\n    const { result } = renderHook(() => useSearchErrorHandler());\r\n\r\n    const error = new Error('Bad Request');\r\n    (error as any).status = 400;\r\n    const nonRetryableOperation = jest.fn().mockRejectedValue(error);\r\n\r\n    await act(async () => {\r\n      await expect(\r\n        result.current.executeWithRetry(nonRetryableOperation, 'validation test')\r\n      ).rejects.toThrow();\r\n    });\r\n\r\n    expect(nonRetryableOperation).toHaveBeenCalledTimes(1);\r\n  });\r\n\r\n  it('should stop retrying after max attempts', async () => {\r\n    const { result } = renderHook(() =>\r\n      useSearchErrorHandler({\r\n        retryConfig: { maxRetries: 2, baseDelay: 1 } // Delay muy pequeño\r\n      })\r\n    );\r\n\r\n    const alwaysFailingOperation = jest.fn().mockRejectedValue(\r\n      new Error('Persistent error')\r\n    );\r\n\r\n    // Usar real timers para este test\r\n    jest.useRealTimers();\r\n\r\n    await expect(\r\n      result.current.executeWithRetry(\r\n        alwaysFailingOperation,\r\n        'persistent failure test'\r\n      )\r\n    ).rejects.toThrow('Persistent error');\r\n\r\n    expect(alwaysFailingOperation).toHaveBeenCalledTimes(3); // Original + 2 retries\r\n\r\n    // Restaurar fake timers\r\n    jest.useFakeTimers();\r\n  });\r\n});\r\n\r\n// ===================================\r\n// TESTS DE CALLBACKS\r\n// ===================================\r\n\r\ndescribe('useSearchErrorHandler - Callbacks', () => {\r\n  it('should call onError callback when error occurs', () => {\r\n    const onError = jest.fn();\r\n    const { result } = renderHook(() => useSearchErrorHandler({ onError }));\r\n\r\n    const testError = new Error('Test error');\r\n\r\n    act(() => {\r\n      result.current.handleError(testError);\r\n    });\r\n\r\n    expect(onError).toHaveBeenCalledWith(\r\n      expect.objectContaining({\r\n        type: 'unknown',\r\n        message: 'Test error',\r\n        retryable: true,\r\n      })\r\n    );\r\n  });\r\n\r\n  it('should call onRetrySuccess callback on successful retry', async () => {\r\n    const onRetrySuccess = jest.fn();\r\n    const { result } = renderHook(() => \r\n      useSearchErrorHandler({ \r\n        onRetrySuccess,\r\n        retryConfig: { maxRetries: 2, baseDelay: 50 }\r\n      })\r\n    );\r\n\r\n    let callCount = 0;\r\n    const retryOperation = jest.fn().mockImplementation(() => {\r\n      callCount++;\r\n      if (callCount === 1) {\r\n        throw new Error('First failure');\r\n      }\r\n      return Promise.resolve('success');\r\n    });\r\n\r\n    let executePromise: Promise<any>;\r\n\r\n    await act(async () => {\r\n      executePromise = result.current.executeWithRetry(retryOperation);\r\n    });\r\n\r\n    await act(async () => {\r\n      jest.advanceTimersByTime(50);\r\n      await Promise.resolve();\r\n    });\r\n\r\n    await executePromise!;\r\n\r\n    expect(onRetrySuccess).toHaveBeenCalled();\r\n  });\r\n\r\n  it('should call onRetryFailed callback when all retries fail', async () => {\r\n    const onRetryFailed = jest.fn();\r\n    const { result } = renderHook(() =>\r\n      useSearchErrorHandler({\r\n        onRetryFailed,\r\n        retryConfig: { maxRetries: 1, baseDelay: 1 } // Delay muy pequeño\r\n      })\r\n    );\r\n\r\n    const failingOperation = jest.fn().mockRejectedValue(new Error('Always fails'));\r\n\r\n    // Usar real timers para este test\r\n    jest.useRealTimers();\r\n\r\n    await expect(\r\n      result.current.executeWithRetry(failingOperation)\r\n    ).rejects.toThrow();\r\n\r\n    expect(onRetryFailed).toHaveBeenCalledWith(\r\n      expect.objectContaining({\r\n        type: 'unknown',\r\n        message: 'Always fails',\r\n      }),\r\n      1 // número de intentos\r\n    );\r\n\r\n    // Restaurar fake timers\r\n    jest.useFakeTimers();\r\n  });\r\n});\r\n\r\n// ===================================\r\n// TESTS DE ESTADO\r\n// ===================================\r\n\r\ndescribe('useSearchErrorHandler - State Management', () => {\r\n  it('should update retry state during retries', async () => {\r\n    const { result } = renderHook(() => \r\n      useSearchErrorHandler({\r\n        retryConfig: { maxRetries: 2, baseDelay: 50 }\r\n      })\r\n    );\r\n\r\n    let callCount = 0;\r\n    const retryOperation = jest.fn().mockImplementation(() => {\r\n      callCount++;\r\n      if (callCount < 3) {\r\n        throw new Error('Retry test');\r\n      }\r\n      return Promise.resolve('success');\r\n    });\r\n\r\n    let executePromise: Promise<any>;\r\n\r\n    await act(async () => {\r\n      executePromise = result.current.executeWithRetry(retryOperation);\r\n    });\r\n\r\n    // Verificar estado durante primer retry\r\n    await act(async () => {\r\n      jest.advanceTimersByTime(50);\r\n      await Promise.resolve();\r\n    });\r\n\r\n    expect(result.current.isRetrying).toBe(true);\r\n    expect(result.current.retryCount).toBe(1);\r\n\r\n    // Completar la operación\r\n    await act(async () => {\r\n      jest.advanceTimersByTime(100);\r\n      await Promise.resolve();\r\n    });\r\n\r\n    await executePromise!;\r\n\r\n    expect(result.current.isRetrying).toBe(false);\r\n    expect(result.current.retryCount).toBe(0);\r\n  });\r\n\r\n  it('should clear error state', () => {\r\n    const { result } = renderHook(() => useSearchErrorHandler());\r\n\r\n    // Simular error\r\n    act(() => {\r\n      result.current.handleError(new Error('Test error'));\r\n    });\r\n\r\n    expect(result.current.hasError).toBe(true);\r\n\r\n    // Limpiar error\r\n    act(() => {\r\n      result.current.clearError();\r\n    });\r\n\r\n    expect(result.current.hasError).toBe(false);\r\n    expect(result.current.currentError).toBe(null);\r\n    expect(result.current.retryCount).toBe(0);\r\n  });\r\n});\r\n"],"names":["beforeEach","jest","clearAllMocks","useFakeTimers","spyOn","console","mockImplementation","afterEach","useRealTimers","restoreAllMocks","describe","it","result","renderHook","useSearchErrorHandler","expect","current","currentError","toBe","retryCount","isRetrying","hasError","retryConfig","maxRetries","baseDelay","networkError","TypeError","name","act","error","handleError","type","retryable","message","toContain","timeoutError","Error","serverError","status","code","validationError","backoffFactor","callCount","failingOperation","fn","Promise","resolve","executePromise","executeWithRetry","advanceTimersByTime","result_value","toHaveBeenCalledTimes","nonRetryableOperation","mockRejectedValue","rejects","toThrow","alwaysFailingOperation","onError","testError","toHaveBeenCalledWith","objectContaining","onRetrySuccess","retryOperation","toHaveBeenCalled","onRetryFailed","clearError"],"mappings":"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"}