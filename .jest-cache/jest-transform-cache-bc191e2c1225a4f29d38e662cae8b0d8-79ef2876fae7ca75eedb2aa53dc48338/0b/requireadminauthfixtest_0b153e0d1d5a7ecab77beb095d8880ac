414dbcfe08fd8809e2790029575ab0ed
// ===================================
// PINTEYA E-COMMERCE - TEST PARA VERIFICAR CORRECCIÓN requireAdminAuth
// ===================================
"use strict";
// Mock completo de supabase-auth-utils
jest.mock('@/lib/auth/supabase-auth-utils', ()=>({
        requireAdminAuth: jest.fn()
    }));
// Mock de authenticatedAdmin
jest.mock('@/lib/auth/admin-auth', ()=>({
        authenticatedAdmin: jest.fn()
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _server = require("next/server");
const mockAuthenticatedAdmin = authenticatedAdmin;
describe('requireAdminAuth - Corrección Error 401', ()=>{
    beforeEach(()=>{
        jest.clearAllMocks();
        console.log = jest.fn(); // Silenciar logs en tests
        console.warn = jest.fn();
    });
    it('debe usar authenticatedAdmin corregida y autorizar admin correctamente', async ()=>{
        // Mock de usuario admin válido
        mockAuthenticatedAdmin.mockResolvedValue({
            userId: 'user_admin123',
            sessionId: 'sess_123',
            isAdmin: true,
            user: {
                id: 'user_admin123',
                email: 'santiago@xor.com.ar'
            }
        });
        const mockRequest = new _server.NextRequest('https://example.com/api/admin/monitoring');
        const result = await requireAdminAuth(mockRequest);
        expect(result).toEqual({
            success: true,
            user: {
                id: 'user_admin123',
                email: 'santiago@xor.com.ar',
                role: 'admin',
                permissions: {}
            },
            supabase: undefined,
            isAdmin: true
        });
        expect(mockAuthenticatedAdmin).toHaveBeenCalledWith(mockRequest);
    });
    it('debe rechazar usuario no autenticado', async ()=>{
        // Mock de usuario no autenticado
        mockAuthenticatedAdmin.mockResolvedValue({
            userId: null,
            isAdmin: false,
            error: 'Usuario no autenticado',
            status: 401
        });
        const mockRequest = new _server.NextRequest('https://example.com/api/admin/monitoring');
        const result = await requireAdminAuth(mockRequest);
        expect(result).toEqual({
            success: false,
            error: 'Usuario no autenticado',
            status: 401
        });
    });
    it('debe rechazar usuario autenticado pero no admin', async ()=>{
        // Mock de usuario regular (no admin)
        mockAuthenticatedAdmin.mockResolvedValue({
            userId: 'user_regular123',
            isAdmin: false,
            user: {
                id: 'user_regular123',
                email: 'user@example.com'
            }
        });
        const mockRequest = new _server.NextRequest('https://example.com/api/admin/monitoring');
        const result = await requireAdminAuth(mockRequest);
        expect(result).toEqual({
            success: false,
            error: 'Acceso denegado: se requiere rol de administrador',
            status: 403
        });
    });
    it('debe manejar errores de authenticatedAdmin', async ()=>{
        // Mock de error en authenticatedAdmin
        mockAuthenticatedAdmin.mockRejectedValue(new Error('Clerk API error'));
        const mockRequest = new _server.NextRequest('https://example.com/api/admin/monitoring');
        const result = await requireAdminAuth(mockRequest);
        expect(result).toEqual({
            success: false,
            error: 'Error interno del servidor',
            status: 500
        });
    });
    it('debe manejar usuario admin sin objeto user completo', async ()=>{
        // Mock de admin con datos mínimos
        mockAuthenticatedAdmin.mockResolvedValue({
            userId: 'user_admin123',
            isAdmin: true,
            user: undefined // Sin objeto user completo
        });
        const mockRequest = new _server.NextRequest('https://example.com/api/admin/monitoring');
        const result = await requireAdminAuth(mockRequest);
        expect(result).toEqual({
            success: true,
            user: {
                id: 'user_admin123',
                email: 'unknown',
                role: 'admin',
                permissions: {}
            },
            supabase: undefined,
            isAdmin: true
        });
    });
});
describe('requireAdminAuth - Integración con APIs de Monitoreo', ()=>{
    it('debe funcionar correctamente para /api/admin/monitoring', async ()=>{
        mockAuthenticatedAdmin.mockResolvedValue({
            userId: 'user_admin123',
            isAdmin: true,
            user: {
                id: 'user_admin123',
                email: 'santiago@xor.com.ar'
            }
        });
        const mockRequest = new _server.NextRequest('https://pinteya.com/api/admin/monitoring');
        const result = await requireAdminAuth(mockRequest);
        expect(result.success).toBe(true);
        expect(result.user?.role).toBe('admin');
    });
    it('debe funcionar correctamente para /api/admin/monitoring/enterprise-metrics', async ()=>{
        mockAuthenticatedAdmin.mockResolvedValue({
            userId: 'user_admin123',
            isAdmin: true,
            user: {
                id: 'user_admin123',
                email: 'santiago@xor.com.ar'
            }
        });
        const mockRequest = new _server.NextRequest('https://pinteya.com/api/admin/monitoring/enterprise-metrics');
        const result = await requireAdminAuth(mockRequest, [
            'admin_access',
            'monitoring_access'
        ]);
        expect(result.success).toBe(true);
        expect(result.isAdmin).toBe(true);
    });
});
describe('requireAdminAuth - Verificación de Regresión', ()=>{
    it('NO debe usar la función authenticatedUser antigua (que esperaba Bearer token)', async ()=>{
        // Este test verifica que ya no se use la función que esperaba Bearer tokens
        mockAuthenticatedAdmin.mockResolvedValue({
            userId: 'user_admin123',
            isAdmin: true,
            user: {
                id: 'user_admin123',
                email: 'santiago@xor.com.ar'
            }
        });
        const mockRequest = new _server.NextRequest('https://pinteya.com/api/admin/monitoring');
        // NO agregar header Authorization - debe funcionar con cookies de sesión
        const result = await requireAdminAuth(mockRequest);
        expect(result.success).toBe(true);
        expect(mockAuthenticatedAdmin).toHaveBeenCalledWith(mockRequest);
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcX190ZXN0c19fXFxhdXRoXFxyZXF1aXJlLWFkbWluLWF1dGgtZml4LnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUElOVEVZQSBFLUNPTU1FUkNFIC0gVEVTVCBQQVJBIFZFUklGSUNBUiBDT1JSRUNDScOTTiByZXF1aXJlQWRtaW5BdXRoXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCB9IGZyb20gJ25leHQvc2VydmVyJztcclxuXHJcbi8vIE1vY2sgY29tcGxldG8gZGUgc3VwYWJhc2UtYXV0aC11dGlsc1xyXG5qZXN0Lm1vY2soJ0AvbGliL2F1dGgvc3VwYWJhc2UtYXV0aC11dGlscycsICgpID0+ICh7XHJcbiAgcmVxdWlyZUFkbWluQXV0aDogamVzdC5mbigpLFxyXG59KSk7XHJcblxyXG4vLyBNb2NrIGRlIGF1dGhlbnRpY2F0ZWRBZG1pblxyXG5qZXN0Lm1vY2soJ0AvbGliL2F1dGgvYWRtaW4tYXV0aCcsICgpID0+ICh7XHJcbiAgYXV0aGVudGljYXRlZEFkbWluOiBqZXN0LmZuKCksXHJcbn0pKTtcclxuXHJcbmNvbnN0IG1vY2tBdXRoZW50aWNhdGVkQWRtaW4gPSBhdXRoZW50aWNhdGVkQWRtaW4gYXMgamVzdC5Nb2NrZWRGdW5jdGlvbjx0eXBlb2YgYXV0aGVudGljYXRlZEFkbWluPjtcclxuXHJcbmRlc2NyaWJlKCdyZXF1aXJlQWRtaW5BdXRoIC0gQ29ycmVjY2nDs24gRXJyb3IgNDAxJywgKCkgPT4ge1xyXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XHJcbiAgICBjb25zb2xlLmxvZyA9IGplc3QuZm4oKTsgLy8gU2lsZW5jaWFyIGxvZ3MgZW4gdGVzdHNcclxuICAgIGNvbnNvbGUud2FybiA9IGplc3QuZm4oKTtcclxuICB9KTtcclxuXHJcbiAgaXQoJ2RlYmUgdXNhciBhdXRoZW50aWNhdGVkQWRtaW4gY29ycmVnaWRhIHkgYXV0b3JpemFyIGFkbWluIGNvcnJlY3RhbWVudGUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAvLyBNb2NrIGRlIHVzdWFyaW8gYWRtaW4gdsOhbGlkb1xyXG4gICAgbW9ja0F1dGhlbnRpY2F0ZWRBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZSh7XHJcbiAgICAgIHVzZXJJZDogJ3VzZXJfYWRtaW4xMjMnLFxyXG4gICAgICBzZXNzaW9uSWQ6ICdzZXNzXzEyMycsXHJcbiAgICAgIGlzQWRtaW46IHRydWUsXHJcbiAgICAgIHVzZXI6IHtcclxuICAgICAgICBpZDogJ3VzZXJfYWRtaW4xMjMnLFxyXG4gICAgICAgIGVtYWlsOiAnc2FudGlhZ29AeG9yLmNvbS5hcidcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgbW9ja1JlcXVlc3QgPSBuZXcgTmV4dFJlcXVlc3QoJ2h0dHBzOi8vZXhhbXBsZS5jb20vYXBpL2FkbWluL21vbml0b3JpbmcnKTtcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlcXVpcmVBZG1pbkF1dGgobW9ja1JlcXVlc3QpO1xyXG5cclxuICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICB1c2VyOiB7XHJcbiAgICAgICAgaWQ6ICd1c2VyX2FkbWluMTIzJyxcclxuICAgICAgICBlbWFpbDogJ3NhbnRpYWdvQHhvci5jb20uYXInLFxyXG4gICAgICAgIHJvbGU6ICdhZG1pbicsXHJcbiAgICAgICAgcGVybWlzc2lvbnM6IHt9XHJcbiAgICAgIH0sXHJcbiAgICAgIHN1cGFiYXNlOiB1bmRlZmluZWQsXHJcbiAgICAgIGlzQWRtaW46IHRydWVcclxuICAgIH0pO1xyXG5cclxuICAgIGV4cGVjdChtb2NrQXV0aGVudGljYXRlZEFkbWluKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChtb2NrUmVxdWVzdCk7XHJcbiAgfSk7XHJcblxyXG4gIGl0KCdkZWJlIHJlY2hhemFyIHVzdWFyaW8gbm8gYXV0ZW50aWNhZG8nLCBhc3luYyAoKSA9PiB7XHJcbiAgICAvLyBNb2NrIGRlIHVzdWFyaW8gbm8gYXV0ZW50aWNhZG9cclxuICAgIG1vY2tBdXRoZW50aWNhdGVkQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoe1xyXG4gICAgICB1c2VySWQ6IG51bGwsXHJcbiAgICAgIGlzQWRtaW46IGZhbHNlLFxyXG4gICAgICBlcnJvcjogJ1VzdWFyaW8gbm8gYXV0ZW50aWNhZG8nLFxyXG4gICAgICBzdGF0dXM6IDQwMVxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgbW9ja1JlcXVlc3QgPSBuZXcgTmV4dFJlcXVlc3QoJ2h0dHBzOi8vZXhhbXBsZS5jb20vYXBpL2FkbWluL21vbml0b3JpbmcnKTtcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlcXVpcmVBZG1pbkF1dGgobW9ja1JlcXVlc3QpO1xyXG5cclxuICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6ICdVc3VhcmlvIG5vIGF1dGVudGljYWRvJyxcclxuICAgICAgc3RhdHVzOiA0MDFcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBpdCgnZGViZSByZWNoYXphciB1c3VhcmlvIGF1dGVudGljYWRvIHBlcm8gbm8gYWRtaW4nLCBhc3luYyAoKSA9PiB7XHJcbiAgICAvLyBNb2NrIGRlIHVzdWFyaW8gcmVndWxhciAobm8gYWRtaW4pXHJcbiAgICBtb2NrQXV0aGVudGljYXRlZEFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKHtcclxuICAgICAgdXNlcklkOiAndXNlcl9yZWd1bGFyMTIzJyxcclxuICAgICAgaXNBZG1pbjogZmFsc2UsXHJcbiAgICAgIHVzZXI6IHtcclxuICAgICAgICBpZDogJ3VzZXJfcmVndWxhcjEyMycsXHJcbiAgICAgICAgZW1haWw6ICd1c2VyQGV4YW1wbGUuY29tJ1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBtb2NrUmVxdWVzdCA9IG5ldyBOZXh0UmVxdWVzdCgnaHR0cHM6Ly9leGFtcGxlLmNvbS9hcGkvYWRtaW4vbW9uaXRvcmluZycpO1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVxdWlyZUFkbWluQXV0aChtb2NrUmVxdWVzdCk7XHJcblxyXG4gICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogJ0FjY2VzbyBkZW5lZ2Fkbzogc2UgcmVxdWllcmUgcm9sIGRlIGFkbWluaXN0cmFkb3InLFxyXG4gICAgICBzdGF0dXM6IDQwM1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGl0KCdkZWJlIG1hbmVqYXIgZXJyb3JlcyBkZSBhdXRoZW50aWNhdGVkQWRtaW4nLCBhc3luYyAoKSA9PiB7XHJcbiAgICAvLyBNb2NrIGRlIGVycm9yIGVuIGF1dGhlbnRpY2F0ZWRBZG1pblxyXG4gICAgbW9ja0F1dGhlbnRpY2F0ZWRBZG1pbi5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ0NsZXJrIEFQSSBlcnJvcicpKTtcclxuXHJcbiAgICBjb25zdCBtb2NrUmVxdWVzdCA9IG5ldyBOZXh0UmVxdWVzdCgnaHR0cHM6Ly9leGFtcGxlLmNvbS9hcGkvYWRtaW4vbW9uaXRvcmluZycpO1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVxdWlyZUFkbWluQXV0aChtb2NrUmVxdWVzdCk7XHJcblxyXG4gICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogJ0Vycm9yIGludGVybm8gZGVsIHNlcnZpZG9yJyxcclxuICAgICAgc3RhdHVzOiA1MDBcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBpdCgnZGViZSBtYW5lamFyIHVzdWFyaW8gYWRtaW4gc2luIG9iamV0byB1c2VyIGNvbXBsZXRvJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgLy8gTW9jayBkZSBhZG1pbiBjb24gZGF0b3MgbcOtbmltb3NcclxuICAgIG1vY2tBdXRoZW50aWNhdGVkQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoe1xyXG4gICAgICB1c2VySWQ6ICd1c2VyX2FkbWluMTIzJyxcclxuICAgICAgaXNBZG1pbjogdHJ1ZSxcclxuICAgICAgdXNlcjogdW5kZWZpbmVkIC8vIFNpbiBvYmpldG8gdXNlciBjb21wbGV0b1xyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgbW9ja1JlcXVlc3QgPSBuZXcgTmV4dFJlcXVlc3QoJ2h0dHBzOi8vZXhhbXBsZS5jb20vYXBpL2FkbWluL21vbml0b3JpbmcnKTtcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlcXVpcmVBZG1pbkF1dGgobW9ja1JlcXVlc3QpO1xyXG5cclxuICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICB1c2VyOiB7XHJcbiAgICAgICAgaWQ6ICd1c2VyX2FkbWluMTIzJyxcclxuICAgICAgICBlbWFpbDogJ3Vua25vd24nLFxyXG4gICAgICAgIHJvbGU6ICdhZG1pbicsXHJcbiAgICAgICAgcGVybWlzc2lvbnM6IHt9XHJcbiAgICAgIH0sXHJcbiAgICAgIHN1cGFiYXNlOiB1bmRlZmluZWQsXHJcbiAgICAgIGlzQWRtaW46IHRydWVcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59KTtcclxuXHJcbmRlc2NyaWJlKCdyZXF1aXJlQWRtaW5BdXRoIC0gSW50ZWdyYWNpw7NuIGNvbiBBUElzIGRlIE1vbml0b3JlbycsICgpID0+IHtcclxuICBpdCgnZGViZSBmdW5jaW9uYXIgY29ycmVjdGFtZW50ZSBwYXJhIC9hcGkvYWRtaW4vbW9uaXRvcmluZycsIGFzeW5jICgpID0+IHtcclxuICAgIG1vY2tBdXRoZW50aWNhdGVkQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoe1xyXG4gICAgICB1c2VySWQ6ICd1c2VyX2FkbWluMTIzJyxcclxuICAgICAgaXNBZG1pbjogdHJ1ZSxcclxuICAgICAgdXNlcjoge1xyXG4gICAgICAgIGlkOiAndXNlcl9hZG1pbjEyMycsXHJcbiAgICAgICAgZW1haWw6ICdzYW50aWFnb0B4b3IuY29tLmFyJ1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBtb2NrUmVxdWVzdCA9IG5ldyBOZXh0UmVxdWVzdCgnaHR0cHM6Ly9waW50ZXlhLmNvbS9hcGkvYWRtaW4vbW9uaXRvcmluZycpO1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVxdWlyZUFkbWluQXV0aChtb2NrUmVxdWVzdCk7XHJcblxyXG4gICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xyXG4gICAgZXhwZWN0KHJlc3VsdC51c2VyPy5yb2xlKS50b0JlKCdhZG1pbicpO1xyXG4gIH0pO1xyXG5cclxuICBpdCgnZGViZSBmdW5jaW9uYXIgY29ycmVjdGFtZW50ZSBwYXJhIC9hcGkvYWRtaW4vbW9uaXRvcmluZy9lbnRlcnByaXNlLW1ldHJpY3MnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBtb2NrQXV0aGVudGljYXRlZEFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKHtcclxuICAgICAgdXNlcklkOiAndXNlcl9hZG1pbjEyMycsXHJcbiAgICAgIGlzQWRtaW46IHRydWUsXHJcbiAgICAgIHVzZXI6IHtcclxuICAgICAgICBpZDogJ3VzZXJfYWRtaW4xMjMnLFxyXG4gICAgICAgIGVtYWlsOiAnc2FudGlhZ29AeG9yLmNvbS5hcidcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgbW9ja1JlcXVlc3QgPSBuZXcgTmV4dFJlcXVlc3QoJ2h0dHBzOi8vcGludGV5YS5jb20vYXBpL2FkbWluL21vbml0b3JpbmcvZW50ZXJwcmlzZS1tZXRyaWNzJyk7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXF1aXJlQWRtaW5BdXRoKG1vY2tSZXF1ZXN0LCBbJ2FkbWluX2FjY2VzcycsICdtb25pdG9yaW5nX2FjY2VzcyddKTtcclxuXHJcbiAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XHJcbiAgICBleHBlY3QocmVzdWx0LmlzQWRtaW4pLnRvQmUodHJ1ZSk7XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuZGVzY3JpYmUoJ3JlcXVpcmVBZG1pbkF1dGggLSBWZXJpZmljYWNpw7NuIGRlIFJlZ3Jlc2nDs24nLCAoKSA9PiB7XHJcbiAgaXQoJ05PIGRlYmUgdXNhciBsYSBmdW5jacOzbiBhdXRoZW50aWNhdGVkVXNlciBhbnRpZ3VhIChxdWUgZXNwZXJhYmEgQmVhcmVyIHRva2VuKScsIGFzeW5jICgpID0+IHtcclxuICAgIC8vIEVzdGUgdGVzdCB2ZXJpZmljYSBxdWUgeWEgbm8gc2UgdXNlIGxhIGZ1bmNpw7NuIHF1ZSBlc3BlcmFiYSBCZWFyZXIgdG9rZW5zXHJcbiAgICBtb2NrQXV0aGVudGljYXRlZEFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKHtcclxuICAgICAgdXNlcklkOiAndXNlcl9hZG1pbjEyMycsXHJcbiAgICAgIGlzQWRtaW46IHRydWUsXHJcbiAgICAgIHVzZXI6IHtcclxuICAgICAgICBpZDogJ3VzZXJfYWRtaW4xMjMnLFxyXG4gICAgICAgIGVtYWlsOiAnc2FudGlhZ29AeG9yLmNvbS5hcidcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgbW9ja1JlcXVlc3QgPSBuZXcgTmV4dFJlcXVlc3QoJ2h0dHBzOi8vcGludGV5YS5jb20vYXBpL2FkbWluL21vbml0b3JpbmcnKTtcclxuICAgIC8vIE5PIGFncmVnYXIgaGVhZGVyIEF1dGhvcml6YXRpb24gLSBkZWJlIGZ1bmNpb25hciBjb24gY29va2llcyBkZSBzZXNpw7NuXHJcbiAgICBcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlcXVpcmVBZG1pbkF1dGgobW9ja1JlcXVlc3QpO1xyXG5cclxuICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcclxuICAgIGV4cGVjdChtb2NrQXV0aGVudGljYXRlZEFkbWluKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChtb2NrUmVxdWVzdCk7XHJcbiAgfSk7XHJcbn0pO1xyXG4iXSwibmFtZXMiOlsiamVzdCIsIm1vY2siLCJyZXF1aXJlQWRtaW5BdXRoIiwiZm4iLCJhdXRoZW50aWNhdGVkQWRtaW4iLCJtb2NrQXV0aGVudGljYXRlZEFkbWluIiwiZGVzY3JpYmUiLCJiZWZvcmVFYWNoIiwiY2xlYXJBbGxNb2NrcyIsImNvbnNvbGUiLCJsb2ciLCJ3YXJuIiwiaXQiLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsInVzZXJJZCIsInNlc3Npb25JZCIsImlzQWRtaW4iLCJ1c2VyIiwiaWQiLCJlbWFpbCIsIm1vY2tSZXF1ZXN0IiwiTmV4dFJlcXVlc3QiLCJyZXN1bHQiLCJleHBlY3QiLCJ0b0VxdWFsIiwic3VjY2VzcyIsInJvbGUiLCJwZXJtaXNzaW9ucyIsInN1cGFiYXNlIiwidW5kZWZpbmVkIiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJlcnJvciIsInN0YXR1cyIsIm1vY2tSZWplY3RlZFZhbHVlIiwiRXJyb3IiLCJ0b0JlIl0sIm1hcHBpbmdzIjoiQUFBQSxzQ0FBc0M7QUFDdEMsdUVBQXVFO0FBQ3ZFLHNDQUFzQzs7QUFJdEMsdUNBQXVDO0FBQ3ZDQSxLQUFLQyxJQUFJLENBQUMsa0NBQWtDLElBQU8sQ0FBQTtRQUNqREMsa0JBQWtCRixLQUFLRyxFQUFFO0lBQzNCLENBQUE7QUFFQSw2QkFBNkI7QUFDN0JILEtBQUtDLElBQUksQ0FBQyx5QkFBeUIsSUFBTyxDQUFBO1FBQ3hDRyxvQkFBb0JKLEtBQUtHLEVBQUU7SUFDN0IsQ0FBQTs7Ozt3QkFWNEI7QUFZNUIsTUFBTUUseUJBQXlCRDtBQUUvQkUsU0FBUywyQ0FBMkM7SUFDbERDLFdBQVc7UUFDVFAsS0FB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