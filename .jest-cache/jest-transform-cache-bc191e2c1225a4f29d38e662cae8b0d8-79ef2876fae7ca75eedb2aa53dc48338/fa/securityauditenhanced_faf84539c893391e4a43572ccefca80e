f916a83e7c9339cd723adae2e781e0aa
/**
 * Sistema de Auditoría de Seguridad Mejorado
 * Extiende el sistema base con análisis avanzado, alertas automáticas y reportes
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    DEFAULT_SECURITY_PATTERNS: function() {
        return DEFAULT_SECURITY_PATTERNS;
    },
    analyzeSecurityPatterns: function() {
        return analyzeSecurityPatterns;
    },
    cleanupOldSecurityEvents: function() {
        return cleanupOldSecurityEvents;
    },
    exportSecurityEvents: function() {
        return exportSecurityEvents;
    },
    generateSecurityReport: function() {
        return generateSecurityReport;
    },
    getActiveSecurityAlerts: function() {
        return getActiveSecurityAlerts;
    },
    getSecurityMetrics: function() {
        return getSecurityMetrics;
    },
    markAlertAsFalsePositive: function() {
        return markAlertAsFalsePositive;
    },
    resolveSecurityAlert: function() {
        return resolveSecurityAlert;
    },
    runSecurityHealthCheck: function() {
        return runSecurityHealthCheck;
    },
    startSecurityMonitoring: function() {
        return startSecurityMonitoring;
    },
    stopSecurityMonitoring: function() {
        return stopSecurityMonitoring;
    },
    updateSecurityAlert: function() {
        return updateSecurityAlert;
    }
});
const _supabase = require("../supabase");
const _securityaudit = require("./security-audit");
const _cachemanager = require("../cache-manager");
const DEFAULT_SECURITY_PATTERNS = [
    {
        id: 'brute_force_login',
        name: 'Ataque de Fuerza Bruta',
        description: 'Múltiples intentos de login fallidos desde la misma IP',
        severity: 'high',
        timeWindow: 15,
        threshold: 5,
        enabled: true,
        conditions: [
            {
                field: 'event_type',
                operator: 'equals',
                value: 'AUTH_FAILURE',
                weight: 1
            },
            {
                field: 'ip_address',
                operator: 'equals',
                value: 'same',
                weight: 1
            }
        ],
        actions: [
            {
                type: 'alert',
                parameters: {
                    notify_admins: true
                }
            },
            {
                type: 'log',
                parameters: {
                    severity: 'high'
                }
            }
        ]
    },
    {
        id: 'privilege_escalation',
        name: 'Escalación de Privilegios',
        description: 'Intento de acceso a recursos sin permisos suficientes',
        severity: 'critical',
        timeWindow: 60,
        threshold: 3,
        enabled: true,
        conditions: [
            {
                field: 'event_type',
                operator: 'equals',
                value: 'PERMISSION_DENIED',
                weight: 1
            },
            {
                field: 'event_category',
                operator: 'equals',
                value: 'authorization',
                weight: 1
            }
        ],
        actions: [
            {
                type: 'alert',
                parameters: {
                    notify_admins: true,
                    priority: 'high'
                }
            },
            {
                type: 'log',
                parameters: {
                    severity: 'critical'
                }
            }
        ]
    },
    {
        id: 'suspicious_data_access',
        name: 'Acceso Sospechoso a Datos',
        description: 'Acceso masivo a datos sensibles en corto período',
        severity: 'medium',
        timeWindow: 30,
        threshold: 10,
        enabled: true,
        conditions: [
            {
                field: 'event_type',
                operator: 'equals',
                value: 'DATA_ACCESS',
                weight: 1
            },
            {
                field: 'event_category',
                operator: 'equals',
                value: 'data_access',
                weight: 1
            }
        ],
        actions: [
            {
                type: 'alert',
                parameters: {
                    notify_admins: false
                }
            },
            {
                type: 'log',
                parameters: {
                    severity: 'medium'
                }
            }
        ]
    },
    {
        id: 'admin_action_burst',
        name: 'Ráfaga de Acciones Administrativas',
        description: 'Múltiples acciones administrativas en corto período',
        severity: 'medium',
        timeWindow: 10,
        threshold: 5,
        enabled: true,
        conditions: [
            {
                field: 'event_type',
                operator: 'equals',
                value: 'ADMIN_ACTION',
                weight: 1
            },
            {
                field: 'event_category',
                operator: 'equals',
                value: 'admin_operations',
                weight: 1
            }
        ],
        actions: [
            {
                type: 'alert',
                parameters: {
                    notify_admins: true
                }
            },
            {
                type: 'log',
                parameters: {
                    severity: 'medium'
                }
            }
        ]
    },
    {
        id: 'geographic_anomaly',
        name: 'Anomalía Geográfica',
        description: 'Acceso desde ubicaciones geográficas inusuales',
        severity: 'medium',
        timeWindow: 60,
        threshold: 2,
        enabled: true,
        conditions: [
            {
                field: 'event_type',
                operator: 'equals',
                value: 'AUTH_SUCCESS',
                weight: 1
            },
            {
                field: 'ip_address',
                operator: 'not_in',
                value: 'usual_locations',
                weight: 1
            }
        ],
        actions: [
            {
                type: 'alert',
                parameters: {
                    notify_user: true
                }
            },
            {
                type: 'log',
                parameters: {
                    severity: 'medium'
                }
            }
        ]
    }
];
async function analyzeSecurityPatterns(userId, timeWindowHours = 24) {
    try {
        console.log('[SECURITY] Iniciando análisis de patrones de seguridad');
        if (!_supabase.supabaseAdmin) {
            throw new Error('Supabase admin client no disponible');
        }
        const timeThreshold = new Date(Date.now() - timeWindowHours * 60 * 60 * 1000).toISOString();
        const alerts = [];
        // Obtener eventos recientes
        let query = _supabase.supabaseAdmin.from('security_events').select('*').gte('timestamp', timeThreshold).order('timestamp', {
            ascending: false
        });
        if (userId) {
            query = query.eq('user_id', userId);
        }
        const { data: events, error } = await query;
        if (error) {
            throw new Error(`Error obteniendo eventos: ${error.message}`);
        }
        if (!events || events.length === 0) {
            return alerts;
        }
        // Analizar cada patrón
        for (const pattern of DEFAULT_SECURITY_PATTERNS){
            if (!pattern.enabled) continue;
            const patternAlerts = await detectPattern(pattern, events);
            alerts.push(...patternAlerts);
        }
        // Guardar alertas en base de datos
        if (alerts.length > 0) {
            const { error: insertError } = await _supabase.supabaseAdmin.from('security_alerts').insert(alerts);
            if (insertError) {
                console.error('[SECURITY] Error guardando alertas:', insertError);
            }
        }
        console.log(`[SECURITY] Análisis completado: ${alerts.length} alertas generadas`);
        return alerts;
    } catch (error) {
        console.error('[SECURITY] Error en análisis de patrones:', error);
        return [];
    }
}
/**
 * Detecta un patrón específico en los eventos
 */ async function detectPattern(pattern, events) {
    const alerts = [];
    const timeWindow = pattern.timeWindow * 60 * 1000; // convertir a ms
    // Agrupar eventos por usuario
    const eventsByUser = events.reduce((acc, event)=>{
        if (!acc[event.user_id]) {
            acc[event.user_id] = [];
        }
        acc[event.user_id].push(event);
        return acc;
    }, {});
    // Analizar cada usuario
    for (const [userId, userEvents] of Object.entries(eventsByUser)){
        const matchingEvents = userEvents.filter((event)=>matchesPatternConditions(event, pattern.conditions));
        if (matchingEvents.length < pattern.threshold) continue;
        // Verificar ventana de tiempo
        const sortedEvents = matchingEvents.sort((a, b)=>new Date(a.timestamp).getTime() - new Date(b.timestamp).getTime());
        for(let i = 0; i <= sortedEvents.length - pattern.threshold; i++){
            const windowStart = new Date(sortedEvents[i].timestamp).getTime();
            const windowEnd = windowStart + timeWindow;
            const eventsInWindow = sortedEvents.filter((event)=>{
                const eventTime = new Date(event.timestamp).getTime();
                return eventTime >= windowStart && eventTime <= windowEnd;
            });
            if (eventsInWindow.length >= pattern.threshold) {
                // Patrón detectado
                const alert = {
                    id: `${pattern.id}_${userId}_${Date.now()}`,
                    pattern_id: pattern.id,
                    user_id: userId,
                    severity: pattern.severity,
                    title: pattern.name,
                    description: `${pattern.description} - ${eventsInWindow.length} eventos detectados`,
                    event_count: eventsInWindow.length,
                    first_occurrence: eventsInWindow[0].timestamp,
                    last_occurrence: eventsInWindow[eventsInWindow.length - 1].timestamp,
                    status: 'open',
                    metadata: {
                        pattern_name: pattern.name,
                        events: eventsInWindow.map((e)=>e.id),
                        threshold: pattern.threshold,
                        time_window_minutes: pattern.timeWindow
                    }
                };
                alerts.push(alert);
                // Ejecutar acciones del patrón
                await executePatternActions(pattern.actions, alert, eventsInWindow);
                break; // Solo una alerta por patrón por usuario
            }
        }
    }
    return alerts;
}
/**
 * Verifica si un evento coincide con las condiciones del patrón
 */ function matchesPatternConditions(event, conditions) {
    return conditions.every((condition)=>{
        const eventValue = event[condition.field];
        switch(condition.operator){
            case 'equals':
                return eventValue === condition.value;
            case 'contains':
                return typeof eventValue === 'string' && eventValue.includes(condition.value);
            case 'greater_than':
                return Number(eventValue) > Number(condition.value);
            case 'less_than':
                return Number(eventValue) < Number(condition.value);
            case 'in':
                return Array.isArray(condition.value) && condition.value.includes(eventValue);
            case 'not_in':
                return Array.isArray(condition.value) && !condition.value.includes(eventValue);
            default:
                return false;
        }
    });
}
/**
 * Ejecuta las acciones definidas para un patrón
 */ async function executePatternActions(actions, alert, events) {
    for (const action of actions){
        try {
            switch(action.type){
                case 'log':
                    await (0, _securityaudit.logSecurityEvent)({
                        user_id: alert.user_id,
                        event_type: 'SUSPICIOUS_ACTIVITY',
                        event_category: 'suspicious_behavior',
                        severity: action.parameters?.severity || alert.severity,
                        description: `Patrón detectado: ${alert.title}`,
                        metadata: {
                            pattern_id: alert.pattern_id,
                            alert_id: alert.id,
                            event_count: alert.event_count,
                            ...action.parameters
                        }
                    });
                    break;
                case 'alert':
                    console.warn(`[SECURITY ALERT] ${alert.title} - Usuario: ${alert.user_id}`);
                    if (action.parameters?.notify_admins) {
                        // Aquí se podría integrar con un sistema de notificaciones
                        console.log('[SECURITY] Notificando a administradores...');
                    }
                    break;
                case 'block_user':
                    console.log(`[SECURITY] Bloqueando usuario: ${alert.user_id}`);
                    break;
                case 'invalidate_sessions':
                    console.log(`[SECURITY] Invalidando sesiones del usuario: ${alert.user_id}`);
                    break;
                default:
                    console.warn(`[SECURITY] Acción no reconocida: ${action.type}`);
            }
        } catch (error) {
            console.error(`[SECURITY] Error ejecutando acción ${action.type}:`, error);
        }
    }
}
async function getSecurityMetrics() {
    try {
        if (!_supabase.supabaseAdmin) {
            throw new Error('Supabase admin client no disponible');
        }
        const cache = _cachemanager.CacheManager.getInstance();
        const cacheKey = 'security_metrics';
        // Intentar obtener desde cache
        const cached = await cache.get(_cachemanager.CACHE_CONFIGS.USER_SESSION, cacheKey);
        if (cached) {
            return cached;
        }
        const now = new Date();
        const last24h = new Date(now.getTime() - 24 * 60 * 60 * 1000).toISOString();
        // Obtener eventos de las últimas 24 horas
        const { data: events, error } = await _supabase.supabaseAdmin.from('security_events').select('*').gte('timestamp', last24h);
        if (error) {
            throw new Error(`Error obteniendo eventos: ${error.message}`);
        }
        // Obtener alertas activas
        const { data: alerts, error: alertsError } = await _supabase.supabaseAdmin.from('security_alerts').select('id').eq('status', 'open');
        if (alertsError) {
            console.error('[SECURITY] Error obteniendo alertas:', alertsError);
        }
        // Calcular métricas
        const totalEvents = events?.length || 0;
        const criticalEvents = events?.filter((e)=>e.severity === 'critical').length || 0;
        const uniqueUsers = new Set(events?.map((e)=>e.user_id)).size;
        const authFailures = events?.filter((e)=>e.event_type === 'AUTH_FAILURE').length || 0;
        const suspiciousActivities = events?.filter((e)=>e.event_type === 'SUSPICIOUS_ACTIVITY').length || 0;
        const activeAlerts = alerts?.length || 0;
        // Calcular score de seguridad (0-100)
        let securityScore = 100;
        if (criticalEvents > 0) securityScore -= criticalEvents * 10;
        if (authFailures > 10) securityScore -= (authFailures - 10) * 2;
        if (suspiciousActivities > 5) securityScore -= (suspiciousActivities - 5) * 5;
        if (activeAlerts > 0) securityScore -= activeAlerts * 3;
        securityScore = Math.max(0, Math.min(100, securityScore));
        const metrics = {
            total_events_24h: totalEvents,
            critical_events_24h: criticalEvents,
            unique_users_24h: uniqueUsers,
            auth_failures_24h: authFailures,
            suspicious_activities_24h: suspiciousActivities,
            blocked_users: 0,
            active_alerts: activeAlerts,
            avg_response_time: 0,
            security_score: securityScore
        };
        // Guardar en cache por 5 minutos
        await cache.set(_cachemanager.CACHE_CONFIGS.USER_SESSION, cacheKey, metrics);
        return metrics;
    } catch (error) {
        console.error('[SECURITY] Error obteniendo métricas:', error);
        return {
            total_events_24h: 0,
            critical_events_24h: 0,
            unique_users_24h: 0,
            auth_failures_24h: 0,
            suspicious_activities_24h: 0,
            blocked_users: 0,
            active_alerts: 0,
            avg_response_time: 0,
            security_score: 0
        };
    }
}
async function generateSecurityReport(startDate, endDate) {
    try {
        if (!_supabase.supabaseAdmin) {
            throw new Error('Supabase admin client no disponible');
        }
        console.log(`[SECURITY] Generando reporte de seguridad: ${startDate.toISOString()} - ${endDate.toISOString()}`);
        // Obtener eventos del período
        const { data: events, error } = await _supabase.supabaseAdmin.from('security_events').select('*').gte('timestamp', startDate.toISOString()).lte('timestamp', endDate.toISOString()).order('timestamp', {
            ascending: false
        });
        if (error) {
            throw new Error(`Error obteniendo eventos: ${error.message}`);
        }
        const totalEvents = events?.length || 0;
        // Agrupar por severidad
        const eventsBySeverity = {
            low: 0,
            medium: 0,
            high: 0,
            critical: 0
        };
        // Agrupar por categoría
        const eventsByCategory = {
            authentication: 0,
            authorization: 0,
            data_access: 0,
            admin_operations: 0,
            suspicious_behavior: 0
        };
        // Contadores de usuarios e IPs
        const userCounts = {};
        const ipCounts = {};
        events?.forEach((event)=>{
            // Contar por severidad
            eventsBySeverity[event.severity]++;
            // Contar por categoría
            eventsByCategory[event.event_category]++;
            // Contar por usuario
            userCounts[event.user_id] = (userCounts[event.user_id] || 0) + 1;
            // Contar por IP
            if (event.ip_address) {
                ipCounts[event.ip_address] = (ipCounts[event.ip_address] || 0) + 1;
            }
        });
        // Top usuarios (más eventos)
        const topUsers = Object.entries(userCounts).sort(([, a], [, b])=>b - a).slice(0, 10).map(([user_id, event_count])=>({
                user_id,
                event_count
            }));
        // Top IPs (más eventos)
        const topIps = Object.entries(ipCounts).sort(([, a], [, b])=>b - a).slice(0, 10).map(([ip_address, event_count])=>({
                ip_address,
                event_count
            }));
        // Obtener patrones detectados
        const { data: alerts, error: alertsError } = await _supabase.supabaseAdmin.from('security_alerts').select('pattern_id').gte('first_occurrence', startDate.toISOString()).lte('last_occurrence', endDate.toISOString());
        const patternsDetected = [];
        if (!alertsError && alerts) {
            const patternCounts = {};
            alerts.forEach((alert)=>{
                patternCounts[alert.pattern_id] = (patternCounts[alert.pattern_id] || 0) + 1;
            });
            Object.entries(patternCounts).forEach(([pattern_id, occurrences])=>{
                patternsDetected.push({
                    pattern_id,
                    occurrences
                });
            });
        }
        // Generar recomendaciones
        const recommendations = generateSecurityRecommendations(eventsBySeverity, eventsByCategory, patternsDetected);
        const report = {
            id: `report_${Date.now()}`,
            period_start: startDate.toISOString(),
            period_end: endDate.toISOString(),
            total_events: totalEvents,
            events_by_severity: eventsBySeverity,
            events_by_category: eventsByCategory,
            top_users: topUsers,
            top_ips: topIps,
            patterns_detected: patternsDetected,
            recommendations,
            generated_at: new Date().toISOString()
        };
        // Guardar reporte en base de datos
        const { error: insertError } = await _supabase.supabaseAdmin.from('security_reports').insert(report);
        if (insertError) {
            console.error('[SECURITY] Error guardando reporte:', insertError);
        }
        console.log(`[SECURITY] Reporte generado: ${totalEvents} eventos analizados`);
        return report;
    } catch (error) {
        console.error('[SECURITY] Error generando reporte:', error);
        throw error;
    }
}
/**
 * Genera recomendaciones de seguridad basadas en los datos del reporte
 */ function generateSecurityRecommendations(eventsBySeverity, eventsByCategory, patternsDetected) {
    const recommendations = [];
    // Recomendaciones basadas en severidad
    if (eventsBySeverity.critical > 0) {
        recommendations.push(`Se detectaron ${eventsBySeverity.critical} eventos críticos. Revisar inmediatamente.`);
    }
    if (eventsBySeverity.high > 10) {
        recommendations.push(`Alto número de eventos de severidad alta (${eventsBySeverity.high}). Considerar reforzar medidas de seguridad.`);
    }
    // Recomendaciones basadas en categorías
    if (eventsByCategory.authentication > 50) {
        recommendations.push(`Muchos eventos de autenticación (${eventsByCategory.authentication}). Considerar implementar MFA.`);
    }
    if (eventsByCategory.authorization > 20) {
        recommendations.push(`Eventos de autorización elevados (${eventsByCategory.authorization}). Revisar permisos de usuarios.`);
    }
    if (eventsByCategory.suspicious_behavior > 5) {
        recommendations.push(`Actividad sospechosa detectada (${eventsByCategory.suspicious_behavior} eventos). Monitorear de cerca.`);
    }
    // Recomendaciones basadas en patrones
    const highFrequencyPatterns = patternsDetected.filter((p)=>p.occurrences > 3);
    if (highFrequencyPatterns.length > 0) {
        recommendations.push(`Patrones de seguridad recurrentes detectados. Considerar medidas preventivas adicionales.`);
    }
    // Recomendaciones generales
    if (recommendations.length === 0) {
        recommendations.push('No se detectaron problemas críticos de seguridad. Mantener monitoreo regular.');
    }
    return recommendations;
}
async function getActiveSecurityAlerts(userId, severity) {
    try {
        if (!_supabase.supabaseAdmin) {
            throw new Error('Supabase admin client no disponible');
        }
        let query = _supabase.supabaseAdmin.from('security_alerts').select('*').eq('status', 'open').order('last_occurrence', {
            ascending: false
        });
        if (userId) {
            query = query.eq('user_id', userId);
        }
        if (severity) {
            query = query.eq('severity', severity);
        }
        const { data: alerts, error } = await query;
        if (error) {
            throw new Error(`Error obteniendo alertas: ${error.message}`);
        }
        return alerts || [];
    } catch (error) {
        console.error('[SECURITY] Error obteniendo alertas activas:', error);
        return [];
    }
}
async function updateSecurityAlert(alertId, updates) {
    try {
        if (!_supabase.supabaseAdmin) {
            throw new Error('Supabase admin client no disponible');
        }
        const { error } = await _supabase.supabaseAdmin.from('security_alerts').update({
            ...updates,
            updated_at: new Date().toISOString()
        }).eq('id', alertId);
        if (error) {
            throw new Error(`Error actualizando alerta: ${error.message}`);
        }
        console.log(`[SECURITY] Alerta ${alertId} actualizada: ${JSON.stringify(updates)}`);
        return true;
    } catch (error) {
        console.error('[SECURITY] Error actualizando alerta:', error);
        return false;
    }
}
async function resolveSecurityAlert(alertId, resolutionNotes, resolvedBy) {
    return await updateSecurityAlert(alertId, {
        status: 'resolved',
        assigned_to: resolvedBy,
        resolution_notes: resolutionNotes
    });
}
async function markAlertAsFalsePositive(alertId, notes, markedBy) {
    return await updateSecurityAlert(alertId, {
        status: 'false_positive',
        assigned_to: markedBy,
        resolution_notes: notes
    });
}
function startSecurityMonitoring(intervalMinutes = 5) {
    console.log(`[SECURITY] Iniciando monitoreo automático cada ${intervalMinutes} minutos`);
    return setInterval(async ()=>{
        try {
            console.log('[SECURITY] Ejecutando análisis automático...');
            // Analizar patrones de seguridad
            const alerts = await analyzeSecurityPatterns();
            if (alerts.length > 0) {
                console.log(`[SECURITY] ${alerts.length} nuevas alertas generadas`);
                // Procesar alertas críticas inmediatamente
                const criticalAlerts = alerts.filter((a)=>a.severity === 'critical');
                if (criticalAlerts.length > 0) {
                    console.warn(`[SECURITY] ¡${criticalAlerts.length} alertas críticas detectadas!`);
                // Aquí se podrían enviar notificaciones inmediatas
                }
            }
            // Actualizar métricas
            await getSecurityMetrics();
        } catch (error) {
            console.error('[SECURITY] Error en monitoreo automático:', error);
        }
    }, intervalMinutes * 60 * 1000);
}
function stopSecurityMonitoring(intervalId) {
    clearInterval(intervalId);
    console.log('[SECURITY] Monitoreo automático detenido');
}
async function runSecurityHealthCheck() {
    try {
        console.log('[SECURITY] Ejecutando verificación completa de seguridad...');
        // Obtener métricas actuales
        const metrics = await getSecurityMetrics();
        // Obtener alertas activas
        const activeAlerts = await getActiveSecurityAlerts();
        const issues = [];
        const recommendations = [];
        let status = 'healthy';
        // Evaluar estado de seguridad
        if (metrics.critical_events_24h > 0) {
            issues.push(`${metrics.critical_events_24h} eventos críticos en las últimas 24 horas`);
            status = 'critical';
        }
        if (metrics.auth_failures_24h > 20) {
            issues.push(`Alto número de fallos de autenticación: ${metrics.auth_failures_24h}`);
            if (status !== 'critical') status = 'warning';
            recommendations.push('Considerar implementar medidas anti-brute force');
        }
        if (metrics.suspicious_activities_24h > 10) {
            issues.push(`Actividad sospechosa elevada: ${metrics.suspicious_activities_24h} eventos`);
            if (status !== 'critical') status = 'warning';
            recommendations.push('Revisar patrones de actividad sospechosa');
        }
        if (metrics.active_alerts > 5) {
            issues.push(`Muchas alertas activas sin resolver: ${metrics.active_alerts}`);
            if (status !== 'critical') status = 'warning';
            recommendations.push('Revisar y resolver alertas pendientes');
        }
        if (metrics.security_score < 70) {
            issues.push(`Score de seguridad bajo: ${metrics.security_score}/100`);
            if (status !== 'critical') status = 'warning';
            recommendations.push('Implementar medidas para mejorar el score de seguridad');
        }
        // Recomendaciones generales
        if (issues.length === 0) {
            recommendations.push('Sistema de seguridad funcionando correctamente');
            recommendations.push('Mantener monitoreo regular y actualizaciones de seguridad');
        }
        console.log(`[SECURITY] Verificación completada - Estado: ${status}`);
        return {
            status,
            issues,
            recommendations,
            metrics
        };
    } catch (error) {
        console.error('[SECURITY] Error en verificación de seguridad:', error);
        return {
            status: 'critical',
            issues: [
                'Error ejecutando verificación de seguridad'
            ],
            recommendations: [
                'Revisar logs del sistema'
            ],
            metrics: await getSecurityMetrics()
        };
    }
}
async function cleanupOldSecurityEvents(daysToKeep = 90) {
    try {
        if (!_supabase.supabaseAdmin) {
            throw new Error('Supabase admin client no disponible');
        }
        const cutoffDate = new Date(Date.now() - daysToKeep * 24 * 60 * 60 * 1000).toISOString();
        const { data, error } = await _supabase.supabaseAdmin.from('security_events').delete().lt('timestamp', cutoffDate);
        if (error) {
            throw new Error(`Error limpiando eventos: ${error.message}`);
        }
        const deletedCount = Array.isArray(data) ? data.length : 0;
        console.log(`[SECURITY] Limpieza completada: ${deletedCount} eventos eliminados`);
        return deletedCount;
    } catch (error) {
        console.error('[SECURITY] Error en limpieza de eventos:', error);
        return 0;
    }
}
async function exportSecurityEvents(startDate, endDate, format = 'json') {
    try {
        if (!_supabase.supabaseAdmin) {
            throw new Error('Supabase admin client no disponible');
        }
        const { data: events, error } = await _supabase.supabaseAdmin.from('security_events').select('*').gte('timestamp', startDate.toISOString()).lte('timestamp', endDate.toISOString()).order('timestamp', {
            ascending: true
        });
        if (error) {
            throw new Error(`Error exportando eventos: ${error.message}`);
        }
        if (format === 'json') {
            return JSON.stringify(events, null, 2);
        } else {
            // Formato CSV
            if (!events || events.length === 0) {
                return 'No hay eventos para exportar';
            }
            const headers = Object.keys(events[0]).join(',');
            const rows = events.map((event)=>Object.values(event).map((value)=>typeof value === 'string' ? `"${value.replace(/"/g, '""')}"` : value).join(','));
            return [
                headers,
                ...rows
            ].join('\n');
        }
    } catch (error) {
        console.error('[SECURITY] Error exportando eventos:', error);
        throw error;
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcbGliXFxhdXRoXFxzZWN1cml0eS1hdWRpdC1lbmhhbmNlZC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFNpc3RlbWEgZGUgQXVkaXRvcsOtYSBkZSBTZWd1cmlkYWQgTWVqb3JhZG9cbiAqIEV4dGllbmRlIGVsIHNpc3RlbWEgYmFzZSBjb24gYW7DoWxpc2lzIGF2YW56YWRvLCBhbGVydGFzIGF1dG9tw6F0aWNhcyB5IHJlcG9ydGVzXG4gKi9cblxuaW1wb3J0IHsgc3VwYWJhc2VBZG1pbiB9IGZyb20gJ0AvbGliL3N1cGFiYXNlJztcbmltcG9ydCB7IFxuICBsb2dTZWN1cml0eUV2ZW50LCBcbiAgdHlwZSBTZWN1cml0eUV2ZW50LCBcbiAgdHlwZSBTZWN1cml0eVNldmVyaXR5LFxuICB0eXBlIFNlY3VyaXR5RXZlbnRUeXBlLFxuICB0eXBlIFNlY3VyaXR5RXZlbnRDYXRlZ29yeSBcbn0gZnJvbSAnLi9zZWN1cml0eS1hdWRpdCc7XG5pbXBvcnQgeyBDYWNoZU1hbmFnZXIsIENBQ0hFX0NPTkZJR1MgfSBmcm9tICdAL2xpYi9jYWNoZS1tYW5hZ2VyJztcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFRJUE9TIFkgSU5URVJGQUNFUyBFWFRFTkRJREFTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgaW50ZXJmYWNlIFNlY3VyaXR5UGF0dGVybiB7XG4gIGlkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgc2V2ZXJpdHk6IFNlY3VyaXR5U2V2ZXJpdHk7XG4gIGNvbmRpdGlvbnM6IFBhdHRlcm5Db25kaXRpb25bXTtcbiAgdGltZVdpbmRvdzogbnVtYmVyOyAvLyBlbiBtaW51dG9zXG4gIHRocmVzaG9sZDogbnVtYmVyO1xuICBlbmFibGVkOiBib29sZWFuO1xuICBhY3Rpb25zOiBTZWN1cml0eUFjdGlvbltdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBhdHRlcm5Db25kaXRpb24ge1xuICBmaWVsZDogc3RyaW5nO1xuICBvcGVyYXRvcjogJ2VxdWFscycgfCAnY29udGFpbnMnIHwgJ2dyZWF0ZXJfdGhhbicgfCAnbGVzc190aGFuJyB8ICdpbicgfCAnbm90X2luJztcbiAgdmFsdWU6IGFueTtcbiAgd2VpZ2h0OiBudW1iZXI7IC8vIHBlc28gZW4gZWwgY8OhbGN1bG8gZGVsIHBhdHLDs25cbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZWN1cml0eUFjdGlvbiB7XG4gIHR5cGU6ICdsb2cnIHwgJ2FsZXJ0JyB8ICdibG9ja191c2VyJyB8ICdub3RpZnlfYWRtaW4nIHwgJ2ludmFsaWRhdGVfc2Vzc2lvbnMnO1xuICBwYXJhbWV0ZXJzPzogUmVjb3JkPHN0cmluZywgYW55Pjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZWN1cml0eVJlcG9ydCB7XG4gIGlkOiBzdHJpbmc7XG4gIHBlcmlvZF9zdGFydDogc3RyaW5nO1xuICBwZXJpb2RfZW5kOiBzdHJpbmc7XG4gIHRvdGFsX2V2ZW50czogbnVtYmVyO1xuICBldmVudHNfYnlfc2V2ZXJpdHk6IFJlY29yZDxTZWN1cml0eVNldmVyaXR5LCBudW1iZXI+O1xuICBldmVudHNfYnlfY2F0ZWdvcnk6IFJlY29yZDxTZWN1cml0eUV2ZW50Q2F0ZWdvcnksIG51bWJlcj47XG4gIHRvcF91c2VyczogQXJyYXk8eyB1c2VyX2lkOiBzdHJpbmc7IGV2ZW50X2NvdW50OiBudW1iZXIgfT47XG4gIHRvcF9pcHM6IEFycmF5PHsgaXBfYWRkcmVzczogc3RyaW5nOyBldmVudF9jb3VudDogbnVtYmVyIH0+O1xuICBwYXR0ZXJuc19kZXRlY3RlZDogQXJyYXk8eyBwYXR0ZXJuX2lkOiBzdHJpbmc7IG9jY3VycmVuY2VzOiBudW1iZXIgfT47XG4gIHJlY29tbWVuZGF0aW9uczogc3RyaW5nW107XG4gIGdlbmVyYXRlZF9hdDogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNlY3VyaXR5TWV0cmljcyB7XG4gIHRvdGFsX2V2ZW50c18yNGg6IG51bWJlcjtcbiAgY3JpdGljYWxfZXZlbnRzXzI0aDogbnVtYmVyO1xuICB1bmlxdWVfdXNlcnNfMjRoOiBudW1iZXI7XG4gIGF1dGhfZmFpbHVyZXNfMjRoOiBudW1iZXI7XG4gIHN1c3BpY2lvdXNfYWN0aXZpdGllc18yNGg6IG51bWJlcjtcbiAgYmxvY2tlZF91c2VyczogbnVtYmVyO1xuICBhY3RpdmVfYWxlcnRzOiBudW1iZXI7XG4gIGF2Z19yZXNwb25zZV90aW1lOiBudW1iZXI7XG4gIHNlY3VyaXR5X3Njb3JlOiBudW1iZXI7IC8vIDAtMTAwXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VjdXJpdHlBbGVydCB7XG4gIGlkOiBzdHJpbmc7XG4gIHBhdHRlcm5faWQ6IHN0cmluZztcbiAgdXNlcl9pZDogc3RyaW5nO1xuICBzZXZlcml0eTogU2VjdXJpdHlTZXZlcml0eTtcbiAgdGl0bGU6IHN0cmluZztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgZXZlbnRfY291bnQ6IG51bWJlcjtcbiAgZmlyc3Rfb2NjdXJyZW5jZTogc3RyaW5nO1xuICBsYXN0X29jY3VycmVuY2U6IHN0cmluZztcbiAgc3RhdHVzOiAnb3BlbicgfCAnaW52ZXN0aWdhdGluZycgfCAncmVzb2x2ZWQnIHwgJ2ZhbHNlX3Bvc2l0aXZlJztcbiAgYXNzaWduZWRfdG8/OiBzdHJpbmc7XG4gIHJlc29sdXRpb25fbm90ZXM/OiBzdHJpbmc7XG4gIG1ldGFkYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUEFUUk9ORVMgREUgU0VHVVJJREFEIFBSRURFRklOSURPU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VDVVJJVFlfUEFUVEVSTlM6IFNlY3VyaXR5UGF0dGVybltdID0gW1xuICB7XG4gICAgaWQ6ICdicnV0ZV9mb3JjZV9sb2dpbicsXG4gICAgbmFtZTogJ0F0YXF1ZSBkZSBGdWVyemEgQnJ1dGEnLFxuICAgIGRlc2NyaXB0aW9uOiAnTcO6bHRpcGxlcyBpbnRlbnRvcyBkZSBsb2dpbiBmYWxsaWRvcyBkZXNkZSBsYSBtaXNtYSBJUCcsXG4gICAgc2V2ZXJpdHk6ICdoaWdoJyxcbiAgICB0aW1lV2luZG93OiAxNSxcbiAgICB0aHJlc2hvbGQ6IDUsXG4gICAgZW5hYmxlZDogdHJ1ZSxcbiAgICBjb25kaXRpb25zOiBbXG4gICAgICB7IGZpZWxkOiAnZXZlbnRfdHlwZScsIG9wZXJhdG9yOiAnZXF1YWxzJywgdmFsdWU6ICdBVVRIX0ZBSUxVUkUnLCB3ZWlnaHQ6IDEgfSxcbiAgICAgIHsgZmllbGQ6ICdpcF9hZGRyZXNzJywgb3BlcmF0b3I6ICdlcXVhbHMnLCB2YWx1ZTogJ3NhbWUnLCB3ZWlnaHQ6IDEgfVxuICAgIF0sXG4gICAgYWN0aW9uczogW1xuICAgICAgeyB0eXBlOiAnYWxlcnQnLCBwYXJhbWV0ZXJzOiB7IG5vdGlmeV9hZG1pbnM6IHRydWUgfSB9LFxuICAgICAgeyB0eXBlOiAnbG9nJywgcGFyYW1ldGVyczogeyBzZXZlcml0eTogJ2hpZ2gnIH0gfVxuICAgIF1cbiAgfSxcbiAge1xuICAgIGlkOiAncHJpdmlsZWdlX2VzY2FsYXRpb24nLFxuICAgIG5hbWU6ICdFc2NhbGFjacOzbiBkZSBQcml2aWxlZ2lvcycsXG4gICAgZGVzY3JpcHRpb246ICdJbnRlbnRvIGRlIGFjY2VzbyBhIHJlY3Vyc29zIHNpbiBwZXJtaXNvcyBzdWZpY2llbnRlcycsXG4gICAgc2V2ZXJpdHk6ICdjcml0aWNhbCcsXG4gICAgdGltZVdpbmRvdzogNjAsXG4gICAgdGhyZXNob2xkOiAzLFxuICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgY29uZGl0aW9uczogW1xuICAgICAgeyBmaWVsZDogJ2V2ZW50X3R5cGUnLCBvcGVyYXRvcjogJ2VxdWFscycsIHZhbHVlOiAnUEVSTUlTU0lPTl9ERU5JRUQnLCB3ZWlnaHQ6IDEgfSxcbiAgICAgIHsgZmllbGQ6ICdldmVudF9jYXRlZ29yeScsIG9wZXJhdG9yOiAnZXF1YWxzJywgdmFsdWU6ICdhdXRob3JpemF0aW9uJywgd2VpZ2h0OiAxIH1cbiAgICBdLFxuICAgIGFjdGlvbnM6IFtcbiAgICAgIHsgdHlwZTogJ2FsZXJ0JywgcGFyYW1ldGVyczogeyBub3RpZnlfYWRtaW5zOiB0cnVlLCBwcmlvcml0eTogJ2hpZ2gnIH0gfSxcbiAgICAgIHsgdHlwZTogJ2xvZycsIHBhcmFtZXRlcnM6IHsgc2V2ZXJpdHk6ICdjcml0aWNhbCcgfSB9XG4gICAgXVxuICB9LFxuICB7XG4gICAgaWQ6ICdzdXNwaWNpb3VzX2RhdGFfYWNjZXNzJyxcbiAgICBuYW1lOiAnQWNjZXNvIFNvc3BlY2hvc28gYSBEYXRvcycsXG4gICAgZGVzY3JpcHRpb246ICdBY2Nlc28gbWFzaXZvIGEgZGF0b3Mgc2Vuc2libGVzIGVuIGNvcnRvIHBlcsOtb2RvJyxcbiAgICBzZXZlcml0eTogJ21lZGl1bScsXG4gICAgdGltZVdpbmRvdzogMzAsXG4gICAgdGhyZXNob2xkOiAxMCxcbiAgICBlbmFibGVkOiB0cnVlLFxuICAgIGNvbmRpdGlvbnM6IFtcbiAgICAgIHsgZmllbGQ6ICdldmVudF90eXBlJywgb3BlcmF0b3I6ICdlcXVhbHMnLCB2YWx1ZTogJ0RBVEFfQUNDRVNTJywgd2VpZ2h0OiAxIH0sXG4gICAgICB7IGZpZWxkOiAnZXZlbnRfY2F0ZWdvcnknLCBvcGVyYXRvcjogJ2VxdWFscycsIHZhbHVlOiAnZGF0YV9hY2Nlc3MnLCB3ZWlnaHQ6IDEgfVxuICAgIF0sXG4gICAgYWN0aW9uczogW1xuICAgICAgeyB0eXBlOiAnYWxlcnQnLCBwYXJhbWV0ZXJzOiB7IG5vdGlmeV9hZG1pbnM6IGZhbHNlIH0gfSxcbiAgICAgIHsgdHlwZTogJ2xvZycsIHBhcmFtZXRlcnM6IHsgc2V2ZXJpdHk6ICdtZWRpdW0nIH0gfVxuICAgIF1cbiAgfSxcbiAge1xuICAgIGlkOiAnYWRtaW5fYWN0aW9uX2J1cnN0JyxcbiAgICBuYW1lOiAnUsOhZmFnYSBkZSBBY2Npb25lcyBBZG1pbmlzdHJhdGl2YXMnLFxuICAgIGRlc2NyaXB0aW9uOiAnTcO6bHRpcGxlcyBhY2Npb25lcyBhZG1pbmlzdHJhdGl2YXMgZW4gY29ydG8gcGVyw61vZG8nLFxuICAgIHNldmVyaXR5OiAnbWVkaXVtJyxcbiAgICB0aW1lV2luZG93OiAxMCxcbiAgICB0aHJlc2hvbGQ6IDUsXG4gICAgZW5hYmxlZDogdHJ1ZSxcbiAgICBjb25kaXRpb25zOiBbXG4gICAgICB7IGZpZWxkOiAnZXZlbnRfdHlwZScsIG9wZXJhdG9yOiAnZXF1YWxzJywgdmFsdWU6ICdBRE1JTl9BQ1RJT04nLCB3ZWlnaHQ6IDEgfSxcbiAgICAgIHsgZmllbGQ6ICdldmVudF9jYXRlZ29yeScsIG9wZXJhdG9yOiAnZXF1YWxzJywgdmFsdWU6ICdhZG1pbl9vcGVyYXRpb25zJywgd2VpZ2h0OiAxIH1cbiAgICBdLFxuICAgIGFjdGlvbnM6IFtcbiAgICAgIHsgdHlwZTogJ2FsZXJ0JywgcGFyYW1ldGVyczogeyBub3RpZnlfYWRtaW5zOiB0cnVlIH0gfSxcbiAgICAgIHsgdHlwZTogJ2xvZycsIHBhcmFtZXRlcnM6IHsgc2V2ZXJpdHk6ICdtZWRpdW0nIH0gfVxuICAgIF1cbiAgfSxcbiAge1xuICAgIGlkOiAnZ2VvZ3JhcGhpY19hbm9tYWx5JyxcbiAgICBuYW1lOiAnQW5vbWFsw61hIEdlb2dyw6FmaWNhJyxcbiAgICBkZXNjcmlwdGlvbjogJ0FjY2VzbyBkZXNkZSB1YmljYWNpb25lcyBnZW9ncsOhZmljYXMgaW51c3VhbGVzJyxcbiAgICBzZXZlcml0eTogJ21lZGl1bScsXG4gICAgdGltZVdpbmRvdzogNjAsXG4gICAgdGhyZXNob2xkOiAyLFxuICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgY29uZGl0aW9uczogW1xuICAgICAgeyBmaWVsZDogJ2V2ZW50X3R5cGUnLCBvcGVyYXRvcjogJ2VxdWFscycsIHZhbHVlOiAnQVVUSF9TVUNDRVNTJywgd2VpZ2h0OiAxIH0sXG4gICAgICB7IGZpZWxkOiAnaXBfYWRkcmVzcycsIG9wZXJhdG9yOiAnbm90X2luJywgdmFsdWU6ICd1c3VhbF9sb2NhdGlvbnMnLCB3ZWlnaHQ6IDEgfVxuICAgIF0sXG4gICAgYWN0aW9uczogW1xuICAgICAgeyB0eXBlOiAnYWxlcnQnLCBwYXJhbWV0ZXJzOiB7IG5vdGlmeV91c2VyOiB0cnVlIH0gfSxcbiAgICAgIHsgdHlwZTogJ2xvZycsIHBhcmFtZXRlcnM6IHsgc2V2ZXJpdHk6ICdtZWRpdW0nIH0gfVxuICAgIF1cbiAgfVxuXTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEZVTkNJT05FUyBERSBBTsOBTElTSVMgQVZBTlpBRE9cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogQW5hbGl6YSBldmVudG9zIGRlIHNlZ3VyaWRhZCBwYXJhIGRldGVjdGFyIHBhdHJvbmVzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhbmFseXplU2VjdXJpdHlQYXR0ZXJucyhcbiAgdXNlcklkPzogc3RyaW5nLFxuICB0aW1lV2luZG93SG91cnM6IG51bWJlciA9IDI0XG4pOiBQcm9taXNlPFNlY3VyaXR5QWxlcnRbXT4ge1xuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKCdbU0VDVVJJVFldIEluaWNpYW5kbyBhbsOhbGlzaXMgZGUgcGF0cm9uZXMgZGUgc2VndXJpZGFkJyk7XG5cbiAgICBpZiAoIXN1cGFiYXNlQWRtaW4pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignU3VwYWJhc2UgYWRtaW4gY2xpZW50IG5vIGRpc3BvbmlibGUnKTtcbiAgICB9XG5cbiAgICBjb25zdCB0aW1lVGhyZXNob2xkID0gbmV3IERhdGUoRGF0ZS5ub3coKSAtIHRpbWVXaW5kb3dIb3VycyAqIDYwICogNjAgKiAxMDAwKS50b0lTT1N0cmluZygpO1xuICAgIGNvbnN0IGFsZXJ0czogU2VjdXJpdHlBbGVydFtdID0gW107XG5cbiAgICAvLyBPYnRlbmVyIGV2ZW50b3MgcmVjaWVudGVzXG4gICAgbGV0IHF1ZXJ5ID0gc3VwYWJhc2VBZG1pblxuICAgICAgLmZyb20oJ3NlY3VyaXR5X2V2ZW50cycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5ndGUoJ3RpbWVzdGFtcCcsIHRpbWVUaHJlc2hvbGQpXG4gICAgICAub3JkZXIoJ3RpbWVzdGFtcCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcblxuICAgIGlmICh1c2VySWQpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ3VzZXJfaWQnLCB1c2VySWQpO1xuICAgIH1cblxuICAgIGNvbnN0IHsgZGF0YTogZXZlbnRzLCBlcnJvciB9ID0gYXdhaXQgcXVlcnk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3Igb2J0ZW5pZW5kbyBldmVudG9zOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuXG4gICAgaWYgKCFldmVudHMgfHwgZXZlbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIGFsZXJ0cztcbiAgICB9XG5cbiAgICAvLyBBbmFsaXphciBjYWRhIHBhdHLDs25cbiAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgREVGQVVMVF9TRUNVUklUWV9QQVRURVJOUykge1xuICAgICAgaWYgKCFwYXR0ZXJuLmVuYWJsZWQpIGNvbnRpbnVlO1xuXG4gICAgICBjb25zdCBwYXR0ZXJuQWxlcnRzID0gYXdhaXQgZGV0ZWN0UGF0dGVybihwYXR0ZXJuLCBldmVudHMpO1xuICAgICAgYWxlcnRzLnB1c2goLi4ucGF0dGVybkFsZXJ0cyk7XG4gICAgfVxuXG4gICAgLy8gR3VhcmRhciBhbGVydGFzIGVuIGJhc2UgZGUgZGF0b3NcbiAgICBpZiAoYWxlcnRzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IHsgZXJyb3I6IGluc2VydEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAgIC5mcm9tKCdzZWN1cml0eV9hbGVydHMnKVxuICAgICAgICAuaW5zZXJ0KGFsZXJ0cyk7XG5cbiAgICAgIGlmIChpbnNlcnRFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbU0VDVVJJVFldIEVycm9yIGd1YXJkYW5kbyBhbGVydGFzOicsIGluc2VydEVycm9yKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhgW1NFQ1VSSVRZXSBBbsOhbGlzaXMgY29tcGxldGFkbzogJHthbGVydHMubGVuZ3RofSBhbGVydGFzIGdlbmVyYWRhc2ApO1xuICAgIHJldHVybiBhbGVydHM7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW1NFQ1VSSVRZXSBFcnJvciBlbiBhbsOhbGlzaXMgZGUgcGF0cm9uZXM6JywgZXJyb3IpO1xuICAgIHJldHVybiBbXTtcbiAgfVxufVxuXG4vKipcbiAqIERldGVjdGEgdW4gcGF0csOzbiBlc3BlY8OtZmljbyBlbiBsb3MgZXZlbnRvc1xuICovXG5hc3luYyBmdW5jdGlvbiBkZXRlY3RQYXR0ZXJuKFxuICBwYXR0ZXJuOiBTZWN1cml0eVBhdHRlcm4sXG4gIGV2ZW50czogU2VjdXJpdHlFdmVudFtdXG4pOiBQcm9taXNlPFNlY3VyaXR5QWxlcnRbXT4ge1xuICBjb25zdCBhbGVydHM6IFNlY3VyaXR5QWxlcnRbXSA9IFtdO1xuICBjb25zdCB0aW1lV2luZG93ID0gcGF0dGVybi50aW1lV2luZG93ICogNjAgKiAxMDAwOyAvLyBjb252ZXJ0aXIgYSBtc1xuXG4gIC8vIEFncnVwYXIgZXZlbnRvcyBwb3IgdXN1YXJpb1xuICBjb25zdCBldmVudHNCeVVzZXIgPSBldmVudHMucmVkdWNlKChhY2MsIGV2ZW50KSA9PiB7XG4gICAgaWYgKCFhY2NbZXZlbnQudXNlcl9pZF0pIHtcbiAgICAgIGFjY1tldmVudC51c2VyX2lkXSA9IFtdO1xuICAgIH1cbiAgICBhY2NbZXZlbnQudXNlcl9pZF0ucHVzaChldmVudCk7XG4gICAgcmV0dXJuIGFjYztcbiAgfSwge30gYXMgUmVjb3JkPHN0cmluZywgU2VjdXJpdHlFdmVudFtdPik7XG5cbiAgLy8gQW5hbGl6YXIgY2FkYSB1c3VhcmlvXG4gIGZvciAoY29uc3QgW3VzZXJJZCwgdXNlckV2ZW50c10gb2YgT2JqZWN0LmVudHJpZXMoZXZlbnRzQnlVc2VyKSkge1xuICAgIGNvbnN0IG1hdGNoaW5nRXZlbnRzID0gdXNlckV2ZW50cy5maWx0ZXIoZXZlbnQgPT4gXG4gICAgICBtYXRjaGVzUGF0dGVybkNvbmRpdGlvbnMoZXZlbnQsIHBhdHRlcm4uY29uZGl0aW9ucylcbiAgICApO1xuXG4gICAgaWYgKG1hdGNoaW5nRXZlbnRzLmxlbmd0aCA8IHBhdHRlcm4udGhyZXNob2xkKSBjb250aW51ZTtcblxuICAgIC8vIFZlcmlmaWNhciB2ZW50YW5hIGRlIHRpZW1wb1xuICAgIGNvbnN0IHNvcnRlZEV2ZW50cyA9IG1hdGNoaW5nRXZlbnRzLnNvcnQoKGEsIGIpID0+IFxuICAgICAgbmV3IERhdGUoYS50aW1lc3RhbXApLmdldFRpbWUoKSAtIG5ldyBEYXRlKGIudGltZXN0YW1wKS5nZXRUaW1lKClcbiAgICApO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gc29ydGVkRXZlbnRzLmxlbmd0aCAtIHBhdHRlcm4udGhyZXNob2xkOyBpKyspIHtcbiAgICAgIGNvbnN0IHdpbmRvd1N0YXJ0ID0gbmV3IERhdGUoc29ydGVkRXZlbnRzW2ldLnRpbWVzdGFtcCkuZ2V0VGltZSgpO1xuICAgICAgY29uc3Qgd2luZG93RW5kID0gd2luZG93U3RhcnQgKyB0aW1lV2luZG93O1xuICAgICAgXG4gICAgICBjb25zdCBldmVudHNJbldpbmRvdyA9IHNvcnRlZEV2ZW50cy5maWx0ZXIoZXZlbnQgPT4ge1xuICAgICAgICBjb25zdCBldmVudFRpbWUgPSBuZXcgRGF0ZShldmVudC50aW1lc3RhbXApLmdldFRpbWUoKTtcbiAgICAgICAgcmV0dXJuIGV2ZW50VGltZSA+PSB3aW5kb3dTdGFydCAmJiBldmVudFRpbWUgPD0gd2luZG93RW5kO1xuICAgICAgfSk7XG5cbiAgICAgIGlmIChldmVudHNJbldpbmRvdy5sZW5ndGggPj0gcGF0dGVybi50aHJlc2hvbGQpIHtcbiAgICAgICAgLy8gUGF0csOzbiBkZXRlY3RhZG9cbiAgICAgICAgY29uc3QgYWxlcnQ6IFNlY3VyaXR5QWxlcnQgPSB7XG4gICAgICAgICAgaWQ6IGAke3BhdHRlcm4uaWR9XyR7dXNlcklkfV8ke0RhdGUubm93KCl9YCxcbiAgICAgICAgICBwYXR0ZXJuX2lkOiBwYXR0ZXJuLmlkLFxuICAgICAgICAgIHVzZXJfaWQ6IHVzZXJJZCxcbiAgICAgICAgICBzZXZlcml0eTogcGF0dGVybi5zZXZlcml0eSxcbiAgICAgICAgICB0aXRsZTogcGF0dGVybi5uYW1lLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBgJHtwYXR0ZXJuLmRlc2NyaXB0aW9ufSAtICR7ZXZlbnRzSW5XaW5kb3cubGVuZ3RofSBldmVudG9zIGRldGVjdGFkb3NgLFxuICAgICAgICAgIGV2ZW50X2NvdW50OiBldmVudHNJbldpbmRvdy5sZW5ndGgsXG4gICAgICAgICAgZmlyc3Rfb2NjdXJyZW5jZTogZXZlbnRzSW5XaW5kb3dbMF0udGltZXN0YW1wLFxuICAgICAgICAgIGxhc3Rfb2NjdXJyZW5jZTogZXZlbnRzSW5XaW5kb3dbZXZlbnRzSW5XaW5kb3cubGVuZ3RoIC0gMV0udGltZXN0YW1wLFxuICAgICAgICAgIHN0YXR1czogJ29wZW4nLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBwYXR0ZXJuX25hbWU6IHBhdHRlcm4ubmFtZSxcbiAgICAgICAgICAgIGV2ZW50czogZXZlbnRzSW5XaW5kb3cubWFwKGUgPT4gZS5pZCksXG4gICAgICAgICAgICB0aHJlc2hvbGQ6IHBhdHRlcm4udGhyZXNob2xkLFxuICAgICAgICAgICAgdGltZV93aW5kb3dfbWludXRlczogcGF0dGVybi50aW1lV2luZG93XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGFsZXJ0cy5wdXNoKGFsZXJ0KTtcblxuICAgICAgICAvLyBFamVjdXRhciBhY2Npb25lcyBkZWwgcGF0csOzblxuICAgICAgICBhd2FpdCBleGVjdXRlUGF0dGVybkFjdGlvbnMocGF0dGVybi5hY3Rpb25zLCBhbGVydCwgZXZlbnRzSW5XaW5kb3cpO1xuICAgICAgICBicmVhazsgLy8gU29sbyB1bmEgYWxlcnRhIHBvciBwYXRyw7NuIHBvciB1c3VhcmlvXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGFsZXJ0cztcbn1cblxuLyoqXG4gKiBWZXJpZmljYSBzaSB1biBldmVudG8gY29pbmNpZGUgY29uIGxhcyBjb25kaWNpb25lcyBkZWwgcGF0csOzblxuICovXG5mdW5jdGlvbiBtYXRjaGVzUGF0dGVybkNvbmRpdGlvbnMoXG4gIGV2ZW50OiBTZWN1cml0eUV2ZW50LFxuICBjb25kaXRpb25zOiBQYXR0ZXJuQ29uZGl0aW9uW11cbik6IGJvb2xlYW4ge1xuICByZXR1cm4gY29uZGl0aW9ucy5ldmVyeShjb25kaXRpb24gPT4ge1xuICAgIGNvbnN0IGV2ZW50VmFsdWUgPSAoZXZlbnQgYXMgYW55KVtjb25kaXRpb24uZmllbGRdO1xuICAgIFxuICAgIHN3aXRjaCAoY29uZGl0aW9uLm9wZXJhdG9yKSB7XG4gICAgICBjYXNlICdlcXVhbHMnOlxuICAgICAgICByZXR1cm4gZXZlbnRWYWx1ZSA9PT0gY29uZGl0aW9uLnZhbHVlO1xuICAgICAgY2FzZSAnY29udGFpbnMnOlxuICAgICAgICByZXR1cm4gdHlwZW9mIGV2ZW50VmFsdWUgPT09ICdzdHJpbmcnICYmIGV2ZW50VmFsdWUuaW5jbHVkZXMoY29uZGl0aW9uLnZhbHVlKTtcbiAgICAgIGNhc2UgJ2dyZWF0ZXJfdGhhbic6XG4gICAgICAgIHJldHVybiBOdW1iZXIoZXZlbnRWYWx1ZSkgPiBOdW1iZXIoY29uZGl0aW9uLnZhbHVlKTtcbiAgICAgIGNhc2UgJ2xlc3NfdGhhbic6XG4gICAgICAgIHJldHVybiBOdW1iZXIoZXZlbnRWYWx1ZSkgPCBOdW1iZXIoY29uZGl0aW9uLnZhbHVlKTtcbiAgICAgIGNhc2UgJ2luJzpcbiAgICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkoY29uZGl0aW9uLnZhbHVlKSAmJiBjb25kaXRpb24udmFsdWUuaW5jbHVkZXMoZXZlbnRWYWx1ZSk7XG4gICAgICBjYXNlICdub3RfaW4nOlxuICAgICAgICByZXR1cm4gQXJyYXkuaXNBcnJheShjb25kaXRpb24udmFsdWUpICYmICFjb25kaXRpb24udmFsdWUuaW5jbHVkZXMoZXZlbnRWYWx1ZSk7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9KTtcbn1cblxuLyoqXG4gKiBFamVjdXRhIGxhcyBhY2Npb25lcyBkZWZpbmlkYXMgcGFyYSB1biBwYXRyw7NuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVQYXR0ZXJuQWN0aW9ucyhcbiAgYWN0aW9uczogU2VjdXJpdHlBY3Rpb25bXSxcbiAgYWxlcnQ6IFNlY3VyaXR5QWxlcnQsXG4gIGV2ZW50czogU2VjdXJpdHlFdmVudFtdXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgZm9yIChjb25zdCBhY3Rpb24gb2YgYWN0aW9ucykge1xuICAgIHRyeSB7XG4gICAgICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7XG4gICAgICAgIGNhc2UgJ2xvZyc6XG4gICAgICAgICAgYXdhaXQgbG9nU2VjdXJpdHlFdmVudCh7XG4gICAgICAgICAgICB1c2VyX2lkOiBhbGVydC51c2VyX2lkLFxuICAgICAgICAgICAgZXZlbnRfdHlwZTogJ1NVU1BJQ0lPVVNfQUNUSVZJVFknLFxuICAgICAgICAgICAgZXZlbnRfY2F0ZWdvcnk6ICdzdXNwaWNpb3VzX2JlaGF2aW9yJyxcbiAgICAgICAgICAgIHNldmVyaXR5OiBhY3Rpb24ucGFyYW1ldGVycz8uc2V2ZXJpdHkgfHwgYWxlcnQuc2V2ZXJpdHksXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogYFBhdHLDs24gZGV0ZWN0YWRvOiAke2FsZXJ0LnRpdGxlfWAsXG4gICAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgICBwYXR0ZXJuX2lkOiBhbGVydC5wYXR0ZXJuX2lkLFxuICAgICAgICAgICAgICBhbGVydF9pZDogYWxlcnQuaWQsXG4gICAgICAgICAgICAgIGV2ZW50X2NvdW50OiBhbGVydC5ldmVudF9jb3VudCxcbiAgICAgICAgICAgICAgLi4uYWN0aW9uLnBhcmFtZXRlcnNcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdhbGVydCc6XG4gICAgICAgICAgY29uc29sZS53YXJuKGBbU0VDVVJJVFkgQUxFUlRdICR7YWxlcnQudGl0bGV9IC0gVXN1YXJpbzogJHthbGVydC51c2VyX2lkfWApO1xuICAgICAgICAgIGlmIChhY3Rpb24ucGFyYW1ldGVycz8ubm90aWZ5X2FkbWlucykge1xuICAgICAgICAgICAgLy8gQXF1w60gc2UgcG9kcsOtYSBpbnRlZ3JhciBjb24gdW4gc2lzdGVtYSBkZSBub3RpZmljYWNpb25lc1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1tTRUNVUklUWV0gTm90aWZpY2FuZG8gYSBhZG1pbmlzdHJhZG9yZXMuLi4nKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnYmxvY2tfdXNlcic6XG4gICAgICAgICAgY29uc29sZS5sb2coYFtTRUNVUklUWV0gQmxvcXVlYW5kbyB1c3VhcmlvOiAke2FsZXJ0LnVzZXJfaWR9YCk7XG4gICAgICAgICAgLy8gSW1wbGVtZW50YXIgbMOzZ2ljYSBkZSBibG9xdWVvXG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnaW52YWxpZGF0ZV9zZXNzaW9ucyc6XG4gICAgICAgICAgY29uc29sZS5sb2coYFtTRUNVUklUWV0gSW52YWxpZGFuZG8gc2VzaW9uZXMgZGVsIHVzdWFyaW86ICR7YWxlcnQudXNlcl9pZH1gKTtcbiAgICAgICAgICAvLyBJbnRlZ3JhciBjb24gc2lzdGVtYSBkZSBnZXN0acOzbiBkZSBzZXNpb25lc1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgY29uc29sZS53YXJuKGBbU0VDVVJJVFldIEFjY2nDs24gbm8gcmVjb25vY2lkYTogJHthY3Rpb24udHlwZX1gKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihgW1NFQ1VSSVRZXSBFcnJvciBlamVjdXRhbmRvIGFjY2nDs24gJHthY3Rpb24udHlwZX06YCwgZXJyb3IpO1xuICAgIH1cbiAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRlVOQ0lPTkVTIERFIE3DiVRSSUNBUyBZIFJFUE9SVEVTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIE9idGllbmUgbcOpdHJpY2FzIGRlIHNlZ3VyaWRhZCBlbiB0aWVtcG8gcmVhbFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2VjdXJpdHlNZXRyaWNzKCk6IFByb21pc2U8U2VjdXJpdHlNZXRyaWNzPiB7XG4gIHRyeSB7XG4gICAgaWYgKCFzdXBhYmFzZUFkbWluKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1N1cGFiYXNlIGFkbWluIGNsaWVudCBubyBkaXNwb25pYmxlJyk7XG4gICAgfVxuXG4gICAgY29uc3QgY2FjaGUgPSBDYWNoZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKTtcbiAgICBjb25zdCBjYWNoZUtleSA9ICdzZWN1cml0eV9tZXRyaWNzJztcblxuICAgIC8vIEludGVudGFyIG9idGVuZXIgZGVzZGUgY2FjaGVcbiAgICBjb25zdCBjYWNoZWQgPSBhd2FpdCBjYWNoZS5nZXQoQ0FDSEVfQ09ORklHUy5VU0VSX1NFU1NJT04sIGNhY2hlS2V5KTtcbiAgICBpZiAoY2FjaGVkKSB7XG4gICAgICByZXR1cm4gY2FjaGVkIGFzIFNlY3VyaXR5TWV0cmljcztcbiAgICB9XG5cbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IGxhc3QyNGggPSBuZXcgRGF0ZShub3cuZ2V0VGltZSgpIC0gMjQgKiA2MCAqIDYwICogMTAwMCkudG9JU09TdHJpbmcoKTtcblxuICAgIC8vIE9idGVuZXIgZXZlbnRvcyBkZSBsYXMgw7psdGltYXMgMjQgaG9yYXNcbiAgICBjb25zdCB7IGRhdGE6IGV2ZW50cywgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgIC5mcm9tKCdzZWN1cml0eV9ldmVudHMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZ3RlKCd0aW1lc3RhbXAnLCBsYXN0MjRoKTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBvYnRlbmllbmRvIGV2ZW50b3M6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG5cbiAgICAvLyBPYnRlbmVyIGFsZXJ0YXMgYWN0aXZhc1xuICAgIGNvbnN0IHsgZGF0YTogYWxlcnRzLCBlcnJvcjogYWxlcnRzRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgIC5mcm9tKCdzZWN1cml0eV9hbGVydHMnKVxuICAgICAgLnNlbGVjdCgnaWQnKVxuICAgICAgLmVxKCdzdGF0dXMnLCAnb3BlbicpO1xuXG4gICAgaWYgKGFsZXJ0c0Vycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbU0VDVVJJVFldIEVycm9yIG9idGVuaWVuZG8gYWxlcnRhczonLCBhbGVydHNFcnJvcik7XG4gICAgfVxuXG4gICAgLy8gQ2FsY3VsYXIgbcOpdHJpY2FzXG4gICAgY29uc3QgdG90YWxFdmVudHMgPSBldmVudHM/Lmxlbmd0aCB8fCAwO1xuICAgIGNvbnN0IGNyaXRpY2FsRXZlbnRzID0gZXZlbnRzPy5maWx0ZXIoZSA9PiBlLnNldmVyaXR5ID09PSAnY3JpdGljYWwnKS5sZW5ndGggfHwgMDtcbiAgICBjb25zdCB1bmlxdWVVc2VycyA9IG5ldyBTZXQoZXZlbnRzPy5tYXAoZSA9PiBlLnVzZXJfaWQpKS5zaXplO1xuICAgIGNvbnN0IGF1dGhGYWlsdXJlcyA9IGV2ZW50cz8uZmlsdGVyKGUgPT4gZS5ldmVudF90eXBlID09PSAnQVVUSF9GQUlMVVJFJykubGVuZ3RoIHx8IDA7XG4gICAgY29uc3Qgc3VzcGljaW91c0FjdGl2aXRpZXMgPSBldmVudHM/LmZpbHRlcihlID0+IGUuZXZlbnRfdHlwZSA9PT0gJ1NVU1BJQ0lPVVNfQUNUSVZJVFknKS5sZW5ndGggfHwgMDtcbiAgICBjb25zdCBhY3RpdmVBbGVydHMgPSBhbGVydHM/Lmxlbmd0aCB8fCAwO1xuXG4gICAgLy8gQ2FsY3VsYXIgc2NvcmUgZGUgc2VndXJpZGFkICgwLTEwMClcbiAgICBsZXQgc2VjdXJpdHlTY29yZSA9IDEwMDtcbiAgICBpZiAoY3JpdGljYWxFdmVudHMgPiAwKSBzZWN1cml0eVNjb3JlIC09IGNyaXRpY2FsRXZlbnRzICogMTA7XG4gICAgaWYgKGF1dGhGYWlsdXJlcyA+IDEwKSBzZWN1cml0eVNjb3JlIC09IChhdXRoRmFpbHVyZXMgLSAxMCkgKiAyO1xuICAgIGlmIChzdXNwaWNpb3VzQWN0aXZpdGllcyA+IDUpIHNlY3VyaXR5U2NvcmUgLT0gKHN1c3BpY2lvdXNBY3Rpdml0aWVzIC0gNSkgKiA1O1xuICAgIGlmIChhY3RpdmVBbGVydHMgPiAwKSBzZWN1cml0eVNjb3JlIC09IGFjdGl2ZUFsZXJ0cyAqIDM7XG4gICAgc2VjdXJpdHlTY29yZSA9IE1hdGgubWF4KDAsIE1hdGgubWluKDEwMCwgc2VjdXJpdHlTY29yZSkpO1xuXG4gICAgY29uc3QgbWV0cmljczogU2VjdXJpdHlNZXRyaWNzID0ge1xuICAgICAgdG90YWxfZXZlbnRzXzI0aDogdG90YWxFdmVudHMsXG4gICAgICBjcml0aWNhbF9ldmVudHNfMjRoOiBjcml0aWNhbEV2ZW50cyxcbiAgICAgIHVuaXF1ZV91c2Vyc18yNGg6IHVuaXF1ZVVzZXJzLFxuICAgICAgYXV0aF9mYWlsdXJlc18yNGg6IGF1dGhGYWlsdXJlcyxcbiAgICAgIHN1c3BpY2lvdXNfYWN0aXZpdGllc18yNGg6IHN1c3BpY2lvdXNBY3Rpdml0aWVzLFxuICAgICAgYmxvY2tlZF91c2VyczogMCwgLy8gVE9ETzogaW1wbGVtZW50YXIgY3VhbmRvIHNlIHRlbmdhIHNpc3RlbWEgZGUgYmxvcXVlb1xuICAgICAgYWN0aXZlX2FsZXJ0czogYWN0aXZlQWxlcnRzLFxuICAgICAgYXZnX3Jlc3BvbnNlX3RpbWU6IDAsIC8vIFRPRE86IGNhbGN1bGFyIHRpZW1wbyBwcm9tZWRpbyBkZSByZXNwdWVzdGFcbiAgICAgIHNlY3VyaXR5X3Njb3JlOiBzZWN1cml0eVNjb3JlXG4gICAgfTtcblxuICAgIC8vIEd1YXJkYXIgZW4gY2FjaGUgcG9yIDUgbWludXRvc1xuICAgIGF3YWl0IGNhY2hlLnNldChDQUNIRV9DT05GSUdTLlVTRVJfU0VTU0lPTiwgY2FjaGVLZXksIG1ldHJpY3MpO1xuXG4gICAgcmV0dXJuIG1ldHJpY3M7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW1NFQ1VSSVRZXSBFcnJvciBvYnRlbmllbmRvIG3DqXRyaWNhczonLCBlcnJvcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRvdGFsX2V2ZW50c18yNGg6IDAsXG4gICAgICBjcml0aWNhbF9ldmVudHNfMjRoOiAwLFxuICAgICAgdW5pcXVlX3VzZXJzXzI0aDogMCxcbiAgICAgIGF1dGhfZmFpbHVyZXNfMjRoOiAwLFxuICAgICAgc3VzcGljaW91c19hY3Rpdml0aWVzXzI0aDogMCxcbiAgICAgIGJsb2NrZWRfdXNlcnM6IDAsXG4gICAgICBhY3RpdmVfYWxlcnRzOiAwLFxuICAgICAgYXZnX3Jlc3BvbnNlX3RpbWU6IDAsXG4gICAgICBzZWN1cml0eV9zY29yZTogMFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBHZW5lcmEgdW4gcmVwb3J0ZSBkZSBzZWd1cmlkYWQgcGFyYSB1biBwZXLDrW9kbyBlc3BlY8OtZmljb1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVTZWN1cml0eVJlcG9ydChcbiAgc3RhcnREYXRlOiBEYXRlLFxuICBlbmREYXRlOiBEYXRlXG4pOiBQcm9taXNlPFNlY3VyaXR5UmVwb3J0PiB7XG4gIHRyeSB7XG4gICAgaWYgKCFzdXBhYmFzZUFkbWluKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1N1cGFiYXNlIGFkbWluIGNsaWVudCBubyBkaXNwb25pYmxlJyk7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYFtTRUNVUklUWV0gR2VuZXJhbmRvIHJlcG9ydGUgZGUgc2VndXJpZGFkOiAke3N0YXJ0RGF0ZS50b0lTT1N0cmluZygpfSAtICR7ZW5kRGF0ZS50b0lTT1N0cmluZygpfWApO1xuXG4gICAgLy8gT2J0ZW5lciBldmVudG9zIGRlbCBwZXLDrW9kb1xuICAgIGNvbnN0IHsgZGF0YTogZXZlbnRzLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgICAgLmZyb20oJ3NlY3VyaXR5X2V2ZW50cycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5ndGUoJ3RpbWVzdGFtcCcsIHN0YXJ0RGF0ZS50b0lTT1N0cmluZygpKVxuICAgICAgLmx0ZSgndGltZXN0YW1wJywgZW5kRGF0ZS50b0lTT1N0cmluZygpKVxuICAgICAgLm9yZGVyKCd0aW1lc3RhbXAnLCB7IGFzY2VuZGluZzogZmFsc2UgfSk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3Igb2J0ZW5pZW5kbyBldmVudG9zOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuXG4gICAgY29uc3QgdG90YWxFdmVudHMgPSBldmVudHM/Lmxlbmd0aCB8fCAwO1xuXG4gICAgLy8gQWdydXBhciBwb3Igc2V2ZXJpZGFkXG4gICAgY29uc3QgZXZlbnRzQnlTZXZlcml0eTogUmVjb3JkPFNlY3VyaXR5U2V2ZXJpdHksIG51bWJlcj4gPSB7XG4gICAgICBsb3c6IDAsXG4gICAgICBtZWRpdW06IDAsXG4gICAgICBoaWdoOiAwLFxuICAgICAgY3JpdGljYWw6IDBcbiAgICB9O1xuXG4gICAgLy8gQWdydXBhciBwb3IgY2F0ZWdvcsOtYVxuICAgIGNvbnN0IGV2ZW50c0J5Q2F0ZWdvcnk6IFJlY29yZDxTZWN1cml0eUV2ZW50Q2F0ZWdvcnksIG51bWJlcj4gPSB7XG4gICAgICBhdXRoZW50aWNhdGlvbjogMCxcbiAgICAgIGF1dGhvcml6YXRpb246IDAsXG4gICAgICBkYXRhX2FjY2VzczogMCxcbiAgICAgIGFkbWluX29wZXJhdGlvbnM6IDAsXG4gICAgICBzdXNwaWNpb3VzX2JlaGF2aW9yOiAwXG4gICAgfTtcblxuICAgIC8vIENvbnRhZG9yZXMgZGUgdXN1YXJpb3MgZSBJUHNcbiAgICBjb25zdCB1c2VyQ291bnRzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XG4gICAgY29uc3QgaXBDb3VudHM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcblxuICAgIGV2ZW50cz8uZm9yRWFjaChldmVudCA9PiB7XG4gICAgICAvLyBDb250YXIgcG9yIHNldmVyaWRhZFxuICAgICAgZXZlbnRzQnlTZXZlcml0eVtldmVudC5zZXZlcml0eV0rKztcblxuICAgICAgLy8gQ29udGFyIHBvciBjYXRlZ29yw61hXG4gICAgICBldmVudHNCeUNhdGVnb3J5W2V2ZW50LmV2ZW50X2NhdGVnb3J5XSsrO1xuXG4gICAgICAvLyBDb250YXIgcG9yIHVzdWFyaW9cbiAgICAgIHVzZXJDb3VudHNbZXZlbnQudXNlcl9pZF0gPSAodXNlckNvdW50c1tldmVudC51c2VyX2lkXSB8fCAwKSArIDE7XG5cbiAgICAgIC8vIENvbnRhciBwb3IgSVBcbiAgICAgIGlmIChldmVudC5pcF9hZGRyZXNzKSB7XG4gICAgICAgIGlwQ291bnRzW2V2ZW50LmlwX2FkZHJlc3NdID0gKGlwQ291bnRzW2V2ZW50LmlwX2FkZHJlc3NdIHx8IDApICsgMTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFRvcCB1c3VhcmlvcyAobcOhcyBldmVudG9zKVxuICAgIGNvbnN0IHRvcFVzZXJzID0gT2JqZWN0LmVudHJpZXModXNlckNvdW50cylcbiAgICAgIC5zb3J0KChbLCBhXSwgWywgYl0pID0+IGIgLSBhKVxuICAgICAgLnNsaWNlKDAsIDEwKVxuICAgICAgLm1hcCgoW3VzZXJfaWQsIGV2ZW50X2NvdW50XSkgPT4gKHsgdXNlcl9pZCwgZXZlbnRfY291bnQgfSkpO1xuXG4gICAgLy8gVG9wIElQcyAobcOhcyBldmVudG9zKVxuICAgIGNvbnN0IHRvcElwcyA9IE9iamVjdC5lbnRyaWVzKGlwQ291bnRzKVxuICAgICAgLnNvcnQoKFssIGFdLCBbLCBiXSkgPT4gYiAtIGEpXG4gICAgICAuc2xpY2UoMCwgMTApXG4gICAgICAubWFwKChbaXBfYWRkcmVzcywgZXZlbnRfY291bnRdKSA9PiAoeyBpcF9hZGRyZXNzLCBldmVudF9jb3VudCB9KSk7XG5cbiAgICAvLyBPYnRlbmVyIHBhdHJvbmVzIGRldGVjdGFkb3NcbiAgICBjb25zdCB7IGRhdGE6IGFsZXJ0cywgZXJyb3I6IGFsZXJ0c0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAuZnJvbSgnc2VjdXJpdHlfYWxlcnRzJylcbiAgICAgIC5zZWxlY3QoJ3BhdHRlcm5faWQnKVxuICAgICAgLmd0ZSgnZmlyc3Rfb2NjdXJyZW5jZScsIHN0YXJ0RGF0ZS50b0lTT1N0cmluZygpKVxuICAgICAgLmx0ZSgnbGFzdF9vY2N1cnJlbmNlJywgZW5kRGF0ZS50b0lTT1N0cmluZygpKTtcblxuICAgIGNvbnN0IHBhdHRlcm5zRGV0ZWN0ZWQ6IEFycmF5PHsgcGF0dGVybl9pZDogc3RyaW5nOyBvY2N1cnJlbmNlczogbnVtYmVyIH0+ID0gW107XG4gICAgaWYgKCFhbGVydHNFcnJvciAmJiBhbGVydHMpIHtcbiAgICAgIGNvbnN0IHBhdHRlcm5Db3VudHM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcbiAgICAgIGFsZXJ0cy5mb3JFYWNoKGFsZXJ0ID0+IHtcbiAgICAgICAgcGF0dGVybkNvdW50c1thbGVydC5wYXR0ZXJuX2lkXSA9IChwYXR0ZXJuQ291bnRzW2FsZXJ0LnBhdHRlcm5faWRdIHx8IDApICsgMTtcbiAgICAgIH0pO1xuXG4gICAgICBPYmplY3QuZW50cmllcyhwYXR0ZXJuQ291bnRzKS5mb3JFYWNoKChbcGF0dGVybl9pZCwgb2NjdXJyZW5jZXNdKSA9PiB7XG4gICAgICAgIHBhdHRlcm5zRGV0ZWN0ZWQucHVzaCh7IHBhdHRlcm5faWQsIG9jY3VycmVuY2VzIH0pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gR2VuZXJhciByZWNvbWVuZGFjaW9uZXNcbiAgICBjb25zdCByZWNvbW1lbmRhdGlvbnMgPSBnZW5lcmF0ZVNlY3VyaXR5UmVjb21tZW5kYXRpb25zKFxuICAgICAgZXZlbnRzQnlTZXZlcml0eSxcbiAgICAgIGV2ZW50c0J5Q2F0ZWdvcnksXG4gICAgICBwYXR0ZXJuc0RldGVjdGVkXG4gICAgKTtcblxuICAgIGNvbnN0IHJlcG9ydDogU2VjdXJpdHlSZXBvcnQgPSB7XG4gICAgICBpZDogYHJlcG9ydF8ke0RhdGUubm93KCl9YCxcbiAgICAgIHBlcmlvZF9zdGFydDogc3RhcnREYXRlLnRvSVNPU3RyaW5nKCksXG4gICAgICBwZXJpb2RfZW5kOiBlbmREYXRlLnRvSVNPU3RyaW5nKCksXG4gICAgICB0b3RhbF9ldmVudHM6IHRvdGFsRXZlbnRzLFxuICAgICAgZXZlbnRzX2J5X3NldmVyaXR5OiBldmVudHNCeVNldmVyaXR5LFxuICAgICAgZXZlbnRzX2J5X2NhdGVnb3J5OiBldmVudHNCeUNhdGVnb3J5LFxuICAgICAgdG9wX3VzZXJzOiB0b3BVc2VycyxcbiAgICAgIHRvcF9pcHM6IHRvcElwcyxcbiAgICAgIHBhdHRlcm5zX2RldGVjdGVkOiBwYXR0ZXJuc0RldGVjdGVkLFxuICAgICAgcmVjb21tZW5kYXRpb25zLFxuICAgICAgZ2VuZXJhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICB9O1xuXG4gICAgLy8gR3VhcmRhciByZXBvcnRlIGVuIGJhc2UgZGUgZGF0b3NcbiAgICBjb25zdCB7IGVycm9yOiBpbnNlcnRFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgICAgLmZyb20oJ3NlY3VyaXR5X3JlcG9ydHMnKVxuICAgICAgLmluc2VydChyZXBvcnQpO1xuXG4gICAgaWYgKGluc2VydEVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbU0VDVVJJVFldIEVycm9yIGd1YXJkYW5kbyByZXBvcnRlOicsIGluc2VydEVycm9yKTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhgW1NFQ1VSSVRZXSBSZXBvcnRlIGdlbmVyYWRvOiAke3RvdGFsRXZlbnRzfSBldmVudG9zIGFuYWxpemFkb3NgKTtcbiAgICByZXR1cm4gcmVwb3J0O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tTRUNVUklUWV0gRXJyb3IgZ2VuZXJhbmRvIHJlcG9ydGU6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbi8qKlxuICogR2VuZXJhIHJlY29tZW5kYWNpb25lcyBkZSBzZWd1cmlkYWQgYmFzYWRhcyBlbiBsb3MgZGF0b3MgZGVsIHJlcG9ydGVcbiAqL1xuZnVuY3Rpb24gZ2VuZXJhdGVTZWN1cml0eVJlY29tbWVuZGF0aW9ucyhcbiAgZXZlbnRzQnlTZXZlcml0eTogUmVjb3JkPFNlY3VyaXR5U2V2ZXJpdHksIG51bWJlcj4sXG4gIGV2ZW50c0J5Q2F0ZWdvcnk6IFJlY29yZDxTZWN1cml0eUV2ZW50Q2F0ZWdvcnksIG51bWJlcj4sXG4gIHBhdHRlcm5zRGV0ZWN0ZWQ6IEFycmF5PHsgcGF0dGVybl9pZDogc3RyaW5nOyBvY2N1cnJlbmNlczogbnVtYmVyIH0+XG4pOiBzdHJpbmdbXSB7XG4gIGNvbnN0IHJlY29tbWVuZGF0aW9uczogc3RyaW5nW10gPSBbXTtcblxuICAvLyBSZWNvbWVuZGFjaW9uZXMgYmFzYWRhcyBlbiBzZXZlcmlkYWRcbiAgaWYgKGV2ZW50c0J5U2V2ZXJpdHkuY3JpdGljYWwgPiAwKSB7XG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goYFNlIGRldGVjdGFyb24gJHtldmVudHNCeVNldmVyaXR5LmNyaXRpY2FsfSBldmVudG9zIGNyw610aWNvcy4gUmV2aXNhciBpbm1lZGlhdGFtZW50ZS5gKTtcbiAgfVxuXG4gIGlmIChldmVudHNCeVNldmVyaXR5LmhpZ2ggPiAxMCkge1xuICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKGBBbHRvIG7Dum1lcm8gZGUgZXZlbnRvcyBkZSBzZXZlcmlkYWQgYWx0YSAoJHtldmVudHNCeVNldmVyaXR5LmhpZ2h9KS4gQ29uc2lkZXJhciByZWZvcnphciBtZWRpZGFzIGRlIHNlZ3VyaWRhZC5gKTtcbiAgfVxuXG4gIC8vIFJlY29tZW5kYWNpb25lcyBiYXNhZGFzIGVuIGNhdGVnb3LDrWFzXG4gIGlmIChldmVudHNCeUNhdGVnb3J5LmF1dGhlbnRpY2F0aW9uID4gNTApIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaChgTXVjaG9zIGV2ZW50b3MgZGUgYXV0ZW50aWNhY2nDs24gKCR7ZXZlbnRzQnlDYXRlZ29yeS5hdXRoZW50aWNhdGlvbn0pLiBDb25zaWRlcmFyIGltcGxlbWVudGFyIE1GQS5gKTtcbiAgfVxuXG4gIGlmIChldmVudHNCeUNhdGVnb3J5LmF1dGhvcml6YXRpb24gPiAyMCkge1xuICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKGBFdmVudG9zIGRlIGF1dG9yaXphY2nDs24gZWxldmFkb3MgKCR7ZXZlbnRzQnlDYXRlZ29yeS5hdXRob3JpemF0aW9ufSkuIFJldmlzYXIgcGVybWlzb3MgZGUgdXN1YXJpb3MuYCk7XG4gIH1cblxuICBpZiAoZXZlbnRzQnlDYXRlZ29yeS5zdXNwaWNpb3VzX2JlaGF2aW9yID4gNSkge1xuICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKGBBY3RpdmlkYWQgc29zcGVjaG9zYSBkZXRlY3RhZGEgKCR7ZXZlbnRzQnlDYXRlZ29yeS5zdXNwaWNpb3VzX2JlaGF2aW9yfSBldmVudG9zKS4gTW9uaXRvcmVhciBkZSBjZXJjYS5gKTtcbiAgfVxuXG4gIC8vIFJlY29tZW5kYWNpb25lcyBiYXNhZGFzIGVuIHBhdHJvbmVzXG4gIGNvbnN0IGhpZ2hGcmVxdWVuY3lQYXR0ZXJucyA9IHBhdHRlcm5zRGV0ZWN0ZWQuZmlsdGVyKHAgPT4gcC5vY2N1cnJlbmNlcyA+IDMpO1xuICBpZiAoaGlnaEZyZXF1ZW5jeVBhdHRlcm5zLmxlbmd0aCA+IDApIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaChgUGF0cm9uZXMgZGUgc2VndXJpZGFkIHJlY3VycmVudGVzIGRldGVjdGFkb3MuIENvbnNpZGVyYXIgbWVkaWRhcyBwcmV2ZW50aXZhcyBhZGljaW9uYWxlcy5gKTtcbiAgfVxuXG4gIC8vIFJlY29tZW5kYWNpb25lcyBnZW5lcmFsZXNcbiAgaWYgKHJlY29tbWVuZGF0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnTm8gc2UgZGV0ZWN0YXJvbiBwcm9ibGVtYXMgY3LDrXRpY29zIGRlIHNlZ3VyaWRhZC4gTWFudGVuZXIgbW9uaXRvcmVvIHJlZ3VsYXIuJyk7XG4gIH1cblxuICByZXR1cm4gcmVjb21tZW5kYXRpb25zO1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRlVOQ0lPTkVTIERFIEdFU1RJw5NOIERFIEFMRVJUQVNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogT2J0aWVuZSBhbGVydGFzIGRlIHNlZ3VyaWRhZCBhY3RpdmFzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBY3RpdmVTZWN1cml0eUFsZXJ0cyhcbiAgdXNlcklkPzogc3RyaW5nLFxuICBzZXZlcml0eT86IFNlY3VyaXR5U2V2ZXJpdHlcbik6IFByb21pc2U8U2VjdXJpdHlBbGVydFtdPiB7XG4gIHRyeSB7XG4gICAgaWYgKCFzdXBhYmFzZUFkbWluKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1N1cGFiYXNlIGFkbWluIGNsaWVudCBubyBkaXNwb25pYmxlJyk7XG4gICAgfVxuXG4gICAgbGV0IHF1ZXJ5ID0gc3VwYWJhc2VBZG1pblxuICAgICAgLmZyb20oJ3NlY3VyaXR5X2FsZXJ0cycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5lcSgnc3RhdHVzJywgJ29wZW4nKVxuICAgICAgLm9yZGVyKCdsYXN0X29jY3VycmVuY2UnLCB7IGFzY2VuZGluZzogZmFsc2UgfSk7XG5cbiAgICBpZiAodXNlcklkKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKCd1c2VyX2lkJywgdXNlcklkKTtcbiAgICB9XG5cbiAgICBpZiAoc2V2ZXJpdHkpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ3NldmVyaXR5Jywgc2V2ZXJpdHkpO1xuICAgIH1cblxuICAgIGNvbnN0IHsgZGF0YTogYWxlcnRzLCBlcnJvciB9ID0gYXdhaXQgcXVlcnk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3Igb2J0ZW5pZW5kbyBhbGVydGFzOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGFsZXJ0cyB8fCBbXTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbU0VDVVJJVFldIEVycm9yIG9idGVuaWVuZG8gYWxlcnRhcyBhY3RpdmFzOicsIGVycm9yKTtcbiAgICByZXR1cm4gW107XG4gIH1cbn1cblxuLyoqXG4gKiBBY3R1YWxpemEgZWwgZXN0YWRvIGRlIHVuYSBhbGVydGFcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVNlY3VyaXR5QWxlcnQoXG4gIGFsZXJ0SWQ6IHN0cmluZyxcbiAgdXBkYXRlczogUGFydGlhbDxQaWNrPFNlY3VyaXR5QWxlcnQsICdzdGF0dXMnIHwgJ2Fzc2lnbmVkX3RvJyB8ICdyZXNvbHV0aW9uX25vdGVzJz4+XG4pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgdHJ5IHtcbiAgICBpZiAoIXN1cGFiYXNlQWRtaW4pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignU3VwYWJhc2UgYWRtaW4gY2xpZW50IG5vIGRpc3BvbmlibGUnKTtcbiAgICB9XG5cbiAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAuZnJvbSgnc2VjdXJpdHlfYWxlcnRzJylcbiAgICAgIC51cGRhdGUoe1xuICAgICAgICAuLi51cGRhdGVzLFxuICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgIH0pXG4gICAgICAuZXEoJ2lkJywgYWxlcnRJZCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3IgYWN0dWFsaXphbmRvIGFsZXJ0YTogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKGBbU0VDVVJJVFldIEFsZXJ0YSAke2FsZXJ0SWR9IGFjdHVhbGl6YWRhOiAke0pTT04uc3RyaW5naWZ5KHVwZGF0ZXMpfWApO1xuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tTRUNVUklUWV0gRXJyb3IgYWN0dWFsaXphbmRvIGFsZXJ0YTonLCBlcnJvcik7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbi8qKlxuICogUmVzdWVsdmUgdW5hIGFsZXJ0YSBkZSBzZWd1cmlkYWRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlc29sdmVTZWN1cml0eUFsZXJ0KFxuICBhbGVydElkOiBzdHJpbmcsXG4gIHJlc29sdXRpb25Ob3Rlczogc3RyaW5nLFxuICByZXNvbHZlZEJ5OiBzdHJpbmdcbik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICByZXR1cm4gYXdhaXQgdXBkYXRlU2VjdXJpdHlBbGVydChhbGVydElkLCB7XG4gICAgc3RhdHVzOiAncmVzb2x2ZWQnLFxuICAgIGFzc2lnbmVkX3RvOiByZXNvbHZlZEJ5LFxuICAgIHJlc29sdXRpb25fbm90ZXM6IHJlc29sdXRpb25Ob3Rlc1xuICB9KTtcbn1cblxuLyoqXG4gKiBNYXJjYSB1bmEgYWxlcnRhIGNvbW8gZmFsc28gcG9zaXRpdm9cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG1hcmtBbGVydEFzRmFsc2VQb3NpdGl2ZShcbiAgYWxlcnRJZDogc3RyaW5nLFxuICBub3Rlczogc3RyaW5nLFxuICBtYXJrZWRCeTogc3RyaW5nXG4pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgcmV0dXJuIGF3YWl0IHVwZGF0ZVNlY3VyaXR5QWxlcnQoYWxlcnRJZCwge1xuICAgIHN0YXR1czogJ2ZhbHNlX3Bvc2l0aXZlJyxcbiAgICBhc3NpZ25lZF90bzogbWFya2VkQnksXG4gICAgcmVzb2x1dGlvbl9ub3Rlczogbm90ZXNcbiAgfSk7XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBGVU5DSU9ORVMgREUgTU9OSVRPUkVPIEVOIFRJRU1QTyBSRUFMXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIEluaWNpYSBlbCBtb25pdG9yZW8gYXV0b23DoXRpY28gZGUgc2VndXJpZGFkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzdGFydFNlY3VyaXR5TW9uaXRvcmluZyhpbnRlcnZhbE1pbnV0ZXM6IG51bWJlciA9IDUpOiBOb2RlSlMuVGltZW91dCB7XG4gIGNvbnNvbGUubG9nKGBbU0VDVVJJVFldIEluaWNpYW5kbyBtb25pdG9yZW8gYXV0b23DoXRpY28gY2FkYSAke2ludGVydmFsTWludXRlc30gbWludXRvc2ApO1xuXG4gIHJldHVybiBzZXRJbnRlcnZhbChhc3luYyAoKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCdbU0VDVVJJVFldIEVqZWN1dGFuZG8gYW7DoWxpc2lzIGF1dG9tw6F0aWNvLi4uJyk7XG5cbiAgICAgIC8vIEFuYWxpemFyIHBhdHJvbmVzIGRlIHNlZ3VyaWRhZFxuICAgICAgY29uc3QgYWxlcnRzID0gYXdhaXQgYW5hbHl6ZVNlY3VyaXR5UGF0dGVybnMoKTtcblxuICAgICAgaWYgKGFsZXJ0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBbU0VDVVJJVFldICR7YWxlcnRzLmxlbmd0aH0gbnVldmFzIGFsZXJ0YXMgZ2VuZXJhZGFzYCk7XG5cbiAgICAgICAgLy8gUHJvY2VzYXIgYWxlcnRhcyBjcsOtdGljYXMgaW5tZWRpYXRhbWVudGVcbiAgICAgICAgY29uc3QgY3JpdGljYWxBbGVydHMgPSBhbGVydHMuZmlsdGVyKGEgPT4gYS5zZXZlcml0eSA9PT0gJ2NyaXRpY2FsJyk7XG4gICAgICAgIGlmIChjcml0aWNhbEFsZXJ0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKGBbU0VDVVJJVFldIMKhJHtjcml0aWNhbEFsZXJ0cy5sZW5ndGh9IGFsZXJ0YXMgY3LDrXRpY2FzIGRldGVjdGFkYXMhYCk7XG4gICAgICAgICAgLy8gQXF1w60gc2UgcG9kcsOtYW4gZW52aWFyIG5vdGlmaWNhY2lvbmVzIGlubWVkaWF0YXNcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBBY3R1YWxpemFyIG3DqXRyaWNhc1xuICAgICAgYXdhaXQgZ2V0U2VjdXJpdHlNZXRyaWNzKCk7XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW1NFQ1VSSVRZXSBFcnJvciBlbiBtb25pdG9yZW8gYXV0b23DoXRpY286JywgZXJyb3IpO1xuICAgIH1cbiAgfSwgaW50ZXJ2YWxNaW51dGVzICogNjAgKiAxMDAwKTtcbn1cblxuLyoqXG4gKiBEZXRpZW5lIGVsIG1vbml0b3JlbyBhdXRvbcOhdGljb1xuICovXG5leHBvcnQgZnVuY3Rpb24gc3RvcFNlY3VyaXR5TW9uaXRvcmluZyhpbnRlcnZhbElkOiBOb2RlSlMuVGltZW91dCk6IHZvaWQge1xuICBjbGVhckludGVydmFsKGludGVydmFsSWQpO1xuICBjb25zb2xlLmxvZygnW1NFQ1VSSVRZXSBNb25pdG9yZW8gYXV0b23DoXRpY28gZGV0ZW5pZG8nKTtcbn1cblxuLyoqXG4gKiBFamVjdXRhIHVuYSB2ZXJpZmljYWNpw7NuIGNvbXBsZXRhIGRlIHNlZ3VyaWRhZFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcnVuU2VjdXJpdHlIZWFsdGhDaGVjaygpOiBQcm9taXNlPHtcbiAgc3RhdHVzOiAnaGVhbHRoeScgfCAnd2FybmluZycgfCAnY3JpdGljYWwnO1xuICBpc3N1ZXM6IHN0cmluZ1tdO1xuICByZWNvbW1lbmRhdGlvbnM6IHN0cmluZ1tdO1xuICBtZXRyaWNzOiBTZWN1cml0eU1ldHJpY3M7XG59PiB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coJ1tTRUNVUklUWV0gRWplY3V0YW5kbyB2ZXJpZmljYWNpw7NuIGNvbXBsZXRhIGRlIHNlZ3VyaWRhZC4uLicpO1xuXG4gICAgLy8gT2J0ZW5lciBtw6l0cmljYXMgYWN0dWFsZXNcbiAgICBjb25zdCBtZXRyaWNzID0gYXdhaXQgZ2V0U2VjdXJpdHlNZXRyaWNzKCk7XG5cbiAgICAvLyBPYnRlbmVyIGFsZXJ0YXMgYWN0aXZhc1xuICAgIGNvbnN0IGFjdGl2ZUFsZXJ0cyA9IGF3YWl0IGdldEFjdGl2ZVNlY3VyaXR5QWxlcnRzKCk7XG5cbiAgICBjb25zdCBpc3N1ZXM6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3QgcmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgIGxldCBzdGF0dXM6ICdoZWFsdGh5JyB8ICd3YXJuaW5nJyB8ICdjcml0aWNhbCcgPSAnaGVhbHRoeSc7XG5cbiAgICAvLyBFdmFsdWFyIGVzdGFkbyBkZSBzZWd1cmlkYWRcbiAgICBpZiAobWV0cmljcy5jcml0aWNhbF9ldmVudHNfMjRoID4gMCkge1xuICAgICAgaXNzdWVzLnB1c2goYCR7bWV0cmljcy5jcml0aWNhbF9ldmVudHNfMjRofSBldmVudG9zIGNyw610aWNvcyBlbiBsYXMgw7psdGltYXMgMjQgaG9yYXNgKTtcbiAgICAgIHN0YXR1cyA9ICdjcml0aWNhbCc7XG4gICAgfVxuXG4gICAgaWYgKG1ldHJpY3MuYXV0aF9mYWlsdXJlc18yNGggPiAyMCkge1xuICAgICAgaXNzdWVzLnB1c2goYEFsdG8gbsO6bWVybyBkZSBmYWxsb3MgZGUgYXV0ZW50aWNhY2nDs246ICR7bWV0cmljcy5hdXRoX2ZhaWx1cmVzXzI0aH1gKTtcbiAgICAgIGlmIChzdGF0dXMgIT09ICdjcml0aWNhbCcpIHN0YXR1cyA9ICd3YXJuaW5nJztcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdDb25zaWRlcmFyIGltcGxlbWVudGFyIG1lZGlkYXMgYW50aS1icnV0ZSBmb3JjZScpO1xuICAgIH1cblxuICAgIGlmIChtZXRyaWNzLnN1c3BpY2lvdXNfYWN0aXZpdGllc18yNGggPiAxMCkge1xuICAgICAgaXNzdWVzLnB1c2goYEFjdGl2aWRhZCBzb3NwZWNob3NhIGVsZXZhZGE6ICR7bWV0cmljcy5zdXNwaWNpb3VzX2FjdGl2aXRpZXNfMjRofSBldmVudG9zYCk7XG4gICAgICBpZiAoc3RhdHVzICE9PSAnY3JpdGljYWwnKSBzdGF0dXMgPSAnd2FybmluZyc7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnUmV2aXNhciBwYXRyb25lcyBkZSBhY3RpdmlkYWQgc29zcGVjaG9zYScpO1xuICAgIH1cblxuICAgIGlmIChtZXRyaWNzLmFjdGl2ZV9hbGVydHMgPiA1KSB7XG4gICAgICBpc3N1ZXMucHVzaChgTXVjaGFzIGFsZXJ0YXMgYWN0aXZhcyBzaW4gcmVzb2x2ZXI6ICR7bWV0cmljcy5hY3RpdmVfYWxlcnRzfWApO1xuICAgICAgaWYgKHN0YXR1cyAhPT0gJ2NyaXRpY2FsJykgc3RhdHVzID0gJ3dhcm5pbmcnO1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ1JldmlzYXIgeSByZXNvbHZlciBhbGVydGFzIHBlbmRpZW50ZXMnKTtcbiAgICB9XG5cbiAgICBpZiAobWV0cmljcy5zZWN1cml0eV9zY29yZSA8IDcwKSB7XG4gICAgICBpc3N1ZXMucHVzaChgU2NvcmUgZGUgc2VndXJpZGFkIGJham86ICR7bWV0cmljcy5zZWN1cml0eV9zY29yZX0vMTAwYCk7XG4gICAgICBpZiAoc3RhdHVzICE9PSAnY3JpdGljYWwnKSBzdGF0dXMgPSAnd2FybmluZyc7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnSW1wbGVtZW50YXIgbWVkaWRhcyBwYXJhIG1lam9yYXIgZWwgc2NvcmUgZGUgc2VndXJpZGFkJyk7XG4gICAgfVxuXG4gICAgLy8gUmVjb21lbmRhY2lvbmVzIGdlbmVyYWxlc1xuICAgIGlmIChpc3N1ZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnU2lzdGVtYSBkZSBzZWd1cmlkYWQgZnVuY2lvbmFuZG8gY29ycmVjdGFtZW50ZScpO1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ01hbnRlbmVyIG1vbml0b3JlbyByZWd1bGFyIHkgYWN0dWFsaXphY2lvbmVzIGRlIHNlZ3VyaWRhZCcpO1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKGBbU0VDVVJJVFldIFZlcmlmaWNhY2nDs24gY29tcGxldGFkYSAtIEVzdGFkbzogJHtzdGF0dXN9YCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3RhdHVzLFxuICAgICAgaXNzdWVzLFxuICAgICAgcmVjb21tZW5kYXRpb25zLFxuICAgICAgbWV0cmljc1xuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW1NFQ1VSSVRZXSBFcnJvciBlbiB2ZXJpZmljYWNpw7NuIGRlIHNlZ3VyaWRhZDonLCBlcnJvcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN0YXR1czogJ2NyaXRpY2FsJyxcbiAgICAgIGlzc3VlczogWydFcnJvciBlamVjdXRhbmRvIHZlcmlmaWNhY2nDs24gZGUgc2VndXJpZGFkJ10sXG4gICAgICByZWNvbW1lbmRhdGlvbnM6IFsnUmV2aXNhciBsb2dzIGRlbCBzaXN0ZW1hJ10sXG4gICAgICBtZXRyaWNzOiBhd2FpdCBnZXRTZWN1cml0eU1ldHJpY3MoKVxuICAgIH07XG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEZVTkNJT05FUyBERSBVVElMSURBRFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBMaW1waWEgZXZlbnRvcyBkZSBzZWd1cmlkYWQgYW50aWd1b3NcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNsZWFudXBPbGRTZWN1cml0eUV2ZW50cyhkYXlzVG9LZWVwOiBudW1iZXIgPSA5MCk6IFByb21pc2U8bnVtYmVyPiB7XG4gIHRyeSB7XG4gICAgaWYgKCFzdXBhYmFzZUFkbWluKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1N1cGFiYXNlIGFkbWluIGNsaWVudCBubyBkaXNwb25pYmxlJyk7XG4gICAgfVxuXG4gICAgY29uc3QgY3V0b2ZmRGF0ZSA9IG5ldyBEYXRlKERhdGUubm93KCkgLSBkYXlzVG9LZWVwICogMjQgKiA2MCAqIDYwICogMTAwMCkudG9JU09TdHJpbmcoKTtcblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgIC5mcm9tKCdzZWN1cml0eV9ldmVudHMnKVxuICAgICAgLmRlbGV0ZSgpXG4gICAgICAubHQoJ3RpbWVzdGFtcCcsIGN1dG9mZkRhdGUpO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGxpbXBpYW5kbyBldmVudG9zOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuXG4gICAgY29uc3QgZGVsZXRlZENvdW50ID0gQXJyYXkuaXNBcnJheShkYXRhKSA/IGRhdGEubGVuZ3RoIDogMDtcbiAgICBjb25zb2xlLmxvZyhgW1NFQ1VSSVRZXSBMaW1waWV6YSBjb21wbGV0YWRhOiAke2RlbGV0ZWRDb3VudH0gZXZlbnRvcyBlbGltaW5hZG9zYCk7XG5cbiAgICByZXR1cm4gZGVsZXRlZENvdW50O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tTRUNVUklUWV0gRXJyb3IgZW4gbGltcGllemEgZGUgZXZlbnRvczonLCBlcnJvcik7XG4gICAgcmV0dXJuIDA7XG4gIH1cbn1cblxuLyoqXG4gKiBFeHBvcnRhIGV2ZW50b3MgZGUgc2VndXJpZGFkIHBhcmEgYW7DoWxpc2lzIGV4dGVybm9cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGV4cG9ydFNlY3VyaXR5RXZlbnRzKFxuICBzdGFydERhdGU6IERhdGUsXG4gIGVuZERhdGU6IERhdGUsXG4gIGZvcm1hdDogJ2pzb24nIHwgJ2NzdicgPSAnanNvbidcbik6IFByb21pc2U8c3RyaW5nPiB7XG4gIHRyeSB7XG4gICAgaWYgKCFzdXBhYmFzZUFkbWluKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1N1cGFiYXNlIGFkbWluIGNsaWVudCBubyBkaXNwb25pYmxlJyk7XG4gICAgfVxuXG4gICAgY29uc3QgeyBkYXRhOiBldmVudHMsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAuZnJvbSgnc2VjdXJpdHlfZXZlbnRzJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLmd0ZSgndGltZXN0YW1wJywgc3RhcnREYXRlLnRvSVNPU3RyaW5nKCkpXG4gICAgICAubHRlKCd0aW1lc3RhbXAnLCBlbmREYXRlLnRvSVNPU3RyaW5nKCkpXG4gICAgICAub3JkZXIoJ3RpbWVzdGFtcCcsIHsgYXNjZW5kaW5nOiB0cnVlIH0pO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGV4cG9ydGFuZG8gZXZlbnRvczogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cblxuICAgIGlmIChmb3JtYXQgPT09ICdqc29uJykge1xuICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGV2ZW50cywgbnVsbCwgMik7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEZvcm1hdG8gQ1NWXG4gICAgICBpZiAoIWV2ZW50cyB8fCBldmVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiAnTm8gaGF5IGV2ZW50b3MgcGFyYSBleHBvcnRhcic7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGhlYWRlcnMgPSBPYmplY3Qua2V5cyhldmVudHNbMF0pLmpvaW4oJywnKTtcbiAgICAgIGNvbnN0IHJvd3MgPSBldmVudHMubWFwKGV2ZW50ID0+XG4gICAgICAgIE9iamVjdC52YWx1ZXMoZXZlbnQpLm1hcCh2YWx1ZSA9PlxuICAgICAgICAgIHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgPyBgXCIke3ZhbHVlLnJlcGxhY2UoL1wiL2csICdcIlwiJyl9XCJgIDogdmFsdWVcbiAgICAgICAgKS5qb2luKCcsJylcbiAgICAgICk7XG5cbiAgICAgIHJldHVybiBbaGVhZGVycywgLi4ucm93c10uam9pbignXFxuJyk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tTRUNVUklUWV0gRXJyb3IgZXhwb3J0YW5kbyBldmVudG9zOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkRFRkFVTFRfU0VDVVJJVFlfUEFUVEVSTlMiLCJhbmFseXplU2VjdXJpdHlQYXR0ZXJucyIsImNsZWFudXBPbGRTZWN1cml0eUV2ZW50cyIsImV4cG9ydFNlY3VyaXR5RXZlbnRzIiwiZ2VuZXJhdGVTZWN1cml0eVJlcG9ydCIsImdldEFjdGl2ZVNlY3VyaXR5QWxlcnRzIiwiZ2V0U2VjdXJpdHlNZXRyaWNzIiwibWFya0FsZXJ0QXNGYWxzZVBvc2l0aXZlIiwicmVzb2x2ZVNlY3VyaXR5QWxlcnQiLCJydW5TZWN1cml0eUhlYWx0aENoZWNrIiwic3RhcnRTZWN1cml0eU1vbml0b3JpbmciLCJzdG9wU2VjdXJpdHlNb25pdG9yaW5nIiwidXBkYXRlU2VjdXJpdHlBbGVydCIsImlkIiwibmFtZSIsImRlc2NyaXB0aW9uIiwic2V2ZXJpdHkiLCJ0aW1lV2luZG93IiwidGhyZXNob2xkIiwiZW5hYmxlZCIsImNvbmRpdGlvbnMiLCJmaWVsZCIsIm9wZXJhdG9yIiwidmFsdWUiLCJ3ZWlnaHQiLCJhY3Rpb25zIiwidHlwZSIsInBhcmFtZXRlcnMiLCJub3RpZnlfYWRtaW5zIiwicHJpb3JpdHkiLCJub3RpZnlfdXNlciIsInVzZXJJZCIsInRpbWVXaW5kb3dIb3VycyIsImNvbnNvbGUiLCJsb2ciLCJzdXBhYmFzZUFkbWluIiwiRXJyb3IiLCJ0aW1lVGhyZXNob2xkIiwiRGF0ZSIsIm5vdyIsInRvSVNPU3RyaW5nIiwiYWxlcnRzIiwicXVlcnkiLCJmcm9tIiwic2VsZWN0IiwiZ3RlIiwib3JkZXIiLCJhc2NlbmRpbmciLCJlcSIsImRhdGEiLCJldmVudHMiLCJlcnJvciIsIm1lc3NhZ2UiLCJsZW5ndGgiLCJwYXR0ZXJuIiwicGF0dGVybkFsZXJ0cyIsImRldGVjdFBhdHRlcm4iLCJwdXNoIiwiaW5zZXJ0RXJyb3IiLCJpbnNlcnQiLCJldmVudHNCeVVzZXIiLCJyZWR1Y2UiLCJhY2MiLCJldmVudCIsInVzZXJfaWQiLCJ1c2VyRXZlbnRzIiwiT2JqZWN0IiwiZW50cmllcyIsIm1hdGNoaW5nRXZlbnRzIiwiZmlsdGVyIiwibWF0Y2hlc1BhdHRlcm5Db25kaXRpb25zIiwic29ydGVkRXZlbnRzIiwic29ydCIsImEiLCJiIiwidGltZXN0YW1wIiwiZ2V0VGltZSIsImkiLCJ3aW5kb3dTdGFydCIsIndpbmRvd0VuZCIsImV2ZW50c0luV2luZG93IiwiZXZlbnRUaW1lIiwiYWxlcnQiLCJwYXR0ZXJuX2lkIiwidGl0bGUiLCJldmVudF9jb3VudCIsImZpcnN0X29jY3VycmVuY2UiLCJsYXN0X29jY3VycmVuY2UiLCJzdGF0dXMiLCJtZXRhZGF0YSIsInBhdHRlcm5fbmFtZSIsIm1hcCIsImUiLCJ0aW1lX3dpbmRvd19taW51dGVzIiwiZXhlY3V0ZVBhdHRlcm5BY3Rpb25zIiwiZXZlcnkiLCJjb25kaXRpb24iLCJldmVudFZhbHVlIiwiaW5jbHVkZXMiLCJOdW1iZXIiLCJBcnJheSIsImlzQXJyYXkiLCJhY3Rpb24iLCJsb2dTZWN1cml0eUV2ZW50IiwiZXZlbnRfdHlwZSIsImV2ZW50X2NhdGVnb3J5IiwiYWxlcnRfaWQiLCJ3YXJuIiwiY2FjaGUiLCJDYWNoZU1hbmFnZXIiLCJnZXRJbnN0YW5jZSIsImNhY2hlS2V5IiwiY2FjaGVkIiwiZ2V0IiwiQ0FDSEVfQ09ORklHUyIsIlVTRVJfU0VTU0lPTiIsImxhc3QyNGgiLCJhbGVydHNFcnJvciIsInRvdGFsRXZlbnRzIiwiY3JpdGljYWxFdmVudHMiLCJ1bmlxdWVVc2VycyIsIlNldCIsInNpemUiLCJhdXRoRmFpbHVyZXMiLCJzdXNwaWNpb3VzQWN0aXZpdGllcyIsImFjdGl2ZUFsZXJ0cyIsInNlY3VyaXR5U2NvcmUiLCJNYXRoIiwibWF4IiwibWluIiwibWV0cmljcyIsInRvdGFsX2V2ZW50c18yNGgiLCJjcml0aWNhbF9ldmVudHNfMjRoIiwidW5pcXVlX3VzZXJzXzI0aCIsImF1dGhfZmFpbHVyZXNfMjRoIiwic3VzcGljaW91c19hY3Rpdml0aWVzXzI0aCIsImJsb2NrZWRfdXNlcnMiLCJhY3RpdmVfYWxlcnRzIiwiYXZnX3Jlc3BvbnNlX3RpbWUiLCJzZWN1cml0eV9zY29yZSIsInNldCIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJsdGUiLCJldmVudHNCeVNldmVyaXR5IiwibG93IiwibWVkaXVtIiwiaGlnaCIsImNyaXRpY2FsIiwiZXZlbnRzQnlDYXRlZ29yeSIsImF1dGhlbnRpY2F0aW9uIiwiYXV0aG9yaXphdGlvbiIsImRhdGFfYWNjZXNzIiwiYWRtaW5fb3BlcmF0aW9ucyIsInN1c3BpY2lvdXNfYmVoYXZpb3IiLCJ1c2VyQ291bnRzIiwiaXBDb3VudHMiLCJmb3JFYWNoIiwiaXBfYWRkcmVzcyIsInRvcFVzZXJzIiwic2xpY2UiLCJ0b3BJcHMiLCJwYXR0ZXJuc0RldGVjdGVkIiwicGF0dGVybkNvdW50cyIsIm9jY3VycmVuY2VzIiwicmVjb21tZW5kYXRpb25zIiwiZ2VuZXJhdGVTZWN1cml0eVJlY29tbWVuZGF0aW9ucyIsInJlcG9ydCIsInBlcmlvZF9zdGFydCIsInBlcmlvZF9lbmQiLCJ0b3RhbF9ldmVudHMiLCJldmVudHNfYnlfc2V2ZXJpdHkiLCJldmVudHNfYnlfY2F0ZWdvcnkiLCJ0b3BfdXNlcnMiLCJ0b3BfaXBzIiwicGF0dGVybnNfZGV0ZWN0ZWQiLCJnZW5lcmF0ZWRfYXQiLCJoaWdoRnJlcXVlbmN5UGF0dGVybnMiLCJwIiwiYWxlcnRJZCIsInVwZGF0ZXMiLCJ1cGRhdGUiLCJ1cGRhdGVkX2F0IiwiSlNPTiIsInN0cmluZ2lmeSIsInJlc29sdXRpb25Ob3RlcyIsInJlc29sdmVkQnkiLCJhc3NpZ25lZF90byIsInJlc29sdXRpb25fbm90ZXMiLCJub3RlcyIsIm1hcmtlZEJ5IiwiaW50ZXJ2YWxNaW51dGVzIiwic2V0SW50ZXJ2YWwiLCJjcml0aWNhbEFsZXJ0cyIsImludGVydmFsSWQiLCJjbGVhckludGVydmFsIiwiaXNzdWVzIiwiZGF5c1RvS2VlcCIsImN1dG9mZkRhdGUiLCJkZWxldGUiLCJsdCIsImRlbGV0ZWRDb3VudCIsImZvcm1hdCIsImhlYWRlcnMi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