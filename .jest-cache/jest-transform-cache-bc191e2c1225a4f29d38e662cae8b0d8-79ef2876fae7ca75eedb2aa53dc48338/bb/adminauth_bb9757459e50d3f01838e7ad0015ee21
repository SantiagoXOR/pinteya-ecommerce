ddad836bf206c54ecf041f6c7f3f7c68
/**
 * Sistema de Autenticación y Autorización para Panel Administrativo
 * Implementa verificación de roles y permisos granulares
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    checkAdminAccess: function() {
        return checkAdminAccess;
    },
    checkAdminPermissions: function() {
        return checkAdminPermissions;
    },
    checkAdvancedSecurity: function() {
        return checkAdvancedSecurity;
    },
    checkCRUDPermissions: function() {
        return checkCRUDPermissions;
    },
    getAuthFromApiRoute: function() {
        return getAuthFromApiRoute;
    },
    getAuthFromHeaders: function() {
        return getAuthFromHeaders;
    },
    getAuthFromRouteHandler: function() {
        return getAuthFromRouteHandler;
    },
    getAuthenticatedAdmin: function() {
        return getAuthenticatedAdmin;
    },
    getAuthenticatedUser: function() {
        return getAuthenticatedUser;
    },
    getRequestInfo: function() {
        return getRequestInfo;
    },
    getUnifiedAuth: function() {
        return getUnifiedAuth;
    },
    getUserProfile: function() {
        return getUserProfile;
    },
    hasAllPermissions: function() {
        return hasAllPermissions;
    },
    hasAnyPermission: function() {
        return hasAnyPermission;
    },
    hasPermission: function() {
        return hasPermission;
    },
    isAdmin: function() {
        return isAdmin;
    },
    isModeratorOrAdmin: function() {
        return isModeratorOrAdmin;
    },
    logAdminAccess: function() {
        return logAdminAccess;
    },
    logAdminAction: function() {
        return logAdminAction;
    },
    withAdminAuth: function() {
        return withAdminAuth;
    },
    withAdminAuthPages: function() {
        return withAdminAuthPages;
    }
});
const _server = require("@clerk/nextjs/server");
const _supabase = require("../supabase");
const _securityvalidations = require("./security-validations");
const _securityaudit = require("./security-audit");
const _audittrail = require("../security/audit-trail");
const _jwtvalidation = require("./jwt-validation");
const _csrfprotection = require("./csrf-protection");
const _ratelimiting = require("./rate-limiting");
async function getAuthenticatedUser(request) {
    try {
        // Método 1: Usar getAuth oficial de Clerk para API Routes (PREFERIDO)
        if (request && 'query' in request) {
            // Es NextApiRequest (Pages Router)
            const { userId, sessionId, getToken } = (0, _server.getAuth)(request);
            if (userId) {
                console.log(`[AUTH] Usuario autenticado via getAuth: ${userId}`);
                // Verificar si es admin usando el token
                let isAdmin = false;
                try {
                    const token = await getToken();
                    if (token) {
                        // Decodificar token para obtener metadata
                        const payload = JSON.parse(atob(token.split('.')[1]));
                        isAdmin = payload.metadata?.role === 'admin';
                    }
                } catch (tokenError) {
                    console.warn('[AUTH] Error obteniendo token para verificar admin:', tokenError);
                }
                return {
                    userId,
                    sessionId,
                    isAdmin
                };
            }
        }
        // Método 2: Usar auth() para App Router Route Handlers
        if (!request || !('query' in request)) {
            try {
                const { userId, sessionId, sessionClaims } = await (0, _server.auth)();
                if (userId) {
                    console.log(`[AUTH] Usuario autenticado via auth(): ${userId}`);
                    // Verificar si es admin usando sessionClaims
                    const isAdmin = sessionClaims?.metadata?.role === 'admin';
                    return {
                        userId,
                        sessionId,
                        isAdmin
                    };
                }
            } catch (authError) {
                console.warn('[AUTH] Error usando auth():', authError);
                return {
                    userId: null,
                    error: `Error de autenticación: ${authError.message}`
                };
            }
        }
        console.warn('[AUTH] No se pudo obtener userId - usuario no autenticado');
        return {
            userId: null,
            error: 'Usuario no autenticado'
        };
    } catch (error) {
        console.error('[AUTH] Error en getAuthenticatedUser:', error);
        return {
            userId: null,
            error: error instanceof Error ? error.message : 'Error de autenticación'
        };
    }
}
async function getAuthFromHeaders(request) {
    console.warn('[AUTH] ⚠️ DEPRECADO: getAuthFromHeaders() - Migrar a getAuthenticatedUser()');
    const clerkUserId = request.headers.get('x-clerk-user-id');
    if (!clerkUserId) {
        return {
            userId: null,
            error: 'Header x-clerk-user-id no encontrado',
            deprecated: true
        };
    }
    return {
        userId: clerkUserId,
        deprecated: true
    };
}
async function getAuthenticatedAdmin(request) {
    try {
        // Obtener usuario autenticado
        const authResult = await getAuthenticatedUser(request);
        if (!authResult.userId) {
            return {
                userId: null,
                isAdmin: false,
                error: authResult.error || 'Usuario no autenticado',
                status: 401
            };
        }
        // Si ya tenemos información de admin del token, usarla
        if (authResult.isAdmin !== undefined) {
            if (!authResult.isAdmin) {
                return {
                    userId: authResult.userId,
                    sessionId: authResult.sessionId,
                    isAdmin: false,
                    error: 'Permisos de administrador requeridos',
                    status: 403
                };
            }
            return {
                userId: authResult.userId,
                sessionId: authResult.sessionId,
                isAdmin: true,
                supabase: _supabase.supabaseAdmin
            };
        }
        // Fallback: verificar admin en base de datos
        const adminCheck = await checkAdminAccess(authResult.userId);
        if (!adminCheck.success) {
            return {
                userId: authResult.userId,
                sessionId: authResult.sessionId,
                isAdmin: false,
                error: adminCheck.error,
                status: adminCheck.status
            };
        }
        return {
            userId: authResult.userId,
            sessionId: authResult.sessionId,
            isAdmin: true,
            user: adminCheck.user,
            supabase: adminCheck.supabase
        };
    } catch (error) {
        console.error('[AUTH] Error en getAuthenticatedAdmin:', error);
        return {
            userId: null,
            isAdmin: false,
            error: 'Error interno de autenticación',
            status: 500
        };
    }
}
function getAuthFromApiRoute(req, res) {
    const { userId, sessionId, getToken } = (0, _server.getAuth)(req);
    if (!userId) {
        throw new Error('Usuario no autenticado');
    }
    console.log(`[AUTH] API Route autenticada: ${userId}`);
    return {
        userId,
        sessionId,
        getToken
    };
}
async function getAuthFromRouteHandler() {
    const { userId, sessionId, getToken } = await (0, _server.auth)();
    if (!userId) {
        throw new Error('Usuario no autenticado');
    }
    console.log(`[AUTH] Route Handler autenticado: ${userId}`);
    return {
        userId,
        sessionId,
        getToken
    };
}
async function getUnifiedAuth(request) {
    try {
        // Detectar si es API Route (Pages Router)
        if (request && 'query' in request) {
            try {
                return getAuthFromApiRoute(request, {});
            } catch (apiError) {
                console.warn('[AUTH] Error en API Route, usando fallback:', apiError);
                // Fallback a función original
                return await getAuthenticatedUser(request);
            }
        }
        // Detectar si es Route Handler (App Router) o sin request
        if (!request || !('query' in request)) {
            try {
                return await getAuthFromRouteHandler();
            } catch (routeError) {
                console.warn('[AUTH] Error en Route Handler, usando fallback:', routeError);
                // Fallback a función original
                return await getAuthenticatedUser(request);
            }
        }
        // Fallback a función original
        return await getAuthenticatedUser(request);
    } catch (error) {
        console.error('[AUTH] Error en getUnifiedAuth:', error);
        // En lugar de lanzar error, retornar resultado de fallback
        return await getAuthenticatedUser(request);
    }
}
async function getUserProfile(clerkUserId) {
    try {
        if (!_supabase.supabaseAdmin) {
            throw new Error('Supabase admin client not available');
        }
        // Primero obtener el perfil del usuario
        const { data: profile, error: profileError } = await _supabase.supabaseAdmin.from('user_profiles').select('*').eq('clerk_user_id', clerkUserId).eq('is_active', true).single();
        if (profileError) {
            console.error('Error fetching user profile:', profileError);
            return null;
        }
        if (!profile) {
            return null;
        }
        // Luego obtener el rol del usuario
        const { data: role, error: roleError } = await _supabase.supabaseAdmin.from('user_roles').select('*').eq('id', profile.role_id).single();
        if (roleError) {
            console.error('Error fetching user role:', roleError);
            return null;
        }
        // Combinar los datos
        const userProfile = {
            ...profile,
            user_roles: role
        };
        return userProfile;
    } catch (error) {
        console.error('Error in getUserProfile:', error);
        return null;
    }
}
async function checkAdminAccess(clerkUserId) {
    try {
        const profile = await getUserProfile(clerkUserId);
        if (!profile) {
            return {
                success: false,
                error: 'Perfil de usuario no encontrado',
                status: 404
            };
        }
        if (!profile.user_roles || !profile.is_active) {
            return {
                success: false,
                error: 'Rol de usuario no válido',
                status: 403
            };
        }
        // Verificar si tiene acceso al panel admin
        const hasAdminAccess = hasPermission(profile, [
            'admin_panel',
            'access'
        ]);
        if (!hasAdminAccess) {
            return {
                success: false,
                error: 'Acceso denegado al panel administrativo',
                status: 403
            };
        }
        return {
            success: true,
            user: profile
        };
    } catch (error) {
        console.error('Error in checkAdminAccess:', error);
        return {
            success: false,
            error: 'Error interno del servidor',
            status: 500
        };
    }
}
function hasPermission(userProfile, permissionPath) {
    try {
        if (!userProfile.user_roles || !userProfile.user_roles.permissions) {
            return false;
        }
        let current = userProfile.user_roles.permissions;
        for (const path of permissionPath){
            if (current[path] === undefined) {
                return false;
            }
            current = current[path];
        }
        // Manejar diferentes tipos de valores de permisos
        if (typeof current === 'boolean') {
            return current;
        }
        if (typeof current === 'string') {
            // Para permisos como "own", "own_limited", etc.
            return current !== 'false';
        }
        return false;
    } catch (error) {
        console.error('Error checking permission:', error);
        return false;
    }
}
function hasAnyPermission(userProfile, permissions) {
    return permissions.some((permission)=>hasPermission(userProfile, permission));
}
function hasAllPermissions(userProfile, permissions) {
    return permissions.every((permission)=>hasPermission(userProfile, permission));
}
function isAdmin(userProfile) {
    return userProfile.user_roles?.role_name === 'admin';
}
function isModeratorOrAdmin(userProfile) {
    const role = userProfile.user_roles?.role_name;
    return role === 'admin' || role === 'moderator';
}
async function checkAdminPermissions(requiredPermissions, request) {
    try {
        // 1. NUEVA VALIDACIÓN: Rate Limiting para APIs admin
        const rateLimitResult = await (0, _ratelimiting.checkRateLimit)(request, _ratelimiting.RATE_LIMIT_CONFIGS.admin, 'admin');
        if (!rateLimitResult.allowed) {
            await (0, _securityaudit.logAuthFailure)('unknown', 'Rate limit exceeded for admin API', request);
            return {
                success: false,
                error: rateLimitResult.error || 'Demasiadas requests administrativas',
                status: 429,
                rateLimitResult
            };
        }
        // 2. NUEVA VALIDACIÓN: Origen de request (CSRF Protection)
        const csrfValidation = await (0, _csrfprotection.validateRequestOrigin)(request);
        if (!csrfValidation.valid) {
            await (0, _securityaudit.logAuthFailure)('unknown', `CSRF validation failed: ${csrfValidation.error}`, request);
            return {
                success: false,
                error: csrfValidation.error || 'Origen de request no válido',
                status: 403,
                csrfValidation
            };
        }
        // 3. Verificar autenticación con Clerk usando métodos oficiales
        let userId;
        let sessionId;
        try {
            const authResult = await getUnifiedAuth(request);
            userId = authResult.userId;
            sessionId = authResult.sessionId;
            // Log autenticación exitosa
            const securityContext = await (0, _securityvalidations.getSecurityContext)(userId, request);
            if (securityContext) {
                await (0, _securityaudit.logAuthSuccess)(userId, securityContext, request);
            }
            // ✅ ENTERPRISE: Audit trail para autenticación exitosa
            await (0, _audittrail.logAuthentication)('user_authenticated', _audittrail.AuditResult.SUCCESS, userId, {
                sessionId,
                authMethod: 'clerk',
                securityContext: securityContext?.riskLevel
            }, {
                ip: securityContext?.ipAddress || 'unknown',
                userAgent: securityContext?.userAgent || 'unknown',
                sessionId
            });
        } catch (authError) {
            console.warn('[AUTH] Error en autenticación unificada, intentando fallback');
            await (0, _securityaudit.logAuthFailure)(null, `Error de autenticación: ${authError.message}`, request);
            // ✅ ENTERPRISE: Audit trail para fallo de autenticación
            await (0, _audittrail.logAuthentication)('authentication_failed', _audittrail.AuditResult.FAILURE, undefined, {
                error: authError.message,
                authMethod: 'clerk',
                fallbackAttempted: true
            }, {
                ip: request?.headers?.get('x-forwarded-for') || 'unknown',
                userAgent: request?.headers?.get('user-agent') || 'unknown'
            });
            const fallbackResult = await getAuthenticatedUser(request);
            if (!fallbackResult.userId) {
                await (0, _securityaudit.logAuthFailure)(null, fallbackResult.error || 'No autorizado', request);
                // ✅ ENTERPRISE: Audit trail para fallo de fallback
                await (0, _audittrail.logAuthentication)('authentication_fallback_failed', _audittrail.AuditResult.FAILURE, undefined, {
                    error: fallbackResult.error,
                    authMethod: 'fallback'
                }, {
                    ip: request?.headers?.get('x-forwarded-for') || 'unknown',
                    userAgent: request?.headers?.get('user-agent') || 'unknown'
                });
                return {
                    success: false,
                    error: fallbackResult.error || 'No autorizado',
                    status: 401
                };
            }
            userId = fallbackResult.userId;
            sessionId = fallbackResult.sessionId;
        }
        // 4. NUEVA VALIDACIÓN: Integridad del JWT
        const jwtValidation = await (0, _jwtvalidation.validateJWTIntegrity)(request);
        if (!jwtValidation.valid) {
            await (0, _securityaudit.logAuthFailure)(userId, `JWT validation failed: ${jwtValidation.error}`, request);
            return {
                success: false,
                error: jwtValidation.error || 'Token JWT inválido',
                status: 401,
                jwtValidation
            };
        }
        // 5. NUEVA VALIDACIÓN: Permisos específicos en JWT
        const jwtPermissionValidation = await (0, _jwtvalidation.validateJWTPermissions)('admin', [
            'admin_access'
        ], request);
        if (!jwtPermissionValidation.valid) {
            await (0, _securityaudit.logPermissionDenied)(userId, `JWT permission validation failed: ${jwtPermissionValidation.error}`, request);
            return {
                success: false,
                error: jwtPermissionValidation.error || 'Permisos JWT insuficientes',
                status: 403,
                jwtValidation: jwtPermissionValidation
            };
        }
        // 6. Ejecutar detección de seguridad
        await (0, _securityaudit.runSecurityDetection)(userId);
        // 3. Obtener contexto de seguridad completo
        const securityContext = await (0, _securityvalidations.getSecurityContext)(userId, request);
        if (!securityContext) {
            await (0, _securityaudit.logAuthFailure)(userId, 'No se pudo obtener contexto de seguridad', request);
            return {
                success: false,
                error: 'Error obteniendo contexto de seguridad',
                status: 500
            };
        }
        // 4. Verificar disponibilidad de Supabase
        if (!_supabase.supabaseAdmin) {
            return {
                success: false,
                error: 'Servicio administrativo no disponible',
                status: 503
            };
        }
        // 5. Verificar acceso administrativo básico
        const adminCheck = await checkAdminAccess(userId);
        if (!adminCheck.success) {
            await (0, _securityaudit.logPermissionDenied)(userId, 'ADMIN_ACCESS', [
                'admin_panel'
            ], securityContext);
            return adminCheck;
        }
        const userProfile = adminCheck.user;
        // 6. Verificar permisos específicos con validaciones de seguridad
        if (requiredPermissions && requiredPermissions.length > 0) {
            const hasRequiredPermissions = hasAnyPermission(userProfile, requiredPermissions);
            if (!hasRequiredPermissions) {
                await (0, _securityaudit.logPermissionDenied)(userId, 'SPECIFIC_PERMISSIONS', requiredPermissions.flat(), securityContext);
                return {
                    success: false,
                    error: 'Permisos insuficientes para esta operación',
                    status: 403
                };
            }
        }
        // 7. Registrar acceso en audit log
        await logAdminAccess(userProfile.id, 'API_ACCESS');
        return {
            success: true,
            user: userProfile,
            supabase: _supabase.supabaseAdmin,
            securityContext,
            jwtValidation,
            csrfValidation,
            rateLimitResult
        };
    } catch (error) {
        console.error('Error in checkAdminPermissions:', error);
        return {
            success: false,
            error: 'Error interno del servidor',
            status: 500
        };
    }
}
async function checkCRUDPermissions(resource, action, request) {
    const requiredPermissions = [
        [
            resource,
            action
        ]
    ];
    return checkAdminPermissions(requiredPermissions, request);
}
async function checkAdvancedSecurity(userId, operation, requiredPermissions, request) {
    try {
        // 1. Ejecutar detección de seguridad
        await (0, _securityaudit.runSecurityDetection)(userId);
        // 2. Validar contexto de seguridad
        const securityValidation = await (0, _securityvalidations.validateSecurityContext)(userId, operation, requiredPermissions, request);
        if (!securityValidation.valid) {
            return securityValidation;
        }
        // 3. Obtener perfil de usuario desde Supabase
        const userProfile = await getUserProfile(userId);
        if (!userProfile) {
            return {
                valid: false,
                error: 'Perfil de usuario no encontrado',
                code: 'USER_PROFILE_NOT_FOUND',
                severity: 'high'
            };
        }
        // 4. Verificar disponibilidad de Supabase
        if (!_supabase.supabaseAdmin) {
            return {
                valid: false,
                error: 'Servicio administrativo no disponible',
                code: 'SERVICE_UNAVAILABLE',
                severity: 'critical'
            };
        }
        return {
            valid: true,
            context: securityValidation.context,
            userProfile,
            supabase: _supabase.supabaseAdmin
        };
    } catch (error) {
        console.error('[SECURITY] Error en checkAdvancedSecurity:', error);
        return {
            valid: false,
            error: 'Error interno en validación de seguridad',
            code: 'SECURITY_VALIDATION_ERROR',
            severity: 'critical'
        };
    }
}
async function logAdminAccess(userProfileId, action, resourceType, resourceId, additionalData) {
    try {
        if (!_supabase.supabaseAdmin) return;
        await _supabase.supabaseAdmin.from('admin_audit_log').insert({
            user_id: userProfileId,
            action,
            resource_type: resourceType || 'system',
            resource_id: resourceId,
            new_values: additionalData ? JSON.stringify(additionalData) : null
        });
    } catch (error) {
        console.error('Error logging admin access:', error);
    // No lanzar error para no interrumpir el flujo principal
    }
}
async function logAdminAction(userProfileId, action, resourceType, resourceId, oldValues, newValues) {
    try {
        if (!_supabase.supabaseAdmin) return;
        await _supabase.supabaseAdmin.from('admin_audit_log').insert({
            user_id: userProfileId,
            action,
            resource_type: resourceType,
            resource_id: resourceId,
            old_values: oldValues ? JSON.stringify(oldValues) : null,
            new_values: newValues ? JSON.stringify(newValues) : null
        });
    } catch (error) {
        console.error('Error logging admin action:', error);
    }
}
function withAdminAuth(handler, requiredPermissions) {
    return async (request)=>{
        const authResult = await checkAdminPermissions(requiredPermissions, request);
        if (!authResult.success) {
            return new Response(JSON.stringify({
                success: false,
                error: authResult.error
            }), {
                status: authResult.status || 500,
                headers: {
                    'Content-Type': 'application/json'
                }
            });
        }
        return handler(request, {
            user: authResult.user,
            supabase: authResult.supabase
        });
    };
}
function withAdminAuthPages(handler, requiredPermissions) {
    return async (req, res)=>{
        const authResult = await checkAdminPermissions(requiredPermissions, req);
        if (!authResult.success) {
            return res.status(authResult.status || 500).json({
                success: false,
                error: authResult.error
            });
        }
        return handler(req, res, {
            user: authResult.user,
            supabase: authResult.supabase
        });
    };
}
function getRequestInfo(request) {
    if ('query' in request) {
        // NextApiRequest (Pages Router)
        const req = request;
        return {
            method: req.method || 'GET',
            url: req.url || 'unknown',
            userAgent: req.headers['user-agent'] || 'unknown',
            ip: req.headers['x-forwarded-for'] || req.headers['x-real-ip'] || req.connection?.remoteAddress || 'unknown'
        };
    } else {
        // NextRequest (App Router)
        const req = request;
        return {
            method: req.method,
            url: req.url,
            userAgent: req.headers.get('user-agent') || 'unknown',
            ip: req.headers.get('x-forwarded-for') || req.headers.get('x-real-ip') || 'unknown'
        };
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcbGliXFxhdXRoXFxhZG1pbi1hdXRoLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU2lzdGVtYSBkZSBBdXRlbnRpY2FjacOzbiB5IEF1dG9yaXphY2nDs24gcGFyYSBQYW5lbCBBZG1pbmlzdHJhdGl2b1xuICogSW1wbGVtZW50YSB2ZXJpZmljYWNpw7NuIGRlIHJvbGVzIHkgcGVybWlzb3MgZ3JhbnVsYXJlc1xuICovXG5cbmltcG9ydCB7IGF1dGgsIGN1cnJlbnRVc2VyLCBnZXRBdXRoIH0gZnJvbSAnQGNsZXJrL25leHRqcy9zZXJ2ZXInO1xuaW1wb3J0IHsgc3VwYWJhc2VBZG1pbiB9IGZyb20gJ0AvbGliL3N1cGFiYXNlJztcbmltcG9ydCB7IE5leHRSZXF1ZXN0IH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHR5cGUgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XG5pbXBvcnQge1xuICB2YWxpZGF0ZVNlY3VyaXR5Q29udGV4dCxcbiAgZ2V0U2VjdXJpdHlDb250ZXh0LFxuICB0eXBlIFNlY3VyaXR5VmFsaWRhdGlvblJlc3VsdCxcbiAgdHlwZSBTZWN1cml0eUNvbnRleHRcbn0gZnJvbSAnLi9zZWN1cml0eS12YWxpZGF0aW9ucyc7XG5pbXBvcnQge1xuICBsb2dBdXRoU3VjY2VzcyxcbiAgbG9nQXV0aEZhaWx1cmUsXG4gIGxvZ1Blcm1pc3Npb25EZW5pZWQsXG4gIHJ1blNlY3VyaXR5RGV0ZWN0aW9uXG59IGZyb20gJy4vc2VjdXJpdHktYXVkaXQnO1xuaW1wb3J0IHtcbiAgbG9nQXV0aGVudGljYXRpb24sXG4gIGxvZ0RhdGFBY2Nlc3MsXG4gIGxvZ0FkbWluQWN0aW9uLFxuICBBdWRpdFJlc3VsdFxufSBmcm9tICdAL2xpYi9zZWN1cml0eS9hdWRpdC10cmFpbCc7XG5pbXBvcnQge1xuICB2YWxpZGF0ZUpXVEludGVncml0eSxcbiAgdmFsaWRhdGVKV1RQZXJtaXNzaW9ucyxcbiAgdHlwZSBKV1RWYWxpZGF0aW9uUmVzdWx0XG59IGZyb20gJy4vand0LXZhbGlkYXRpb24nO1xuaW1wb3J0IHtcbiAgdmFsaWRhdGVSZXF1ZXN0T3JpZ2luLFxuICB0eXBlIENTUkZWYWxpZGF0aW9uUmVzdWx0XG59IGZyb20gJy4vY3NyZi1wcm90ZWN0aW9uJztcbmltcG9ydCB7XG4gIGNoZWNrUmF0ZUxpbWl0LFxuICBSQVRFX0xJTUlUX0NPTkZJR1MsXG4gIHR5cGUgUmF0ZUxpbWl0UmVzdWx0XG59IGZyb20gJy4vcmF0ZS1saW1pdGluZyc7XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBUSVBPUyBZIElOVEVSRkFDRVNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBpbnRlcmZhY2UgVXNlclByb2ZpbGUge1xuICBpZDogc3RyaW5nO1xuICBzdXBhYmFzZV91c2VyX2lkOiBzdHJpbmcgfCBudWxsO1xuICBjbGVya191c2VyX2lkOiBzdHJpbmcgfCBudWxsO1xuICBlbWFpbDogc3RyaW5nO1xuICBmaXJzdF9uYW1lOiBzdHJpbmcgfCBudWxsO1xuICBsYXN0X25hbWU6IHN0cmluZyB8IG51bGw7XG4gIHJvbGVfaWQ6IG51bWJlcjtcbiAgaXNfYWN0aXZlOiBib29sZWFuO1xuICBpc192ZXJpZmllZDogYm9vbGVhbjtcbiAgdXNlcl9yb2xlczoge1xuICAgIGlkOiBudW1iZXI7XG4gICAgcm9sZV9uYW1lOiBzdHJpbmc7XG4gICAgZGlzcGxheV9uYW1lOiBzdHJpbmc7XG4gICAgcGVybWlzc2lvbnM6IFJlY29yZDxzdHJpbmcsIGFueT47XG4gICAgaXNfYWN0aXZlOiBib29sZWFuO1xuICB9O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFkbWluQXV0aFJlc3VsdCB7XG4gIHN1Y2Nlc3M6IGJvb2xlYW47XG4gIHVzZXI/OiBVc2VyUHJvZmlsZTtcbiAgZXJyb3I/OiBzdHJpbmc7XG4gIHN0YXR1cz86IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQZXJtaXNzaW9uQ2hlY2sge1xuICByZXNvdXJjZTogc3RyaW5nO1xuICBhY3Rpb246IHN0cmluZztcbiAgdXNlcklkPzogc3RyaW5nO1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRlVOQ0lPTkVTIERFIFZFUklGSUNBQ0nDk04gREUgQVVURU5USUNBQ0nDk05cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogT2J0aWVuZSBlbCB1c3VhcmlvIGF1dGVudGljYWRvIHVzYW5kbyBTT0xPIG3DqXRvZG9zIG9maWNpYWxlcyBkZSBDbGVya1xuICogTUlHUkFETzogWWEgbm8gdXNhIGhlYWRlcnMgbmkgSldUIGNvbW8gZmFsbGJhY2sgLSBTb2xvIGdldEF1dGgocmVxKSB5IGF1dGgoKVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QXV0aGVudGljYXRlZFVzZXIoXG4gIHJlcXVlc3Q/OiBOZXh0UmVxdWVzdCB8IE5leHRBcGlSZXF1ZXN0XG4pOiBQcm9taXNlPHsgdXNlcklkOiBzdHJpbmcgfCBudWxsOyBzZXNzaW9uSWQ/OiBzdHJpbmc7IGVycm9yPzogc3RyaW5nOyBpc0FkbWluPzogYm9vbGVhbiB9PiB7XG4gIHRyeSB7XG4gICAgLy8gTcOpdG9kbyAxOiBVc2FyIGdldEF1dGggb2ZpY2lhbCBkZSBDbGVyayBwYXJhIEFQSSBSb3V0ZXMgKFBSRUZFUklETylcbiAgICBpZiAocmVxdWVzdCAmJiAncXVlcnknIGluIHJlcXVlc3QpIHtcbiAgICAgIC8vIEVzIE5leHRBcGlSZXF1ZXN0IChQYWdlcyBSb3V0ZXIpXG4gICAgICBjb25zdCB7IHVzZXJJZCwgc2Vzc2lvbklkLCBnZXRUb2tlbiB9ID0gZ2V0QXV0aChyZXF1ZXN0IGFzIE5leHRBcGlSZXF1ZXN0KTtcbiAgICAgIGlmICh1c2VySWQpIHtcbiAgICAgICAgY29uc29sZS5sb2coYFtBVVRIXSBVc3VhcmlvIGF1dGVudGljYWRvIHZpYSBnZXRBdXRoOiAke3VzZXJJZH1gKTtcblxuICAgICAgICAvLyBWZXJpZmljYXIgc2kgZXMgYWRtaW4gdXNhbmRvIGVsIHRva2VuXG4gICAgICAgIGxldCBpc0FkbWluID0gZmFsc2U7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgdG9rZW4gPSBhd2FpdCBnZXRUb2tlbigpO1xuICAgICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgLy8gRGVjb2RpZmljYXIgdG9rZW4gcGFyYSBvYnRlbmVyIG1ldGFkYXRhXG4gICAgICAgICAgICBjb25zdCBwYXlsb2FkID0gSlNPTi5wYXJzZShhdG9iKHRva2VuLnNwbGl0KCcuJylbMV0pKTtcbiAgICAgICAgICAgIGlzQWRtaW4gPSBwYXlsb2FkLm1ldGFkYXRhPy5yb2xlID09PSAnYWRtaW4nO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAodG9rZW5FcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUud2FybignW0FVVEhdIEVycm9yIG9idGVuaWVuZG8gdG9rZW4gcGFyYSB2ZXJpZmljYXIgYWRtaW46JywgdG9rZW5FcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB1c2VySWQsIHNlc3Npb25JZCwgaXNBZG1pbiB9O1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIE3DqXRvZG8gMjogVXNhciBhdXRoKCkgcGFyYSBBcHAgUm91dGVyIFJvdXRlIEhhbmRsZXJzXG4gICAgaWYgKCFyZXF1ZXN0IHx8ICEoJ3F1ZXJ5JyBpbiByZXF1ZXN0KSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgeyB1c2VySWQsIHNlc3Npb25JZCwgc2Vzc2lvbkNsYWltcyB9ID0gYXdhaXQgYXV0aCgpO1xuICAgICAgICBpZiAodXNlcklkKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coYFtBVVRIXSBVc3VhcmlvIGF1dGVudGljYWRvIHZpYSBhdXRoKCk6ICR7dXNlcklkfWApO1xuXG4gICAgICAgICAgLy8gVmVyaWZpY2FyIHNpIGVzIGFkbWluIHVzYW5kbyBzZXNzaW9uQ2xhaW1zXG4gICAgICAgICAgY29uc3QgaXNBZG1pbiA9IHNlc3Npb25DbGFpbXM/Lm1ldGFkYXRhPy5yb2xlID09PSAnYWRtaW4nO1xuXG4gICAgICAgICAgcmV0dXJuIHsgdXNlcklkLCBzZXNzaW9uSWQsIGlzQWRtaW4gfTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoYXV0aEVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybignW0FVVEhdIEVycm9yIHVzYW5kbyBhdXRoKCk6JywgYXV0aEVycm9yKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB1c2VySWQ6IG51bGwsXG4gICAgICAgICAgZXJyb3I6IGBFcnJvciBkZSBhdXRlbnRpY2FjacOzbjogJHthdXRoRXJyb3IubWVzc2FnZX1gXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc29sZS53YXJuKCdbQVVUSF0gTm8gc2UgcHVkbyBvYnRlbmVyIHVzZXJJZCAtIHVzdWFyaW8gbm8gYXV0ZW50aWNhZG8nKTtcbiAgICByZXR1cm4geyB1c2VySWQ6IG51bGwsIGVycm9yOiAnVXN1YXJpbyBubyBhdXRlbnRpY2FkbycgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbQVVUSF0gRXJyb3IgZW4gZ2V0QXV0aGVudGljYXRlZFVzZXI6JywgZXJyb3IpO1xuICAgIHJldHVybiB7XG4gICAgICB1c2VySWQ6IG51bGwsXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRXJyb3IgZGUgYXV0ZW50aWNhY2nDs24nXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIEZ1bmNpw7NuIGRlIG1pZ3JhY2nDs24gcGFyYSBBUElzIHF1ZSBhw7puIHVzYW4gaGVhZGVycyBkaXJlY3RhbWVudGVcbiAqIERFUFJFQ0FEQTogVXNhciBnZXRBdXRoZW50aWNhdGVkVXNlcigpIGVuIHN1IGx1Z2FyXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBdXRoRnJvbUhlYWRlcnMoXG4gIHJlcXVlc3Q6IE5leHRSZXF1ZXN0XG4pOiBQcm9taXNlPHsgdXNlcklkOiBzdHJpbmcgfCBudWxsOyBlcnJvcj86IHN0cmluZzsgZGVwcmVjYXRlZDogYm9vbGVhbiB9PiB7XG4gIGNvbnNvbGUud2FybignW0FVVEhdIOKaoO+4jyBERVBSRUNBRE86IGdldEF1dGhGcm9tSGVhZGVycygpIC0gTWlncmFyIGEgZ2V0QXV0aGVudGljYXRlZFVzZXIoKScpO1xuXG4gIGNvbnN0IGNsZXJrVXNlcklkID0gcmVxdWVzdC5oZWFkZXJzLmdldCgneC1jbGVyay11c2VyLWlkJyk7XG5cbiAgaWYgKCFjbGVya1VzZXJJZCkge1xuICAgIHJldHVybiB7XG4gICAgICB1c2VySWQ6IG51bGwsXG4gICAgICBlcnJvcjogJ0hlYWRlciB4LWNsZXJrLXVzZXItaWQgbm8gZW5jb250cmFkbycsXG4gICAgICBkZXByZWNhdGVkOiB0cnVlXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdXNlcklkOiBjbGVya1VzZXJJZCxcbiAgICBkZXByZWNhdGVkOiB0cnVlXG4gIH07XG59XG5cbi8qKlxuICogRnVuY2nDs24gbWVqb3JhZGEgcXVlIGNvbWJpbmEgYXV0ZW50aWNhY2nDs24geSB2ZXJpZmljYWNpw7NuIGRlIGFkbWluXG4gKiBSZWVtcGxhemEgZWwgcGF0csOzbiBjb23Dum4gZGUgZ2V0QXV0aGVudGljYXRlZFVzZXIgKyBjaGVja0FkbWluQWNjZXNzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBdXRoZW50aWNhdGVkQWRtaW4oXG4gIHJlcXVlc3Q/OiBOZXh0UmVxdWVzdCB8IE5leHRBcGlSZXF1ZXN0XG4pOiBQcm9taXNlPHtcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsO1xuICBzZXNzaW9uSWQ/OiBzdHJpbmc7XG4gIGlzQWRtaW46IGJvb2xlYW47XG4gIHVzZXI/OiBhbnk7XG4gIHN1cGFiYXNlPzogYW55O1xuICBlcnJvcj86IHN0cmluZztcbiAgc3RhdHVzPzogbnVtYmVyO1xufT4ge1xuICB0cnkge1xuICAgIC8vIE9idGVuZXIgdXN1YXJpbyBhdXRlbnRpY2Fkb1xuICAgIGNvbnN0IGF1dGhSZXN1bHQgPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcihyZXF1ZXN0KTtcblxuICAgIGlmICghYXV0aFJlc3VsdC51c2VySWQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXJJZDogbnVsbCxcbiAgICAgICAgaXNBZG1pbjogZmFsc2UsXG4gICAgICAgIGVycm9yOiBhdXRoUmVzdWx0LmVycm9yIHx8ICdVc3VhcmlvIG5vIGF1dGVudGljYWRvJyxcbiAgICAgICAgc3RhdHVzOiA0MDFcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gU2kgeWEgdGVuZW1vcyBpbmZvcm1hY2nDs24gZGUgYWRtaW4gZGVsIHRva2VuLCB1c2FybGFcbiAgICBpZiAoYXV0aFJlc3VsdC5pc0FkbWluICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGlmICghYXV0aFJlc3VsdC5pc0FkbWluKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdXNlcklkOiBhdXRoUmVzdWx0LnVzZXJJZCxcbiAgICAgICAgICBzZXNzaW9uSWQ6IGF1dGhSZXN1bHQuc2Vzc2lvbklkLFxuICAgICAgICAgIGlzQWRtaW46IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiAnUGVybWlzb3MgZGUgYWRtaW5pc3RyYWRvciByZXF1ZXJpZG9zJyxcbiAgICAgICAgICBzdGF0dXM6IDQwM1xuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VySWQ6IGF1dGhSZXN1bHQudXNlcklkLFxuICAgICAgICBzZXNzaW9uSWQ6IGF1dGhSZXN1bHQuc2Vzc2lvbklkLFxuICAgICAgICBpc0FkbWluOiB0cnVlLFxuICAgICAgICBzdXBhYmFzZTogc3VwYWJhc2VBZG1pblxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBGYWxsYmFjazogdmVyaWZpY2FyIGFkbWluIGVuIGJhc2UgZGUgZGF0b3NcbiAgICBjb25zdCBhZG1pbkNoZWNrID0gYXdhaXQgY2hlY2tBZG1pbkFjY2VzcyhhdXRoUmVzdWx0LnVzZXJJZCk7XG5cbiAgICBpZiAoIWFkbWluQ2hlY2suc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcklkOiBhdXRoUmVzdWx0LnVzZXJJZCxcbiAgICAgICAgc2Vzc2lvbklkOiBhdXRoUmVzdWx0LnNlc3Npb25JZCxcbiAgICAgICAgaXNBZG1pbjogZmFsc2UsXG4gICAgICAgIGVycm9yOiBhZG1pbkNoZWNrLmVycm9yLFxuICAgICAgICBzdGF0dXM6IGFkbWluQ2hlY2suc3RhdHVzXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICB1c2VySWQ6IGF1dGhSZXN1bHQudXNlcklkLFxuICAgICAgc2Vzc2lvbklkOiBhdXRoUmVzdWx0LnNlc3Npb25JZCxcbiAgICAgIGlzQWRtaW46IHRydWUsXG4gICAgICB1c2VyOiBhZG1pbkNoZWNrLnVzZXIsXG4gICAgICBzdXBhYmFzZTogYWRtaW5DaGVjay5zdXBhYmFzZVxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW0FVVEhdIEVycm9yIGVuIGdldEF1dGhlbnRpY2F0ZWRBZG1pbjonLCBlcnJvcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIHVzZXJJZDogbnVsbCxcbiAgICAgIGlzQWRtaW46IGZhbHNlLFxuICAgICAgZXJyb3I6ICdFcnJvciBpbnRlcm5vIGRlIGF1dGVudGljYWNpw7NuJyxcbiAgICAgIHN0YXR1czogNTAwXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIE51ZXZhIGZ1bmNpw7NuIGVzcGVjw61maWNhIHBhcmEgUGFnZXMgUm91dGVyIEFQSSBSb3V0ZXNcbiAqIFVzYSBnZXRBdXRoKHJlcSkgb2ZpY2lhbCBkZSBDbGVya1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0QXV0aEZyb21BcGlSb3V0ZShyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xuICBjb25zdCB7IHVzZXJJZCwgc2Vzc2lvbklkLCBnZXRUb2tlbiB9ID0gZ2V0QXV0aChyZXEpO1xuXG4gIGlmICghdXNlcklkKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdVc3VhcmlvIG5vIGF1dGVudGljYWRvJyk7XG4gIH1cblxuICBjb25zb2xlLmxvZyhgW0FVVEhdIEFQSSBSb3V0ZSBhdXRlbnRpY2FkYTogJHt1c2VySWR9YCk7XG4gIHJldHVybiB7IHVzZXJJZCwgc2Vzc2lvbklkLCBnZXRUb2tlbiB9O1xufVxuXG4vKipcbiAqIE51ZXZhIGZ1bmNpw7NuIGVzcGVjw61maWNhIHBhcmEgQXBwIFJvdXRlciBSb3V0ZSBIYW5kbGVyc1xuICogVXNhIGF1dGgoKSBvZmljaWFsIGRlIENsZXJrXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBdXRoRnJvbVJvdXRlSGFuZGxlcigpIHtcbiAgY29uc3QgeyB1c2VySWQsIHNlc3Npb25JZCwgZ2V0VG9rZW4gfSA9IGF3YWl0IGF1dGgoKTtcblxuICBpZiAoIXVzZXJJZCkge1xuICAgIHRocm93IG5ldyBFcnJvcignVXN1YXJpbyBubyBhdXRlbnRpY2FkbycpO1xuICB9XG5cbiAgY29uc29sZS5sb2coYFtBVVRIXSBSb3V0ZSBIYW5kbGVyIGF1dGVudGljYWRvOiAke3VzZXJJZH1gKTtcbiAgcmV0dXJuIHsgdXNlcklkLCBzZXNzaW9uSWQsIGdldFRva2VuIH07XG59XG5cbi8qKlxuICogRnVuY2nDs24gdW5pZmljYWRhIHF1ZSBkZXRlY3RhIGF1dG9tw6F0aWNhbWVudGUgZWwgdGlwbyBkZSBydXRhXG4gKiBDb24gbWFuZWpvIHJvYnVzdG8gZGUgZXJyb3JlcyB5IGZhbGxiYWNrc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VW5pZmllZEF1dGgocmVxdWVzdD86IE5leHRSZXF1ZXN0IHwgTmV4dEFwaVJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICAvLyBEZXRlY3RhciBzaSBlcyBBUEkgUm91dGUgKFBhZ2VzIFJvdXRlcilcbiAgICBpZiAocmVxdWVzdCAmJiAncXVlcnknIGluIHJlcXVlc3QpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBnZXRBdXRoRnJvbUFwaVJvdXRlKHJlcXVlc3QgYXMgTmV4dEFwaVJlcXVlc3QsIHt9IGFzIE5leHRBcGlSZXNwb25zZSk7XG4gICAgICB9IGNhdGNoIChhcGlFcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oJ1tBVVRIXSBFcnJvciBlbiBBUEkgUm91dGUsIHVzYW5kbyBmYWxsYmFjazonLCBhcGlFcnJvcik7XG4gICAgICAgIC8vIEZhbGxiYWNrIGEgZnVuY2nDs24gb3JpZ2luYWxcbiAgICAgICAgcmV0dXJuIGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKHJlcXVlc3QpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIERldGVjdGFyIHNpIGVzIFJvdXRlIEhhbmRsZXIgKEFwcCBSb3V0ZXIpIG8gc2luIHJlcXVlc3RcbiAgICBpZiAoIXJlcXVlc3QgfHwgISgncXVlcnknIGluIHJlcXVlc3QpKSB7XG4gICAgICB0cnkge1xuICAgICAgICByZXR1cm4gYXdhaXQgZ2V0QXV0aEZyb21Sb3V0ZUhhbmRsZXIoKTtcbiAgICAgIH0gY2F0Y2ggKHJvdXRlRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdbQVVUSF0gRXJyb3IgZW4gUm91dGUgSGFuZGxlciwgdXNhbmRvIGZhbGxiYWNrOicsIHJvdXRlRXJyb3IpO1xuICAgICAgICAvLyBGYWxsYmFjayBhIGZ1bmNpw7NuIG9yaWdpbmFsXG4gICAgICAgIHJldHVybiBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcihyZXF1ZXN0KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBGYWxsYmFjayBhIGZ1bmNpw7NuIG9yaWdpbmFsXG4gICAgcmV0dXJuIGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKHJlcXVlc3QpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tBVVRIXSBFcnJvciBlbiBnZXRVbmlmaWVkQXV0aDonLCBlcnJvcik7XG4gICAgLy8gRW4gbHVnYXIgZGUgbGFuemFyIGVycm9yLCByZXRvcm5hciByZXN1bHRhZG8gZGUgZmFsbGJhY2tcbiAgICByZXR1cm4gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIocmVxdWVzdCk7XG4gIH1cbn1cblxuLyoqXG4gKiBPYnRpZW5lIGVsIHBlcmZpbCBjb21wbGV0byBkZWwgdXN1YXJpbyBkZXNkZSBTdXBhYmFzZVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlclByb2ZpbGUoY2xlcmtVc2VySWQ6IHN0cmluZyk6IFByb21pc2U8VXNlclByb2ZpbGUgfCBudWxsPiB7XG4gIHRyeSB7XG4gICAgaWYgKCFzdXBhYmFzZUFkbWluKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1N1cGFiYXNlIGFkbWluIGNsaWVudCBub3QgYXZhaWxhYmxlJyk7XG4gICAgfVxuXG4gICAgLy8gUHJpbWVybyBvYnRlbmVyIGVsIHBlcmZpbCBkZWwgdXN1YXJpb1xuICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3I6IHByb2ZpbGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgICAgLmZyb20oJ3VzZXJfcHJvZmlsZXMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ2NsZXJrX3VzZXJfaWQnLCBjbGVya1VzZXJJZClcbiAgICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmIChwcm9maWxlRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHVzZXIgcHJvZmlsZTonLCBwcm9maWxlRXJyb3IpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgaWYgKCFwcm9maWxlKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBMdWVnbyBvYnRlbmVyIGVsIHJvbCBkZWwgdXN1YXJpb1xuICAgIGNvbnN0IHsgZGF0YTogcm9sZSwgZXJyb3I6IHJvbGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgICAgLmZyb20oJ3VzZXJfcm9sZXMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ2lkJywgcHJvZmlsZS5yb2xlX2lkKVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgaWYgKHJvbGVFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgdXNlciByb2xlOicsIHJvbGVFcnJvcik7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBDb21iaW5hciBsb3MgZGF0b3NcbiAgICBjb25zdCB1c2VyUHJvZmlsZTogVXNlclByb2ZpbGUgPSB7XG4gICAgICAuLi5wcm9maWxlLFxuICAgICAgdXNlcl9yb2xlczogcm9sZVxuICAgIH07XG5cbiAgICByZXR1cm4gdXNlclByb2ZpbGU7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0VXNlclByb2ZpbGU6JywgZXJyb3IpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbi8qKlxuICogVmVyaWZpY2Egc2kgdW4gdXN1YXJpbyB0aWVuZSBhY2Nlc28gYWwgcGFuZWwgYWRtaW5pc3RyYXRpdm9cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNoZWNrQWRtaW5BY2Nlc3MoY2xlcmtVc2VySWQ6IHN0cmluZyk6IFByb21pc2U8QWRtaW5BdXRoUmVzdWx0PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcHJvZmlsZSA9IGF3YWl0IGdldFVzZXJQcm9maWxlKGNsZXJrVXNlcklkKTtcbiAgICBcbiAgICBpZiAoIXByb2ZpbGUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ1BlcmZpbCBkZSB1c3VhcmlvIG5vIGVuY29udHJhZG8nLFxuICAgICAgICBzdGF0dXM6IDQwNFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAoIXByb2ZpbGUudXNlcl9yb2xlcyB8fCAhcHJvZmlsZS5pc19hY3RpdmUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ1JvbCBkZSB1c3VhcmlvIG5vIHbDoWxpZG8nLFxuICAgICAgICBzdGF0dXM6IDQwM1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBWZXJpZmljYXIgc2kgdGllbmUgYWNjZXNvIGFsIHBhbmVsIGFkbWluXG4gICAgY29uc3QgaGFzQWRtaW5BY2Nlc3MgPSBoYXNQZXJtaXNzaW9uKHByb2ZpbGUsIFsnYWRtaW5fcGFuZWwnLCAnYWNjZXNzJ10pO1xuICAgIFxuICAgIGlmICghaGFzQWRtaW5BY2Nlc3MpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ0FjY2VzbyBkZW5lZ2FkbyBhbCBwYW5lbCBhZG1pbmlzdHJhdGl2bycsXG4gICAgICAgIHN0YXR1czogNDAzXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgdXNlcjogcHJvZmlsZVxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gY2hlY2tBZG1pbkFjY2VzczonLCBlcnJvcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdFcnJvciBpbnRlcm5vIGRlbCBzZXJ2aWRvcicsXG4gICAgICBzdGF0dXM6IDUwMFxuICAgIH07XG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEZVTkNJT05FUyBERSBWRVJJRklDQUNJw5NOIERFIFBFUk1JU09TXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIFZlcmlmaWNhIHNpIHVuIHVzdWFyaW8gdGllbmUgdW4gcGVybWlzbyBlc3BlY8OtZmljb1xuICovXG5leHBvcnQgZnVuY3Rpb24gaGFzUGVybWlzc2lvbihcbiAgdXNlclByb2ZpbGU6IFVzZXJQcm9maWxlLFxuICBwZXJtaXNzaW9uUGF0aDogc3RyaW5nW11cbik6IGJvb2xlYW4ge1xuICB0cnkge1xuICAgIGlmICghdXNlclByb2ZpbGUudXNlcl9yb2xlcyB8fCAhdXNlclByb2ZpbGUudXNlcl9yb2xlcy5wZXJtaXNzaW9ucykge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGxldCBjdXJyZW50OiBhbnkgPSB1c2VyUHJvZmlsZS51c2VyX3JvbGVzLnBlcm1pc3Npb25zO1xuICAgIFxuICAgIGZvciAoY29uc3QgcGF0aCBvZiBwZXJtaXNzaW9uUGF0aCkge1xuICAgICAgaWYgKGN1cnJlbnRbcGF0aF0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBjdXJyZW50ID0gY3VycmVudFtwYXRoXTtcbiAgICB9XG5cbiAgICAvLyBNYW5lamFyIGRpZmVyZW50ZXMgdGlwb3MgZGUgdmFsb3JlcyBkZSBwZXJtaXNvc1xuICAgIGlmICh0eXBlb2YgY3VycmVudCA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICByZXR1cm4gY3VycmVudDtcbiAgICB9XG4gICAgXG4gICAgaWYgKHR5cGVvZiBjdXJyZW50ID09PSAnc3RyaW5nJykge1xuICAgICAgLy8gUGFyYSBwZXJtaXNvcyBjb21vIFwib3duXCIsIFwib3duX2xpbWl0ZWRcIiwgZXRjLlxuICAgICAgcmV0dXJuIGN1cnJlbnQgIT09ICdmYWxzZSc7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNoZWNraW5nIHBlcm1pc3Npb246JywgZXJyb3IpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vKipcbiAqIFZlcmlmaWNhIG3Dumx0aXBsZXMgcGVybWlzb3NcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhhc0FueVBlcm1pc3Npb24oXG4gIHVzZXJQcm9maWxlOiBVc2VyUHJvZmlsZSxcbiAgcGVybWlzc2lvbnM6IHN0cmluZ1tdW11cbik6IGJvb2xlYW4ge1xuICByZXR1cm4gcGVybWlzc2lvbnMuc29tZShwZXJtaXNzaW9uID0+IGhhc1Blcm1pc3Npb24odXNlclByb2ZpbGUsIHBlcm1pc3Npb24pKTtcbn1cblxuLyoqXG4gKiBWZXJpZmljYSB0b2RvcyBsb3MgcGVybWlzb3NcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhhc0FsbFBlcm1pc3Npb25zKFxuICB1c2VyUHJvZmlsZTogVXNlclByb2ZpbGUsXG4gIHBlcm1pc3Npb25zOiBzdHJpbmdbXVtdXG4pOiBib29sZWFuIHtcbiAgcmV0dXJuIHBlcm1pc3Npb25zLmV2ZXJ5KHBlcm1pc3Npb24gPT4gaGFzUGVybWlzc2lvbih1c2VyUHJvZmlsZSwgcGVybWlzc2lvbikpO1xufVxuXG4vKipcbiAqIFZlcmlmaWNhIHNpIGVsIHVzdWFyaW8gZXMgYWRtaW5pc3RyYWRvclxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNBZG1pbih1c2VyUHJvZmlsZTogVXNlclByb2ZpbGUpOiBib29sZWFuIHtcbiAgcmV0dXJuIHVzZXJQcm9maWxlLnVzZXJfcm9sZXM/LnJvbGVfbmFtZSA9PT0gJ2FkbWluJztcbn1cblxuLyoqXG4gKiBWZXJpZmljYSBzaSBlbCB1c3VhcmlvIGVzIG1vZGVyYWRvciBvIGFkbWluaXN0cmFkb3JcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzTW9kZXJhdG9yT3JBZG1pbih1c2VyUHJvZmlsZTogVXNlclByb2ZpbGUpOiBib29sZWFuIHtcbiAgY29uc3Qgcm9sZSA9IHVzZXJQcm9maWxlLnVzZXJfcm9sZXM/LnJvbGVfbmFtZTtcbiAgcmV0dXJuIHJvbGUgPT09ICdhZG1pbicgfHwgcm9sZSA9PT0gJ21vZGVyYXRvcic7XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBNSURETEVXQVJFIERFIEFVVE9SSVpBQ0nDk05cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogTWlkZGxld2FyZSBwcmluY2lwYWwgcGFyYSB2ZXJpZmljYXIgcGVybWlzb3MgYWRtaW5pc3RyYXRpdm9zXG4gKiBNRUpPUkFETzogSW5jbHV5ZSB2YWxpZGFjaW9uZXMgYWRpY2lvbmFsZXMgZGUgc2VndXJpZGFkIChKV1QsIENTUkYsIFJhdGUgTGltaXRpbmcpXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja0FkbWluUGVybWlzc2lvbnMoXG4gIHJlcXVpcmVkUGVybWlzc2lvbnM/OiBzdHJpbmdbXVtdLFxuICByZXF1ZXN0PzogTmV4dFJlcXVlc3QgfCBOZXh0QXBpUmVxdWVzdFxuKTogUHJvbWlzZTxBZG1pbkF1dGhSZXN1bHQgJiB7XG4gIHN1cGFiYXNlPzogdHlwZW9mIHN1cGFiYXNlQWRtaW47XG4gIHNlY3VyaXR5Q29udGV4dD86IFNlY3VyaXR5Q29udGV4dDtcbiAgand0VmFsaWRhdGlvbj86IEpXVFZhbGlkYXRpb25SZXN1bHQ7XG4gIGNzcmZWYWxpZGF0aW9uPzogQ1NSRlZhbGlkYXRpb25SZXN1bHQ7XG4gIHJhdGVMaW1pdFJlc3VsdD86IFJhdGVMaW1pdFJlc3VsdDtcbn0+IHtcbiAgdHJ5IHtcbiAgICAvLyAxLiBOVUVWQSBWQUxJREFDScOTTjogUmF0ZSBMaW1pdGluZyBwYXJhIEFQSXMgYWRtaW5cbiAgICBjb25zdCByYXRlTGltaXRSZXN1bHQgPSBhd2FpdCBjaGVja1JhdGVMaW1pdChcbiAgICAgIHJlcXVlc3QhLFxuICAgICAgUkFURV9MSU1JVF9DT05GSUdTLmFkbWluLFxuICAgICAgJ2FkbWluJ1xuICAgICk7XG5cbiAgICBpZiAoIXJhdGVMaW1pdFJlc3VsdC5hbGxvd2VkKSB7XG4gICAgICBhd2FpdCBsb2dBdXRoRmFpbHVyZShcbiAgICAgICAgJ3Vua25vd24nLFxuICAgICAgICAnUmF0ZSBsaW1pdCBleGNlZWRlZCBmb3IgYWRtaW4gQVBJJyxcbiAgICAgICAgcmVxdWVzdFxuICAgICAgKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiByYXRlTGltaXRSZXN1bHQuZXJyb3IgfHwgJ0RlbWFzaWFkYXMgcmVxdWVzdHMgYWRtaW5pc3RyYXRpdmFzJyxcbiAgICAgICAgc3RhdHVzOiA0MjksXG4gICAgICAgIHJhdGVMaW1pdFJlc3VsdFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyAyLiBOVUVWQSBWQUxJREFDScOTTjogT3JpZ2VuIGRlIHJlcXVlc3QgKENTUkYgUHJvdGVjdGlvbilcbiAgICBjb25zdCBjc3JmVmFsaWRhdGlvbiA9IGF3YWl0IHZhbGlkYXRlUmVxdWVzdE9yaWdpbihyZXF1ZXN0ISk7XG5cbiAgICBpZiAoIWNzcmZWYWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICBhd2FpdCBsb2dBdXRoRmFpbHVyZShcbiAgICAgICAgJ3Vua25vd24nLFxuICAgICAgICBgQ1NSRiB2YWxpZGF0aW9uIGZhaWxlZDogJHtjc3JmVmFsaWRhdGlvbi5lcnJvcn1gLFxuICAgICAgICByZXF1ZXN0XG4gICAgICApO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IGNzcmZWYWxpZGF0aW9uLmVycm9yIHx8ICdPcmlnZW4gZGUgcmVxdWVzdCBubyB2w6FsaWRvJyxcbiAgICAgICAgc3RhdHVzOiA0MDMsXG4gICAgICAgIGNzcmZWYWxpZGF0aW9uXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIDMuIFZlcmlmaWNhciBhdXRlbnRpY2FjacOzbiBjb24gQ2xlcmsgdXNhbmRvIG3DqXRvZG9zIG9maWNpYWxlc1xuICAgIGxldCB1c2VySWQ6IHN0cmluZztcbiAgICBsZXQgc2Vzc2lvbklkOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgYXV0aFJlc3VsdCA9IGF3YWl0IGdldFVuaWZpZWRBdXRoKHJlcXVlc3QpO1xuICAgICAgdXNlcklkID0gYXV0aFJlc3VsdC51c2VySWQ7XG4gICAgICBzZXNzaW9uSWQgPSBhdXRoUmVzdWx0LnNlc3Npb25JZDtcblxuICAgICAgLy8gTG9nIGF1dGVudGljYWNpw7NuIGV4aXRvc2FcbiAgICAgIGNvbnN0IHNlY3VyaXR5Q29udGV4dCA9IGF3YWl0IGdldFNlY3VyaXR5Q29udGV4dCh1c2VySWQsIHJlcXVlc3QpO1xuICAgICAgaWYgKHNlY3VyaXR5Q29udGV4dCkge1xuICAgICAgICBhd2FpdCBsb2dBdXRoU3VjY2Vzcyh1c2VySWQsIHNlY3VyaXR5Q29udGV4dCwgcmVxdWVzdCk7XG4gICAgICB9XG5cbiAgICAgIC8vIOKchSBFTlRFUlBSSVNFOiBBdWRpdCB0cmFpbCBwYXJhIGF1dGVudGljYWNpw7NuIGV4aXRvc2FcbiAgICAgIGF3YWl0IGxvZ0F1dGhlbnRpY2F0aW9uKFxuICAgICAgICAndXNlcl9hdXRoZW50aWNhdGVkJyxcbiAgICAgICAgQXVkaXRSZXN1bHQuU1VDQ0VTUyxcbiAgICAgICAgdXNlcklkLFxuICAgICAgICB7XG4gICAgICAgICAgc2Vzc2lvbklkLFxuICAgICAgICAgIGF1dGhNZXRob2Q6ICdjbGVyaycsXG4gICAgICAgICAgc2VjdXJpdHlDb250ZXh0OiBzZWN1cml0eUNvbnRleHQ/LnJpc2tMZXZlbFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgaXA6IHNlY3VyaXR5Q29udGV4dD8uaXBBZGRyZXNzIHx8ICd1bmtub3duJyxcbiAgICAgICAgICB1c2VyQWdlbnQ6IHNlY3VyaXR5Q29udGV4dD8udXNlckFnZW50IHx8ICd1bmtub3duJyxcbiAgICAgICAgICBzZXNzaW9uSWRcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9IGNhdGNoIChhdXRoRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybignW0FVVEhdIEVycm9yIGVuIGF1dGVudGljYWNpw7NuIHVuaWZpY2FkYSwgaW50ZW50YW5kbyBmYWxsYmFjaycpO1xuICAgICAgYXdhaXQgbG9nQXV0aEZhaWx1cmUobnVsbCwgYEVycm9yIGRlIGF1dGVudGljYWNpw7NuOiAke2F1dGhFcnJvci5tZXNzYWdlfWAsIHJlcXVlc3QpO1xuXG4gICAgICAvLyDinIUgRU5URVJQUklTRTogQXVkaXQgdHJhaWwgcGFyYSBmYWxsbyBkZSBhdXRlbnRpY2FjacOzblxuICAgICAgYXdhaXQgbG9nQXV0aGVudGljYXRpb24oXG4gICAgICAgICdhdXRoZW50aWNhdGlvbl9mYWlsZWQnLFxuICAgICAgICBBdWRpdFJlc3VsdC5GQUlMVVJFLFxuICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgIHtcbiAgICAgICAgICBlcnJvcjogYXV0aEVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgYXV0aE1ldGhvZDogJ2NsZXJrJyxcbiAgICAgICAgICBmYWxsYmFja0F0dGVtcHRlZDogdHJ1ZVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgaXA6IHJlcXVlc3Q/LmhlYWRlcnM/LmdldCgneC1mb3J3YXJkZWQtZm9yJykgfHwgJ3Vua25vd24nLFxuICAgICAgICAgIHVzZXJBZ2VudDogcmVxdWVzdD8uaGVhZGVycz8uZ2V0KCd1c2VyLWFnZW50JykgfHwgJ3Vua25vd24nXG4gICAgICAgIH1cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGZhbGxiYWNrUmVzdWx0ID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIocmVxdWVzdCk7XG4gICAgICBpZiAoIWZhbGxiYWNrUmVzdWx0LnVzZXJJZCkge1xuICAgICAgICBhd2FpdCBsb2dBdXRoRmFpbHVyZShudWxsLCBmYWxsYmFja1Jlc3VsdC5lcnJvciB8fCAnTm8gYXV0b3JpemFkbycsIHJlcXVlc3QpO1xuXG4gICAgICAgIC8vIOKchSBFTlRFUlBSSVNFOiBBdWRpdCB0cmFpbCBwYXJhIGZhbGxvIGRlIGZhbGxiYWNrXG4gICAgICAgIGF3YWl0IGxvZ0F1dGhlbnRpY2F0aW9uKFxuICAgICAgICAgICdhdXRoZW50aWNhdGlvbl9mYWxsYmFja19mYWlsZWQnLFxuICAgICAgICAgIEF1ZGl0UmVzdWx0LkZBSUxVUkUsXG4gICAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGVycm9yOiBmYWxsYmFja1Jlc3VsdC5lcnJvcixcbiAgICAgICAgICAgIGF1dGhNZXRob2Q6ICdmYWxsYmFjaydcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGlwOiByZXF1ZXN0Py5oZWFkZXJzPy5nZXQoJ3gtZm9yd2FyZGVkLWZvcicpIHx8ICd1bmtub3duJyxcbiAgICAgICAgICAgIHVzZXJBZ2VudDogcmVxdWVzdD8uaGVhZGVycz8uZ2V0KCd1c2VyLWFnZW50JykgfHwgJ3Vua25vd24nXG4gICAgICAgICAgfVxuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IGZhbGxiYWNrUmVzdWx0LmVycm9yIHx8ICdObyBhdXRvcml6YWRvJyxcbiAgICAgICAgICBzdGF0dXM6IDQwMVxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgdXNlcklkID0gZmFsbGJhY2tSZXN1bHQudXNlcklkO1xuICAgICAgc2Vzc2lvbklkID0gZmFsbGJhY2tSZXN1bHQuc2Vzc2lvbklkO1xuICAgIH1cblxuICAgIC8vIDQuIE5VRVZBIFZBTElEQUNJw5NOOiBJbnRlZ3JpZGFkIGRlbCBKV1RcbiAgICBjb25zdCBqd3RWYWxpZGF0aW9uID0gYXdhaXQgdmFsaWRhdGVKV1RJbnRlZ3JpdHkocmVxdWVzdCk7XG5cbiAgICBpZiAoIWp3dFZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgIGF3YWl0IGxvZ0F1dGhGYWlsdXJlKFxuICAgICAgICB1c2VySWQsXG4gICAgICAgIGBKV1QgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7and0VmFsaWRhdGlvbi5lcnJvcn1gLFxuICAgICAgICByZXF1ZXN0XG4gICAgICApO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IGp3dFZhbGlkYXRpb24uZXJyb3IgfHwgJ1Rva2VuIEpXVCBpbnbDoWxpZG8nLFxuICAgICAgICBzdGF0dXM6IDQwMSxcbiAgICAgICAgand0VmFsaWRhdGlvblxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyA1LiBOVUVWQSBWQUxJREFDScOTTjogUGVybWlzb3MgZXNwZWPDrWZpY29zIGVuIEpXVFxuICAgIGNvbnN0IGp3dFBlcm1pc3Npb25WYWxpZGF0aW9uID0gYXdhaXQgdmFsaWRhdGVKV1RQZXJtaXNzaW9ucyhcbiAgICAgICdhZG1pbicsXG4gICAgICBbJ2FkbWluX2FjY2VzcyddLFxuICAgICAgcmVxdWVzdFxuICAgICk7XG5cbiAgICBpZiAoIWp3dFBlcm1pc3Npb25WYWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICBhd2FpdCBsb2dQZXJtaXNzaW9uRGVuaWVkKFxuICAgICAgICB1c2VySWQsXG4gICAgICAgIGBKV1QgcGVybWlzc2lvbiB2YWxpZGF0aW9uIGZhaWxlZDogJHtqd3RQZXJtaXNzaW9uVmFsaWRhdGlvbi5lcnJvcn1gLFxuICAgICAgICByZXF1ZXN0XG4gICAgICApO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IGp3dFBlcm1pc3Npb25WYWxpZGF0aW9uLmVycm9yIHx8ICdQZXJtaXNvcyBKV1QgaW5zdWZpY2llbnRlcycsXG4gICAgICAgIHN0YXR1czogNDAzLFxuICAgICAgICBqd3RWYWxpZGF0aW9uOiBqd3RQZXJtaXNzaW9uVmFsaWRhdGlvblxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyA2LiBFamVjdXRhciBkZXRlY2Npw7NuIGRlIHNlZ3VyaWRhZFxuICAgIGF3YWl0IHJ1blNlY3VyaXR5RGV0ZWN0aW9uKHVzZXJJZCk7XG5cbiAgICAvLyAzLiBPYnRlbmVyIGNvbnRleHRvIGRlIHNlZ3VyaWRhZCBjb21wbGV0b1xuICAgIGNvbnN0IHNlY3VyaXR5Q29udGV4dCA9IGF3YWl0IGdldFNlY3VyaXR5Q29udGV4dCh1c2VySWQsIHJlcXVlc3QpO1xuICAgIGlmICghc2VjdXJpdHlDb250ZXh0KSB7XG4gICAgICBhd2FpdCBsb2dBdXRoRmFpbHVyZSh1c2VySWQsICdObyBzZSBwdWRvIG9idGVuZXIgY29udGV4dG8gZGUgc2VndXJpZGFkJywgcmVxdWVzdCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6ICdFcnJvciBvYnRlbmllbmRvIGNvbnRleHRvIGRlIHNlZ3VyaWRhZCcsXG4gICAgICAgIHN0YXR1czogNTAwXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIDQuIFZlcmlmaWNhciBkaXNwb25pYmlsaWRhZCBkZSBTdXBhYmFzZVxuICAgIGlmICghc3VwYWJhc2VBZG1pbikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnU2VydmljaW8gYWRtaW5pc3RyYXRpdm8gbm8gZGlzcG9uaWJsZScsXG4gICAgICAgIHN0YXR1czogNTAzXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIDUuIFZlcmlmaWNhciBhY2Nlc28gYWRtaW5pc3RyYXRpdm8gYsOhc2ljb1xuICAgIGNvbnN0IGFkbWluQ2hlY2sgPSBhd2FpdCBjaGVja0FkbWluQWNjZXNzKHVzZXJJZCk7XG5cbiAgICBpZiAoIWFkbWluQ2hlY2suc3VjY2Vzcykge1xuICAgICAgYXdhaXQgbG9nUGVybWlzc2lvbkRlbmllZCh1c2VySWQsICdBRE1JTl9BQ0NFU1MnLCBbJ2FkbWluX3BhbmVsJ10sIHNlY3VyaXR5Q29udGV4dCk7XG4gICAgICByZXR1cm4gYWRtaW5DaGVjaztcbiAgICB9XG5cbiAgICBjb25zdCB1c2VyUHJvZmlsZSA9IGFkbWluQ2hlY2sudXNlciE7XG5cbiAgICAvLyA2LiBWZXJpZmljYXIgcGVybWlzb3MgZXNwZWPDrWZpY29zIGNvbiB2YWxpZGFjaW9uZXMgZGUgc2VndXJpZGFkXG4gICAgaWYgKHJlcXVpcmVkUGVybWlzc2lvbnMgJiYgcmVxdWlyZWRQZXJtaXNzaW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBoYXNSZXF1aXJlZFBlcm1pc3Npb25zID0gaGFzQW55UGVybWlzc2lvbih1c2VyUHJvZmlsZSwgcmVxdWlyZWRQZXJtaXNzaW9ucyk7XG5cbiAgICAgIGlmICghaGFzUmVxdWlyZWRQZXJtaXNzaW9ucykge1xuICAgICAgICBhd2FpdCBsb2dQZXJtaXNzaW9uRGVuaWVkKFxuICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICAnU1BFQ0lGSUNfUEVSTUlTU0lPTlMnLFxuICAgICAgICAgIHJlcXVpcmVkUGVybWlzc2lvbnMuZmxhdCgpLFxuICAgICAgICAgIHNlY3VyaXR5Q29udGV4dFxuICAgICAgICApO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiAnUGVybWlzb3MgaW5zdWZpY2llbnRlcyBwYXJhIGVzdGEgb3BlcmFjacOzbicsXG4gICAgICAgICAgc3RhdHVzOiA0MDNcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyA3LiBSZWdpc3RyYXIgYWNjZXNvIGVuIGF1ZGl0IGxvZ1xuICAgIGF3YWl0IGxvZ0FkbWluQWNjZXNzKHVzZXJQcm9maWxlLmlkLCAnQVBJX0FDQ0VTUycpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICB1c2VyOiB1c2VyUHJvZmlsZSxcbiAgICAgIHN1cGFiYXNlOiBzdXBhYmFzZUFkbWluLFxuICAgICAgc2VjdXJpdHlDb250ZXh0LFxuICAgICAgand0VmFsaWRhdGlvbixcbiAgICAgIGNzcmZWYWxpZGF0aW9uLFxuICAgICAgcmF0ZUxpbWl0UmVzdWx0XG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBjaGVja0FkbWluUGVybWlzc2lvbnM6JywgZXJyb3IpO1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnRXJyb3IgaW50ZXJubyBkZWwgc2Vydmlkb3InLFxuICAgICAgc3RhdHVzOiA1MDBcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogTWlkZGxld2FyZSBlc3BlY8OtZmljbyBwYXJhIG9wZXJhY2lvbmVzIENSVUQgY29uIHZhbGlkYWNpb25lcyBkZSBzZWd1cmlkYWRcbiAqIEFjdHVhbGl6YWRvIHBhcmEgc29wb3J0YXIgdGFudG8gTmV4dFJlcXVlc3QgY29tbyBOZXh0QXBpUmVxdWVzdFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2hlY2tDUlVEUGVybWlzc2lvbnMoXG4gIHJlc291cmNlOiBzdHJpbmcsXG4gIGFjdGlvbjogJ2NyZWF0ZScgfCAncmVhZCcgfCAndXBkYXRlJyB8ICdkZWxldGUnLFxuICByZXF1ZXN0PzogTmV4dFJlcXVlc3QgfCBOZXh0QXBpUmVxdWVzdFxuKTogUHJvbWlzZTxBZG1pbkF1dGhSZXN1bHQgJiB7IHN1cGFiYXNlPzogdHlwZW9mIHN1cGFiYXNlQWRtaW47IHNlY3VyaXR5Q29udGV4dD86IFNlY3VyaXR5Q29udGV4dCB9PiB7XG4gIGNvbnN0IHJlcXVpcmVkUGVybWlzc2lvbnMgPSBbW3Jlc291cmNlLCBhY3Rpb25dXTtcbiAgcmV0dXJuIGNoZWNrQWRtaW5QZXJtaXNzaW9ucyhyZXF1aXJlZFBlcm1pc3Npb25zLCByZXF1ZXN0KTtcbn1cblxuLyoqXG4gKiBOdWV2YSBmdW5jacOzbiBkZSB2YWxpZGFjacOzbiBkZSBzZWd1cmlkYWQgYXZhbnphZGFcbiAqIEludGVncmEgdG9kYXMgbGFzIHZhbGlkYWNpb25lcyBkZSBzZWd1cmlkYWQgZW4gdW5hIHNvbGEgZnVuY2nDs25cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNoZWNrQWR2YW5jZWRTZWN1cml0eShcbiAgdXNlcklkOiBzdHJpbmcsXG4gIG9wZXJhdGlvbjogc3RyaW5nLFxuICByZXF1aXJlZFBlcm1pc3Npb25zOiBzdHJpbmdbXSxcbiAgcmVxdWVzdD86IE5leHRSZXF1ZXN0IHwgTmV4dEFwaVJlcXVlc3Rcbik6IFByb21pc2U8U2VjdXJpdHlWYWxpZGF0aW9uUmVzdWx0ICYgeyB1c2VyUHJvZmlsZT86IFVzZXJQcm9maWxlOyBzdXBhYmFzZT86IHR5cGVvZiBzdXBhYmFzZUFkbWluIH0+IHtcbiAgdHJ5IHtcbiAgICAvLyAxLiBFamVjdXRhciBkZXRlY2Npw7NuIGRlIHNlZ3VyaWRhZFxuICAgIGF3YWl0IHJ1blNlY3VyaXR5RGV0ZWN0aW9uKHVzZXJJZCk7XG5cbiAgICAvLyAyLiBWYWxpZGFyIGNvbnRleHRvIGRlIHNlZ3VyaWRhZFxuICAgIGNvbnN0IHNlY3VyaXR5VmFsaWRhdGlvbiA9IGF3YWl0IHZhbGlkYXRlU2VjdXJpdHlDb250ZXh0KFxuICAgICAgdXNlcklkLFxuICAgICAgb3BlcmF0aW9uLFxuICAgICAgcmVxdWlyZWRQZXJtaXNzaW9ucyBhcyBhbnksXG4gICAgICByZXF1ZXN0XG4gICAgKTtcblxuICAgIGlmICghc2VjdXJpdHlWYWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICByZXR1cm4gc2VjdXJpdHlWYWxpZGF0aW9uO1xuICAgIH1cblxuICAgIC8vIDMuIE9idGVuZXIgcGVyZmlsIGRlIHVzdWFyaW8gZGVzZGUgU3VwYWJhc2VcbiAgICBjb25zdCB1c2VyUHJvZmlsZSA9IGF3YWl0IGdldFVzZXJQcm9maWxlKHVzZXJJZCk7XG4gICAgaWYgKCF1c2VyUHJvZmlsZSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ1BlcmZpbCBkZSB1c3VhcmlvIG5vIGVuY29udHJhZG8nLFxuICAgICAgICBjb2RlOiAnVVNFUl9QUk9GSUxFX05PVF9GT1VORCcsXG4gICAgICAgIHNldmVyaXR5OiAnaGlnaCdcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gNC4gVmVyaWZpY2FyIGRpc3BvbmliaWxpZGFkIGRlIFN1cGFiYXNlXG4gICAgaWYgKCFzdXBhYmFzZUFkbWluKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnU2VydmljaW8gYWRtaW5pc3RyYXRpdm8gbm8gZGlzcG9uaWJsZScsXG4gICAgICAgIGNvZGU6ICdTRVJWSUNFX1VOQVZBSUxBQkxFJyxcbiAgICAgICAgc2V2ZXJpdHk6ICdjcml0aWNhbCdcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbGlkOiB0cnVlLFxuICAgICAgY29udGV4dDogc2VjdXJpdHlWYWxpZGF0aW9uLmNvbnRleHQsXG4gICAgICB1c2VyUHJvZmlsZSxcbiAgICAgIHN1cGFiYXNlOiBzdXBhYmFzZUFkbWluXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbU0VDVVJJVFldIEVycm9yIGVuIGNoZWNrQWR2YW5jZWRTZWN1cml0eTonLCBlcnJvcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnRXJyb3IgaW50ZXJubyBlbiB2YWxpZGFjacOzbiBkZSBzZWd1cmlkYWQnLFxuICAgICAgY29kZTogJ1NFQ1VSSVRZX1ZBTElEQVRJT05fRVJST1InLFxuICAgICAgc2V2ZXJpdHk6ICdjcml0aWNhbCdcbiAgICB9O1xuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBGVU5DSU9ORVMgREUgTE9HR0lORyBZIEFVRElUT1LDjUFcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogUmVnaXN0cmEgYWNjZXNvIGFkbWluaXN0cmF0aXZvIGVuIGVsIGF1ZGl0IGxvZ1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9nQWRtaW5BY2Nlc3MoXG4gIHVzZXJQcm9maWxlSWQ6IHN0cmluZyxcbiAgYWN0aW9uOiBzdHJpbmcsXG4gIHJlc291cmNlVHlwZT86IHN0cmluZyxcbiAgcmVzb3VyY2VJZD86IHN0cmluZyxcbiAgYWRkaXRpb25hbERhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgdHJ5IHtcbiAgICBpZiAoIXN1cGFiYXNlQWRtaW4pIHJldHVybjtcblxuICAgIGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgIC5mcm9tKCdhZG1pbl9hdWRpdF9sb2cnKVxuICAgICAgLmluc2VydCh7XG4gICAgICAgIHVzZXJfaWQ6IHVzZXJQcm9maWxlSWQsXG4gICAgICAgIGFjdGlvbixcbiAgICAgICAgcmVzb3VyY2VfdHlwZTogcmVzb3VyY2VUeXBlIHx8ICdzeXN0ZW0nLFxuICAgICAgICByZXNvdXJjZV9pZDogcmVzb3VyY2VJZCxcbiAgICAgICAgbmV3X3ZhbHVlczogYWRkaXRpb25hbERhdGEgPyBKU09OLnN0cmluZ2lmeShhZGRpdGlvbmFsRGF0YSkgOiBudWxsXG4gICAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb2dnaW5nIGFkbWluIGFjY2VzczonLCBlcnJvcik7XG4gICAgLy8gTm8gbGFuemFyIGVycm9yIHBhcmEgbm8gaW50ZXJydW1waXIgZWwgZmx1am8gcHJpbmNpcGFsXG4gIH1cbn1cblxuLyoqXG4gKiBSZWdpc3RyYSBjYW1iaW9zIGVuIHJlY3Vyc29zIGFkbWluaXN0cmF0aXZvc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9nQWRtaW5BY3Rpb24oXG4gIHVzZXJQcm9maWxlSWQ6IHN0cmluZyxcbiAgYWN0aW9uOiBzdHJpbmcsXG4gIHJlc291cmNlVHlwZTogc3RyaW5nLFxuICByZXNvdXJjZUlkOiBzdHJpbmcsXG4gIG9sZFZhbHVlcz86IGFueSxcbiAgbmV3VmFsdWVzPzogYW55XG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgdHJ5IHtcbiAgICBpZiAoIXN1cGFiYXNlQWRtaW4pIHJldHVybjtcblxuICAgIGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgIC5mcm9tKCdhZG1pbl9hdWRpdF9sb2cnKVxuICAgICAgLmluc2VydCh7XG4gICAgICAgIHVzZXJfaWQ6IHVzZXJQcm9maWxlSWQsXG4gICAgICAgIGFjdGlvbixcbiAgICAgICAgcmVzb3VyY2VfdHlwZTogcmVzb3VyY2VUeXBlLFxuICAgICAgICByZXNvdXJjZV9pZDogcmVzb3VyY2VJZCxcbiAgICAgICAgb2xkX3ZhbHVlczogb2xkVmFsdWVzID8gSlNPTi5zdHJpbmdpZnkob2xkVmFsdWVzKSA6IG51bGwsXG4gICAgICAgIG5ld192YWx1ZXM6IG5ld1ZhbHVlcyA/IEpTT04uc3RyaW5naWZ5KG5ld1ZhbHVlcykgOiBudWxsXG4gICAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb2dnaW5nIGFkbWluIGFjdGlvbjonLCBlcnJvcik7XG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFVUSUxJREFERVMgUEFSQSBORVhULkpTIEFQSSBST1VURVNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogV3JhcHBlciBwYXJhIEFQSSByb3V0ZXMgcXVlIHJlcXVpZXJlbiBhdXRlbnRpY2FjacOzbiBhZG1pbiAoQXBwIFJvdXRlcilcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhBZG1pbkF1dGgoXG4gIGhhbmRsZXI6IChcbiAgICByZXF1ZXN0OiBOZXh0UmVxdWVzdCxcbiAgICBjb250ZXh0OiB7IHVzZXI6IFVzZXJQcm9maWxlOyBzdXBhYmFzZTogdHlwZW9mIHN1cGFiYXNlQWRtaW4gfVxuICApID0+IFByb21pc2U8UmVzcG9uc2U+LFxuICByZXF1aXJlZFBlcm1pc3Npb25zPzogc3RyaW5nW11bXVxuKSB7XG4gIHJldHVybiBhc3luYyAocmVxdWVzdDogTmV4dFJlcXVlc3QpOiBQcm9taXNlPFJlc3BvbnNlPiA9PiB7XG4gICAgY29uc3QgYXV0aFJlc3VsdCA9IGF3YWl0IGNoZWNrQWRtaW5QZXJtaXNzaW9ucyhyZXF1aXJlZFBlcm1pc3Npb25zLCByZXF1ZXN0KTtcblxuICAgIGlmICghYXV0aFJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4gbmV3IFJlc3BvbnNlKFxuICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IGF1dGhSZXN1bHQuZXJyb3JcbiAgICAgICAgfSksXG4gICAgICAgIHtcbiAgICAgICAgICBzdGF0dXM6IGF1dGhSZXN1bHQuc3RhdHVzIHx8IDUwMCxcbiAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiBoYW5kbGVyKHJlcXVlc3QsIHtcbiAgICAgIHVzZXI6IGF1dGhSZXN1bHQudXNlciEsXG4gICAgICBzdXBhYmFzZTogYXV0aFJlc3VsdC5zdXBhYmFzZSFcbiAgICB9KTtcbiAgfTtcbn1cblxuLyoqXG4gKiBXcmFwcGVyIHBhcmEgUGFnZXMgUm91dGVyIEFQSSBSb3V0ZXMgcXVlIHJlcXVpZXJlbiBhdXRlbnRpY2FjacOzbiBhZG1pblxuICovXG5leHBvcnQgZnVuY3Rpb24gd2l0aEFkbWluQXV0aFBhZ2VzKFxuICBoYW5kbGVyOiAoXG4gICAgcmVxOiBOZXh0QXBpUmVxdWVzdCxcbiAgICByZXM6IE5leHRBcGlSZXNwb25zZSxcbiAgICBjb250ZXh0OiB7IHVzZXI6IFVzZXJQcm9maWxlOyBzdXBhYmFzZTogdHlwZW9mIHN1cGFiYXNlQWRtaW4gfVxuICApID0+IFByb21pc2U8dm9pZD4sXG4gIHJlcXVpcmVkUGVybWlzc2lvbnM/OiBzdHJpbmdbXVtdXG4pIHtcbiAgcmV0dXJuIGFzeW5jIChyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgIGNvbnN0IGF1dGhSZXN1bHQgPSBhd2FpdCBjaGVja0FkbWluUGVybWlzc2lvbnMocmVxdWlyZWRQZXJtaXNzaW9ucywgcmVxKTtcblxuICAgIGlmICghYXV0aFJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyhhdXRoUmVzdWx0LnN0YXR1cyB8fCA1MDApLmpzb24oe1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IGF1dGhSZXN1bHQuZXJyb3JcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBoYW5kbGVyKHJlcSwgcmVzLCB7XG4gICAgICB1c2VyOiBhdXRoUmVzdWx0LnVzZXIhLFxuICAgICAgc3VwYWJhc2U6IGF1dGhSZXN1bHQuc3VwYWJhc2UhXG4gICAgfSk7XG4gIH07XG59XG5cbi8qKlxuICogRXh0cmFlIGluZm9ybWFjacOzbiBkZSBsYSByZXF1ZXN0IHBhcmEgbG9nZ2luZ1xuICogU29wb3J0YSB0YW50byBOZXh0UmVxdWVzdCBjb21vIE5leHRBcGlSZXF1ZXN0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRSZXF1ZXN0SW5mbyhyZXF1ZXN0OiBOZXh0UmVxdWVzdCB8IE5leHRBcGlSZXF1ZXN0KSB7XG4gIGlmICgncXVlcnknIGluIHJlcXVlc3QpIHtcbiAgICAvLyBOZXh0QXBpUmVxdWVzdCAoUGFnZXMgUm91dGVyKVxuICAgIGNvbnN0IHJlcSA9IHJlcXVlc3QgYXMgTmV4dEFwaVJlcXVlc3Q7XG4gICAgcmV0dXJuIHtcbiAgICAgIG1ldGhvZDogcmVxLm1ldGhvZCB8fCAnR0VUJyxcbiAgICAgIHVybDogcmVxLnVybCB8fCAndW5rbm93bicsXG4gICAgICB1c2VyQWdlbnQ6IHJlcS5oZWFkZXJzWyd1c2VyLWFnZW50J10gfHwgJ3Vua25vd24nLFxuICAgICAgaXA6IHJlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXSB8fFxuICAgICAgICAgIHJlcS5oZWFkZXJzWyd4LXJlYWwtaXAnXSB8fFxuICAgICAgICAgIHJlcS5jb25uZWN0aW9uPy5yZW1vdGVBZGRyZXNzIHx8XG4gICAgICAgICAgJ3Vua25vd24nXG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICAvLyBOZXh0UmVxdWVzdCAoQXBwIFJvdXRlcilcbiAgICBjb25zdCByZXEgPSByZXF1ZXN0IGFzIE5leHRSZXF1ZXN0O1xuICAgIHJldHVybiB7XG4gICAgICBtZXRob2Q6IHJlcS5tZXRob2QsXG4gICAgICB1cmw6IHJlcS51cmwsXG4gICAgICB1c2VyQWdlbnQ6IHJlcS5oZWFkZXJzLmdldCgndXNlci1hZ2VudCcpIHx8ICd1bmtub3duJyxcbiAgICAgIGlwOiByZXEuaGVhZGVycy5nZXQoJ3gtZm9yd2FyZGVkLWZvcicpIHx8XG4gICAgICAgICAgcmVxLmhlYWRlcnMuZ2V0KCd4LXJlYWwtaXAnKSB8fFxuICAgICAgICAgICd1bmtub3duJ1xuICAgIH07XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJjaGVja0FkbWluQWNjZXNzIiwiY2hlY2tBZG1pblBlcm1pc3Npb25zIiwiY2hlY2tBZHZhbmNlZFNlY3VyaXR5IiwiY2hlY2tDUlVEUGVybWlzc2lvbnMiLCJnZXRBdXRoRnJvbUFwaVJvdXRlIiwiZ2V0QXV0aEZyb21IZWFkZXJzIiwiZ2V0QXV0aEZyb21Sb3V0ZUhhbmRsZXIiLCJnZXRBdXRoZW50aWNhdGVkQWRtaW4iLCJnZXRBdXRoZW50aWNhdGVkVXNlciIsImdldFJlcXVlc3RJbmZvIiwiZ2V0VW5pZmllZEF1dGgiLCJnZXRVc2VyUHJvZmlsZSIsImhhc0FsbFBlcm1pc3Npb25zIiwiaGFzQW55UGVybWlzc2lvbiIsImhhc1Blcm1pc3Npb24iLCJpc0FkbWluIiwiaXNNb2RlcmF0b3JPckFkbWluIiwibG9nQWRtaW5BY2Nlc3MiLCJsb2dBZG1pbkFjdGlvbiIsIndpdGhBZG1pbkF1dGgiLCJ3aXRoQWRtaW5BdXRoUGFnZXMiLCJyZXF1ZXN0IiwidXNlcklkIiwic2Vzc2lvbklkIiwiZ2V0VG9rZW4iLCJnZXRBdXRoIiwiY29uc29sZSIsImxvZyIsInRva2VuIiwicGF5bG9hZCIsIkpTT04iLCJwYXJzZSIsImF0b2IiLCJzcGxpdCIsIm1ldGFkYXRhIiwicm9sZSIsInRva2VuRXJyb3IiLCJ3YXJuIiwic2Vzc2lvbkNsYWltcyIsImF1dGgiLCJhdXRoRXJyb3IiLCJlcnJvciIsIm1lc3NhZ2UiLCJFcnJvciIsImNsZXJrVXNlcklkIiwiaGVhZGVycyIsImdldCIsImRlcHJlY2F0ZWQiLCJhdXRoUmVzdWx0Iiwic3RhdHVzIiwidW5kZWZpbmVkIiwic3VwYWJhc2UiLCJzdXBhYmFzZUFkbWluIiwiYWRtaW5DaGVjayIsInN1Y2Nlc3MiLCJ1c2VyIiwicmVxIiwicmVzIiwiYXBpRXJyb3IiLCJyb3V0ZUVycm9yIiwiZGF0YSIsInByb2ZpbGUiLCJwcm9maWxlRXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJzaW5nbGUiLCJyb2xlRXJyb3IiLCJyb2xlX2lkIiwidXNlclByb2ZpbGUiLCJ1c2VyX3JvbGVzIiwiaXNfYWN0aXZlIiwiaGFzQWRtaW5BY2Nlc3MiLCJwZXJtaXNzaW9uUGF0aCIsInBlcm1pc3Npb25zIiwiY3VycmVudCIsInBhdGgiLCJzb21lIiwicGVybWlzc2lvbiIsImV2ZXJ5Iiwicm9sZV9uYW1lIiwicmVxdWlyZWRQZXJtaXNzaW9ucyIsInJhdGVMaW1pdFJlc3VsdCIsImNoZWNrUmF0ZUxpbWl0IiwiUkFURV9MSU1JVF9DT05GSUdTIiwiYWRtaW4iLCJhbGxvd2VkIiwibG9nQXV0aEZhaWx1cmUiLCJjc3JmVmFsaWRhdGlvbiIsInZhbGlkYXRlUmVxdWVzdE9yaWdpbiIsInZhbGlkIiwic2VjdXJpdHlDb250ZXh0IiwiZ2V0U2VjdXJpdHlDb250ZXh0IiwibG9nQXV0aFN1Y2Nlc3MiLCJsb2dBdXRoZW50aWNhdGlvbiIsIkF1ZGl0UmVzdWx0IiwiU1VDQ0VTUyIsImF1dGhNZXRob2QiLCJyaXNrTGV2ZWwiLCJpcCIsImlwQWRkcmVzcyIsInVzZXJBZ2VudCIsIkZBSUxVUkUiLCJmYWxsYmFja0F0dGVtcHRlZCIsImZhbGxiYWNrUmVzdWx0Iiwiand0VmFsaWRhdGlvbiIsInZhbGlkYXRlSldUSW50ZWdyaXR5Iiwiand0UGVybWlzc2lvblZhbGlkYXRpb24iLCJ2YWxpZGF0ZUpXVFBlcm1pc3Npb25zIiwibG9nUGVybWlzc2lvbkRlbmllZCIsInJ1blNlY3VyaXR5RGV0ZWN0aW9uIiwibGVuZ3RoIiwiaGFzUmVxdWlyZWRQZXJtaXNzaW9ucyIsImZsYXQiLCJpZCIsInJlc291cmNlIiwiYWN0aW9uIiwib3BlcmF0aW9uIiwic2VjdXJpdHlWYWxpZGF0aW9uIiwidmFsaWRhdGVTZWN1cml0eUNvbnRleHQiLCJjb2RlIiwic2V2ZXJpdHkiLCJjb250ZXh0IiwidXNlclByb2ZpbGVJZCIsInJlc291cmNlVHlwZSIsInJlc291cmNlSWQiLCJhZGRpdGlvbmFsRGF0YSIsImluc2VydCIsInVzZXJfaWQiLCJyZXNvdXJjZV90eXBlIiwicmVzb3VyY2VfaWQiLCJuZXdfdmFsdWVzIiwic3RyaW5naWZ5Iiwib2xkVmFsdWVzIiwibmV3VmFsdWVzIiwib2xkX3ZhbHVlcyIsImhhbmRsZXIiLCJSZXNwb25zZSIs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