ccab677ce2ee844ea7d7afcd4b80a6af
/**
 * Tests para APIs Admin Refactorizadas
 * Verifica que las APIs admin refactorizadas funcionan con utilidades enterprise + RLS
 */ // Mock de utilidades enterprise
"use strict";
jest.mock('@/lib/auth/enterprise-auth-utils', ()=>({
        requireAdminAuth: jest.fn(),
        requireCriticalAuth: jest.fn()
    }));
jest.mock('@/lib/auth/enterprise-rls-utils', ()=>({
        executeWithRLS: jest.fn(),
        validateRLSContext: jest.fn(),
        checkRLSPermission: jest.fn(),
        createRLSFilters: jest.fn()
    }));
jest.mock('@/lib/auth/enterprise-cache', ()=>({
        withCache: jest.fn(),
        getCacheStats: jest.fn(),
        invalidateUserCache: jest.fn()
    }));
// Mock de Supabase
jest.mock('@/lib/supabase', ()=>({
        supabaseAdmin: {
            auth: {
                admin: {
                    listUsers: jest.fn(),
                    createUser: jest.fn()
                }
            },
            from: jest.fn(()=>({
                    select: jest.fn(()=>({
                            eq: jest.fn(()=>({
                                    single: jest.fn()
                                }))
                        })),
                    insert: jest.fn(()=>({
                            select: jest.fn(()=>({
                                    single: jest.fn()
                                }))
                        })),
                    update: jest.fn(()=>({
                            eq: jest.fn(()=>({
                                    select: jest.fn(()=>({
                                            single: jest.fn()
                                        }))
                                }))
                        }))
                }))
        }
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _enterpriseauthutils = require("../lib/auth/enterprise-auth-utils");
const _enterpriserlsutils = require("../lib/auth/enterprise-rls-utils");
const _enterprisecache = require("../lib/auth/enterprise-cache");
describe('APIs Admin Refactorizadas', ()=>{
    let mockRequireAdminAuth;
    let mockRequireCriticalAuth;
    let mockExecuteWithRLS;
    let mockWithCache;
    let mockGetCacheStats;
    beforeEach(()=>{
        mockRequireAdminAuth = _enterpriseauthutils.requireAdminAuth;
        mockRequireCriticalAuth = _enterpriseauthutils.requireCriticalAuth;
        mockExecuteWithRLS = _enterpriserlsutils.executeWithRLS;
        mockWithCache = _enterprisecache.withCache;
        mockGetCacheStats = _enterprisecache.getCacheStats;
        jest.clearAllMocks();
        // Setup default mocks
        mockRequireAdminAuth.mockResolvedValue({
            success: true,
            context: {
                userId: 'user_123',
                sessionId: 'sess_123',
                email: 'admin@test.com',
                role: 'admin',
                permissions: [
                    'admin_access',
                    'user_management',
                    'products_read'
                ],
                sessionValid: true,
                securityLevel: 'critical',
                ipAddress: '127.0.0.1',
                userAgent: 'test-agent',
                supabase: {},
                validations: {
                    jwtValid: true,
                    csrfValid: true,
                    rateLimitPassed: true,
                    originValid: true
                }
            }
        });
        mockRequireCriticalAuth.mockResolvedValue({
            success: true,
            context: {
                userId: 'user_123',
                sessionId: 'sess_123',
                email: 'admin@test.com',
                role: 'admin',
                permissions: [
                    'admin_access',
                    'admin_create'
                ],
                sessionValid: true,
                securityLevel: 'critical',
                ipAddress: '127.0.0.1',
                userAgent: 'test-agent',
                supabase: {},
                validations: {
                    jwtValid: true,
                    csrfValid: true,
                    rateLimitPassed: true,
                    originValid: true
                }
            }
        });
        mockExecuteWithRLS.mockResolvedValue({
            success: true,
            data: {
                test: 'data'
            }
        });
        mockWithCache.mockImplementation(async (key, fetcher)=>{
            return await fetcher();
        });
        mockGetCacheStats.mockReturnValue({
            hits: 10,
            misses: 2,
            entries: 5,
            hitRate: 83.33,
            memoryUsage: 1024
        });
    });
    describe('API de Debug Check Admin Access', ()=>{
        it('debe usar autenticación enterprise y legacy para comparación', async ()=>{
            // Mock de la API
            const { GET } = require('@/app/api/debug/check-admin-access/route');
            const mockRequest = {
                method: 'GET',
                url: 'http://localhost:3000/api/debug/check-admin-access',
                headers: new Map([
                    [
                        'user-agent',
                        'test-agent'
                    ]
                ])
            };
            const response = await GET(mockRequest);
            const responseData = await response.json();
            expect(mockRequireAdminAuth).toHaveBeenCalledWith(mockRequest, [
                'admin_access'
            ]);
            expect(responseData.success).toBe(true);
            expect(responseData.enterprise).toBeDefined();
            expect(responseData.legacy).toBeDefined();
            expect(responseData.migration.status).toBe('ENTERPRISE_COMPLETED');
        });
        it('debe manejar fallo de autenticación enterprise', async ()=>{
            mockRequireAdminAuth.mockResolvedValue({
                success: false,
                error: 'Authentication failed',
                code: 'AUTH_FAILED',
                status: 401
            });
            const { GET } = require('@/app/api/debug/check-admin-access/route');
            const mockRequest = {
                method: 'GET',
                url: 'http://localhost:3000/api/debug/check-admin-access',
                headers: new Map()
            };
            const response = await GET(mockRequest);
            const responseData = await response.json();
            expect(responseData.enterprise.status).toBe('FAILED');
            expect(responseData.enterprise.error).toBe('Authentication failed');
        });
    });
    describe('API de Debug Admin Products', ()=>{
        it('debe usar RLS para consultar productos', async ()=>{
            mockExecuteWithRLS.mockResolvedValue({
                success: true,
                data: [
                    {
                        id: 1,
                        name: 'Product 1',
                        price: 100
                    },
                    {
                        id: 2,
                        name: 'Product 2',
                        price: 200
                    }
                ]
            });
            const { GET } = require('@/app/api/debug/admin-products/route');
            const mockRequest = {
                method: 'GET',
                url: 'http://localhost:3000/api/debug/admin-products',
                headers: new Map()
            };
            const response = await GET(mockRequest);
            const responseData = await response.json();
            expect(mockRequireAdminAuth).toHaveBeenCalledWith(mockRequest, [
                'products_read'
            ]);
            expect(mockExecuteWithRLS).toHaveBeenCalled();
            expect(responseData.enterprise.rls.products_found).toBe(2);
            expect(responseData.enterprise.rls.sample_products).toHaveLength(2);
        });
        it('debe comparar métodos enterprise y legacy', async ()=>{
            const { GET } = require('@/app/api/debug/admin-products/route');
            const mockRequest = {
                method: 'GET',
                url: 'http://localhost:3000/api/debug/admin-products'
            };
            const response = await GET(mockRequest);
            const responseData = await response.json();
            expect(responseData.comparison).toBeDefined();
            expect(responseData.comparison.enterprise_advantages).toContain('RLS integration with automatic filters');
            expect(responseData.enterprise).toBeDefined();
            expect(responseData.legacy).toBeDefined();
        });
    });
    describe('API de Seguridad Enterprise', ()=>{
        it('debe usar cache enterprise para métricas', async ()=>{
            const mockMetrics = {
                total_events: 100,
                security_alerts: 5,
                failed_logins: 10
            };
            mockWithCache.mockResolvedValue(mockMetrics);
            // Mock de la función getSecurityMetrics
            jest.doMock('@/lib/auth/security-audit-enhanced', ()=>({
                    getSecurityMetrics: jest.fn().mockResolvedValue(mockMetrics)
                }));
            const { GET } = require('@/app/api/auth/security/route');
            const mockRequest = {
                method: 'GET',
                url: 'http://localhost:3000/api/auth/security?action=metrics',
                headers: new Map()
            };
            const response = await GET(mockRequest);
            const responseData = await response.json();
            expect(mockRequireAdminAuth).toHaveBeenCalledWith(mockRequest, [
                'security_read',
                'admin_access'
            ]);
            expect(mockWithCache).toHaveBeenCalled();
            expect(responseData.data.metrics).toEqual(mockMetrics);
            expect(responseData.data.cache).toBeDefined();
            expect(responseData.enterprise).toBe(true);
        });
    });
    describe('API de Creación de Admin Enterprise', ()=>{
        it('debe usar autenticación crítica para crear admin', async ()=>{
            mockExecuteWithRLS.mockResolvedValue({
                success: true,
                data: {
                    action: 'created',
                    authUser: {
                        id: 'auth_123',
                        email: 'new-admin@test.com'
                    },
                    profile: {
                        id: 'profile_123',
                        first_name: 'New',
                        last_name: 'Admin',
                        permissions: [
                            'admin_access'
                        ],
                        user_roles: {
                            role_name: 'admin'
                        }
                    }
                }
            });
            const { POST } = require('@/app/api/admin/create-admin-user-enterprise/route');
            const mockRequest = {
                method: 'POST',
                json: jest.fn().mockResolvedValue({
                    securityKey: 'CREATE_ADMIN_PINTEYA_ENTERPRISE_2025',
                    email: 'new-admin@test.com',
                    password: 'SecurePassword123!',
                    firstName: 'New',
                    lastName: 'Admin'
                })
            };
            const response = await POST(mockRequest);
            const responseData = await response.json();
            expect(mockRequireCriticalAuth).toHaveBeenCalledWith(mockRequest);
            expect(mockExecuteWithRLS).toHaveBeenCalled();
            expect(responseData.success).toBe(true);
            expect(responseData.data.action).toBe('created');
            expect(responseData.enterprise.security_level).toBe('critical');
        });
        it('debe validar contraseña robusta', async ()=>{
            const { POST } = require('@/app/api/admin/create-admin-user-enterprise/route');
            const mockRequest = {
                method: 'POST',
                json: jest.fn().mockResolvedValue({
                    securityKey: 'CREATE_ADMIN_PINTEYA_ENTERPRISE_2025',
                    email: 'new-admin@test.com',
                    password: 'weak',
                    firstName: 'New',
                    lastName: 'Admin'
                })
            };
            const response = await POST(mockRequest);
            const responseData = await response.json();
            expect(response.status).toBe(400);
            expect(responseData.error).toContain('12 caracteres');
            expect(responseData.code).toBe('WEAK_PASSWORD');
        });
        it('debe validar clave de seguridad', async ()=>{
            const { POST } = require('@/app/api/admin/create-admin-user-enterprise/route');
            const mockRequest = {
                method: 'POST',
                json: jest.fn().mockResolvedValue({
                    securityKey: 'WRONG_KEY',
                    email: 'new-admin@test.com',
                    password: 'SecurePassword123!'
                })
            };
            const response = await POST(mockRequest);
            const responseData = await response.json();
            expect(response.status).toBe(403);
            expect(responseData.error).toContain('Clave de seguridad enterprise incorrecta');
            expect(responseData.code).toBe('INVALID_SECURITY_KEY');
        });
    });
    describe('Integración General', ()=>{
        it('debe usar cache stats en todas las APIs enterprise', ()=>{
            expect(mockGetCacheStats).toHaveBeenCalled();
        });
        it('debe usar RLS en operaciones de base de datos', ()=>{
            expect(mockExecuteWithRLS).toHaveBeenCalled();
        });
        it('debe requerir permisos específicos para cada operación', ()=>{
            expect(mockRequireAdminAuth).toHaveBeenCalledWith(expect.any(Object), expect.arrayContaining([
                expect.any(String)
            ]));
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcX190ZXN0c19fXFxhZG1pbi1hcGlzLXJlZmFjdG9yZWQudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRlc3RzIHBhcmEgQVBJcyBBZG1pbiBSZWZhY3Rvcml6YWRhc1xuICogVmVyaWZpY2EgcXVlIGxhcyBBUElzIGFkbWluIHJlZmFjdG9yaXphZGFzIGZ1bmNpb25hbiBjb24gdXRpbGlkYWRlcyBlbnRlcnByaXNlICsgUkxTXG4gKi9cblxuLy8gTW9jayBkZSB1dGlsaWRhZGVzIGVudGVycHJpc2Vcbmplc3QubW9jaygnQC9saWIvYXV0aC9lbnRlcnByaXNlLWF1dGgtdXRpbHMnLCAoKSA9PiAoe1xuICByZXF1aXJlQWRtaW5BdXRoOiBqZXN0LmZuKCksXG4gIHJlcXVpcmVDcml0aWNhbEF1dGg6IGplc3QuZm4oKVxufSkpO1xuXG5qZXN0Lm1vY2soJ0AvbGliL2F1dGgvZW50ZXJwcmlzZS1ybHMtdXRpbHMnLCAoKSA9PiAoe1xuICBleGVjdXRlV2l0aFJMUzogamVzdC5mbigpLFxuICB2YWxpZGF0ZVJMU0NvbnRleHQ6IGplc3QuZm4oKSxcbiAgY2hlY2tSTFNQZXJtaXNzaW9uOiBqZXN0LmZuKCksXG4gIGNyZWF0ZVJMU0ZpbHRlcnM6IGplc3QuZm4oKVxufSkpO1xuXG5qZXN0Lm1vY2soJ0AvbGliL2F1dGgvZW50ZXJwcmlzZS1jYWNoZScsICgpID0+ICh7XG4gIHdpdGhDYWNoZTogamVzdC5mbigpLFxuICBnZXRDYWNoZVN0YXRzOiBqZXN0LmZuKCksXG4gIGludmFsaWRhdGVVc2VyQ2FjaGU6IGplc3QuZm4oKVxufSkpO1xuXG4vLyBNb2NrIGRlIFN1cGFiYXNlXG5qZXN0Lm1vY2soJ0AvbGliL3N1cGFiYXNlJywgKCkgPT4gKHtcbiAgc3VwYWJhc2VBZG1pbjoge1xuICAgIGF1dGg6IHtcbiAgICAgIGFkbWluOiB7XG4gICAgICAgIGxpc3RVc2VyczogamVzdC5mbigpLFxuICAgICAgICBjcmVhdGVVc2VyOiBqZXN0LmZuKClcbiAgICAgIH1cbiAgICB9LFxuICAgIGZyb206IGplc3QuZm4oKCkgPT4gKHtcbiAgICAgIHNlbGVjdDogamVzdC5mbigoKSA9PiAoe1xuICAgICAgICBlcTogamVzdC5mbigoKSA9PiAoe1xuICAgICAgICAgIHNpbmdsZTogamVzdC5mbigpXG4gICAgICAgIH0pKVxuICAgICAgfSkpLFxuICAgICAgaW5zZXJ0OiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICAgIHNlbGVjdDogamVzdC5mbigoKSA9PiAoe1xuICAgICAgICAgIHNpbmdsZTogamVzdC5mbigpXG4gICAgICAgIH0pKVxuICAgICAgfSkpLFxuICAgICAgdXBkYXRlOiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICAgIGVxOiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICAgICAgICBzaW5nbGU6IGplc3QuZm4oKVxuICAgICAgICAgIH0pKVxuICAgICAgICB9KSlcbiAgICAgIH0pKVxuICAgIH0pKVxuICB9XG59KSk7XG5cbmltcG9ydCB7IE5leHRSZXF1ZXN0IH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgXG4gIHJlcXVpcmVBZG1pbkF1dGgsXG4gIHJlcXVpcmVDcml0aWNhbEF1dGggXG59IGZyb20gJ0AvbGliL2F1dGgvZW50ZXJwcmlzZS1hdXRoLXV0aWxzJztcbmltcG9ydCB7XG4gIGV4ZWN1dGVXaXRoUkxTLFxuICB2YWxpZGF0ZVJMU0NvbnRleHQsXG4gIGNoZWNrUkxTUGVybWlzc2lvbixcbiAgY3JlYXRlUkxTRmlsdGVyc1xufSBmcm9tICdAL2xpYi9hdXRoL2VudGVycHJpc2UtcmxzLXV0aWxzJztcbmltcG9ydCB7XG4gIHdpdGhDYWNoZSxcbiAgZ2V0Q2FjaGVTdGF0cyxcbiAgaW52YWxpZGF0ZVVzZXJDYWNoZVxufSBmcm9tICdAL2xpYi9hdXRoL2VudGVycHJpc2UtY2FjaGUnO1xuXG5kZXNjcmliZSgnQVBJcyBBZG1pbiBSZWZhY3Rvcml6YWRhcycsICgpID0+IHtcbiAgbGV0IG1vY2tSZXF1aXJlQWRtaW5BdXRoOiBqZXN0Lk1vY2tlZEZ1bmN0aW9uPHR5cGVvZiByZXF1aXJlQWRtaW5BdXRoPjtcbiAgbGV0IG1vY2tSZXF1aXJlQ3JpdGljYWxBdXRoOiBqZXN0Lk1vY2tlZEZ1bmN0aW9uPHR5cGVvZiByZXF1aXJlQ3JpdGljYWxBdXRoPjtcbiAgbGV0IG1vY2tFeGVjdXRlV2l0aFJMUzogamVzdC5Nb2NrZWRGdW5jdGlvbjx0eXBlb2YgZXhlY3V0ZVdpdGhSTFM+O1xuICBsZXQgbW9ja1dpdGhDYWNoZTogamVzdC5Nb2NrZWRGdW5jdGlvbjx0eXBlb2Ygd2l0aENhY2hlPjtcbiAgbGV0IG1vY2tHZXRDYWNoZVN0YXRzOiBqZXN0Lk1vY2tlZEZ1bmN0aW9uPHR5cGVvZiBnZXRDYWNoZVN0YXRzPjtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBtb2NrUmVxdWlyZUFkbWluQXV0aCA9IHJlcXVpcmVBZG1pbkF1dGggYXMgamVzdC5Nb2NrZWRGdW5jdGlvbjx0eXBlb2YgcmVxdWlyZUFkbWluQXV0aD47XG4gICAgbW9ja1JlcXVpcmVDcml0aWNhbEF1dGggPSByZXF1aXJlQ3JpdGljYWxBdXRoIGFzIGplc3QuTW9ja2VkRnVuY3Rpb248dHlwZW9mIHJlcXVpcmVDcml0aWNhbEF1dGg+O1xuICAgIG1vY2tFeGVjdXRlV2l0aFJMUyA9IGV4ZWN1dGVXaXRoUkxTIGFzIGplc3QuTW9ja2VkRnVuY3Rpb248dHlwZW9mIGV4ZWN1dGVXaXRoUkxTPjtcbiAgICBtb2NrV2l0aENhY2hlID0gd2l0aENhY2hlIGFzIGplc3QuTW9ja2VkRnVuY3Rpb248dHlwZW9mIHdpdGhDYWNoZT47XG4gICAgbW9ja0dldENhY2hlU3RhdHMgPSBnZXRDYWNoZVN0YXRzIGFzIGplc3QuTW9ja2VkRnVuY3Rpb248dHlwZW9mIGdldENhY2hlU3RhdHM+O1xuXG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG5cbiAgICAvLyBTZXR1cCBkZWZhdWx0IG1vY2tzXG4gICAgbW9ja1JlcXVpcmVBZG1pbkF1dGgubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGNvbnRleHQ6IHtcbiAgICAgICAgdXNlcklkOiAndXNlcl8xMjMnLFxuICAgICAgICBzZXNzaW9uSWQ6ICdzZXNzXzEyMycsXG4gICAgICAgIGVtYWlsOiAnYWRtaW5AdGVzdC5jb20nLFxuICAgICAgICByb2xlOiAnYWRtaW4nLFxuICAgICAgICBwZXJtaXNzaW9uczogWydhZG1pbl9hY2Nlc3MnLCAndXNlcl9tYW5hZ2VtZW50JywgJ3Byb2R1Y3RzX3JlYWQnXSxcbiAgICAgICAgc2Vzc2lvblZhbGlkOiB0cnVlLFxuICAgICAgICBzZWN1cml0eUxldmVsOiAnY3JpdGljYWwnLFxuICAgICAgICBpcEFkZHJlc3M6ICcxMjcuMC4wLjEnLFxuICAgICAgICB1c2VyQWdlbnQ6ICd0ZXN0LWFnZW50JyxcbiAgICAgICAgc3VwYWJhc2U6IHt9IGFzIGFueSxcbiAgICAgICAgdmFsaWRhdGlvbnM6IHtcbiAgICAgICAgICBqd3RWYWxpZDogdHJ1ZSxcbiAgICAgICAgICBjc3JmVmFsaWQ6IHRydWUsXG4gICAgICAgICAgcmF0ZUxpbWl0UGFzc2VkOiB0cnVlLFxuICAgICAgICAgIG9yaWdpblZhbGlkOiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIG1vY2tSZXF1aXJlQ3JpdGljYWxBdXRoLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBjb250ZXh0OiB7XG4gICAgICAgIHVzZXJJZDogJ3VzZXJfMTIzJyxcbiAgICAgICAgc2Vzc2lvbklkOiAnc2Vzc18xMjMnLFxuICAgICAgICBlbWFpbDogJ2FkbWluQHRlc3QuY29tJyxcbiAgICAgICAgcm9sZTogJ2FkbWluJyxcbiAgICAgICAgcGVybWlzc2lvbnM6IFsnYWRtaW5fYWNjZXNzJywgJ2FkbWluX2NyZWF0ZSddLFxuICAgICAgICBzZXNzaW9uVmFsaWQ6IHRydWUsXG4gICAgICAgIHNlY3VyaXR5TGV2ZWw6ICdjcml0aWNhbCcsXG4gICAgICAgIGlwQWRkcmVzczogJzEyNy4wLjAuMScsXG4gICAgICAgIHVzZXJBZ2VudDogJ3Rlc3QtYWdlbnQnLFxuICAgICAgICBzdXBhYmFzZToge30gYXMgYW55LFxuICAgICAgICB2YWxpZGF0aW9uczoge1xuICAgICAgICAgIGp3dFZhbGlkOiB0cnVlLFxuICAgICAgICAgIGNzcmZWYWxpZDogdHJ1ZSxcbiAgICAgICAgICByYXRlTGltaXRQYXNzZWQ6IHRydWUsXG4gICAgICAgICAgb3JpZ2luVmFsaWQ6IHRydWVcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgbW9ja0V4ZWN1dGVXaXRoUkxTLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiB7IHRlc3Q6ICdkYXRhJyB9XG4gICAgfSk7XG5cbiAgICBtb2NrV2l0aENhY2hlLm1vY2tJbXBsZW1lbnRhdGlvbihhc3luYyAoa2V5LCBmZXRjaGVyKSA9PiB7XG4gICAgICByZXR1cm4gYXdhaXQgZmV0Y2hlcigpO1xuICAgIH0pO1xuXG4gICAgbW9ja0dldENhY2hlU3RhdHMubW9ja1JldHVyblZhbHVlKHtcbiAgICAgIGhpdHM6IDEwLFxuICAgICAgbWlzc2VzOiAyLFxuICAgICAgZW50cmllczogNSxcbiAgICAgIGhpdFJhdGU6IDgzLjMzLFxuICAgICAgbWVtb3J5VXNhZ2U6IDEwMjRcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0FQSSBkZSBEZWJ1ZyBDaGVjayBBZG1pbiBBY2Nlc3MnLCAoKSA9PiB7XG4gICAgaXQoJ2RlYmUgdXNhciBhdXRlbnRpY2FjacOzbiBlbnRlcnByaXNlIHkgbGVnYWN5IHBhcmEgY29tcGFyYWNpw7NuJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBkZSBsYSBBUElcbiAgICAgIGNvbnN0IHsgR0VUIH0gPSByZXF1aXJlKCdAL2FwcC9hcGkvZGVidWcvY2hlY2stYWRtaW4tYWNjZXNzL3JvdXRlJyk7XG4gICAgICBcbiAgICAgIGNvbnN0IG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2RlYnVnL2NoZWNrLWFkbWluLWFjY2VzcycsXG4gICAgICAgIGhlYWRlcnM6IG5ldyBNYXAoW1sndXNlci1hZ2VudCcsICd0ZXN0LWFnZW50J11dKVxuICAgICAgfSBhcyBhbnk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgR0VUKG1vY2tSZXF1ZXN0KTtcbiAgICAgIGNvbnN0IHJlc3BvbnNlRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgZXhwZWN0KG1vY2tSZXF1aXJlQWRtaW5BdXRoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChtb2NrUmVxdWVzdCwgWydhZG1pbl9hY2Nlc3MnXSk7XG4gICAgICBleHBlY3QocmVzcG9uc2VEYXRhLnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzcG9uc2VEYXRhLmVudGVycHJpc2UpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVzcG9uc2VEYXRhLmxlZ2FjeSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZURhdGEubWlncmF0aW9uLnN0YXR1cykudG9CZSgnRU5URVJQUklTRV9DT01QTEVURUQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZWJlIG1hbmVqYXIgZmFsbG8gZGUgYXV0ZW50aWNhY2nDs24gZW50ZXJwcmlzZScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tSZXF1aXJlQWRtaW5BdXRoLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnQXV0aGVudGljYXRpb24gZmFpbGVkJyxcbiAgICAgICAgY29kZTogJ0FVVEhfRkFJTEVEJyxcbiAgICAgICAgc3RhdHVzOiA0MDFcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB7IEdFVCB9ID0gcmVxdWlyZSgnQC9hcHAvYXBpL2RlYnVnL2NoZWNrLWFkbWluLWFjY2Vzcy9yb3V0ZScpO1xuICAgICAgXG4gICAgICBjb25zdCBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9kZWJ1Zy9jaGVjay1hZG1pbi1hY2Nlc3MnLFxuICAgICAgICBoZWFkZXJzOiBuZXcgTWFwKClcbiAgICAgIH0gYXMgYW55O1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IEdFVChtb2NrUmVxdWVzdCk7XG4gICAgICBjb25zdCByZXNwb25zZURhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZURhdGEuZW50ZXJwcmlzZS5zdGF0dXMpLnRvQmUoJ0ZBSUxFRCcpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlRGF0YS5lbnRlcnByaXNlLmVycm9yKS50b0JlKCdBdXRoZW50aWNhdGlvbiBmYWlsZWQnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0FQSSBkZSBEZWJ1ZyBBZG1pbiBQcm9kdWN0cycsICgpID0+IHtcbiAgICBpdCgnZGViZSB1c2FyIFJMUyBwYXJhIGNvbnN1bHRhciBwcm9kdWN0b3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRXhlY3V0ZVdpdGhSTFMubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiBbXG4gICAgICAgICAgeyBpZDogMSwgbmFtZTogJ1Byb2R1Y3QgMScsIHByaWNlOiAxMDAgfSxcbiAgICAgICAgICB7IGlkOiAyLCBuYW1lOiAnUHJvZHVjdCAyJywgcHJpY2U6IDIwMCB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB7IEdFVCB9ID0gcmVxdWlyZSgnQC9hcHAvYXBpL2RlYnVnL2FkbWluLXByb2R1Y3RzL3JvdXRlJyk7XG4gICAgICBcbiAgICAgIGNvbnN0IG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2RlYnVnL2FkbWluLXByb2R1Y3RzJyxcbiAgICAgICAgaGVhZGVyczogbmV3IE1hcCgpXG4gICAgICB9IGFzIGFueTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBHRVQobW9ja1JlcXVlc3QpO1xuICAgICAgY29uc3QgcmVzcG9uc2VEYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICBleHBlY3QobW9ja1JlcXVpcmVBZG1pbkF1dGgpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1vY2tSZXF1ZXN0LCBbJ3Byb2R1Y3RzX3JlYWQnXSk7XG4gICAgICBleHBlY3QobW9ja0V4ZWN1dGVXaXRoUkxTKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QocmVzcG9uc2VEYXRhLmVudGVycHJpc2UucmxzLnByb2R1Y3RzX2ZvdW5kKS50b0JlKDIpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlRGF0YS5lbnRlcnByaXNlLnJscy5zYW1wbGVfcHJvZHVjdHMpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZWJlIGNvbXBhcmFyIG3DqXRvZG9zIGVudGVycHJpc2UgeSBsZWdhY3knLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB7IEdFVCB9ID0gcmVxdWlyZSgnQC9hcHAvYXBpL2RlYnVnL2FkbWluLXByb2R1Y3RzL3JvdXRlJyk7XG4gICAgICBcbiAgICAgIGNvbnN0IG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2RlYnVnL2FkbWluLXByb2R1Y3RzJ1xuICAgICAgfSBhcyBhbnk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgR0VUKG1vY2tSZXF1ZXN0KTtcbiAgICAgIGNvbnN0IHJlc3BvbnNlRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlRGF0YS5jb21wYXJpc29uKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlRGF0YS5jb21wYXJpc29uLmVudGVycHJpc2VfYWR2YW50YWdlcykudG9Db250YWluKCdSTFMgaW50ZWdyYXRpb24gd2l0aCBhdXRvbWF0aWMgZmlsdGVycycpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlRGF0YS5lbnRlcnByaXNlKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlRGF0YS5sZWdhY3kpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdBUEkgZGUgU2VndXJpZGFkIEVudGVycHJpc2UnLCAoKSA9PiB7XG4gICAgaXQoJ2RlYmUgdXNhciBjYWNoZSBlbnRlcnByaXNlIHBhcmEgbcOpdHJpY2FzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja01ldHJpY3MgPSB7XG4gICAgICAgIHRvdGFsX2V2ZW50czogMTAwLFxuICAgICAgICBzZWN1cml0eV9hbGVydHM6IDUsXG4gICAgICAgIGZhaWxlZF9sb2dpbnM6IDEwXG4gICAgICB9O1xuXG4gICAgICBtb2NrV2l0aENhY2hlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tNZXRyaWNzKTtcblxuICAgICAgLy8gTW9jayBkZSBsYSBmdW5jacOzbiBnZXRTZWN1cml0eU1ldHJpY3NcbiAgICAgIGplc3QuZG9Nb2NrKCdAL2xpYi9hdXRoL3NlY3VyaXR5LWF1ZGl0LWVuaGFuY2VkJywgKCkgPT4gKHtcbiAgICAgICAgZ2V0U2VjdXJpdHlNZXRyaWNzOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUobW9ja01ldHJpY3MpXG4gICAgICB9KSk7XG5cbiAgICAgIGNvbnN0IHsgR0VUIH0gPSByZXF1aXJlKCdAL2FwcC9hcGkvYXV0aC9zZWN1cml0eS9yb3V0ZScpO1xuICAgICAgXG4gICAgICBjb25zdCBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hdXRoL3NlY3VyaXR5P2FjdGlvbj1tZXRyaWNzJyxcbiAgICAgICAgaGVhZGVyczogbmV3IE1hcCgpXG4gICAgICB9IGFzIGFueTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBHRVQobW9ja1JlcXVlc3QpO1xuICAgICAgY29uc3QgcmVzcG9uc2VEYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICBleHBlY3QobW9ja1JlcXVpcmVBZG1pbkF1dGgpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1vY2tSZXF1ZXN0LCBbJ3NlY3VyaXR5X3JlYWQnLCAnYWRtaW5fYWNjZXNzJ10pO1xuICAgICAgZXhwZWN0KG1vY2tXaXRoQ2FjaGUpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZURhdGEuZGF0YS5tZXRyaWNzKS50b0VxdWFsKG1vY2tNZXRyaWNzKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZURhdGEuZGF0YS5jYWNoZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZURhdGEuZW50ZXJwcmlzZSkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0FQSSBkZSBDcmVhY2nDs24gZGUgQWRtaW4gRW50ZXJwcmlzZScsICgpID0+IHtcbiAgICBpdCgnZGViZSB1c2FyIGF1dGVudGljYWNpw7NuIGNyw610aWNhIHBhcmEgY3JlYXIgYWRtaW4nLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRXhlY3V0ZVdpdGhSTFMubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgYWN0aW9uOiAnY3JlYXRlZCcsXG4gICAgICAgICAgYXV0aFVzZXI6IHsgaWQ6ICdhdXRoXzEyMycsIGVtYWlsOiAnbmV3LWFkbWluQHRlc3QuY29tJyB9LFxuICAgICAgICAgIHByb2ZpbGU6IHtcbiAgICAgICAgICAgIGlkOiAncHJvZmlsZV8xMjMnLFxuICAgICAgICAgICAgZmlyc3RfbmFtZTogJ05ldycsXG4gICAgICAgICAgICBsYXN0X25hbWU6ICdBZG1pbicsXG4gICAgICAgICAgICBwZXJtaXNzaW9uczogWydhZG1pbl9hY2Nlc3MnXSxcbiAgICAgICAgICAgIHVzZXJfcm9sZXM6IHsgcm9sZV9uYW1lOiAnYWRtaW4nIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB7IFBPU1QgfSA9IHJlcXVpcmUoJ0AvYXBwL2FwaS9hZG1pbi9jcmVhdGUtYWRtaW4tdXNlci1lbnRlcnByaXNlL3JvdXRlJyk7XG4gICAgICBcbiAgICAgIGNvbnN0IG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAganNvbjogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICBzZWN1cml0eUtleTogJ0NSRUFURV9BRE1JTl9QSU5URVlBX0VOVEVSUFJJU0VfMjAyNScsXG4gICAgICAgICAgZW1haWw6ICduZXctYWRtaW5AdGVzdC5jb20nLFxuICAgICAgICAgIHBhc3N3b3JkOiAnU2VjdXJlUGFzc3dvcmQxMjMhJyxcbiAgICAgICAgICBmaXJzdE5hbWU6ICdOZXcnLFxuICAgICAgICAgIGxhc3ROYW1lOiAnQWRtaW4nXG4gICAgICAgIH0pXG4gICAgICB9IGFzIGFueTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBQT1NUKG1vY2tSZXF1ZXN0KTtcbiAgICAgIGNvbnN0IHJlc3BvbnNlRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgZXhwZWN0KG1vY2tSZXF1aXJlQ3JpdGljYWxBdXRoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChtb2NrUmVxdWVzdCk7XG4gICAgICBleHBlY3QobW9ja0V4ZWN1dGVXaXRoUkxTKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QocmVzcG9uc2VEYXRhLnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzcG9uc2VEYXRhLmRhdGEuYWN0aW9uKS50b0JlKCdjcmVhdGVkJyk7XG4gICAgICBleHBlY3QocmVzcG9uc2VEYXRhLmVudGVycHJpc2Uuc2VjdXJpdHlfbGV2ZWwpLnRvQmUoJ2NyaXRpY2FsJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGViZSB2YWxpZGFyIGNvbnRyYXNlw7FhIHJvYnVzdGEnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB7IFBPU1QgfSA9IHJlcXVpcmUoJ0AvYXBwL2FwaS9hZG1pbi9jcmVhdGUtYWRtaW4tdXNlci1lbnRlcnByaXNlL3JvdXRlJyk7XG4gICAgICBcbiAgICAgIGNvbnN0IG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAganNvbjogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICBzZWN1cml0eUtleTogJ0NSRUFURV9BRE1JTl9QSU5URVlBX0VOVEVSUFJJU0VfMjAyNScsXG4gICAgICAgICAgZW1haWw6ICduZXctYWRtaW5AdGVzdC5jb20nLFxuICAgICAgICAgIHBhc3N3b3JkOiAnd2VhaycsIC8vIENvbnRyYXNlw7FhIGTDqWJpbFxuICAgICAgICAgIGZpcnN0TmFtZTogJ05ldycsXG4gICAgICAgICAgbGFzdE5hbWU6ICdBZG1pbidcbiAgICAgICAgfSlcbiAgICAgIH0gYXMgYW55O1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IFBPU1QobW9ja1JlcXVlc3QpO1xuICAgICAgY29uc3QgcmVzcG9uc2VEYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDQwMCk7XG4gICAgICBleHBlY3QocmVzcG9uc2VEYXRhLmVycm9yKS50b0NvbnRhaW4oJzEyIGNhcmFjdGVyZXMnKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZURhdGEuY29kZSkudG9CZSgnV0VBS19QQVNTV09SRCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RlYmUgdmFsaWRhciBjbGF2ZSBkZSBzZWd1cmlkYWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB7IFBPU1QgfSA9IHJlcXVpcmUoJ0AvYXBwL2FwaS9hZG1pbi9jcmVhdGUtYWRtaW4tdXNlci1lbnRlcnByaXNlL3JvdXRlJyk7XG4gICAgICBcbiAgICAgIGNvbnN0IG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAganNvbjogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICBzZWN1cml0eUtleTogJ1dST05HX0tFWScsXG4gICAgICAgICAgZW1haWw6ICduZXctYWRtaW5AdGVzdC5jb20nLFxuICAgICAgICAgIHBhc3N3b3JkOiAnU2VjdXJlUGFzc3dvcmQxMjMhJ1xuICAgICAgICB9KVxuICAgICAgfSBhcyBhbnk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgUE9TVChtb2NrUmVxdWVzdCk7XG4gICAgICBjb25zdCByZXNwb25zZURhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDAzKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZURhdGEuZXJyb3IpLnRvQ29udGFpbignQ2xhdmUgZGUgc2VndXJpZGFkIGVudGVycHJpc2UgaW5jb3JyZWN0YScpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlRGF0YS5jb2RlKS50b0JlKCdJTlZBTElEX1NFQ1VSSVRZX0tFWScpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnSW50ZWdyYWNpw7NuIEdlbmVyYWwnLCAoKSA9PiB7XG4gICAgaXQoJ2RlYmUgdXNhciBjYWNoZSBzdGF0cyBlbiB0b2RhcyBsYXMgQVBJcyBlbnRlcnByaXNlJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KG1vY2tHZXRDYWNoZVN0YXRzKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGViZSB1c2FyIFJMUyBlbiBvcGVyYWNpb25lcyBkZSBiYXNlIGRlIGRhdG9zJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KG1vY2tFeGVjdXRlV2l0aFJMUykudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RlYmUgcmVxdWVyaXIgcGVybWlzb3MgZXNwZWPDrWZpY29zIHBhcmEgY2FkYSBvcGVyYWNpw7NuJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KG1vY2tSZXF1aXJlQWRtaW5BdXRoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0LmFueShPYmplY3QpLFxuICAgICAgICBleHBlY3QuYXJyYXlDb250YWluaW5nKFtleHBlY3QuYW55KFN0cmluZyldKVxuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJuYW1lcyI6WyJqZXN0IiwibW9jayIsInJlcXVpcmVBZG1pbkF1dGgiLCJmbiIsInJlcXVpcmVDcml0aWNhbEF1dGgiLCJleGVjdXRlV2l0aFJMUyIsInZhbGlkYXRlUkxTQ29udGV4dCIsImNoZWNrUkxTUGVybWlzc2lvbiIsImNyZWF0ZVJMU0ZpbHRlcnMiLCJ3aXRoQ2FjaGUiLCJnZXRDYWNoZVN0YXRzIiwiaW52YWxpZGF0ZVVzZXJDYWNoZSIsInN1cGFiYXNlQWRtaW4iLCJhdXRoIiwiYWRtaW4iLCJsaXN0VXNlcnMiLCJjcmVhdGVVc2VyIiwiZnJvbSIsInNlbGVjdCIsImVxIiwic2luZ2xlIiwiaW5zZXJ0IiwidXBkYXRlIiwiZGVzY3JpYmUiLCJtb2NrUmVxdWlyZUFkbWluQXV0aCIsIm1vY2tSZXF1aXJlQ3JpdGljYWxBdXRoIiwibW9ja0V4ZWN1dGVXaXRoUkxTIiwibW9ja1dpdGhDYWNoZSIsIm1vY2tHZXRDYWNoZVN0YXRzIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsInN1Y2Nlc3MiLCJjb250ZXh0IiwidXNlcklkIiwic2Vzc2lvbklkIiwiZW1haWwiLCJyb2xlIiwicGVybWlzc2lvbnMiLCJzZXNzaW9uVmFsaWQiLCJzZWN1cml0eUxldmVsIiwiaXBBZGRyZXNzIiwidXNlckFnZW50Iiwic3VwYWJhc2UiLCJ2YWxpZGF0aW9ucyIsImp3dFZhbGlkIiwiY3NyZlZhbGlkIiwicmF0ZUxpbWl0UGFzc2VkIiwib3JpZ2luVmFsaWQiLCJkYXRhIiwidGVzdCIsIm1vY2tJbXBsZW1lbnRhdGlvbiIsImtleSIsImZldGNoZXIiLCJtb2NrUmV0dXJuVmFsdWUiLCJoaXRzIiwibWlzc2VzIiwiZW50cmllcyIsImhpdFJhdGUiLCJtZW1vcnlVc2FnZSIsIml0IiwiR0VUIiwicmVxdWlyZSIsIm1vY2tSZXF1ZXN0IiwibWV0aG9kIiwidXJsIiwiaGVhZGVycyIsIk1hcCIsInJlc3BvbnNlIiwicmVzcG9uc2VEYXRhIiwianNvbiIsImV4cGVjdCIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIiwidG9CZSIsImVudGVycHJpc2UiLCJ0b0JlRGVmaW5lZCIsImxlZ2FjeSIsIm1pZ3JhdGlvbiIsInN0YXR1cyIsImVycm9yIiwiY29kZSIsImlkIiwibmFtZSIsInByaWNlIiwidG9IYXZlQmVlbkNhbGxlZCIsInJscyIsInByb2R1Y3RzX2ZvdW5kIiwic2FtcGxlX3Byb2R1Y3RzIiwidG9IYXZlTGVuZ3RoIiwiY29tcGFyaXNvbiIsImVudGVycHJpc2VfYWR2YW50YWdlcyIsInRvQ29udGFpbiIsIm1vY2tNZXRyaWNzIiwidG90YWxfZXZlbnRzIiwic2VjdXJpdHlfYWxlcnRzIiwiZmFpbGVkX2xvZ2lucyIsImRvTW9jayIsImdldFNlY3VyaXR5TWV0cmljcyIsIm1ldHJpY3MiLCJ0b0VxdWFsIiwiY2FjaGUiLCJhY3Rpb24iLCJhdXRoVXNlciIsInByb2ZpbGUiLCJmaXJzdF9uYW1lIiwibGFzdF9uYW1lIiwidXNlcl9yb2xlcyIsInJvbGVfbmFtZSIsIlBPU1QiLCJzZWN1cml0eUtleSIsInBhc3N3b3JkIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJzZWN1cml0eV9sZXZlbCIsImFueSIsIk9iamVjdCIsImFycmF5Q29udGFpbmluZyIsIlN0cmluZyJdLCJtYXBwaW5ncyI6IkFBQUE7OztDQUdDLEdBRUQsZ0NBQWdDOztBQUNoQ0EsS0FBS0MsSUFBSSxDQUFDLG9DQUFvQyxJQUFPLENBQUE7UUFDbkRDLGtCQUFrQkYsS0FBS0csRUFBRTtRQUN6QkMscUJBQXFCSixLQUFLRyxFQUFFO0lBQzlCLENBQUE7QUFFQUgsS0FBS0MsSUFBSSxDQUFDLG1DQUFtQyxJQUFPLENBQUE7UUFDbERJLGdCQUFnQkwsS0FBS0csRUFBRTtRQUN2Qkcsb0JBQW9CTixLQUFLRyxFQUFFO1FBQzNCSSxvQkFBb0JQLEtBQUtHLEVBQUU7UUFDM0JLLGtCQUFrQlIsS0FBS0csRUFBRTtJQUMzQixDQUFBO0FBRUFILEtBQUtDLElBQUksQ0FBQywrQkFBK0IsSUFBTyxDQUFBO1FBQzlDUSxXQUFXVCxLQUFLRyxFQUFFO1FBQ2xCTyxlQUFlVixLQUFLRyxFQUFFO1FBQ3RCUSxxQkFBcUJYLEtBQUtHLEVBQUU7SUFDOUIsQ0FBQTtBQUVBLG1CQUFtQjtBQUNuQkgsS0FBS0MsSUFBSSxDQUFDLGtCQUFrQixJQUFPLENBQUE7UUFDakNXLGVBQWU7WUFDYkMsTUFBTTtnQkFDSkMsT0FBTztvQkFDTEMsV0FBV2YsS0FBS0csRUFBRTtvQkFDbEJhLFlBQVloQixLQUFLRyxFQUFFO2dCQUNyQjtZQUNGO1lBQ0FjLE1BQU1qQixLQUFLRyxFQUFFLENBQUMsSUFBTyxDQUFBO29CQUNuQmUsUUFBUWxCLEtBQUtHLEVBQUUsQ0FBQyxJQUFPLENBQUE7NEJBQ3JCZ0Is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