{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\components\\ui\\quick-add-suggestions.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Plus, Star, Loader2 } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { getProducts } from \"@/lib/api/products\";\nimport { ProductWithCategory } from \"@/types/api\";\nimport { getValidImageUrl } from \"@/lib/adapters/product-adapter\";\nimport Image from \"next/image\";\nimport { useDispatch } from \"react-redux\";\nimport { AppDispatch } from \"@/redux/store\";\nimport { addItemToCart } from \"@/redux/features/cart-slice\";\n\ninterface QuickAddSuggestionsProps {\n  onAddToCart?: (productId: string) => void;\n  onClose?: () => void;\n  className?: string;\n}\n\nconst QuickAddSuggestions: React.FC<QuickAddSuggestionsProps> = ({\n  onAddToCart,\n  onClose,\n  className\n}) => {\n  const [products, setProducts] = useState<ProductWithCategory[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const dispatch = useDispatch<AppDispatch>();\n\n  useEffect(() => {\n    const fetchPopularProducts = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n\n        // Obtener productos con descuento (populares) limitados a 3\n        const response = await getProducts({\n          limit: 3,\n          sortBy: 'created_at',\n          sortOrder: 'desc'\n        });\n\n        if (response.success && response.data) {\n          setProducts(response.data);\n        } else {\n          setError('No se pudieron cargar los productos');\n        }\n      } catch (err) {\n        console.error('Error fetching popular products:', err);\n        setError('Error al cargar productos populares');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchPopularProducts();\n  }, []);\n\n  const handleAddToCart = (productId: string) => {\n    // Buscar el producto en la lista\n    const product = products.find(p => p.id.toString() === productId);\n\n    if (product) {\n      // Convertir el producto al formato esperado por el carrito\n      const cartItem = {\n        id: product.id,\n        title: product.name,\n        brand: product.brand || '',\n        price: product.price,\n        discountedPrice: product.discounted_price || product.price,\n        imgs: {\n          thumbnails: product.images ? [product.images[0]] : [],\n          previews: product.images || []\n        },\n        reviews: 0, // No tenemos reviews en la API actual\n        quantity: 1\n      };\n\n      dispatch(addItemToCart(cartItem));\n    }\n\n    // Llamar callback personalizado si existe\n    if (onAddToCart) {\n      onAddToCart(productId);\n    }\n  };\n\n  return (\n    <div className={cn(\"bg-white rounded-xl border border-gray-200 p-4\", className)}>\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-4\">\n        <div>\n          <h4 className=\"font-bold text-gray-900 text-sm\">Productos Populares</h4>\n          <p className=\"text-xs text-gray-600\">Agrega rápidamente a tu carrito</p>\n        </div>\n      </div>\n\n      {/* Lista de productos */}\n      <div className=\"space-y-3\">\n        {loading ? (\n          <div className=\"flex items-center justify-center py-8\">\n            <Loader2 className=\"w-6 h-6 animate-spin text-gray-400\" />\n            <span className=\"ml-2 text-sm text-gray-500\">Cargando productos...</span>\n          </div>\n        ) : error ? (\n          <div className=\"text-center py-4\">\n            <p className=\"text-sm text-red-500\">{error}</p>\n          </div>\n        ) : products.length === 0 ? (\n          <div className=\"text-center py-4\">\n            <p className=\"text-sm text-gray-500\">No hay productos disponibles</p>\n          </div>\n        ) : (\n          products.map((product) => {\n            const currentPrice = product.discounted_price || product.price;\n            const originalPrice = product.discounted_price ? product.price : null;\n            const hasDiscount = originalPrice && currentPrice < originalPrice;\n\n            return (\n              <div\n                key={product.id}\n                className=\"flex items-center gap-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors duration-200\"\n              >\n                {/* Imagen del producto */}\n                <div className=\"w-16 h-16 bg-gray-200 rounded-xl overflow-hidden flex-shrink-0 shadow-sm border border-gray-300\">\n                  <Image\n                    src={getValidImageUrl(product.images?.[0])}\n                    alt={product.name}\n                    width={64}\n                    height={64}\n                    className=\"w-full h-full object-cover\"\n                  />\n                </div>\n\n                {/* Info del producto */}\n                <div className=\"flex-1 min-w-0\">\n                  <h5 className=\"font-semibold text-xs text-gray-900 line-clamp-1\">\n                    {product.name}\n                  </h5>\n                  <p className=\"text-2xs text-gray-500 mb-1\">{product.brand || 'Sin marca'}</p>\n\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"font-bold text-sm\" style={{ color: '#ea5a17' }}>\n                      ${currentPrice.toLocaleString()}\n                    </span>\n                    {hasDiscount && (\n                      <span className=\"text-2xs text-gray-400 line-through\">\n                        ${originalPrice!.toLocaleString()}\n                      </span>\n                    )}\n                  </div>\n\n                  {/* Categoría */}\n                  <div className=\"flex items-center gap-1 mt-1\">\n                    <span className=\"text-2xs text-gray-600\">{product.category?.name || 'General'}</span>\n                  </div>\n                </div>\n\n                {/* Botón agregar */}\n                <Button\n                  size=\"sm\"\n                  onClick={() => handleAddToCart(product.id.toString())}\n                  className=\"h-10 w-10 p-0 bg-yellow-400 hover:bg-yellow-500 text-black rounded-xl shadow-md hover:shadow-lg transition-all duration-200\"\n                >\n                  <Plus className=\"w-5 h-5\" />\n                </Button>\n              </div>\n            );\n          })\n        )}\n      </div>\n\n      {/* Footer con enlace a ver más */}\n      <div className=\"mt-4 pt-3 border-t border-gray-200\">\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          onClick={onClose}\n          className=\"w-full text-xs text-gray-600 hover:text-gray-900\"\n        >\n          Ver todos los productos →\n        </Button>\n      </div>\n    </div>\n  );\n};\n\nexport default QuickAddSuggestions;\n"],"names":["QuickAddSuggestions","onAddToCart","onClose","className","products","setProducts","useState","loading","setLoading","error","setError","dispatch","useDispatch","useEffect","fetchPopularProducts","response","getProducts","limit","sortBy","sortOrder","success","data","err","console","handleAddToCart","productId","product","find","p","id","toString","cartItem","title","name","brand","price","discountedPrice","discounted_price","imgs","thumbnails","images","previews","reviews","quantity","addItemToCart","div","cn","h4","Loader2","span","length","map","currentPrice","originalPrice","hasDiscount","Image","src","getValidImageUrl","alt","width","height","h5","style","color","toLocaleString","category","Button","size","onClick","Plus","variant"],"mappings":"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"}