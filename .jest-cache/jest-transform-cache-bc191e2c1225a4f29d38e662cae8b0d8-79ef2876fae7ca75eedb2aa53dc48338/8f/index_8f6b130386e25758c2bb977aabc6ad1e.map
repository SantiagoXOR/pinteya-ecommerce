{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\components\\Header\\index.tsx"],"sourcesContent":["\"use client\";\r\nimport React, { useState, useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { useAppSelector } from \"@/redux/store\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { selectTotalPrice } from \"@/redux/features/cart-slice\";\r\nimport { useCartModalContext } from \"@/app/context/CartSidebarModalContext\";\r\nimport AuthSection from \"./AuthSection\";\r\nimport { SearchAutocompleteIntegrated } from \"@/components/ui/SearchAutocompleteIntegrated\";\r\nimport { useCartAnimation } from \"@/hooks/useCartAnimation\";\r\nimport { MapPin, Loader2 } from \"lucide-react\";\r\nimport { useGeolocation } from \"@/hooks/useGeolocation\";\r\nimport { HeaderLogo } from \"@/components/ui/OptimizedLogo\";\r\nimport GeolocationDebugger from \"./GeolocationDebugger\";\r\n\r\nconst Header = () => {\r\n  const [cartShake, setCartShake] = useState(false);\r\n  const { openCartModal } = useCartModalContext();\r\n  const { isAnimating } = useCartAnimation();\r\n\r\n  // Hook de geolocalizaci√≥n para detectar ubicaci√≥n\r\n  const { detectedZone, requestLocation, permissionStatus, isLoading, error, location, testLocation } = useGeolocation();\r\n\r\n  // Log para debugging del estado de geolocalizaci√≥n (solo cuando cambia la zona)\r\n  useEffect(() => {\r\n    console.log('üè† Header - Geolocation zone updated:', detectedZone?.name);\r\n  }, [detectedZone?.name]); // Solo depender del nombre de la zona\r\n\r\n  const product = useAppSelector((state) => state.cartReducer.items);\r\n  const totalPrice = useSelector(selectTotalPrice);\r\n\r\n  // Efecto para animar el carrito cuando se agregan productos\r\n  useEffect(() => {\r\n    if (product.length > 0) {\r\n      setCartShake(true);\r\n      setTimeout(() => setCartShake(false), 500);\r\n    }\r\n  }, [product.length]);\r\n\r\n  // Efecto para solicitar geolocalizaci√≥n autom√°ticamente\r\n  useEffect(() => {\r\n    console.log('üó∫Ô∏è Header mounted, checking geolocation...');\r\n    // Solicitar ubicaci√≥n autom√°ticamente si no se ha detectado\r\n    if (permissionStatus === 'unknown' || permissionStatus === 'prompt') {\r\n      console.log('üó∫Ô∏è Auto-requesting location on mount');\r\n      setTimeout(() => {\r\n        requestLocation();\r\n      }, 1000); // Delay de 1 segundo para evitar conflictos\r\n    }\r\n  }, [permissionStatus, requestLocation]);\r\n\r\n  const handleOpenCartModal = () => {\r\n    openCartModal();\r\n  };\r\n\r\n  const handleLocationClick = () => {\r\n    console.log('üó∫Ô∏è === LOCATION CLICK EVENT ===');\r\n    console.log('üó∫Ô∏è Current status:', permissionStatus);\r\n    console.log('üó∫Ô∏è Current detected zone:', detectedZone);\r\n    console.log('üó∫Ô∏è Is loading:', isLoading);\r\n    console.log('üó∫Ô∏è Error:', error);\r\n    console.log('üó∫Ô∏è Location:', location);\r\n\r\n    // Siempre intentar solicitar ubicaci√≥n cuando se hace click\r\n    if (permissionStatus === 'denied') {\r\n      console.log('üó∫Ô∏è Permisos denegados, mostrando mensaje al usuario');\r\n      alert('Para detectar tu ubicaci√≥n autom√°ticamente, permite el acceso a la ubicaci√≥n en la configuraci√≥n de tu navegador.');\r\n    } else if (permissionStatus === 'granted' && detectedZone && detectedZone.name !== \"C√≥rdoba Capital\") {\r\n      console.log('üó∫Ô∏è Ubicaci√≥n ya detectada, refrescando...');\r\n      requestLocation();\r\n    } else {\r\n      console.log('üó∫Ô∏è Solicitando permisos de geolocalizaci√≥n...');\r\n      requestLocation();\r\n    }\r\n\r\n    console.log('üó∫Ô∏è === LOCATION CLICK COMPLETE ===');\r\n  };\r\n\r\n  const handleSearchSubmit = (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    // El SearchAutocomplete maneja su propia l√≥gica de b√∫squeda\r\n    // Este handler previene el comportamiento por defecto del form\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <header className=\"fixed left-0 top-0 w-full z-9999 bg-blaze-orange-600 rounded-b-3xl shadow-lg transition-all ease-in-out duration-500\">\r\n        {/* Topbar con ubicaci√≥n y promociones - Estilo ML */}\r\n        <div className=\"bg-blaze-orange-700 py-1.5\">\r\n          <div className=\"max-w-[1200px] mx-auto px-4 flex items-center justify-between text-xs\">\r\n            {/* Ubicaci√≥n compacta */}\r\n            <div\r\n              onClick={handleLocationClick}\r\n              className=\"flex items-center gap-1 cursor-pointer transition-colors\"\r\n              style={{ color: '#fff3c5' }}\r\n            >\r\n              <MapPin className=\"w-3 h-3 text-yellow-400\" />\r\n              <span className=\"font-medium\">\r\n                {isLoading ? (\r\n                  <span className=\"flex items-center gap-1\">\r\n                    <Loader2 className=\"w-3 h-3 animate-spin text-yellow-400\" />\r\n                    Detectando...\r\n                  </span>\r\n                ) : (\r\n                  `Env√≠os en ${detectedZone?.name || \"C√≥rdoba Capital\"}`\r\n                )}\r\n              </span>\r\n            </div>\r\n\r\n            {/* Promoci√≥n central */}\r\n            <div className=\"hidden md:flex items-center gap-1\" style={{ color: '#fff3c5' }}>\r\n              <svg className=\"w-3 h-3 text-yellow-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                <path d=\"M8 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM15 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z\"/>\r\n                <path d=\"M3 4a1 1 0 00-1 1v1a1 1 0 001 1h1l1.68 5.39A3 3 0 008.62 15h5.76a3 3 0 002.94-2.61L18 7H6.41l-.77-3H3z\"/>\r\n              </svg>\r\n              <span className=\"font-medium\">Env√≠o gratis desde $15.000</span>\r\n            </div>\r\n\r\n            {/* Contacto compacto */}\r\n            <div className=\"hidden lg:flex items-center gap-1 text-xs\" style={{ color: '#fff3c5' }}>\r\n              <svg className=\"w-3 h-3 text-yellow-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                <path d=\"M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z\"/>\r\n              </svg>\r\n              <span>+54 351 341 1796</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Header principal - Layout estilo MercadoLibre */}\r\n        <div className=\"max-w-[1200px] mx-auto px-4 py-3\">\r\n          <div className=\"flex items-center gap-4\">\r\n            {/* Logo compacto - Estilo ML */}\r\n            <Link href=\"/\" className=\"flex-shrink-0\">\r\n              <HeaderLogo\r\n                isMobile={false}\r\n                className=\"hidden sm:block w-28 h-auto\"\r\n              />\r\n              <HeaderLogo\r\n                isMobile={true}\r\n                className=\"sm:hidden w-20 h-auto\"\r\n              />\r\n            </Link>\r\n\r\n            {/* Buscador prominente - Fondo amarillo claro */}\r\n            <div className=\"flex-1 max-w-2xl\">\r\n              <form onSubmit={handleSearchSubmit} className=\"relative\">\r\n                <div style={{ backgroundColor: '#fff3c5', borderRadius: '8px', padding: '1px' }}>\r\n                  <SearchAutocompleteIntegrated\r\n                    placeholder=\"latex interior blanco 20lts\"\r\n                    className=\"[&>div>div>input]:w-full [&>div>div>input]:border-2 [&>div>div>input]:border-orange-300 [&>div>div>input]:rounded-lg [&>div>div>input]:pl-4 [&>div>div>input]:pr-4 [&>div>div>input]:py-2.5 [&>div>div>input]:text-blaze-orange-600 [&>div>div>input]:text-base [&>div>div>input]:font-medium [&>div>div>input]:shadow-sm [&>div>div>input]:focus:border-orange-500 [&>div>div>input]:focus:ring-2 [&>div>div>input]:focus:ring-orange-200 [&>div>div>input]:transition-all [&>div>div>input]:!bg-transparent\"\r\n                    style={{\r\n                      backgroundColor: 'transparent'\r\n                    } as React.CSSProperties}\r\n                    size=\"lg\"\r\n                    debounceMs={300}\r\n                    maxSuggestions={6}\r\n                    showRecentSearches={true}\r\n                    showTrendingSearches={true}\r\n                  />\r\n                </div>\r\n              </form>\r\n            </div>\r\n\r\n            {/* Acciones del usuario - Estilo ML */}\r\n            <div className=\"flex items-center gap-3\">\r\n              {/* Autenticaci√≥n compacta */}\r\n              <AuthSection variant=\"mobile\" />\r\n\r\n              {/* Carrito destacado - Bot√≥n amarillo con icono naranja */}\r\n              <button\r\n                onClick={handleOpenCartModal}\r\n                data-testid=\"cart-icon\"\r\n                className={`relative bg-yellow-400 hover:bg-yellow-500 text-gray-900 px-3 py-2 rounded-lg font-bold shadow-lg hover:shadow-xl transition-all duration-200 flex items-center gap-2 group active:scale-95 ${\r\n                  cartShake ? 'animate-bounce' : ''\r\n                } ${isAnimating ? 'scale-110' : 'scale-100'}`}\r\n              >\r\n                <svg\r\n                  width=\"20\"\r\n                  height=\"20\"\r\n                  viewBox=\"0 0 24 24\"\r\n                  fill=\"none\"\r\n                  xmlns=\"http://www.w3.org/2000/svg\"\r\n                  className=\"text-blaze-orange-600\"\r\n                  style={{ color: '#ea5a17' }}\r\n                >\r\n                  <path\r\n                    d=\"M3.74157 18.5545C4.94119 20 7.17389 20 11.6393 20H12.3605C16.8259 20 19.0586 20 20.2582 18.5545M3.74157 18.5545C2.54194 17.1091 2.9534 14.9146 3.77633 10.5257C4.36155 7.40452 4.65416 5.84393 5.76506 4.92196M3.74157 18.5545L5.76506 4.92196M20.2582 18.5545C21.4578 17.1091 21.0464 14.9146 20.2235 10.5257C19.6382 7.40452 19.3456 5.84393 18.2347 4.92196M20.2582 18.5545L18.2347 4.92196M18.2347 4.92196C17.1238 4 15.5361 4 12.3605 4H11.6393C8.46374 4 6.87596 4 5.76506 4.92196\"\r\n                    stroke=\"currentColor\"\r\n                    strokeWidth=\"1.5\"\r\n                  />\r\n                  <path\r\n                    d=\"M9.5 14L14.5 14\"\r\n                    stroke=\"currentColor\"\r\n                    strokeWidth=\"1.5\"\r\n                    strokeLinecap=\"round\"\r\n                  />\r\n                </svg>\r\n                <span className=\"hidden sm:inline text-sm font-bold text-blaze-orange-600\">Carrito</span>\r\n                {product.length > 0 && (\r\n                  <span className=\"absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center\">\r\n                    {product.length}\r\n                  </span>\r\n                )}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </header>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Header;\r\n"],"names":["Header","cartShake","setCartShake","useState","openCartModal","useCartModalContext","isAnimating","useCartAnimation","detectedZone","requestLocation","permissionStatus","isLoading","error","location","testLocation","useGeolocation","useEffect","console","log","name","product","useAppSelector","state","cartReducer","items","totalPrice","useSelector","selectTotalPrice","length","setTimeout","handleOpenCartModal","handleLocationClick","alert","handleSearchSubmit","e","preventDefault","header","className","div","onClick","style","color","MapPin","span","Loader2","svg","fill","viewBox","path","d","Link","href","HeaderLogo","isMobile","form","onSubmit","backgroundColor","borderRadius","padding","SearchAutocompleteIntegrated","placeholder","size","debounceMs","maxSuggestions","showRecentSearches","showTrendingSearches","AuthSection","variant","button","data-testid","width","height","xmlns","stroke","strokeWidth","strokeLinecap"],"mappings":"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"}