{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\__tests__\\hooks\\useCartWithClerk.test.ts"],"sourcesContent":["// ===================================\r\n// PINTEYA E-COMMERCE - TESTS UNITARIOS PARA USECART WITH CLERK HOOK\r\n// ===================================\r\n\r\nimport React from 'react'\r\nimport { renderHook, act } from '@testing-library/react'\r\nimport { Provider } from 'react-redux'\r\nimport { configureStore } from '@reduxjs/toolkit'\r\nimport { useUser } from '@clerk/nextjs'\r\nimport cartReducer, { addItemToCart, hydrateCart } from '@/redux/features/cart-slice'\r\nimport { useCartWithClerk } from '@/hooks/useCartWithClerk'\r\nimport { cartPersistenceMiddleware } from '@/redux/middleware/cartPersistence'\r\n\r\n// Mock Clerk\r\njest.mock('@clerk/nextjs', () => ({\r\n  useUser: jest.fn()\r\n}))\r\n\r\n// Mock localStorage\r\nconst localStorageMock = (() => {\r\n  let store: Record<string, string> = {}\r\n\r\n  return {\r\n    getItem: jest.fn((key: string) => store[key] || null),\r\n    setItem: jest.fn((key: string, value: string) => {\r\n      store[key] = value.toString()\r\n    }),\r\n    removeItem: jest.fn((key: string) => {\r\n      delete store[key]\r\n    }),\r\n    clear: jest.fn(() => {\r\n      store = {}\r\n    })\r\n  }\r\n})()\r\n\r\nObject.defineProperty(window, 'localStorage', {\r\n  value: localStorageMock\r\n})\r\n\r\n// Mock console methods\r\nconst consoleSpy = {\r\n  warn: jest.spyOn(console, 'warn').mockImplementation(() => {}),\r\n  log: jest.spyOn(console, 'log').mockImplementation(() => {}),\r\n  error: jest.spyOn(console, 'error').mockImplementation(() => {})\r\n}\r\n\r\n// Producto de prueba\r\nconst mockProduct = {\r\n  id: 1,\r\n  title: 'Pintura Latex Interior Blanco 4L',\r\n  price: 18000,\r\n  discountedPrice: 15000,\r\n  quantity: 1,\r\n  imgs: {\r\n    thumbnails: ['/images/products/pintura-latex-blanco-sm.jpg'],\r\n    previews: ['/images/products/pintura-latex-blanco.jpg'],\r\n  },\r\n}\r\n\r\n// Mock user data\r\nconst mockUser = {\r\n  id: 'user_123',\r\n  firstName: 'Juan',\r\n  lastName: 'Pérez',\r\n  emailAddresses: [{ emailAddress: 'juan@example.com' }]\r\n}\r\n\r\ndescribe('useCartWithClerk Hook', () => {\r\n  let store: any\r\n  const mockUseUser = useUser as jest.MockedFunction<typeof useUser>\r\n\r\n  const renderHookWithStore = (initialState = {}) => {\r\n    store = configureStore({\r\n      reducer: {\r\n        cartReducer\r\n      },\r\n      middleware: (getDefaultMiddleware) =>\r\n        getDefaultMiddleware().concat(cartPersistenceMiddleware),\r\n      preloadedState: initialState\r\n    })\r\n\r\n    const wrapper = ({ children }: { children: React.ReactNode }) => (\r\n      React.createElement(Provider, { store }, children)\r\n    )\r\n\r\n    return renderHook(() => useCartWithClerk(), { wrapper })\r\n  }\r\n\r\n  beforeEach(() => {\r\n    localStorageMock.clear()\r\n    jest.clearAllMocks()\r\n  })\r\n\r\n  afterAll(() => {\r\n    // Limpiar mocks\r\n    jest.clearAllMocks()\r\n  })\r\n\r\n  describe('Unauthenticated User', () => {\r\n    beforeEach(() => {\r\n      mockUseUser.mockReturnValue({\r\n        user: null,\r\n        isLoaded: true,\r\n        isSignedIn: false\r\n      } as any)\r\n    })\r\n\r\n    it('should load cart from localStorage for unauthenticated user', () => {\r\n      // Preparar localStorage con datos\r\n      const cartData = {\r\n        items: [mockProduct],\r\n        timestamp: Date.now(),\r\n        version: '1.0.0'\r\n      }\r\n      localStorageMock.setItem('pinteya-cart', JSON.stringify(cartData))\r\n\r\n      const { result } = renderHookWithStore()\r\n\r\n      expect(result.current.isAuthenticated).toBe(false)\r\n      expect(result.current.userId).toBeUndefined()\r\n      expect(result.current.cartItems).toHaveLength(1)\r\n    })\r\n\r\n    it('should start with empty cart when no localStorage data', () => {\r\n      const { result } = renderHookWithStore()\r\n\r\n      expect(result.current.isAuthenticated).toBe(false)\r\n      expect(result.current.cartItems).toHaveLength(0)\r\n    })\r\n\r\n    it('should handle corrupted localStorage gracefully', () => {\r\n      localStorageMock.setItem('pinteya-cart', 'invalid-json')\r\n\r\n      const { result } = renderHookWithStore()\r\n\r\n      expect(result.current.cartItems).toHaveLength(0)\r\n      expect(localStorageMock.removeItem).toHaveBeenCalledWith('pinteya-cart')\r\n    })\r\n  })\r\n\r\n  describe('Authenticated User', () => {\r\n    beforeEach(() => {\r\n      mockUseUser.mockReturnValue({\r\n        user: mockUser,\r\n        isLoaded: true,\r\n        isSignedIn: true\r\n      } as any)\r\n    })\r\n\r\n    it('should identify authenticated user correctly', () => {\r\n      const { result } = renderHookWithStore()\r\n\r\n      expect(result.current.isAuthenticated).toBe(true)\r\n      expect(result.current.userId).toBe(mockUser.id)\r\n    })\r\n\r\n    it('should migrate temporary cart when user signs in', async () => {\r\n      // Preparar carrito temporal en localStorage\r\n      const temporaryCartData = {\r\n        items: [mockProduct],\r\n        timestamp: Date.now(),\r\n        version: '1.0.0'\r\n      }\r\n      localStorageMock.setItem('pinteya-cart', JSON.stringify(temporaryCartData))\r\n\r\n      const { result } = renderHookWithStore()\r\n\r\n      // Verificar que el hook funciona correctamente (sin verificar console logs)\r\n      expect(result.current.isAuthenticated).toBe(true)\r\n\r\n      // La migración es asíncrona, verificar que el hook se inicializa correctamente\r\n      // El carrito puede estar vacío inicialmente mientras se procesa la migración\r\n      expect(Array.isArray(result.current.cartItems)).toBe(true)\r\n    })\r\n\r\n    it('should save cart changes for authenticated user', async () => {\r\n      const { result } = renderHookWithStore()\r\n\r\n      // Agregar item al carrito\r\n      act(() => {\r\n        store.dispatch(addItemToCart(mockProduct))\r\n      })\r\n\r\n      // Esperar el debounce del efecto (optimizado)\r\n      await act(async () => {\r\n        await new Promise(resolve => setTimeout(resolve, 500))\r\n      })\r\n\r\n      // Verificar que el hook funciona correctamente\r\n      expect(result.current.isAuthenticated).toBe(true)\r\n    })\r\n\r\n    it('should handle sign out correctly', () => {\r\n      const { result } = renderHookWithStore({\r\n        cartReducer: {\r\n          items: [mockProduct]\r\n        }\r\n      })\r\n\r\n      act(() => {\r\n        result.current.handleSignOut()\r\n      })\r\n\r\n      expect(result.current.cartItems).toHaveLength(0)\r\n      expect(localStorageMock.removeItem).toHaveBeenCalledWith('pinteya-cart')\r\n    })\r\n  })\r\n\r\n  describe('Loading States', () => {\r\n    it('should handle loading state correctly', () => {\r\n      mockUseUser.mockReturnValue({\r\n        user: null,\r\n        isLoaded: false,\r\n        isSignedIn: false\r\n      } as any)\r\n\r\n      const { result } = renderHookWithStore()\r\n\r\n      expect(result.current.isAuthenticated).toBe(false)\r\n      expect(result.current.userId).toBeUndefined()\r\n    })\r\n\r\n    it('should not perform actions while loading', () => {\r\n      mockUseUser.mockReturnValue({\r\n        user: null,\r\n        isLoaded: false,\r\n        isSignedIn: false\r\n      } as any)\r\n\r\n      // Preparar localStorage con datos\r\n      const cartData = {\r\n        items: [mockProduct],\r\n        timestamp: Date.now(),\r\n        version: '1.0.0'\r\n      }\r\n      localStorageMock.setItem('pinteya-cart', JSON.stringify(cartData))\r\n\r\n      const { result } = renderHookWithStore()\r\n\r\n      // No debería cargar desde localStorage mientras está loading\r\n      expect(result.current.cartItems).toHaveLength(0)\r\n    })\r\n  })\r\n\r\n  describe('User State Transitions', () => {\r\n    it('should handle transition from unauthenticated to authenticated', () => {\r\n      // Iniciar como no autenticado\r\n      mockUseUser.mockReturnValue({\r\n        user: null,\r\n        isLoaded: true,\r\n        isSignedIn: false\r\n      } as any)\r\n\r\n      const { result, rerender } = renderHookWithStore()\r\n\r\n      // Agregar item como usuario no autenticado\r\n      act(() => {\r\n        store.dispatch(addItemToCart(mockProduct))\r\n      })\r\n\r\n      expect(result.current.isAuthenticated).toBe(false)\r\n      expect(result.current.cartItems).toHaveLength(1)\r\n\r\n      // Simular autenticación\r\n      mockUseUser.mockReturnValue({\r\n        user: mockUser,\r\n        isLoaded: true,\r\n        isSignedIn: true\r\n      } as any)\r\n\r\n      rerender()\r\n\r\n      expect(result.current.isAuthenticated).toBe(true)\r\n      expect(result.current.userId).toBe(mockUser.id)\r\n      expect(result.current.cartItems).toHaveLength(1) // Carrito se mantiene\r\n    })\r\n\r\n    it('should handle transition from authenticated to unauthenticated', () => {\r\n      // Iniciar como autenticado\r\n      mockUseUser.mockReturnValue({\r\n        user: mockUser,\r\n        isLoaded: true,\r\n        isSignedIn: true\r\n      } as any)\r\n\r\n      const { result, rerender } = renderHookWithStore()\r\n\r\n      expect(result.current.isAuthenticated).toBe(true)\r\n\r\n      // Simular cierre de sesión\r\n      mockUseUser.mockReturnValue({\r\n        user: null,\r\n        isLoaded: true,\r\n        isSignedIn: false\r\n      } as any)\r\n\r\n      rerender()\r\n\r\n      expect(result.current.isAuthenticated).toBe(false)\r\n      expect(result.current.userId).toBeUndefined()\r\n    })\r\n  })\r\n\r\n  describe('Error Handling', () => {\r\n    it('should handle migration errors gracefully', async () => {\r\n      // Mock error en migración\r\n      consoleSpy.log.mockImplementationOnce(() => {\r\n        throw new Error('Migration failed')\r\n      })\r\n\r\n      mockUseUser.mockReturnValue({\r\n        user: mockUser,\r\n        isLoaded: true,\r\n        isSignedIn: true\r\n      } as any)\r\n\r\n      // Preparar carrito temporal\r\n      const temporaryCartData = {\r\n        items: [mockProduct],\r\n        timestamp: Date.now(),\r\n        version: '1.0.0'\r\n      }\r\n      localStorageMock.setItem('pinteya-cart', JSON.stringify(temporaryCartData))\r\n\r\n      const { result } = renderHookWithStore()\r\n\r\n      expect(result.current.isAuthenticated).toBe(true)\r\n      // Verificar que el hook maneja errores sin lanzar excepciones\r\n    })\r\n\r\n    it('should handle save errors gracefully', async () => {\r\n      mockUseUser.mockReturnValue({\r\n        user: mockUser,\r\n        isLoaded: true,\r\n        isSignedIn: true\r\n      } as any)\r\n\r\n      // Mock error en guardado\r\n      consoleSpy.log.mockImplementation((message) => {\r\n        if (message.includes('Saving')) {\r\n          throw new Error('Save failed')\r\n        }\r\n      })\r\n\r\n      const { result } = renderHookWithStore()\r\n\r\n      // Agregar item al carrito\r\n      act(() => {\r\n        store.dispatch(addItemToCart(mockProduct))\r\n      })\r\n\r\n      // Esperar el debounce del efecto (optimizado)\r\n      await act(async () => {\r\n        await new Promise(resolve => setTimeout(resolve, 500))\r\n      })\r\n\r\n      // Verificar que el hook maneja errores sin lanzar excepciones\r\n      expect(result.current.isAuthenticated).toBe(true)\r\n    })\r\n  })\r\n})\r\n"],"names":["jest","mock","useUser","fn","localStorageMock","store","getItem","key","setItem","value","toString","removeItem","clear","Object","defineProperty","window","consoleSpy","warn","spyOn","console","mockImplementation","log","error","mockProduct","id","title","price","discountedPrice","quantity","imgs","thumbnails","previews","mockUser","firstName","lastName","emailAddresses","emailAddress","describe","mockUseUser","renderHookWithStore","initialState","configureStore","reducer","cartReducer","middleware","getDefaultMiddleware","concat","cartPersistenceMiddleware","preloadedState","wrapper","children","React","createElement","Provider","renderHook","useCartWithClerk","beforeEach","clearAllMocks","afterAll","mockReturnValue","user","isLoaded","isSignedIn","it","cartData","items","timestamp","Date","now","version","JSON","stringify","result","expect","current","isAuthenticated","toBe","userId","toBeUndefined","cartItems","toHaveLength","toHaveBeenCalledWith","temporaryCartData","Array","isArray","act","dispatch","addItemToCart","Promise","resolve","setTimeout","handleSignOut","rerender","mockImplementationOnce","Error","message","includes"],"mappings":"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"}