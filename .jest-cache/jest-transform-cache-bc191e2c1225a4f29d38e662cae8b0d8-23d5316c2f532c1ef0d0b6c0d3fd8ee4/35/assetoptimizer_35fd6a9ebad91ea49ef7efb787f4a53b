2604f3e3b49e66963960b2af9d2a852b
// ===================================
// PINTEYA E-COMMERCE - ASSET OPTIMIZER
// ===================================
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get ASSET_CONFIGS () {
        return ASSET_CONFIGS;
    },
    get AssetOptimizer () {
        return AssetOptimizer;
    },
    get AssetUtils () {
        return AssetUtils;
    },
    get assetOptimizer () {
        return assetOptimizer;
    }
});
const _logger = require("./enterprise/logger");
const ASSET_CONFIGS = {
    // Para imágenes de productos
    PRODUCT_IMAGES: {
        compress: true,
        quality: 85,
        format: 'webp',
        maxWidth: 800,
        maxHeight: 600,
        lazy: true
    },
    // Para iconos de pago
    PAYMENT_ICONS: {
        compress: true,
        quality: 90,
        format: 'webp',
        maxWidth: 64,
        maxHeight: 64,
        lazy: false
    },
    // Para imágenes de hero/banner
    HERO_IMAGES: {
        compress: true,
        quality: 80,
        format: 'webp',
        maxWidth: 1920,
        maxHeight: 1080,
        lazy: true
    },
    // Para avatares de usuario
    AVATARS: {
        compress: true,
        quality: 85,
        format: 'webp',
        maxWidth: 200,
        maxHeight: 200,
        lazy: true
    }
};
class AssetOptimizer {
    constructor(){}
    static getInstance() {
        if (!AssetOptimizer.instance) {
            AssetOptimizer.instance = new AssetOptimizer();
        }
        return AssetOptimizer.instance;
    }
    /**
   * Optimiza una URL de imagen
   */ optimizeImageUrl(originalUrl, config = ASSET_CONFIGS.PRODUCT_IMAGES) {
        try {
            // Si es una URL externa, aplicar parámetros de optimización
            if (originalUrl.startsWith('http')) {
                const url = new URL(originalUrl);
                // Para Supabase Storage, agregar parámetros de transformación
                if (url.hostname.includes('supabase')) {
                    const params = new URLSearchParams();
                    if (config.maxWidth) {
                        params.set('width', config.maxWidth.toString());
                    }
                    if (config.maxHeight) {
                        params.set('height', config.maxHeight.toString());
                    }
                    if (config.quality) {
                        params.set('quality', config.quality.toString());
                    }
                    if (config.format) {
                        params.set('format', config.format);
                    }
                    if (params.toString()) {
                        url.search = params.toString();
                    }
                }
                return url.toString();
            }
            // Para URLs locales, mantener como están
            return originalUrl;
        } catch (error) {
            _logger.logger.error(_logger.LogCategory.API, 'Image URL optimization failed', error);
            return originalUrl;
        }
    }
    /**
   * Genera srcSet para imágenes responsivas
   */ generateSrcSet(baseUrl, config = ASSET_CONFIGS.PRODUCT_IMAGES) {
        try {
            const sizes = [
                {
                    width: 320,
                    suffix: 'sm'
                },
                {
                    width: 640,
                    suffix: 'md'
                },
                {
                    width: 1024,
                    suffix: 'lg'
                },
                {
                    width: 1920,
                    suffix: 'xl'
                }
            ];
            const srcSet = sizes.filter((size)=>!config.maxWidth || size.width <= config.maxWidth).map((size)=>{
                const optimizedConfig = {
                    ...config,
                    maxWidth: size.width
                };
                const url = this.optimizeImageUrl(baseUrl, optimizedConfig);
                return `${url} ${size.width}w`;
            }).join(', ');
            return srcSet;
        } catch (error) {
            _logger.logger.error(_logger.LogCategory.API, 'SrcSet generation failed', error);
            return baseUrl;
        }
    }
    /**
   * Genera sizes attribute para imágenes responsivas
   */ generateSizes(breakpoints) {
        return breakpoints.map((bp)=>`${bp.condition} ${bp.size}`).join(', ');
    }
    /**
   * Precarga assets críticos
   */ preloadCriticalAssets(assets) {
        if (typeof window === 'undefined') {
            return;
        }
        assets.forEach((asset)=>{
            try {
                const link = document.createElement('link');
                link.rel = 'preload';
                link.href = asset.url;
                switch(asset.type){
                    case 'image':
                        link.as = 'image';
                        break;
                    case 'font':
                        link.as = 'font';
                        link.crossOrigin = 'anonymous';
                        break;
                    case 'style':
                        link.as = 'style';
                        break;
                }
                document.head.appendChild(link);
                _logger.logger.info(_logger.LogCategory.API, 'Asset preloaded');
            } catch (error) {
                _logger.logger.error(_logger.LogCategory.API, 'Asset preload failed', error);
            }
        });
    }
    /**
   * Lazy load de imágenes con Intersection Observer
   */ setupLazyLoading() {
        if (typeof window === 'undefined' || !('IntersectionObserver' in window)) {
            return;
        }
        const imageObserver = new IntersectionObserver((entries, observer)=>{
            entries.forEach((entry)=>{
                if (entry.isIntersecting) {
                    const img = entry.target;
                    if (img.dataset.src) {
                        img.src = img.dataset.src;
                        img.removeAttribute('data-src');
                    }
                    if (img.dataset.srcset) {
                        img.srcset = img.dataset.srcset;
                        img.removeAttribute('data-srcset');
                    }
                    img.classList.remove('lazy');
                    observer.unobserve(img);
                    _logger.logger.info(_logger.LogCategory.API, 'Lazy image loaded');
                }
            });
        }, {
            rootMargin: '50px 0px',
            threshold: 0.01
        });
        // Observar todas las imágenes lazy
        document.querySelectorAll('img[data-src]').forEach((img)=>{
            imageObserver.observe(img);
        });
    }
    /**
   * Optimiza CSS crítico
   */ optimizeCriticalCSS(criticalSelectors) {
        try {
            // En una implementación real, esto extraería CSS crítico
            // Por ahora, retornamos un placeholder
            const criticalCSS = criticalSelectors.map((selector)=>`${selector} { /* critical styles */ }`).join('\n');
            _logger.logger.info(_logger.LogCategory.API, 'Critical CSS optimized');
            return criticalCSS;
        } catch (error) {
            _logger.logger.error(_logger.LogCategory.API, 'Critical CSS optimization failed', error);
            return '';
        }
    }
    /**
   * Comprime y optimiza JSON para APIs
   */ optimizeJsonResponse(data) {
        try {
            // Remover propiedades null/undefined
            const cleaned = this.removeNullValues(data);
            // Comprimir JSON (sin espacios)
            const compressed = JSON.stringify(cleaned);
            _logger.logger.info(_logger.LogCategory.API, 'JSON response optimized');
            return compressed;
        } catch (error) {
            _logger.logger.error(_logger.LogCategory.API, 'JSON optimization failed', error);
            // En caso de error (como objetos circulares), retornar string simple
            try {
                return JSON.stringify({
                    error: 'Serialization failed'
                });
            } catch  {
                return '{"error":"Serialization failed"}';
            }
        }
    }
    /**
   * Remueve valores null/undefined de objetos
   */ removeNullValues(obj) {
        if (obj === null || obj === undefined) {
            return undefined;
        }
        if (Array.isArray(obj)) {
            return obj.map((item)=>this.removeNullValues(item)).filter((item)=>item !== undefined);
        }
        if (typeof obj === 'object') {
            const cleaned = {};
            for (const [key, value] of Object.entries(obj)){
                const cleanedValue = this.removeNullValues(value);
                if (cleanedValue !== undefined) {
                    cleaned[key] = cleanedValue;
                }
            }
            return cleaned;
        }
        return obj;
    }
}
const assetOptimizer = AssetOptimizer.getInstance();
const AssetUtils = {
    /**
   * Optimiza imagen de producto
   */ optimizeProductImage (url) {
        return assetOptimizer.optimizeImageUrl(url, ASSET_CONFIGS.PRODUCT_IMAGES);
    },
    /**
   * Optimiza icono de pago
   */ optimizePaymentIcon (url) {
        return assetOptimizer.optimizeImageUrl(url, ASSET_CONFIGS.PAYMENT_ICONS);
    },
    /**
   * Genera imagen responsiva para productos
   */ generateProductImageProps (url) {
        return {
            src: assetOptimizer.optimizeImageUrl(url, ASSET_CONFIGS.PRODUCT_IMAGES),
            srcSet: assetOptimizer.generateSrcSet(url, ASSET_CONFIGS.PRODUCT_IMAGES),
            sizes: assetOptimizer.generateSizes([
                {
                    condition: '(max-width: 640px)',
                    size: '100vw'
                },
                {
                    condition: '(max-width: 1024px)',
                    size: '50vw'
                },
                {
                    condition: '',
                    size: '33vw'
                }
            ]),
            loading: 'lazy',
            decoding: 'async'
        };
    },
    /**
   * Precarga assets críticos de pago
   */ preloadPaymentAssets () {
        const criticalAssets = [
            {
                url: '/images/logo/visa.svg',
                type: 'image'
            },
            {
                url: '/images/logo/mastercard.svg',
                type: 'image'
            },
            {
                url: '/images/logo/mercadopago.svg',
                type: 'image'
            }
        ];
        assetOptimizer.preloadCriticalAssets(criticalAssets);
    },
    /**
   * Inicializa optimizaciones en el cliente
   */ initializeClientOptimizations () {
        if (typeof window === 'undefined') {
            return;
        }
        // Configurar lazy loading
        assetOptimizer.setupLazyLoading();
        // Precargar assets críticos
        AssetUtils.preloadPaymentAssets();
        _logger.logger.info(_logger.LogCategory.API, 'Client asset optimizations initialized');
    }
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcbGliXFxhc3NldC1vcHRpbWl6ZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBJTlRFWUEgRS1DT01NRVJDRSAtIEFTU0VUIE9QVElNSVpFUlxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuaW1wb3J0IHsgbG9nZ2VyLCBMb2dMZXZlbCwgTG9nQ2F0ZWdvcnkgfSBmcm9tICcuL2VudGVycHJpc2UvbG9nZ2VyJ1xuXG4vLyBDb25maWd1cmFjacOzbiBkZSBvcHRpbWl6YWNpw7NuIGRlIGFzc2V0c1xuaW50ZXJmYWNlIEFzc2V0Q29uZmlnIHtcbiAgY29tcHJlc3M6IGJvb2xlYW5cbiAgcXVhbGl0eT86IG51bWJlclxuICBmb3JtYXQ/OiAnd2VicCcgfCAnanBlZycgfCAncG5nJ1xuICBtYXhXaWR0aD86IG51bWJlclxuICBtYXhIZWlnaHQ/OiBudW1iZXJcbiAgbGF6eT86IGJvb2xlYW5cbn1cblxuLy8gQ29uZmlndXJhY2lvbmVzIHByZWRlZmluaWRhc1xuZXhwb3J0IGNvbnN0IEFTU0VUX0NPTkZJR1MgPSB7XG4gIC8vIFBhcmEgaW3DoWdlbmVzIGRlIHByb2R1Y3Rvc1xuICBQUk9EVUNUX0lNQUdFUzoge1xuICAgIGNvbXByZXNzOiB0cnVlLFxuICAgIHF1YWxpdHk6IDg1LFxuICAgIGZvcm1hdDogJ3dlYnAnIGFzIGNvbnN0LFxuICAgIG1heFdpZHRoOiA4MDAsXG4gICAgbWF4SGVpZ2h0OiA2MDAsXG4gICAgbGF6eTogdHJ1ZSxcbiAgfSxcblxuICAvLyBQYXJhIGljb25vcyBkZSBwYWdvXG4gIFBBWU1FTlRfSUNPTlM6IHtcbiAgICBjb21wcmVzczogdHJ1ZSxcbiAgICBxdWFsaXR5OiA5MCxcbiAgICBmb3JtYXQ6ICd3ZWJwJyBhcyBjb25zdCxcbiAgICBtYXhXaWR0aDogNjQsXG4gICAgbWF4SGVpZ2h0OiA2NCxcbiAgICBsYXp5OiBmYWxzZSxcbiAgfSxcblxuICAvLyBQYXJhIGltw6FnZW5lcyBkZSBoZXJvL2Jhbm5lclxuICBIRVJPX0lNQUdFUzoge1xuICAgIGNvbXByZXNzOiB0cnVlLFxuICAgIHF1YWxpdHk6IDgwLFxuICAgIGZvcm1hdDogJ3dlYnAnIGFzIGNvbnN0LFxuICAgIG1heFdpZHRoOiAxOTIwLFxuICAgIG1heEhlaWdodDogMTA4MCxcbiAgICBsYXp5OiB0cnVlLFxuICB9LFxuXG4gIC8vIFBhcmEgYXZhdGFyZXMgZGUgdXN1YXJpb1xuICBBVkFUQVJTOiB7XG4gICAgY29tcHJlc3M6IHRydWUsXG4gICAgcXVhbGl0eTogODUsXG4gICAgZm9ybWF0OiAnd2VicCcgYXMgY29uc3QsXG4gICAgbWF4V2lkdGg6IDIwMCxcbiAgICBtYXhIZWlnaHQ6IDIwMCxcbiAgICBsYXp5OiB0cnVlLFxuICB9LFxufSBhcyBjb25zdFxuXG4vKipcbiAqIENsYXNlIHByaW5jaXBhbCBwYXJhIG9wdGltaXphY2nDs24gZGUgYXNzZXRzXG4gKi9cbmV4cG9ydCBjbGFzcyBBc3NldE9wdGltaXplciB7XG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBBc3NldE9wdGltaXplclxuXG4gIHByaXZhdGUgY29uc3RydWN0b3IoKSB7fVxuXG4gIHN0YXRpYyBnZXRJbnN0YW5jZSgpOiBBc3NldE9wdGltaXplciB7XG4gICAgaWYgKCFBc3NldE9wdGltaXplci5pbnN0YW5jZSkge1xuICAgICAgQXNzZXRPcHRpbWl6ZXIuaW5zdGFuY2UgPSBuZXcgQXNzZXRPcHRpbWl6ZXIoKVxuICAgIH1cbiAgICByZXR1cm4gQXNzZXRPcHRpbWl6ZXIuaW5zdGFuY2VcbiAgfVxuXG4gIC8qKlxuICAgKiBPcHRpbWl6YSB1bmEgVVJMIGRlIGltYWdlblxuICAgKi9cbiAgb3B0aW1pemVJbWFnZVVybChcbiAgICBvcmlnaW5hbFVybDogc3RyaW5nLFxuICAgIGNvbmZpZzogQXNzZXRDb25maWcgPSBBU1NFVF9DT05GSUdTLlBST0RVQ1RfSU1BR0VTXG4gICk6IHN0cmluZyB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFNpIGVzIHVuYSBVUkwgZXh0ZXJuYSwgYXBsaWNhciBwYXLDoW1ldHJvcyBkZSBvcHRpbWl6YWNpw7NuXG4gICAgICBpZiAob3JpZ2luYWxVcmwuc3RhcnRzV2l0aCgnaHR0cCcpKSB7XG4gICAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwob3JpZ2luYWxVcmwpXG5cbiAgICAgICAgLy8gUGFyYSBTdXBhYmFzZSBTdG9yYWdlLCBhZ3JlZ2FyIHBhcsOhbWV0cm9zIGRlIHRyYW5zZm9ybWFjacOzblxuICAgICAgICBpZiAodXJsLmhvc3RuYW1lLmluY2x1ZGVzKCdzdXBhYmFzZScpKSB7XG4gICAgICAgICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpXG5cbiAgICAgICAgICBpZiAoY29uZmlnLm1heFdpZHRoKSB7XG4gICAgICAgICAgICBwYXJhbXMuc2V0KCd3aWR0aCcsIGNvbmZpZy5tYXhXaWR0aC50b1N0cmluZygpKVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChjb25maWcubWF4SGVpZ2h0KSB7XG4gICAgICAgICAgICBwYXJhbXMuc2V0KCdoZWlnaHQnLCBjb25maWcubWF4SGVpZ2h0LnRvU3RyaW5nKCkpXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGNvbmZpZy5xdWFsaXR5KSB7XG4gICAgICAgICAgICBwYXJhbXMuc2V0KCdxdWFsaXR5JywgY29uZmlnLnF1YWxpdHkudG9TdHJpbmcoKSlcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoY29uZmlnLmZvcm1hdCkge1xuICAgICAgICAgICAgcGFyYW1zLnNldCgnZm9ybWF0JywgY29uZmlnLmZvcm1hdClcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAocGFyYW1zLnRvU3RyaW5nKCkpIHtcbiAgICAgICAgICAgIHVybC5zZWFyY2ggPSBwYXJhbXMudG9TdHJpbmcoKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB1cmwudG9TdHJpbmcoKVxuICAgICAgfVxuXG4gICAgICAvLyBQYXJhIFVSTHMgbG9jYWxlcywgbWFudGVuZXIgY29tbyBlc3TDoW5cbiAgICAgIHJldHVybiBvcmlnaW5hbFVybFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoTG9nQ2F0ZWdvcnkuQVBJLCAnSW1hZ2UgVVJMIG9wdGltaXphdGlvbiBmYWlsZWQnLCBlcnJvciBhcyBFcnJvcilcbiAgICAgIHJldHVybiBvcmlnaW5hbFVybFxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmEgc3JjU2V0IHBhcmEgaW3DoWdlbmVzIHJlc3BvbnNpdmFzXG4gICAqL1xuICBnZW5lcmF0ZVNyY1NldChiYXNlVXJsOiBzdHJpbmcsIGNvbmZpZzogQXNzZXRDb25maWcgPSBBU1NFVF9DT05GSUdTLlBST0RVQ1RfSU1BR0VTKTogc3RyaW5nIHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc2l6ZXMgPSBbXG4gICAgICAgIHsgd2lkdGg6IDMyMCwgc3VmZml4OiAnc20nIH0sXG4gICAgICAgIHsgd2lkdGg6IDY0MCwgc3VmZml4OiAnbWQnIH0sXG4gICAgICAgIHsgd2lkdGg6IDEwMjQsIHN1ZmZpeDogJ2xnJyB9LFxuICAgICAgICB7IHdpZHRoOiAxOTIwLCBzdWZmaXg6ICd4bCcgfSxcbiAgICAgIF1cblxuICAgICAgY29uc3Qgc3JjU2V0ID0gc2l6ZXNcbiAgICAgICAgLmZpbHRlcihzaXplID0+ICFjb25maWcubWF4V2lkdGggfHwgc2l6ZS53aWR0aCA8PSBjb25maWcubWF4V2lkdGgpXG4gICAgICAgIC5tYXAoc2l6ZSA9PiB7XG4gICAgICAgICAgY29uc3Qgb3B0aW1pemVkQ29uZmlnID0geyAuLi5jb25maWcsIG1heFdpZHRoOiBzaXplLndpZHRoIH1cbiAgICAgICAgICBjb25zdCB1cmwgPSB0aGlzLm9wdGltaXplSW1hZ2VVcmwoYmFzZVVybCwgb3B0aW1pemVkQ29uZmlnKVxuICAgICAgICAgIHJldHVybiBgJHt1cmx9ICR7c2l6ZS53aWR0aH13YFxuICAgICAgICB9KVxuICAgICAgICAuam9pbignLCAnKVxuXG4gICAgICByZXR1cm4gc3JjU2V0XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihMb2dDYXRlZ29yeS5BUEksICdTcmNTZXQgZ2VuZXJhdGlvbiBmYWlsZWQnLCBlcnJvciBhcyBFcnJvcilcbiAgICAgIHJldHVybiBiYXNlVXJsXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYSBzaXplcyBhdHRyaWJ1dGUgcGFyYSBpbcOhZ2VuZXMgcmVzcG9uc2l2YXNcbiAgICovXG4gIGdlbmVyYXRlU2l6ZXMoYnJlYWtwb2ludHM6IEFycmF5PHsgY29uZGl0aW9uOiBzdHJpbmc7IHNpemU6IHN0cmluZyB9Pik6IHN0cmluZyB7XG4gICAgcmV0dXJuIGJyZWFrcG9pbnRzLm1hcChicCA9PiBgJHticC5jb25kaXRpb259ICR7YnAuc2l6ZX1gKS5qb2luKCcsICcpXG4gIH1cblxuICAvKipcbiAgICogUHJlY2FyZ2EgYXNzZXRzIGNyw610aWNvc1xuICAgKi9cbiAgcHJlbG9hZENyaXRpY2FsQXNzZXRzKGFzc2V0czogQXJyYXk8eyB1cmw6IHN0cmluZzsgdHlwZTogJ2ltYWdlJyB8ICdmb250JyB8ICdzdHlsZScgfT4pOiB2b2lkIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGFzc2V0cy5mb3JFYWNoKGFzc2V0ID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaW5rJylcbiAgICAgICAgbGluay5yZWwgPSAncHJlbG9hZCdcbiAgICAgICAgbGluay5ocmVmID0gYXNzZXQudXJsXG5cbiAgICAgICAgc3dpdGNoIChhc3NldC50eXBlKSB7XG4gICAgICAgICAgY2FzZSAnaW1hZ2UnOlxuICAgICAgICAgICAgbGluay5hcyA9ICdpbWFnZSdcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgY2FzZSAnZm9udCc6XG4gICAgICAgICAgICBsaW5rLmFzID0gJ2ZvbnQnXG4gICAgICAgICAgICBsaW5rLmNyb3NzT3JpZ2luID0gJ2Fub255bW91cydcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgY2FzZSAnc3R5bGUnOlxuICAgICAgICAgICAgbGluay5hcyA9ICdzdHlsZSdcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cblxuICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGxpbmspXG5cbiAgICAgICAgbG9nZ2VyLmluZm8oTG9nQ2F0ZWdvcnkuQVBJLCAnQXNzZXQgcHJlbG9hZGVkJylcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihMb2dDYXRlZ29yeS5BUEksICdBc3NldCBwcmVsb2FkIGZhaWxlZCcsIGVycm9yIGFzIEVycm9yKVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICAvKipcbiAgICogTGF6eSBsb2FkIGRlIGltw6FnZW5lcyBjb24gSW50ZXJzZWN0aW9uIE9ic2VydmVyXG4gICAqL1xuICBzZXR1cExhenlMb2FkaW5nKCk6IHZvaWQge1xuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJyB8fCAhKCdJbnRlcnNlY3Rpb25PYnNlcnZlcicgaW4gd2luZG93KSkge1xuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgY29uc3QgaW1hZ2VPYnNlcnZlciA9IG5ldyBJbnRlcnNlY3Rpb25PYnNlcnZlcihcbiAgICAgIChlbnRyaWVzLCBvYnNlcnZlcikgPT4ge1xuICAgICAgICBlbnRyaWVzLmZvckVhY2goZW50cnkgPT4ge1xuICAgICAgICAgIGlmIChlbnRyeS5pc0ludGVyc2VjdGluZykge1xuICAgICAgICAgICAgY29uc3QgaW1nID0gZW50cnkudGFyZ2V0IGFzIEhUTUxJbWFnZUVsZW1lbnRcblxuICAgICAgICAgICAgaWYgKGltZy5kYXRhc2V0LnNyYykge1xuICAgICAgICAgICAgICBpbWcuc3JjID0gaW1nLmRhdGFzZXQuc3JjXG4gICAgICAgICAgICAgIGltZy5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtc3JjJylcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGltZy5kYXRhc2V0LnNyY3NldCkge1xuICAgICAgICAgICAgICBpbWcuc3Jjc2V0ID0gaW1nLmRhdGFzZXQuc3Jjc2V0XG4gICAgICAgICAgICAgIGltZy5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtc3Jjc2V0JylcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaW1nLmNsYXNzTGlzdC5yZW1vdmUoJ2xhenknKVxuICAgICAgICAgICAgb2JzZXJ2ZXIudW5vYnNlcnZlKGltZylcblxuICAgICAgICAgICAgbG9nZ2VyLmluZm8oTG9nQ2F0ZWdvcnkuQVBJLCAnTGF6eSBpbWFnZSBsb2FkZWQnKVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHJvb3RNYXJnaW46ICc1MHB4IDBweCcsXG4gICAgICAgIHRocmVzaG9sZDogMC4wMSxcbiAgICAgIH1cbiAgICApXG5cbiAgICAvLyBPYnNlcnZhciB0b2RhcyBsYXMgaW3DoWdlbmVzIGxhenlcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdpbWdbZGF0YS1zcmNdJykuZm9yRWFjaChpbWcgPT4ge1xuICAgICAgaW1hZ2VPYnNlcnZlci5vYnNlcnZlKGltZylcbiAgICB9KVxuICB9XG5cbiAgLyoqXG4gICAqIE9wdGltaXphIENTUyBjcsOtdGljb1xuICAgKi9cbiAgb3B0aW1pemVDcml0aWNhbENTUyhjcml0aWNhbFNlbGVjdG9yczogc3RyaW5nW10pOiBzdHJpbmcge1xuICAgIHRyeSB7XG4gICAgICAvLyBFbiB1bmEgaW1wbGVtZW50YWNpw7NuIHJlYWwsIGVzdG8gZXh0cmFlcsOtYSBDU1MgY3LDrXRpY29cbiAgICAgIC8vIFBvciBhaG9yYSwgcmV0b3JuYW1vcyB1biBwbGFjZWhvbGRlclxuICAgICAgY29uc3QgY3JpdGljYWxDU1MgPSBjcml0aWNhbFNlbGVjdG9yc1xuICAgICAgICAubWFwKHNlbGVjdG9yID0+IGAke3NlbGVjdG9yfSB7IC8qIGNyaXRpY2FsIHN0eWxlcyAqLyB9YClcbiAgICAgICAgLmpvaW4oJ1xcbicpXG5cbiAgICAgIGxvZ2dlci5pbmZvKExvZ0NhdGVnb3J5LkFQSSwgJ0NyaXRpY2FsIENTUyBvcHRpbWl6ZWQnKVxuXG4gICAgICByZXR1cm4gY3JpdGljYWxDU1NcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKExvZ0NhdGVnb3J5LkFQSSwgJ0NyaXRpY2FsIENTUyBvcHRpbWl6YXRpb24gZmFpbGVkJywgZXJyb3IgYXMgRXJyb3IpXG4gICAgICByZXR1cm4gJydcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ29tcHJpbWUgeSBvcHRpbWl6YSBKU09OIHBhcmEgQVBJc1xuICAgKi9cbiAgb3B0aW1pemVKc29uUmVzcG9uc2UoZGF0YTogYW55KTogc3RyaW5nIHtcbiAgICB0cnkge1xuICAgICAgLy8gUmVtb3ZlciBwcm9waWVkYWRlcyBudWxsL3VuZGVmaW5lZFxuICAgICAgY29uc3QgY2xlYW5lZCA9IHRoaXMucmVtb3ZlTnVsbFZhbHVlcyhkYXRhKVxuXG4gICAgICAvLyBDb21wcmltaXIgSlNPTiAoc2luIGVzcGFjaW9zKVxuICAgICAgY29uc3QgY29tcHJlc3NlZCA9IEpTT04uc3RyaW5naWZ5KGNsZWFuZWQpXG5cbiAgICAgIGxvZ2dlci5pbmZvKExvZ0NhdGVnb3J5LkFQSSwgJ0pTT04gcmVzcG9uc2Ugb3B0aW1pemVkJylcblxuICAgICAgcmV0dXJuIGNvbXByZXNzZWRcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKExvZ0NhdGVnb3J5LkFQSSwgJ0pTT04gb3B0aW1pemF0aW9uIGZhaWxlZCcsIGVycm9yIGFzIEVycm9yKVxuICAgICAgLy8gRW4gY2FzbyBkZSBlcnJvciAoY29tbyBvYmpldG9zIGNpcmN1bGFyZXMpLCByZXRvcm5hciBzdHJpbmcgc2ltcGxlXG4gICAgICB0cnkge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoeyBlcnJvcjogJ1NlcmlhbGl6YXRpb24gZmFpbGVkJyB9KVxuICAgICAgfSBjYXRjaCB7XG4gICAgICAgIHJldHVybiAne1wiZXJyb3JcIjpcIlNlcmlhbGl6YXRpb24gZmFpbGVkXCJ9J1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZW11ZXZlIHZhbG9yZXMgbnVsbC91bmRlZmluZWQgZGUgb2JqZXRvc1xuICAgKi9cbiAgcHJpdmF0ZSByZW1vdmVOdWxsVmFsdWVzKG9iajogYW55KTogYW55IHtcbiAgICBpZiAob2JqID09PSBudWxsIHx8IG9iaiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkXG4gICAgfVxuXG4gICAgaWYgKEFycmF5LmlzQXJyYXkob2JqKSkge1xuICAgICAgcmV0dXJuIG9iai5tYXAoaXRlbSA9PiB0aGlzLnJlbW92ZU51bGxWYWx1ZXMoaXRlbSkpLmZpbHRlcihpdGVtID0+IGl0ZW0gIT09IHVuZGVmaW5lZClcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIG9iaiA9PT0gJ29iamVjdCcpIHtcbiAgICAgIGNvbnN0IGNsZWFuZWQ6IGFueSA9IHt9XG4gICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhvYmopKSB7XG4gICAgICAgIGNvbnN0IGNsZWFuZWRWYWx1ZSA9IHRoaXMucmVtb3ZlTnVsbFZhbHVlcyh2YWx1ZSlcbiAgICAgICAgaWYgKGNsZWFuZWRWYWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgY2xlYW5lZFtrZXldID0gY2xlYW5lZFZhbHVlXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBjbGVhbmVkXG4gICAgfVxuXG4gICAgcmV0dXJuIG9ialxuICB9XG59XG5cbi8vIEluc3RhbmNpYSBzaW5nbGV0b25cbmV4cG9ydCBjb25zdCBhc3NldE9wdGltaXplciA9IEFzc2V0T3B0aW1pemVyLmdldEluc3RhbmNlKClcblxuLyoqXG4gKiBGdW5jaW9uZXMgZGUgdXRpbGlkYWQgcGFyYSBvcHRpbWl6YWNpw7NuIGRlIGFzc2V0c1xuICovXG5leHBvcnQgY29uc3QgQXNzZXRVdGlscyA9IHtcbiAgLyoqXG4gICAqIE9wdGltaXphIGltYWdlbiBkZSBwcm9kdWN0b1xuICAgKi9cbiAgb3B0aW1pemVQcm9kdWN0SW1hZ2UodXJsOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiBhc3NldE9wdGltaXplci5vcHRpbWl6ZUltYWdlVXJsKHVybCwgQVNTRVRfQ09ORklHUy5QUk9EVUNUX0lNQUdFUylcbiAgfSxcblxuICAvKipcbiAgICogT3B0aW1pemEgaWNvbm8gZGUgcGFnb1xuICAgKi9cbiAgb3B0aW1pemVQYXltZW50SWNvbih1cmw6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGFzc2V0T3B0aW1pemVyLm9wdGltaXplSW1hZ2VVcmwodXJsLCBBU1NFVF9DT05GSUdTLlBBWU1FTlRfSUNPTlMpXG4gIH0sXG5cbiAgLyoqXG4gICAqIEdlbmVyYSBpbWFnZW4gcmVzcG9uc2l2YSBwYXJhIHByb2R1Y3Rvc1xuICAgKi9cbiAgZ2VuZXJhdGVQcm9kdWN0SW1hZ2VQcm9wcyh1cmw6IHN0cmluZykge1xuICAgIHJldHVybiB7XG4gICAgICBzcmM6IGFzc2V0T3B0aW1pemVyLm9wdGltaXplSW1hZ2VVcmwodXJsLCBBU1NFVF9DT05GSUdTLlBST0RVQ1RfSU1BR0VTKSxcbiAgICAgIHNyY1NldDogYXNzZXRPcHRpbWl6ZXIuZ2VuZXJhdGVTcmNTZXQodXJsLCBBU1NFVF9DT05GSUdTLlBST0RVQ1RfSU1BR0VTKSxcbiAgICAgIHNpemVzOiBhc3NldE9wdGltaXplci5nZW5lcmF0ZVNpemVzKFtcbiAgICAgICAgeyBjb25kaXRpb246ICcobWF4LXdpZHRoOiA2NDBweCknLCBzaXplOiAnMTAwdncnIH0sXG4gICAgICAgIHsgY29uZGl0aW9uOiAnKG1heC13aWR0aDogMTAyNHB4KScsIHNpemU6ICc1MHZ3JyB9LFxuICAgICAgICB7IGNvbmRpdGlvbjogJycsIHNpemU6ICczM3Z3JyB9LFxuICAgICAgXSksXG4gICAgICBsb2FkaW5nOiAnbGF6eScgYXMgY29uc3QsXG4gICAgICBkZWNvZGluZzogJ2FzeW5jJyBhcyBjb25zdCxcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIFByZWNhcmdhIGFzc2V0cyBjcsOtdGljb3MgZGUgcGFnb1xuICAgKi9cbiAgcHJlbG9hZFBheW1lbnRBc3NldHMoKTogdm9pZCB7XG4gICAgY29uc3QgY3JpdGljYWxBc3NldHMgPSBbXG4gICAgICB7IHVybDogJy9pbWFnZXMvbG9nby92aXNhLnN2ZycsIHR5cGU6ICdpbWFnZScgYXMgY29uc3QgfSxcbiAgICAgIHsgdXJsOiAnL2ltYWdlcy9sb2dvL21hc3RlcmNhcmQuc3ZnJywgdHlwZTogJ2ltYWdlJyBhcyBjb25zdCB9LFxuICAgICAgeyB1cmw6ICcvaW1hZ2VzL2xvZ28vbWVyY2Fkb3BhZ28uc3ZnJywgdHlwZTogJ2ltYWdlJyBhcyBjb25zdCB9LFxuICAgIF1cblxuICAgIGFzc2V0T3B0aW1pemVyLnByZWxvYWRDcml0aWNhbEFzc2V0cyhjcml0aWNhbEFzc2V0cylcbiAgfSxcblxuICAvKipcbiAgICogSW5pY2lhbGl6YSBvcHRpbWl6YWNpb25lcyBlbiBlbCBjbGllbnRlXG4gICAqL1xuICBpbml0aWFsaXplQ2xpZW50T3B0aW1pemF0aW9ucygpOiB2b2lkIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIC8vIENvbmZpZ3VyYXIgbGF6eSBsb2FkaW5nXG4gICAgYXNzZXRPcHRpbWl6ZXIuc2V0dXBMYXp5TG9hZGluZygpXG5cbiAgICAvLyBQcmVjYXJnYXIgYXNzZXRzIGNyw610aWNvc1xuICAgIEFzc2V0VXRpbHMucHJlbG9hZFBheW1lbnRBc3NldHMoKVxuXG4gICAgbG9nZ2VyLmluZm8oTG9nQ2F0ZWdvcnkuQVBJLCAnQ2xpZW50IGFzc2V0IG9wdGltaXphdGlvbnMgaW5pdGlhbGl6ZWQnKVxuICB9LFxufVxuIl0sIm5hbWVzIjpbIkFTU0VUX0NPTkZJR1MiLCJBc3NldE9wdGltaXplciIsIkFzc2V0VXRpbHMiLCJhc3NldE9wdGltaXplciIsIlBST0RVQ1RfSU1BR0VTIiwiY29tcHJlc3MiLCJxdWFsaXR5IiwiZm9ybWF0IiwibWF4V2lkdGgiLCJtYXhIZWlnaHQiLCJsYXp5IiwiUEFZTUVOVF9JQ09OUyIsIkhFUk9fSU1BR0VTIiwiQVZBVEFSUyIsImdldEluc3RhbmNlIiwiaW5zdGFuY2UiLCJvcHRpbWl6ZUltYWdlVXJsIiwib3JpZ2luYWxVcmwiLCJjb25maWciLCJzdGFydHNXaXRoIiwidXJsIiwiVVJMIiwiaG9zdG5hbWUiLCJpbmNsdWRlcyIsInBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsInNldCIsInRvU3RyaW5nIiwic2VhcmNoIiwiZXJyb3IiLCJsb2dnZXIiLCJMb2dDYXRlZ29yeSIsIkFQSSIsImdlbmVyYXRlU3JjU2V0IiwiYmFzZVVybCIsInNpemVzIiwid2lkdGgiLCJzdWZmaXgiLCJzcmNTZXQiLCJmaWx0ZXIiLCJzaXplIiwibWFwIiwib3B0aW1pemVkQ29uZmlnIiwiam9pbiIsImdlbmVyYXRlU2l6ZXMiLCJicmVha3BvaW50cyIsImJwIiwiY29uZGl0aW9uIiwicHJlbG9hZENyaXRpY2FsQXNzZXRzIiwiYXNzZXRzIiwid2luZG93IiwiZm9yRWFjaCIsImFzc2V0IiwibGluayIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsInJlbCIsImhyZWYiLCJ0eXBlIiwiYXMiLCJjcm9zc09yaWdpbiIsImhlYWQiLCJhcHBlbmRDaGlsZCIsImluZm8iLCJzZXR1cExhenlMb2FkaW5nIiwiaW1hZ2VPYnNlcnZlciIsIkludGVyc2VjdGlvbk9ic2VydmVyIiwiZW50cmllcyIsIm9ic2VydmVyIiwiZW50cnkiLCJpc0ludGVyc2VjdGluZyIsImltZyIsInRhcmdldCIsImRhdGFzZXQiLCJzcmMiLCJyZW1vdmVBdHRyaWJ1dGUiLCJzcmNzZXQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ1bm9ic2VydmUiLCJyb290TWFyZ2luIiwidGhyZXNob2xkIiwicXVlcnlTZWxlY3RvckFsbCIsIm9ic2VydmUiLCJvcHRpbWl6ZUNyaXRpY2FsQ1NTIiwiY3JpdGljYWxTZWxlY3RvcnMiLCJjcml0aWNhbENTUyIsInNlbGVjdG9yIiwib3B0aW1pemVKc29uUmVzcG9uc2UiLCJkYXRhIiwiY2xlYW5lZCIsInJlbW92ZU51bGxWYWx1ZXMiLCJjb21wcmVzc2VkIiwiSlNPTiIsInN0cmluZ2lmeSIsIm9iaiIsInVuZGVmaW5lZCIsIkFycmF5IiwiaXNBcnJheSIsIml0ZW0iLCJrZXkiLCJ2YWx1ZSIsIk9iamVjdCIsImNsZWFuZWRWYWx1ZSIsIm9wdGltaXplUHJvZHVjdEltYWdlIiwib3B0aW1pemVQYXltZW50SWNvbiIsImdlbmVyYXRlUHJvZHVjdEltYWdlUHJvcHMiLCJsb2FkaW5nIiwiZGVjb2RpbmciLCJwcmVsb2FkUGF5bWVudEFzc2V0cyIsImNyaXRpY2FsQXNzZXRzIiwiaW5pdGlhbGl6ZUNsaWVudE9wdGltaXphdGlvbnMiXSwibWFwcGluZ3MiOiJBQUFBLHNDQUFzQztBQUN0Qyx1Q0FBdUM7QUFDdkMsc0NBQXNDOzs7Ozs7Ozs7Ozs7UUFlekJBO2VBQUFBOztRQTZDQUM7ZUFBQUE7O1FBNFBBQztlQUFBQTs7UUFMQUM7ZUFBQUE7Ozt3QkFqVGlDO0FBYXZDLE1BQU1ILGdCQUFnQjtJQUMzQiw2QkFBNkI7SUFDN0JJLGdCQUFnQjtRQUNkQyxVQUFVO1FBQ1ZDLFNBQVM7UUFDVEMsUUFBUTtRQUNSQyxVQUFVO1FBQ1ZDLFdBQVc7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