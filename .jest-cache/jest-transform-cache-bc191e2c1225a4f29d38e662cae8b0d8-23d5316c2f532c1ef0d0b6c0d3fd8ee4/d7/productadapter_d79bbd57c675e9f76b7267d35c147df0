330eaf4ca3b95d1a0c9a6e1b5378b90b
// ===================================
// PINTEYA E-COMMERCE - ADAPTADOR DE PRODUCTOS
// ===================================
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get adaptApiProductToComponent () {
        return adaptApiProductToComponent;
    },
    get adaptApiProductsToComponents () {
        return adaptApiProductsToComponents;
    },
    get adaptComponentProductToApi () {
        return adaptComponentProductToApi;
    },
    get formatPrice () {
        return formatPrice;
    },
    get generateSlug () {
        return generateSlug;
    },
    get getDiscountPercentage () {
        return getDiscountPercentage;
    },
    get getFinalPrice () {
        return getFinalPrice;
    },
    get getMainImage () {
        return getMainImage;
    },
    get getPreviewImage () {
        return getPreviewImage;
    },
    get getThumbnailImage () {
        return getThumbnailImage;
    },
    get getValidImageUrl () {
        return getValidImageUrl;
    },
    get hasDiscount () {
        return hasDiscount;
    }
});
function adaptApiProductToComponent(apiProduct) {
    // Mapear correctamente las imágenes desde la estructura de BD a la estructura de componentes
    const images = apiProduct.images || {};
    return {
        id: apiProduct.id,
        title: apiProduct.name,
        name: apiProduct.name,
        brand: apiProduct.brand,
        reviews: Math.floor(Math.random() * 50) + 1,
        price: apiProduct.price,
        // FIX CRÍTICO: Solo usar discounted_price si es menor que price, sino undefined
        discountedPrice: apiProduct.discounted_price && apiProduct.discounted_price < apiProduct.price ? apiProduct.discounted_price : undefined,
        imgs: {
            // Mapear desde la estructura real de la BD: { main, gallery, thumbnail }
            thumbnails: images.thumbnail ? [
                images.thumbnail
            ] : [
                '/images/products/placeholder.svg'
            ],
            previews: images.main ? [
                images.main
            ] : images.gallery?.[0] ? [
                images.gallery[0]
            ] : [
                '/images/products/placeholder.svg'
            ]
        }
    };
}
function adaptApiProductsToComponents(apiProducts) {
    return apiProducts.map(adaptApiProductToComponent);
}
function adaptComponentProductToApi(componentProduct) {
    return {
        id: componentProduct.id,
        name: componentProduct.title,
        price: componentProduct.price,
        discounted_price: componentProduct.discountedPrice !== componentProduct.price ? componentProduct.discountedPrice : null,
        images: componentProduct.imgs,
        stock: 50
    };
}
function hasDiscount(product) {
    if ('discountedPrice' in product) {
        return product.discountedPrice !== undefined && product.discountedPrice < product.price;
    }
    if ('discounted_price' in product) {
        return product.discounted_price !== null && product.discounted_price < product.price;
    }
    return false;
}
function getDiscountPercentage(product) {
    let originalPrice;
    let discountedPrice;
    if ('discountedPrice' in product) {
        originalPrice = product.price;
        discountedPrice = product.discountedPrice;
    } else {
        originalPrice = product.price;
        discountedPrice = product.discounted_price || product.price;
    }
    if (discountedPrice >= originalPrice) {
        return 0;
    }
    return Math.round((originalPrice - discountedPrice) / originalPrice * 100);
}
function getFinalPrice(product) {
    if ('discountedPrice' in product) {
        return product.discountedPrice;
    }
    return product.discounted_price ?? product.price;
}
function getMainImage(product) {
    if ('imgs' in product && product.imgs?.previews?.[0]) {
        return product.imgs.previews[0];
    }
    if ('images' in product && product.images?.previews?.[0]) {
        return product.images.previews[0];
    }
    return '/images/products/placeholder.svg';
}
function getValidImageUrl(imageUrl, fallback = '/images/products/placeholder.svg') {
    // Verificar si la imagen existe y no es una cadena vacía o solo espacios
    if (imageUrl && typeof imageUrl === 'string' && imageUrl.trim() !== '') {
        return imageUrl.trim();
    }
    return fallback;
}
function getThumbnailImage(product) {
    let imageUrl;
    if ('imgs' in product && product.imgs?.thumbnails?.[0]) {
        imageUrl = product.imgs.thumbnails[0];
    } else if ('images' in product && product.images?.thumbnails?.[0]) {
        imageUrl = product.images.thumbnails[0];
    }
    return getValidImageUrl(imageUrl);
}
function getPreviewImage(product) {
    let imageUrl;
    if ('imgs' in product && product.imgs?.previews?.[0]) {
        imageUrl = product.imgs.previews[0];
    } else if ('images' in product && product.images?.previews?.[0]) {
        imageUrl = product.images.previews[0];
    }
    return getValidImageUrl(imageUrl);
}
function formatPrice(price) {
    return new Intl.NumberFormat('es-AR', {
        style: 'currency',
        currency: 'ARS',
        minimumFractionDigits: 0,
        maximumFractionDigits: 0
    }).format(price);
}
function generateSlug(name) {
    return name.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '') // Remover acentos
    .replace(/[^a-z0-9\s-]/g, '') // Remover caracteres especiales
    .replace(/\s+/g, '-') // Reemplazar espacios con guiones
    .replace(/-+/g, '-') // Remover guiones múltiples
    .replace(/^-|-$/g, ''); // Remover guiones al inicio y final
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcbGliXFxhZGFwdGVyc1xccHJvZHVjdC1hZGFwdGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBJTlRFWUEgRS1DT01NRVJDRSAtIEFEQVBUQURPUiBERSBQUk9EVUNUT1NcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmltcG9ydCB7IFByb2R1Y3QgfSBmcm9tICdAL3R5cGVzL3Byb2R1Y3QnO1xyXG5pbXBvcnQgeyBQcm9kdWN0V2l0aENhdGVnb3J5IH0gZnJvbSAnQC90eXBlcy9hcGknO1xyXG5cclxuLyoqXHJcbiAqIENvbnZpZXJ0ZSB1biBwcm9kdWN0byBkZSBsYSBBUEkgYWwgZm9ybWF0byBlc3BlcmFkbyBwb3IgbG9zIGNvbXBvbmVudGVzXHJcbiAqIEBwYXJhbSBhcGlQcm9kdWN0IC0gUHJvZHVjdG8gZGVzZGUgbGEgQVBJXHJcbiAqIEByZXR1cm5zIFByb2R1Y3QgLSBQcm9kdWN0byBlbiBmb3JtYXRvIGRlIGNvbXBvbmVudGVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBhZGFwdEFwaVByb2R1Y3RUb0NvbXBvbmVudChhcGlQcm9kdWN0OiBQcm9kdWN0V2l0aENhdGVnb3J5KTogUHJvZHVjdCAmIHsgbmFtZT86IHN0cmluZyB9IHtcclxuICAvLyBNYXBlYXIgY29ycmVjdGFtZW50ZSBsYXMgaW3DoWdlbmVzIGRlc2RlIGxhIGVzdHJ1Y3R1cmEgZGUgQkQgYSBsYSBlc3RydWN0dXJhIGRlIGNvbXBvbmVudGVzXHJcbiAgY29uc3QgaW1hZ2VzID0gYXBpUHJvZHVjdC5pbWFnZXMgfHwge307XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBpZDogYXBpUHJvZHVjdC5pZCxcclxuICAgIHRpdGxlOiBhcGlQcm9kdWN0Lm5hbWUsXHJcbiAgICBuYW1lOiBhcGlQcm9kdWN0Lm5hbWUsIC8vIEFncmVnYXIgZWwgY2FtcG8gbmFtZSBwYXJhIGNvbXBhdGliaWxpZGFkXHJcbiAgICBicmFuZDogYXBpUHJvZHVjdC5icmFuZCwgLy8gQWdyZWdhciBlbCBjYW1wbyBicmFuZCBxdWUgZmFsdGFiYVxyXG4gICAgcmV2aWV3czogTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNTApICsgMSwgLy8gVGVtcG9yYWw6IGdlbmVyYXIgcmV2aWV3cyBhbGVhdG9yaWFzXHJcbiAgICBwcmljZTogYXBpUHJvZHVjdC5wcmljZSxcclxuICAgIC8vIEZJWCBDUsONVElDTzogU29sbyB1c2FyIGRpc2NvdW50ZWRfcHJpY2Ugc2kgZXMgbWVub3IgcXVlIHByaWNlLCBzaW5vIHVuZGVmaW5lZFxyXG4gICAgZGlzY291bnRlZFByaWNlOiAoYXBpUHJvZHVjdC5kaXNjb3VudGVkX3ByaWNlICYmIGFwaVByb2R1Y3QuZGlzY291bnRlZF9wcmljZSA8IGFwaVByb2R1Y3QucHJpY2UpIFxyXG4gICAgICA/IGFwaVByb2R1Y3QuZGlzY291bnRlZF9wcmljZSBcclxuICAgICAgOiB1bmRlZmluZWQsXHJcbiAgICBpbWdzOiB7XHJcbiAgICAgIC8vIE1hcGVhciBkZXNkZSBsYSBlc3RydWN0dXJhIHJlYWwgZGUgbGEgQkQ6IHsgbWFpbiwgZ2FsbGVyeSwgdGh1bWJuYWlsIH1cclxuICAgICAgdGh1bWJuYWlsczogaW1hZ2VzLnRodW1ibmFpbCA/IFtpbWFnZXMudGh1bWJuYWlsXSA6IFsnL2ltYWdlcy9wcm9kdWN0cy9wbGFjZWhvbGRlci5zdmcnXSxcclxuICAgICAgcHJldmlld3M6IGltYWdlcy5tYWluID8gW2ltYWdlcy5tYWluXSA6IChpbWFnZXMuZ2FsbGVyeT8uWzBdID8gW2ltYWdlcy5nYWxsZXJ5WzBdXSA6IFsnL2ltYWdlcy9wcm9kdWN0cy9wbGFjZWhvbGRlci5zdmcnXSksXHJcbiAgICB9LFxyXG4gIH07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDb252aWVydGUgdW5hIGxpc3RhIGRlIHByb2R1Y3RvcyBkZSBsYSBBUEkgYWwgZm9ybWF0byBkZSBjb21wb25lbnRlc1xyXG4gKiBAcGFyYW0gYXBpUHJvZHVjdHMgLSBMaXN0YSBkZSBwcm9kdWN0b3MgZGVzZGUgbGEgQVBJXHJcbiAqIEByZXR1cm5zIFByb2R1Y3RbXSAtIExpc3RhIGRlIHByb2R1Y3RvcyBlbiBmb3JtYXRvIGRlIGNvbXBvbmVudGVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBhZGFwdEFwaVByb2R1Y3RzVG9Db21wb25lbnRzKGFwaVByb2R1Y3RzOiBQcm9kdWN0V2l0aENhdGVnb3J5W10pOiAoUHJvZHVjdCAmIHsgbmFtZT86IHN0cmluZyB9KVtdIHtcclxuICByZXR1cm4gYXBpUHJvZHVjdHMubWFwKGFkYXB0QXBpUHJvZHVjdFRvQ29tcG9uZW50KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENvbnZpZXJ0ZSB1biBwcm9kdWN0byBkZSBjb21wb25lbnRlIGFsIGZvcm1hdG8gZGUgbGEgQVBJXHJcbiAqIEBwYXJhbSBjb21wb25lbnRQcm9kdWN0IC0gUHJvZHVjdG8gZW4gZm9ybWF0byBkZSBjb21wb25lbnRlXHJcbiAqIEByZXR1cm5zIFBhcnRpYWw8UHJvZHVjdFdpdGhDYXRlZ29yeT4gLSBQcm9kdWN0byBlbiBmb3JtYXRvIGRlIEFQSVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGFkYXB0Q29tcG9uZW50UHJvZHVjdFRvQXBpKGNvbXBvbmVudFByb2R1Y3Q6IFByb2R1Y3QpOiBQYXJ0aWFsPFByb2R1Y3RXaXRoQ2F0ZWdvcnk+IHtcclxuICByZXR1cm4ge1xyXG4gICAgaWQ6IGNvbXBvbmVudFByb2R1Y3QuaWQsXHJcbiAgICBuYW1lOiBjb21wb25lbnRQcm9kdWN0LnRpdGxlLFxyXG4gICAgcHJpY2U6IGNvbXBvbmVudFByb2R1Y3QucHJpY2UsXHJcbiAgICBkaXNjb3VudGVkX3ByaWNlOiBjb21wb25lbnRQcm9kdWN0LmRpc2NvdW50ZWRQcmljZSAhPT0gY29tcG9uZW50UHJvZHVjdC5wcmljZSBcclxuICAgICAgPyBjb21wb25lbnRQcm9kdWN0LmRpc2NvdW50ZWRQcmljZSBcclxuICAgICAgOiBudWxsLFxyXG4gICAgaW1hZ2VzOiBjb21wb25lbnRQcm9kdWN0LmltZ3MsXHJcbiAgICBzdG9jazogNTAsIC8vIFZhbG9yIHBvciBkZWZlY3RvXHJcbiAgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFZlcmlmaWNhIHNpIHVuIHByb2R1Y3RvIHRpZW5lIGRlc2N1ZW50b1xyXG4gKiBAcGFyYW0gcHJvZHVjdCAtIFByb2R1Y3RvXHJcbiAqIEByZXR1cm5zIGJvb2xlYW5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBoYXNEaXNjb3VudChwcm9kdWN0OiBQcm9kdWN0IHwgUHJvZHVjdFdpdGhDYXRlZ29yeSk6IGJvb2xlYW4ge1xyXG4gIGlmICgnZGlzY291bnRlZFByaWNlJyBpbiBwcm9kdWN0KSB7XHJcbiAgICByZXR1cm4gcHJvZHVjdC5kaXNjb3VudGVkUHJpY2UgIT09IHVuZGVmaW5lZCAmJiBwcm9kdWN0LmRpc2NvdW50ZWRQcmljZSA8IHByb2R1Y3QucHJpY2U7XHJcbiAgfVxyXG4gIGlmICgnZGlzY291bnRlZF9wcmljZScgaW4gcHJvZHVjdCkge1xyXG4gICAgcmV0dXJuIHByb2R1Y3QuZGlzY291bnRlZF9wcmljZSAhPT0gbnVsbCAmJiBwcm9kdWN0LmRpc2NvdW50ZWRfcHJpY2UgPCBwcm9kdWN0LnByaWNlO1xyXG4gIH1cclxuICByZXR1cm4gZmFsc2U7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDYWxjdWxhIGVsIHBvcmNlbnRhamUgZGUgZGVzY3VlbnRvXHJcbiAqIEBwYXJhbSBwcm9kdWN0IC0gUHJvZHVjdG9cclxuICogQHJldHVybnMgbnVtYmVyIC0gUG9yY2VudGFqZSBkZSBkZXNjdWVudG9cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXREaXNjb3VudFBlcmNlbnRhZ2UocHJvZHVjdDogUHJvZHVjdCB8IFByb2R1Y3RXaXRoQ2F0ZWdvcnkpOiBudW1iZXIge1xyXG4gIGxldCBvcmlnaW5hbFByaWNlOiBudW1iZXI7XHJcbiAgbGV0IGRpc2NvdW50ZWRQcmljZTogbnVtYmVyO1xyXG5cclxuICBpZiAoJ2Rpc2NvdW50ZWRQcmljZScgaW4gcHJvZHVjdCkge1xyXG4gICAgb3JpZ2luYWxQcmljZSA9IHByb2R1Y3QucHJpY2U7XHJcbiAgICBkaXNjb3VudGVkUHJpY2UgPSBwcm9kdWN0LmRpc2NvdW50ZWRQcmljZTtcclxuICB9IGVsc2Uge1xyXG4gICAgb3JpZ2luYWxQcmljZSA9IHByb2R1Y3QucHJpY2U7XHJcbiAgICBkaXNjb3VudGVkUHJpY2UgPSBwcm9kdWN0LmRpc2NvdW50ZWRfcHJpY2UgfHwgcHJvZHVjdC5wcmljZTtcclxuICB9XHJcblxyXG4gIGlmIChkaXNjb3VudGVkUHJpY2UgPj0gb3JpZ2luYWxQcmljZSkge1xyXG4gICAgcmV0dXJuIDA7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gTWF0aC5yb3VuZCgoKG9yaWdpbmFsUHJpY2UgLSBkaXNjb3VudGVkUHJpY2UpIC8gb3JpZ2luYWxQcmljZSkgKiAxMDApO1xyXG59XHJcblxyXG4vKipcclxuICogT2J0aWVuZSBlbCBwcmVjaW8gZmluYWwgZGVsIHByb2R1Y3RvIChjb24gZGVzY3VlbnRvIHNpIGFwbGljYSlcclxuICogQHBhcmFtIHByb2R1Y3QgLSBQcm9kdWN0b1xyXG4gKiBAcmV0dXJucyBudW1iZXIgLSBQcmVjaW8gZmluYWxcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRGaW5hbFByaWNlKHByb2R1Y3Q6IFByb2R1Y3QgfCBQcm9kdWN0V2l0aENhdGVnb3J5KTogbnVtYmVyIHtcclxuICBpZiAoJ2Rpc2NvdW50ZWRQcmljZScgaW4gcHJvZHVjdCkge1xyXG4gICAgcmV0dXJuIHByb2R1Y3QuZGlzY291bnRlZFByaWNlO1xyXG4gIH1cclxuICByZXR1cm4gcHJvZHVjdC5kaXNjb3VudGVkX3ByaWNlID8/IHByb2R1Y3QucHJpY2U7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBPYnRpZW5lIGxhIGltYWdlbiBwcmluY2lwYWwgZGVsIHByb2R1Y3RvXHJcbiAqIEBwYXJhbSBwcm9kdWN0IC0gUHJvZHVjdG9cclxuICogQHJldHVybnMgc3RyaW5nIC0gVVJMIGRlIGxhIGltYWdlblxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldE1haW5JbWFnZShwcm9kdWN0OiBQcm9kdWN0IHwgUHJvZHVjdFdpdGhDYXRlZ29yeSk6IHN0cmluZyB7XHJcbiAgaWYgKCdpbWdzJyBpbiBwcm9kdWN0ICYmIHByb2R1Y3QuaW1ncz8ucHJldmlld3M/LlswXSkge1xyXG4gICAgcmV0dXJuIHByb2R1Y3QuaW1ncy5wcmV2aWV3c1swXTtcclxuICB9XHJcbiAgaWYgKCdpbWFnZXMnIGluIHByb2R1Y3QgJiYgcHJvZHVjdC5pbWFnZXM/LnByZXZpZXdzPy5bMF0pIHtcclxuICAgIHJldHVybiBwcm9kdWN0LmltYWdlcy5wcmV2aWV3c1swXTtcclxuICB9XHJcbiAgcmV0dXJuICcvaW1hZ2VzL3Byb2R1Y3RzL3BsYWNlaG9sZGVyLnN2Zyc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBWYWxpZGEgeSBvYnRpZW5lIHVuYSBVUkwgZGUgaW1hZ2VuIHbDoWxpZGEsIG1hbmVqYW5kbyBjYWRlbmFzIHZhY8OtYXMgeSB1bmRlZmluZWRcclxuICogQHBhcmFtIGltYWdlVXJsIC0gVVJMIGRlIGltYWdlbiBhIHZhbGlkYXJcclxuICogQHBhcmFtIGZhbGxiYWNrIC0gVVJMIGRlIGZhbGxiYWNrIChwb3IgZGVmZWN0bzogcGxhY2Vob2xkZXIpXHJcbiAqIEByZXR1cm5zIHN0cmluZyAtIFVSTCBkZSBpbWFnZW4gdsOhbGlkYVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFZhbGlkSW1hZ2VVcmwoaW1hZ2VVcmw6IHN0cmluZyB8IHVuZGVmaW5lZCB8IG51bGwsIGZhbGxiYWNrOiBzdHJpbmcgPSAnL2ltYWdlcy9wcm9kdWN0cy9wbGFjZWhvbGRlci5zdmcnKTogc3RyaW5nIHtcclxuICAvLyBWZXJpZmljYXIgc2kgbGEgaW1hZ2VuIGV4aXN0ZSB5IG5vIGVzIHVuYSBjYWRlbmEgdmFjw61hIG8gc29sbyBlc3BhY2lvc1xyXG4gIGlmIChpbWFnZVVybCAmJiB0eXBlb2YgaW1hZ2VVcmwgPT09ICdzdHJpbmcnICYmIGltYWdlVXJsLnRyaW0oKSAhPT0gJycpIHtcclxuICAgIHJldHVybiBpbWFnZVVybC50cmltKCk7XHJcbiAgfVxyXG4gIHJldHVybiBmYWxsYmFjaztcclxufVxyXG5cclxuLyoqXHJcbiAqIE9idGllbmUgbGEgaW1hZ2VuIHRodW1ibmFpbCBkZWwgcHJvZHVjdG8gY29uIHZhbGlkYWNpw7NuIHJvYnVzdGFcclxuICogQHBhcmFtIHByb2R1Y3QgLSBQcm9kdWN0b1xyXG4gKiBAcmV0dXJucyBzdHJpbmcgLSBVUkwgZGUgbGEgaW1hZ2VuIHRodW1ibmFpbCB2w6FsaWRhXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGh1bWJuYWlsSW1hZ2UocHJvZHVjdDogUHJvZHVjdCB8IFByb2R1Y3RXaXRoQ2F0ZWdvcnkpOiBzdHJpbmcge1xyXG4gIGxldCBpbWFnZVVybDogc3RyaW5nIHwgdW5kZWZpbmVkO1xyXG5cclxuICBpZiAoJ2ltZ3MnIGluIHByb2R1Y3QgJiYgcHJvZHVjdC5pbWdzPy50aHVtYm5haWxzPy5bMF0pIHtcclxuICAgIGltYWdlVXJsID0gcHJvZHVjdC5pbWdzLnRodW1ibmFpbHNbMF07XHJcbiAgfSBlbHNlIGlmICgnaW1hZ2VzJyBpbiBwcm9kdWN0ICYmIHByb2R1Y3QuaW1hZ2VzPy50aHVtYm5haWxzPy5bMF0pIHtcclxuICAgIGltYWdlVXJsID0gcHJvZHVjdC5pbWFnZXMudGh1bWJuYWlsc1swXTtcclxuICB9XHJcblxyXG4gIHJldHVybiBnZXRWYWxpZEltYWdlVXJsKGltYWdlVXJsKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIE9idGllbmUgbGEgaW1hZ2VuIHByZXZpZXcgZGVsIHByb2R1Y3RvIGNvbiB2YWxpZGFjacOzbiByb2J1c3RhXHJcbiAqIEBwYXJhbSBwcm9kdWN0IC0gUHJvZHVjdG9cclxuICogQHJldHVybnMgc3RyaW5nIC0gVVJMIGRlIGxhIGltYWdlbiBwcmV2aWV3IHbDoWxpZGFcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRQcmV2aWV3SW1hZ2UocHJvZHVjdDogUHJvZHVjdCB8IFByb2R1Y3RXaXRoQ2F0ZWdvcnkpOiBzdHJpbmcge1xyXG4gIGxldCBpbWFnZVVybDogc3RyaW5nIHwgdW5kZWZpbmVkO1xyXG5cclxuICBpZiAoJ2ltZ3MnIGluIHByb2R1Y3QgJiYgcHJvZHVjdC5pbWdzPy5wcmV2aWV3cz8uWzBdKSB7XHJcbiAgICBpbWFnZVVybCA9IHByb2R1Y3QuaW1ncy5wcmV2aWV3c1swXTtcclxuICB9IGVsc2UgaWYgKCdpbWFnZXMnIGluIHByb2R1Y3QgJiYgcHJvZHVjdC5pbWFnZXM/LnByZXZpZXdzPy5bMF0pIHtcclxuICAgIGltYWdlVXJsID0gcHJvZHVjdC5pbWFnZXMucHJldmlld3NbMF07XHJcbiAgfVxyXG5cclxuICByZXR1cm4gZ2V0VmFsaWRJbWFnZVVybChpbWFnZVVybCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBGb3JtYXRlYSBlbCBwcmVjaW8gcGFyYSBtb3N0cmFyIGVuIHBlc29zIGFyZ2VudGlub3NcclxuICogQHBhcmFtIHByaWNlIC0gUHJlY2lvXHJcbiAqIEByZXR1cm5zIHN0cmluZyAtIFByZWNpbyBmb3JtYXRlYWRvXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0UHJpY2UocHJpY2U6IG51bWJlcik6IHN0cmluZyB7XHJcbiAgcmV0dXJuIG5ldyBJbnRsLk51bWJlckZvcm1hdCgnZXMtQVInLCB7XHJcbiAgICBzdHlsZTogJ2N1cnJlbmN5JyxcclxuICAgIGN1cnJlbmN5OiAnQVJTJyxcclxuICAgIG1pbmltdW1GcmFjdGlvbkRpZ2l0czogMCxcclxuICAgIG1heGltdW1GcmFjdGlvbkRpZ2l0czogMCxcclxuICB9KS5mb3JtYXQocHJpY2UpO1xyXG59XHJcblxyXG4vKipcclxuICogR2VuZXJhIHVuIHNsdWcgYSBwYXJ0aXIgZGVsIG5vbWJyZSBkZWwgcHJvZHVjdG9cclxuICogQHBhcmFtIG5hbWUgLSBOb21icmUgZGVsIHByb2R1Y3RvXHJcbiAqIEByZXR1cm5zIHN0cmluZyAtIFNsdWdcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVNsdWcobmFtZTogc3RyaW5nKTogc3RyaW5nIHtcclxuICByZXR1cm4gbmFtZVxyXG4gICAgLnRvTG93ZXJDYXNlKClcclxuICAgIC5ub3JtYWxpemUoJ05GRCcpXHJcbiAgICAucmVwbGFjZSgvW1xcdTAzMDAtXFx1MDM2Zl0vZywgJycpIC8vIFJlbW92ZXIgYWNlbnRvc1xyXG4gICAgLnJlcGxhY2UoL1teYS16MC05XFxzLV0vZywgJycpIC8vIFJlbW92ZXIgY2FyYWN0ZXJlcyBlc3BlY2lhbGVzXHJcbiAgICAucmVwbGFjZSgvXFxzKy9nLCAnLScpIC8vIFJlZW1wbGF6YXIgZXNwYWNpb3MgY29uIGd1aW9uZXNcclxuICAgIC5yZXBsYWNlKC8tKy9nLCAnLScpIC8vIFJlbW92ZXIgZ3Vpb25lcyBtw7psdGlwbGVzXHJcbiAgICAucmVwbGFjZSgvXi18LSQvZywgJycpOyAvLyBSZW1vdmVyIGd1aW9uZXMgYWwgaW5pY2lvIHkgZmluYWxcclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4iXSwibmFtZXMiOlsiYWRhcHRBcGlQcm9kdWN0VG9Db21wb25lbnQiLCJhZGFwdEFwaVByb2R1Y3RzVG9Db21wb25lbnRzIiwiYWRhcHRDb21wb25lbnRQcm9kdWN0VG9BcGkiLCJmb3JtYXRQcmljZSIsImdlbmVyYXRlU2x1ZyIsImdldERpc2NvdW50UGVyY2VudGFnZSIsImdldEZpbmFsUHJpY2UiLCJnZXRNYWluSW1hZ2UiLCJnZXRQcmV2aWV3SW1hZ2UiLCJnZXRUaHVtYm5haWxJbWFnZSIsImdldFZhbGlkSW1hZ2VVcmwiLCJoYXNEaXNjb3VudCIsImFwaVByb2R1Y3QiLCJpbWFnZXMiLCJpZCIsInRpdGxlIiwibmFtZSIsImJyYW5kIiwicmV2aWV3cyIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInByaWNlIiwiZGlzY291bnRlZFByaWNlIiwiZGlzY291bnRlZF9wcmljZSIsInVuZGVmaW5lZCIsImltZ3MiLCJ0aHVtYm5haWxzIiwidGh1bWJuYWlsIiwicHJldmlld3MiLCJtYWluIiwiZ2FsbGVyeSIsImFwaVByb2R1Y3RzIiwibWFwIiwiY29tcG9uZW50UHJvZHVjdCIsInN0b2NrIiwicHJvZHVjdCIsIm9yaWdpbmFsUHJpY2UiLCJyb3VuZCIsImltYWdlVXJsIiwiZmFsbGJhY2siLCJ0cmltIiwiSW50bCIsIk51bWJlckZvcm1hdCIsInN0eWxlIiwiY3VycmVuY3kiLCJtaW5pbXVtRnJhY3Rpb25EaWdpdHMiLCJtYXhpbXVtRnJhY3Rpb25EaWdpdHMiLCJmb3JtYXQiLCJ0b0xvd2VyQ2FzZSIsIm5vcm1hbGl6ZSIsInJlcGxhY2UiXSwibWFwcGluZ3MiOiJBQUFBLHNDQUFzQztBQUN0Qyw4Q0FBOEM7QUFDOUMsc0NBQXNDOzs7Ozs7Ozs7Ozs7UUFVdEJBO2VBQUFBOztRQTRCQUM7ZUFBQUE7O1FBU0FDO2VBQUFBOztRQW9JQUM7ZUFBQUE7O1FBY0FDO2VBQUFBOztRQWpIQUM7ZUFBQUE7O1FBd0JBQztlQUFBQTs7UUFZQUM7ZUFBQUE7O1FBOENBQztlQUFBQTs7UUFqQkFDO2VBQUFBOztRQWJBQztlQUFBQTs7UUFuRUFDO2VBQUFBOzs7QUF2RFQsU0FBU1gsMkJBQTJCWSxVQUErQjtJQUN4RSw2RkFBNkY7SUFDN0YsTUFBTUMsU0FBU0QsV0FBV0MsTUFBTSxJQUFJLENBQUM7SUFFckMsT0FBTztRQUNMQyxJQUFJRixXQUFXRSxFQUFFO1FBQ2pCQyxPQUFPSCxXQUFXSSxJQUFJO1FBQ3RCQSxNQUFNSixXQUFXSSxJQUFJO1FBQ3JCQyxPQUFPTCxXQUFXSyxLQUFLO1FBQ3ZCQyxTQUFTQyxLQUFLQyxLQUFLLENBQUNELEtBQUtFLE1BQU0sS0FBSyxNQUFNO1FBQzFDQyxPQUFP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