{"version":3,"names":["cov_9r7or87j1","actualCoverage","s","useSalesReports","f","salesData","setSalesData","_react","useState","isLoading","setIsLoading","error","setError","filters","setFiltersState","startDate","Date","now","toISOString","split","endDate","fetchSalesData","useCallback","queryParams","URLSearchParams","b","category","status","response","fetch","ok","Error","data","json","err","errorMessage","message","_usetoast","toast","title","description","variant","setFilters","newFilters","prev","refreshData","exportReport","format","blob","url","window","URL","createObjectURL","a","document","createElement","href","download","body","appendChild","click","revokeObjectURL","removeChild","generateCustomReport","config","method","headers","JSON","stringify","useEffect"],"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\hooks\\admin\\useSalesReports.ts"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect, useCallback } from 'react'\r\nimport { toast } from '@/components/ui/use-toast'\r\n\r\nexport interface SalesData {\r\n  id: string\r\n  date: string\r\n  totalSales: number\r\n  totalOrders: number\r\n  averageOrderValue: number\r\n  topProducts: Array<{\r\n    id: string\r\n    name: string\r\n    sales: number\r\n    revenue: number\r\n  }>\r\n  salesByCategory: Array<{\r\n    category: string\r\n    sales: number\r\n    percentage: number\r\n  }>\r\n}\r\n\r\nexport interface SalesFilters {\r\n  startDate: string\r\n  endDate: string\r\n  category?: string\r\n  status?: 'completed' | 'pending' | 'cancelled'\r\n}\r\n\r\nexport interface UseSalesReportsReturn {\r\n  salesData: SalesData | null\r\n  isLoading: boolean\r\n  error: string | null\r\n  filters: SalesFilters\r\n  setFilters: (filters: Partial<SalesFilters>) => void\r\n  refreshData: () => Promise<void>\r\n  exportReport: (format: 'csv' | 'pdf' | 'excel') => Promise<void>\r\n  generateCustomReport: (config: any) => Promise<void>\r\n}\r\n\r\nexport function useSalesReports(): UseSalesReportsReturn {\r\n  const [salesData, setSalesData] = useState<SalesData | null>(null)\r\n  const [isLoading, setIsLoading] = useState(false)\r\n  const [error, setError] = useState<string | null>(null)\r\n  const [filters, setFiltersState] = useState<SalesFilters>({\r\n    startDate: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\r\n    endDate: new Date().toISOString().split('T')[0]\r\n  })\r\n\r\n  const fetchSalesData = useCallback(async () => {\r\n    setIsLoading(true)\r\n    setError(null)\r\n\r\n    try {\r\n      const queryParams = new URLSearchParams({\r\n        startDate: filters.startDate,\r\n        endDate: filters.endDate,\r\n        ...(filters.category && { category: filters.category }),\r\n        ...(filters.status && { status: filters.status })\r\n      })\r\n\r\n      const response = await fetch(`/api/admin/sales/reports?${queryParams}`)\r\n      \r\n      if (!response.ok) {\r\n        throw new Error('Error al obtener datos de ventas')\r\n      }\r\n\r\n      const data = await response.json()\r\n      setSalesData(data)\r\n    } catch (err) {\r\n      const errorMessage = err instanceof Error ? err.message : 'Error desconocido'\r\n      setError(errorMessage)\r\n      toast({\r\n        title: 'Error',\r\n        description: errorMessage,\r\n        variant: 'destructive'\r\n      })\r\n    } finally {\r\n      setIsLoading(false)\r\n    }\r\n  }, [filters])\r\n\r\n  const setFilters = useCallback((newFilters: Partial<SalesFilters>) => {\r\n    setFiltersState(prev => ({ ...prev, ...newFilters }))\r\n  }, [])\r\n\r\n  const refreshData = useCallback(async () => {\r\n    await fetchSalesData()\r\n  }, [fetchSalesData])\r\n\r\n  const exportReport = useCallback(async (format: 'csv' | 'pdf' | 'excel') => {\r\n    try {\r\n      setIsLoading(true)\r\n      \r\n      const queryParams = new URLSearchParams({\r\n        ...filters,\r\n        format\r\n      })\r\n\r\n      const response = await fetch(`/api/admin/sales/export?${queryParams}`)\r\n      \r\n      if (!response.ok) {\r\n        throw new Error('Error al exportar reporte')\r\n      }\r\n\r\n      const blob = await response.blob()\r\n      const url = window.URL.createObjectURL(blob)\r\n      const a = document.createElement('a')\r\n      a.href = url\r\n      a.download = `sales-report-${filters.startDate}-${filters.endDate}.${format}`\r\n      document.body.appendChild(a)\r\n      a.click()\r\n      window.URL.revokeObjectURL(url)\r\n      document.body.removeChild(a)\r\n\r\n      toast({\r\n        title: 'Éxito',\r\n        description: 'Reporte exportado correctamente'\r\n      })\r\n    } catch (err) {\r\n      const errorMessage = err instanceof Error ? err.message : 'Error al exportar'\r\n      toast({\r\n        title: 'Error',\r\n        description: errorMessage,\r\n        variant: 'destructive'\r\n      })\r\n    } finally {\r\n      setIsLoading(false)\r\n    }\r\n  }, [filters])\r\n\r\n  const generateCustomReport = useCallback(async (config: any) => {\r\n    try {\r\n      setIsLoading(true)\r\n      \r\n      const response = await fetch('/api/admin/sales/custom-report', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({ ...config, filters })\r\n      })\r\n      \r\n      if (!response.ok) {\r\n        throw new Error('Error al generar reporte personalizado')\r\n      }\r\n\r\n      const data = await response.json()\r\n      setSalesData(data)\r\n\r\n      toast({\r\n        title: 'Éxito',\r\n        description: 'Reporte personalizado generado correctamente'\r\n      })\r\n    } catch (err) {\r\n      const errorMessage = err instanceof Error ? err.message : 'Error al generar reporte'\r\n      toast({\r\n        title: 'Error',\r\n        description: errorMessage,\r\n        variant: 'destructive'\r\n      })\r\n    } finally {\r\n      setIsLoading(false)\r\n    }\r\n  }, [filters])\r\n\r\n  useEffect(() => {\r\n    fetchSalesData()\r\n  }, [fetchSalesData])\r\n\r\n  return {\r\n    salesData,\r\n    isLoading,\r\n    error,\r\n    filters,\r\n    setFilters,\r\n    refreshData,\r\n    exportReport,\r\n    generateCustomReport\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}