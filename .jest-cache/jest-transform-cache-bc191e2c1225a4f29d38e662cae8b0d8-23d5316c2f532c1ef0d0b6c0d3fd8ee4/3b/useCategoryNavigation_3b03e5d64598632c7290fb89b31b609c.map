{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\hooks\\useCategoryNavigation.ts"],"sourcesContent":["/**\n * useCategoryNavigation Hook\n * Manages URL navigation for category filters\n * Pinteya E-commerce - Enterprise-ready implementation\n */\n\nimport React, { useCallback, useState, useMemo } from 'react'\nimport { useRouter, useSearchParams, usePathname } from 'next/navigation'\nimport type { CategoryId, UseCategoryNavigationReturn } from '@/types/categories'\n\n/**\n * Configuration options for the category navigation hook\n */\ninterface UseCategoryNavigationOptions {\n  /** URL parameter name for categories */\n  paramName?: string\n  /** Base path for navigation */\n  basePath?: string\n  /** Debounce delay for URL updates in milliseconds */\n  debounceDelay?: number\n  /** Whether to preserve other URL parameters */\n  preserveParams?: boolean\n  /** Callback when navigation starts */\n  onNavigationStart?: () => void\n  /** Callback when navigation completes */\n  onNavigationComplete?: () => void\n  /** Whether to enable analytics tracking */\n  enableAnalytics?: boolean\n}\n\n/**\n * Custom hook for managing category filter navigation\n *\n * Features:\n * - URL parameter management\n * - Debounced navigation\n * - State preservation\n * - Analytics tracking\n * - Performance optimization\n *\n * @param options Configuration options\n * @returns Navigation state and actions\n */\nexport const useCategoryNavigation = (\n  options: UseCategoryNavigationOptions = {}\n): UseCategoryNavigationReturn => {\n  const {\n    paramName = 'categories',\n    basePath = '/',\n    debounceDelay = 300,\n    preserveParams = true,\n    onNavigationStart,\n    onNavigationComplete,\n    enableAnalytics = true,\n  } = options\n\n  const router = useRouter()\n  const searchParams = useSearchParams()\n  const pathname = usePathname()\n\n  const [isNavigating, setIsNavigating] = useState(false)\n  const [debounceTimer, setDebounceTimer] = useState<NodeJS.Timeout | null>(null)\n\n  /**\n   * Track navigation analytics if enabled\n   */\n  const trackNavigation = useCallback(\n    (categories: CategoryId[], action: 'filter' | 'clear') => {\n      if (!enableAnalytics) {\n        return\n      }\n\n      // Track with analytics service\n      if (typeof window !== 'undefined' && window.gtag) {\n        window.gtag('event', 'category_navigation', {\n          event_category: 'navigation',\n          event_label: action,\n          value: categories.length,\n          custom_parameters: {\n            categories: categories.join(','),\n            path: pathname,\n          },\n        })\n      }\n\n      // Console log for development\n      if (process.env.NODE_ENV === 'development') {\n      }\n    },\n    [enableAnalytics, pathname]\n  )\n\n  /**\n   * Build URL with category parameters\n   */\n  const buildUrl = useCallback(\n    (categories: CategoryId[]): string => {\n      const params = new URLSearchParams()\n\n      // Preserve existing parameters if enabled\n      if (preserveParams) {\n        searchParams.forEach((value, key) => {\n          if (key !== paramName) {\n            params.set(key, value)\n          }\n        })\n      }\n\n      // Add categories parameter if there are categories\n      if (categories.length > 0) {\n        params.set(paramName, categories.join(','))\n      }\n\n      // Build final URL\n      const queryString = params.toString()\n      return queryString ? `${basePath}?${queryString}` : basePath\n    },\n    [basePath, paramName, preserveParams, searchParams]\n  )\n\n  /**\n   * Perform navigation with debouncing\n   */\n  const performNavigation = useCallback(\n    (url: string) => {\n      // Clear existing timer\n      if (debounceTimer) {\n        clearTimeout(debounceTimer)\n      }\n\n      // Set navigation state\n      setIsNavigating(true)\n      onNavigationStart?.()\n\n      // Debounced navigation\n      const timer = setTimeout(() => {\n        try {\n          router.push(url)\n\n          // Reset navigation state after a short delay\n          setTimeout(() => {\n            setIsNavigating(false)\n            onNavigationComplete?.()\n          }, 100)\n        } catch (error) {\n          console.error('Navigation error:', error)\n          setIsNavigating(false)\n          onNavigationComplete?.()\n        }\n      }, debounceDelay)\n\n      setDebounceTimer(timer)\n    },\n    [debounceTimer, debounceDelay, router, onNavigationStart, onNavigationComplete]\n  )\n\n  /**\n   * Navigate to filtered view with selected categories\n   */\n  const navigateToFiltered = useCallback(\n    (categories: CategoryId[]) => {\n      // Validate categories\n      const validCategories = categories.filter(\n        cat => typeof cat === 'string' && cat.trim().length > 0\n      )\n\n      // Build URL and navigate\n      const url = buildUrl(validCategories)\n      performNavigation(url)\n\n      // Track analytics\n      trackNavigation(validCategories, 'filter')\n    },\n    [buildUrl, performNavigation, trackNavigation]\n  )\n\n  /**\n   * Navigate to home (clear all filters)\n   */\n  const navigateToHome = useCallback(() => {\n    const url = buildUrl([])\n    performNavigation(url)\n\n    // Track analytics\n    trackNavigation([], 'clear')\n  }, [buildUrl, performNavigation, trackNavigation])\n\n  /**\n   * Get current URL with categories\n   */\n  const getCurrentUrl = useCallback((): string => {\n    const currentCategories = searchParams.get(paramName)\n    const categories = currentCategories ? currentCategories.split(',') : []\n    return buildUrl(categories)\n  }, [searchParams, paramName, buildUrl])\n\n  /**\n   * Get current categories from URL\n   */\n  const getCurrentCategories = useCallback((): CategoryId[] => {\n    const categoriesParam = searchParams.get(paramName)\n    return categoriesParam ? categoriesParam.split(',').filter(Boolean) : []\n  }, [searchParams, paramName])\n\n  /**\n   * Check if specific categories are currently active\n   */\n  const areCategoriesToActive = useCallback(\n    (categories: CategoryId[]): boolean => {\n      const currentCategories = getCurrentCategories()\n      return (\n        categories.every(cat => currentCategories.includes(cat)) &&\n        currentCategories.every(cat => categories.includes(cat))\n      )\n    },\n    [getCurrentCategories]\n  )\n\n  /**\n   * Cleanup effect for debounce timer\n   */\n  const cleanup = useCallback(() => {\n    if (debounceTimer) {\n      clearTimeout(debounceTimer)\n      setDebounceTimer(null)\n    }\n  }, [debounceTimer])\n\n  // Cleanup on unmount\n  React.useEffect(() => {\n    return cleanup\n  }, [cleanup])\n\n  /**\n   * Memoized return object for performance\n   */\n  const returnValue = useMemo(\n    (): UseCategoryNavigationReturn => ({\n      navigateToFiltered,\n      navigateToHome,\n      getCurrentUrl,\n      isNavigating,\n    }),\n    [navigateToFiltered, navigateToHome, getCurrentUrl, isNavigating]\n  )\n\n  return returnValue\n}\n\n/**\n * Utility function to extract categories from URL\n */\nexport const extractCategoriesFromUrl = (url: string, paramName = 'categories'): CategoryId[] => {\n  try {\n    const urlObj = new URL(url, window.location.origin)\n    const categoriesParam = urlObj.searchParams.get(paramName)\n    return categoriesParam ? categoriesParam.split(',').filter(Boolean) : []\n  } catch {\n    return []\n  }\n}\n\n/**\n * Utility function to check if URL has category filters\n */\nexport const hasCategories = (url: string, paramName = 'categories'): boolean => {\n  return extractCategoriesFromUrl(url, paramName).length > 0\n}\n\n/**\n * Default export for convenience\n */\nexport default useCategoryNavigation\n"],"names":["extractCategoriesFromUrl","hasCategories","useCategoryNavigation","options","paramName","basePath","debounceDelay","preserveParams","onNavigationStart","onNavigationComplete","enableAnalytics","router","useRouter","searchParams","useSearchParams","pathname","usePathname","isNavigating","setIsNavigating","useState","debounceTimer","setDebounceTimer","trackNavigation","useCallback","categories","action","window","gtag","event_category","event_label","value","length","custom_parameters","join","path","process","env","NODE_ENV","buildUrl","params","URLSearchParams","forEach","key","set","queryString","toString","performNavigation","url","clearTimeout","timer","setTimeout","push","error","console","navigateToFiltered","validCategories","filter","cat","trim","navigateToHome","getCurrentUrl","currentCategories","get","split","getCurrentCategories","categoriesParam","Boolean","areCategoriesToActive","every","includes","cleanup","React","useEffect","returnValue","useMemo","urlObj","URL","location","origin"],"mappings":"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"}