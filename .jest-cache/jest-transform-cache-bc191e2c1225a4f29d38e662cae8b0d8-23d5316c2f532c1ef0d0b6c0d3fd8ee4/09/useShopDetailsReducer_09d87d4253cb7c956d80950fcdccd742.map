{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\hooks\\optimization\\useShopDetailsReducer.ts"],"sourcesContent":["import { useReducer, useCallback, useMemo } from 'react';\r\n\r\n// Tipos para el estado del componente ShopDetails\r\ninterface ShopDetailsState {\r\n  activeColor: string;\r\n  previewImg: number;\r\n  storage: string;\r\n  type: string;\r\n  sim: string;\r\n  quantity: number;\r\n  activeTab: string;\r\n  isLoading: boolean;\r\n  error: string | null;\r\n}\r\n\r\n// Tipos de acciones\r\ntype ShopDetailsAction =\r\n  | { type: 'SET_ACTIVE_COLOR'; payload: string }\r\n  | { type: 'SET_PREVIEW_IMG'; payload: number }\r\n  | { type: 'SET_STORAGE'; payload: string }\r\n  | { type: 'SET_TYPE'; payload: string }\r\n  | { type: 'SET_SIM'; payload: string }\r\n  | { type: 'SET_QUANTITY'; payload: number }\r\n  | { type: 'SET_ACTIVE_TAB'; payload: string }\r\n  | { type: 'SET_LOADING'; payload: boolean }\r\n  | { type: 'SET_ERROR'; payload: string | null }\r\n  | { type: 'RESET_STATE' }\r\n  | { type: 'INCREMENT_QUANTITY' }\r\n  | { type: 'DECREMENT_QUANTITY' };\r\n\r\n// Estado inicial\r\nconst initialState: ShopDetailsState = {\r\n  activeColor: 'blanco-puro', // Usar ID del color por defecto\r\n  previewImg: 0,\r\n  storage: 'gb128',\r\n  type: 'active',\r\n  sim: 'dual',\r\n  quantity: 1,\r\n  activeTab: 'tabOne',\r\n  isLoading: false,\r\n  error: null,\r\n};\r\n\r\n// Reducer function\r\nfunction shopDetailsReducer(\r\n  state: ShopDetailsState,\r\n  action: ShopDetailsAction\r\n): ShopDetailsState {\r\n  switch (action.type) {\r\n    case 'SET_ACTIVE_COLOR':\r\n      return { ...state, activeColor: action.payload };\r\n    \r\n    case 'SET_PREVIEW_IMG':\r\n      return { ...state, previewImg: action.payload };\r\n    \r\n    case 'SET_STORAGE':\r\n      return { ...state, storage: action.payload };\r\n    \r\n    case 'SET_TYPE':\r\n      return { ...state, type: action.payload };\r\n    \r\n    case 'SET_SIM':\r\n      return { ...state, sim: action.payload };\r\n    \r\n    case 'SET_QUANTITY':\r\n      return { \r\n        ...state, \r\n        quantity: Math.max(1, Math.min(99, action.payload)) // Límites de cantidad\r\n      };\r\n    \r\n    case 'SET_ACTIVE_TAB':\r\n      return { ...state, activeTab: action.payload };\r\n    \r\n    case 'SET_LOADING':\r\n      return { ...state, isLoading: action.payload };\r\n    \r\n    case 'SET_ERROR':\r\n      return { ...state, error: action.payload };\r\n    \r\n    case 'INCREMENT_QUANTITY':\r\n      return { \r\n        ...state, \r\n        quantity: Math.min(99, state.quantity + 1)\r\n      };\r\n    \r\n    case 'DECREMENT_QUANTITY':\r\n      return { \r\n        ...state, \r\n        quantity: Math.max(1, state.quantity - 1)\r\n      };\r\n    \r\n    case 'RESET_STATE':\r\n      return initialState;\r\n    \r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\n// Hook personalizado\r\nexport function useShopDetailsReducer() {\r\n  const [state, dispatch] = useReducer(shopDetailsReducer, initialState);\r\n\r\n  // Acciones memoizadas\r\n  const actions = useMemo(() => ({\r\n    setActiveColor: (color: string) => \r\n      dispatch({ type: 'SET_ACTIVE_COLOR', payload: color }),\r\n    \r\n    setPreviewImg: (index: number) => \r\n      dispatch({ type: 'SET_PREVIEW_IMG', payload: index }),\r\n    \r\n    setStorage: (storage: string) => \r\n      dispatch({ type: 'SET_STORAGE', payload: storage }),\r\n    \r\n    setType: (type: string) => \r\n      dispatch({ type: 'SET_TYPE', payload: type }),\r\n    \r\n    setSim: (sim: string) => \r\n      dispatch({ type: 'SET_SIM', payload: sim }),\r\n    \r\n    setQuantity: (quantity: number) => \r\n      dispatch({ type: 'SET_QUANTITY', payload: quantity }),\r\n    \r\n    setActiveTab: (tab: string) => \r\n      dispatch({ type: 'SET_ACTIVE_TAB', payload: tab }),\r\n    \r\n    setLoading: (loading: boolean) => \r\n      dispatch({ type: 'SET_LOADING', payload: loading }),\r\n    \r\n    setError: (error: string | null) => \r\n      dispatch({ type: 'SET_ERROR', payload: error }),\r\n    \r\n    incrementQuantity: () => \r\n      dispatch({ type: 'INCREMENT_QUANTITY' }),\r\n    \r\n    decrementQuantity: () => \r\n      dispatch({ type: 'DECREMENT_QUANTITY' }),\r\n    \r\n    resetState: () => \r\n      dispatch({ type: 'RESET_STATE' }),\r\n  }), []);\r\n\r\n  // Selectores memoizados para valores derivados\r\n  const selectors = useMemo(() => ({\r\n    // Verificar si hay errores\r\n    hasError: Boolean(state.error),\r\n    \r\n    // Verificar si está en estado de carga\r\n    isLoading: state.isLoading,\r\n    \r\n    // Obtener configuración actual del producto\r\n    currentConfig: {\r\n      color: state.activeColor,\r\n      storage: state.storage,\r\n      type: state.type,\r\n      sim: state.sim,\r\n      quantity: state.quantity,\r\n    },\r\n    \r\n    // Verificar si la cantidad está en el límite\r\n    isMaxQuantity: state.quantity >= 99,\r\n    isMinQuantity: state.quantity <= 1,\r\n    \r\n    // Obtener precio total basado en cantidad\r\n    getTotalPrice: (unitPrice: number) => unitPrice * state.quantity,\r\n  }), [state]);\r\n\r\n  return {\r\n    state,\r\n    actions,\r\n    selectors,\r\n  };\r\n}\r\n\r\n// Hook para manejar la persistencia en localStorage\r\nexport function useShopDetailsWithPersistence(productId?: string) {\r\n  const { state, actions, selectors } = useShopDetailsReducer();\r\n  \r\n  // Callbacks memoizados para persistencia\r\n  const persistenceActions = useMemo(() => ({\r\n    saveToStorage: useCallback(() => {\r\n      if (productId) {\r\n        const key = `shop-details-${productId}`;\r\n        localStorage.setItem(key, JSON.stringify(state));\r\n      }\r\n    }, [state, productId]),\r\n    \r\n    loadFromStorage: useCallback(() => {\r\n      if (productId) {\r\n        const key = `shop-details-${productId}`;\r\n        const saved = localStorage.getItem(key);\r\n        if (saved) {\r\n          try {\r\n            const parsedState = JSON.parse(saved);\r\n            // Restaurar estado desde localStorage\r\n            Object.entries(parsedState).forEach(([key, value]) => {\r\n              switch (key) {\r\n                case 'activeColor':\r\n                  actions.setActiveColor(value as string);\r\n                  break;\r\n                case 'storage':\r\n                  actions.setStorage(value as string);\r\n                  break;\r\n                case 'type':\r\n                  actions.setType(value as string);\r\n                  break;\r\n                case 'sim':\r\n                  actions.setSim(value as string);\r\n                  break;\r\n                case 'quantity':\r\n                  actions.setQuantity(value as number);\r\n                  break;\r\n              }\r\n            });\r\n          } catch (error) {\r\n            console.warn('Error loading shop details from storage:', error);\r\n          }\r\n        }\r\n      }\r\n    }, [productId, actions]),\r\n  }), [state, productId, actions]);\r\n\r\n  return {\r\n    state,\r\n    actions,\r\n    selectors,\r\n    persistenceActions,\r\n  };\r\n}\r\n\r\nexport type { ShopDetailsState, ShopDetailsAction };\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":["useShopDetailsReducer","useShopDetailsWithPersistence","initialState","activeColor","previewImg","storage","type","sim","quantity","activeTab","isLoading","error","shopDetailsReducer","state","action","payload","Math","max","min","dispatch","useReducer","actions","useMemo","setActiveColor","color","setPreviewImg","index","setStorage","setType","setSim","setQuantity","setActiveTab","tab","setLoading","loading","setError","incrementQuantity","decrementQuantity","resetState","selectors","hasError","Boolean","currentConfig","isMaxQuantity","isMinQuantity","getTotalPrice","unitPrice","productId","persistenceActions","saveToStorage","useCallback","key","localStorage","setItem","JSON","stringify","loadFromStorage","saved","getItem","parsedState","parse","Object","entries","forEach","value","console","warn"],"mappings":"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"}