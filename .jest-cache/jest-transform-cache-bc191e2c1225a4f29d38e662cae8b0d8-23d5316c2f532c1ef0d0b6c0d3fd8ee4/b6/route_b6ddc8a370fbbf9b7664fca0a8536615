52a8d9b2c7bba2366fd2fb3a3c253706
// Configuración para Node.js Runtime
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get OPTIONS () {
        return OPTIONS;
    },
    get POST () {
        return POST;
    },
    get runtime () {
        return runtime;
    }
});
const _server = require("next/server");
const _zod = require("zod");
const _ratelimiter = require("../../../../lib/rate-limiting/rate-limiter");
const _securitylogger = require("../../../../lib/logging/security-logger");
const runtime = 'nodejs';
// Schema de validación para checkout
const checkoutValidationSchema = _zod.z.object({
    customerInfo: _zod.z.object({
        firstName: _zod.z.string().min(1, 'Nombre es requerido'),
        lastName: _zod.z.string().min(1, 'Apellido es requerido'),
        email: _zod.z.string().email('Email inválido'),
        phone: _zod.z.string().min(8, 'Teléfono debe tener al menos 8 dígitos')
    }),
    shippingAddress: _zod.z.object({
        streetAddress: _zod.z.string().min(5, 'Dirección debe tener al menos 5 caracteres'),
        apartment: _zod.z.string().optional(),
        city: _zod.z.string().min(2, 'Ciudad es requerida'),
        state: _zod.z.string().min(2, 'Provincia es requerida'),
        zipCode: _zod.z.string().min(4, 'Código postal inválido'),
        country: _zod.z.string().default('Argentina'),
        observations: _zod.z.string().optional()
    }),
    items: _zod.z.array(_zod.z.object({
        id: _zod.z.string(),
        name: _zod.z.string(),
        price: _zod.z.number().positive('Precio debe ser positivo'),
        quantity: _zod.z.number().int().positive('Cantidad debe ser positiva'),
        stock: _zod.z.number().int().nonnegative().optional()
    })).min(1, 'Debe haber al menos un producto'),
    paymentMethod: _zod.z.enum([
        'mercadopago',
        'bank',
        'cash'
    ]),
    shippingMethod: _zod.z.enum([
        'free',
        'express',
        'pickup'
    ]),
    totals: _zod.z.object({
        subtotal: _zod.z.number().nonnegative(),
        shipping: _zod.z.number().nonnegative(),
        discount: _zod.z.number().nonnegative().default(0),
        total: _zod.z.number().positive('Total debe ser mayor a 0')
    })
});
async function POST(request) {
    // Crear logger de seguridad con contexto
    const securityLogger = (0, _securitylogger.createSecurityLogger)(request);
    // Aplicar rate limiting para APIs de checkout
    const rateLimitResult = await (0, _ratelimiter.withRateLimit)(request, _ratelimiter.RATE_LIMIT_CONFIGS.checkout, async ()=>{
        // Log de acceso a la API
        securityLogger.log({
            type: 'api_access',
            endpoint: '/api/checkout/validate',
            method: 'POST',
            userAgent: request.headers.get('user-agent'),
            timestamp: new Date().toISOString()
        });
        try {
            const body = await request.json();
            // Validar estructura básica
            const validatedData = checkoutValidationSchema.parse(body);
            const validationResults = {
                isValid: true,
                errors: [],
                warnings: [],
                suggestions: []
            };
            // Validaciones adicionales de negocio
            // 1. Validar stock de productos (simulado)
            for (const item of validatedData.items){
                const simulatedStock = Math.floor(Math.random() * 100) + 10 // Stock simulado
                ;
                if (item.quantity > simulatedStock) {
                    validationResults.errors.push(`Producto "${item.name}": Stock insuficiente (disponible: ${simulatedStock}, solicitado: ${item.quantity})`);
                    validationResults.isValid = false;
                }
            }
            // 2. Validar totales
            const calculatedSubtotal = validatedData.items.reduce((sum, item)=>sum + item.price * item.quantity, 0);
            if (Math.abs(calculatedSubtotal - validatedData.totals.subtotal) > 0.01) {
                validationResults.errors.push(`Subtotal incorrecto. Calculado: $${calculatedSubtotal}, Recibido: $${validatedData.totals.subtotal}`);
                validationResults.isValid = false;
            }
            // 3. Validar costo de envío
            const expectedShipping = calculateShippingCost(validatedData.shippingMethod, validatedData.totals.subtotal, validatedData.shippingAddress.state);
            if (Math.abs(expectedShipping - validatedData.totals.shipping) > 0.01) {
                validationResults.errors.push(`Costo de envío incorrecto. Esperado: $${expectedShipping}, Recibido: $${validatedData.totals.shipping}`);
                validationResults.isValid = false;
            }
            // 4. Validar total final
            const expectedTotal = calculatedSubtotal + expectedShipping - validatedData.totals.discount;
            if (Math.abs(expectedTotal - validatedData.totals.total) > 0.01) {
                validationResults.errors.push(`Total incorrecto. Esperado: $${expectedTotal}, Recibido: $${validatedData.totals.total}`);
                validationResults.isValid = false;
            }
            // 5. Validaciones de dirección
            if (validatedData.shippingAddress.state === 'CABA' && !validatedData.shippingAddress.zipCode.startsWith('C')) {
                validationResults.warnings.push('El código postal no parece corresponder a CABA');
            }
            // 6. Sugerencias basadas en observaciones
            if (validatedData.shippingAddress.observations) {
                const obs = validatedData.shippingAddress.observations.toLowerCase();
                if (obs.includes('barrio') || obs.includes('zona')) {
                    validationResults.suggestions.push('Excelente! Las observaciones sobre el barrio ayudarán al delivery');
                }
                if (obs.includes('horario') || obs.includes('hora')) {
                    validationResults.suggestions.push('Perfecto! Los horarios especificados facilitarán la entrega');
                }
            } else {
                validationResults.suggestions.push('Considera agregar observaciones sobre el barrio o horarios preferidos para mejorar la entrega');
            }
            // 7. Validar método de pago
            if (validatedData.paymentMethod === 'bank' && validatedData.totals.total < 10000) {
                validationResults.warnings.push('Para montos menores a $10.000, recomendamos MercadoPago para mayor comodidad');
            }
            // Log de validación
            console.log('✅ Validación de checkout:', {
                customer: `${validatedData.customerInfo.firstName} ${validatedData.customerInfo.lastName}`,
                items: validatedData.items.length,
                total: validatedData.totals.total,
                isValid: validationResults.isValid,
                errors: validationResults.errors.length,
                warnings: validationResults.warnings.length,
                observations: validatedData.shippingAddress.observations ? 'Sí' : 'No'
            });
            const response = {
                success: true,
                data: {
                    validation: validationResults,
                    estimatedDelivery: calculateEstimatedDelivery(validatedData.shippingMethod),
                    recommendedActions: generateRecommendations(validatedData, validationResults)
                },
                message: validationResults.isValid ? 'Checkout válido' : 'Checkout con errores'
            };
            // Log de validación exitosa
            securityLogger.log({
                type: 'checkout_validation',
                isValid: validationResults.isValid,
                errorsCount: validationResults.errors.length,
                warningsCount: validationResults.warnings.length,
                total: validatedData.totals.total,
                paymentMethod: validatedData.paymentMethod
            });
            return _server.NextResponse.json(response, {
                status: validationResults.isValid ? 200 : 400
            });
        } catch (error) {
            console.error('❌ Error validando checkout:', error);
            // Log de error de seguridad
            securityLogger.logApiError(error instanceof Error ? error.message : 'Unknown error', '/api/checkout/validate');
            if (error instanceof _zod.z.ZodError) {
                return _server.NextResponse.json({
                    success: false,
                    error: 'Datos de entrada inválidos',
                    details: error.errors.map((err)=>({
                            field: err.path.join('.'),
                            message: err.message
                        }))
                }, {
                    status: 400
                });
            }
            return _server.NextResponse.json({
                success: false,
                error: 'Error interno del servidor'
            }, {
                status: 500
            });
        }
    });
    // Manejar rate limit excedido
    if (rateLimitResult instanceof _server.NextResponse) {
        securityLogger.logRateLimitExceeded(securityLogger.context, {
            endpoint: '/api/checkout/validate',
            method: 'POST'
        });
        return rateLimitResult;
    }
    return rateLimitResult;
}
// Función auxiliar para calcular costo de envío
function calculateShippingCost(method, subtotal, state) {
    if (method === 'pickup') {
        return 0;
    }
    if (method === 'free' && subtotal >= 25000) {
        return 0;
    }
    const baseCost = method === 'express' ? 5000 : 2500;
    // Costo adicional por provincia
    const stateSurcharge = state === 'CABA' ? 0 : 500;
    return baseCost + stateSurcharge;
}
// Función auxiliar para calcular fecha estimada de entrega
function calculateEstimatedDelivery(shippingMethod) {
    const now = new Date();
    let daysToAdd = 7;
    switch(shippingMethod){
        case 'express':
            daysToAdd = 2;
            break;
        case 'free':
            daysToAdd = 7;
            break;
        case 'pickup':
            daysToAdd = 1;
            break;
    }
    const estimatedDate = new Date(now.getTime() + daysToAdd * 24 * 60 * 60 * 1000);
    return estimatedDate.toISOString().split('T')[0] // Solo fecha
    ;
}
// Función auxiliar para generar recomendaciones
function generateRecommendations(data, validation) {
    const recommendations = [];
    if (!validation.isValid) {
        recommendations.push('Corrige los errores antes de continuar');
    }
    if (data.totals.total > 50000) {
        recommendations.push('Considera dividir la compra en múltiples órdenes para mayor seguridad');
    }
    if (data.paymentMethod === 'cash' && data.totals.total > 30000) {
        recommendations.push('Para montos altos, recomendamos pago digital por seguridad');
    }
    if (!data.shippingAddress.observations) {
        recommendations.push('Agrega observaciones para facilitar la entrega');
    }
    return recommendations;
}
async function OPTIONS() {
    return new _server.NextResponse(null, {
        status: 200,
        headers: {
            'Access-Control-Allow-Origin': '*',
            'Access-Control-Allow-Methods': 'POST, OPTIONS',
            'Access-Control-Allow-Headers': 'Content-Type, Authorization'
        }
    });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcYXBwXFxhcGlcXGNoZWNrb3V0XFx2YWxpZGF0ZVxccm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29uZmlndXJhY2nDs24gcGFyYSBOb2RlLmpzIFJ1bnRpbWVcbmV4cG9ydCBjb25zdCBydW50aW1lID0gJ25vZGVqcydcblxuaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCdcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIE1FSk9SQVMgREUgU0VHVVJJREFEIC0gQUxUQSBQUklPUklEQURcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5pbXBvcnQgeyB3aXRoUmF0ZUxpbWl0LCBSQVRFX0xJTUlUX0NPTkZJR1MgfSBmcm9tICdAL2xpYi9yYXRlLWxpbWl0aW5nL3JhdGUtbGltaXRlcidcbmltcG9ydCB7IEFQSV9USU1FT1VUUywgd2l0aERhdGFiYXNlVGltZW91dCwgZ2V0RW5kcG9pbnRUaW1lb3V0cyB9IGZyb20gJ0AvbGliL2NvbmZpZy9hcGktdGltZW91dHMnXG5pbXBvcnQgeyBjcmVhdGVTZWN1cml0eUxvZ2dlciB9IGZyb20gJ0AvbGliL2xvZ2dpbmcvc2VjdXJpdHktbG9nZ2VyJ1xuXG4vLyBTY2hlbWEgZGUgdmFsaWRhY2nDs24gcGFyYSBjaGVja291dFxuY29uc3QgY2hlY2tvdXRWYWxpZGF0aW9uU2NoZW1hID0gei5vYmplY3Qoe1xuICBjdXN0b21lckluZm86IHoub2JqZWN0KHtcbiAgICBmaXJzdE5hbWU6IHouc3RyaW5nKCkubWluKDEsICdOb21icmUgZXMgcmVxdWVyaWRvJyksXG4gICAgbGFzdE5hbWU6IHouc3RyaW5nKCkubWluKDEsICdBcGVsbGlkbyBlcyByZXF1ZXJpZG8nKSxcbiAgICBlbWFpbDogei5zdHJpbmcoKS5lbWFpbCgnRW1haWwgaW52w6FsaWRvJyksXG4gICAgcGhvbmU6IHouc3RyaW5nKCkubWluKDgsICdUZWzDqWZvbm8gZGViZSB0ZW5lciBhbCBtZW5vcyA4IGTDrWdpdG9zJyksXG4gIH0pLFxuICBzaGlwcGluZ0FkZHJlc3M6IHoub2JqZWN0KHtcbiAgICBzdHJlZXRBZGRyZXNzOiB6LnN0cmluZygpLm1pbig1LCAnRGlyZWNjacOzbiBkZWJlIHRlbmVyIGFsIG1lbm9zIDUgY2FyYWN0ZXJlcycpLFxuICAgIGFwYXJ0bWVudDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgIGNpdHk6IHouc3RyaW5nKCkubWluKDIsICdDaXVkYWQgZXMgcmVxdWVyaWRhJyksXG4gICAgc3RhdGU6IHouc3RyaW5nKCkubWluKDIsICdQcm92aW5jaWEgZXMgcmVxdWVyaWRhJyksXG4gICAgemlwQ29kZTogei5zdHJpbmcoKS5taW4oNCwgJ0PDs2RpZ28gcG9zdGFsIGludsOhbGlkbycpLFxuICAgIGNvdW50cnk6IHouc3RyaW5nKCkuZGVmYXVsdCgnQXJnZW50aW5hJyksXG4gICAgb2JzZXJ2YXRpb25zOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIH0pLFxuICBpdGVtczogelxuICAgIC5hcnJheShcbiAgICAgIHoub2JqZWN0KHtcbiAgICAgICAgaWQ6IHouc3RyaW5nKCksXG4gICAgICAgIG5hbWU6IHouc3RyaW5nKCksXG4gICAgICAgIHByaWNlOiB6Lm51bWJlcigpLnBvc2l0aXZlKCdQcmVjaW8gZGViZSBzZXIgcG9zaXRpdm8nKSxcbiAgICAgICAgcXVhbnRpdHk6IHoubnVtYmVyKCkuaW50KCkucG9zaXRpdmUoJ0NhbnRpZGFkIGRlYmUgc2VyIHBvc2l0aXZhJyksXG4gICAgICAgIHN0b2NrOiB6Lm51bWJlcigpLmludCgpLm5vbm5lZ2F0aXZlKCkub3B0aW9uYWwoKSxcbiAgICAgIH0pXG4gICAgKVxuICAgIC5taW4oMSwgJ0RlYmUgaGFiZXIgYWwgbWVub3MgdW4gcHJvZHVjdG8nKSxcbiAgcGF5bWVudE1ldGhvZDogei5lbnVtKFsnbWVyY2Fkb3BhZ28nLCAnYmFuaycsICdjYXNoJ10pLFxuICBzaGlwcGluZ01ldGhvZDogei5lbnVtKFsnZnJlZScsICdleHByZXNzJywgJ3BpY2t1cCddKSxcbiAgdG90YWxzOiB6Lm9iamVjdCh7XG4gICAgc3VidG90YWw6IHoubnVtYmVyKCkubm9ubmVnYXRpdmUoKSxcbiAgICBzaGlwcGluZzogei5udW1iZXIoKS5ub25uZWdhdGl2ZSgpLFxuICAgIGRpc2NvdW50OiB6Lm51bWJlcigpLm5vbm5lZ2F0aXZlKCkuZGVmYXVsdCgwKSxcbiAgICB0b3RhbDogei5udW1iZXIoKS5wb3NpdGl2ZSgnVG90YWwgZGViZSBzZXIgbWF5b3IgYSAwJyksXG4gIH0pLFxufSlcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgLy8gQ3JlYXIgbG9nZ2VyIGRlIHNlZ3VyaWRhZCBjb24gY29udGV4dG9cbiAgY29uc3Qgc2VjdXJpdHlMb2dnZXIgPSBjcmVhdGVTZWN1cml0eUxvZ2dlcihyZXF1ZXN0KVxuXG4gIC8vIEFwbGljYXIgcmF0ZSBsaW1pdGluZyBwYXJhIEFQSXMgZGUgY2hlY2tvdXRcbiAgY29uc3QgcmF0ZUxpbWl0UmVzdWx0ID0gYXdhaXQgd2l0aFJhdGVMaW1pdChyZXF1ZXN0LCBSQVRFX0xJTUlUX0NPTkZJR1MuY2hlY2tvdXQsIGFzeW5jICgpID0+IHtcbiAgICAvLyBMb2cgZGUgYWNjZXNvIGEgbGEgQVBJXG4gICAgc2VjdXJpdHlMb2dnZXIubG9nKHtcbiAgICAgIHR5cGU6ICdhcGlfYWNjZXNzJyxcbiAgICAgIGVuZHBvaW50OiAnL2FwaS9jaGVja291dC92YWxpZGF0ZScsXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIHVzZXJBZ2VudDogcmVxdWVzdC5oZWFkZXJzLmdldCgndXNlci1hZ2VudCcpLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgfSlcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcblxuICAgICAgLy8gVmFsaWRhciBlc3RydWN0dXJhIGLDoXNpY2FcbiAgICAgIGNvbnN0IHZhbGlkYXRlZERhdGEgPSBjaGVja291dFZhbGlkYXRpb25TY2hlbWEucGFyc2UoYm9keSlcblxuICAgICAgY29uc3QgdmFsaWRhdGlvblJlc3VsdHMgPSB7XG4gICAgICAgIGlzVmFsaWQ6IHRydWUsXG4gICAgICAgIGVycm9yczogW10gYXMgc3RyaW5nW10sXG4gICAgICAgIHdhcm5pbmdzOiBbXSBhcyBzdHJpbmdbXSxcbiAgICAgICAgc3VnZ2VzdGlvbnM6IFtdIGFzIHN0cmluZ1tdLFxuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGFjaW9uZXMgYWRpY2lvbmFsZXMgZGUgbmVnb2Npb1xuXG4gICAgICAvLyAxLiBWYWxpZGFyIHN0b2NrIGRlIHByb2R1Y3RvcyAoc2ltdWxhZG8pXG4gICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgdmFsaWRhdGVkRGF0YS5pdGVtcykge1xuICAgICAgICBjb25zdCBzaW11bGF0ZWRTdG9jayA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCkgKyAxMCAvLyBTdG9jayBzaW11bGFkb1xuICAgICAgICBpZiAoaXRlbS5xdWFudGl0eSA+IHNpbXVsYXRlZFN0b2NrKSB7XG4gICAgICAgICAgdmFsaWRhdGlvblJlc3VsdHMuZXJyb3JzLnB1c2goXG4gICAgICAgICAgICBgUHJvZHVjdG8gXCIke2l0ZW0ubmFtZX1cIjogU3RvY2sgaW5zdWZpY2llbnRlIChkaXNwb25pYmxlOiAke3NpbXVsYXRlZFN0b2NrfSwgc29saWNpdGFkbzogJHtpdGVtLnF1YW50aXR5fSlgXG4gICAgICAgICAgKVxuICAgICAgICAgIHZhbGlkYXRpb25SZXN1bHRzLmlzVmFsaWQgPSBmYWxzZVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIDIuIFZhbGlkYXIgdG90YWxlc1xuICAgICAgY29uc3QgY2FsY3VsYXRlZFN1YnRvdGFsID0gdmFsaWRhdGVkRGF0YS5pdGVtcy5yZWR1Y2UoXG4gICAgICAgIChzdW0sIGl0ZW0pID0+IHN1bSArIGl0ZW0ucHJpY2UgKiBpdGVtLnF1YW50aXR5LFxuICAgICAgICAwXG4gICAgICApXG5cbiAgICAgIGlmIChNYXRoLmFicyhjYWxjdWxhdGVkU3VidG90YWwgLSB2YWxpZGF0ZWREYXRhLnRvdGFscy5zdWJ0b3RhbCkgPiAwLjAxKSB7XG4gICAgICAgIHZhbGlkYXRpb25SZXN1bHRzLmVycm9ycy5wdXNoKFxuICAgICAgICAgIGBTdWJ0b3RhbCBpbmNvcnJlY3RvLiBDYWxjdWxhZG86ICQke2NhbGN1bGF0ZWRTdWJ0b3RhbH0sIFJlY2liaWRvOiAkJHt2YWxpZGF0ZWREYXRhLnRvdGFscy5zdWJ0b3RhbH1gXG4gICAgICAgIClcbiAgICAgICAgdmFsaWRhdGlvblJlc3VsdHMuaXNWYWxpZCA9IGZhbHNlXG4gICAgICB9XG5cbiAgICAgIC8vIDMuIFZhbGlkYXIgY29zdG8gZGUgZW52w61vXG4gICAgICBjb25zdCBleHBlY3RlZFNoaXBwaW5nID0gY2FsY3VsYXRlU2hpcHBpbmdDb3N0KFxuICAgICAgICB2YWxpZGF0ZWREYXRhLnNoaXBwaW5nTWV0aG9kLFxuICAgICAgICB2YWxpZGF0ZWREYXRhLnRvdGFscy5zdWJ0b3RhbCxcbiAgICAgICAgdmFsaWRhdGVkRGF0YS5zaGlwcGluZ0FkZHJlc3Muc3RhdGVcbiAgICAgIClcblxuICAgICAgaWYgKE1hdGguYWJzKGV4cGVjdGVkU2hpcHBpbmcgLSB2YWxpZGF0ZWREYXRhLnRvdGFscy5zaGlwcGluZykgPiAwLjAxKSB7XG4gICAgICAgIHZhbGlkYXRpb25SZXN1bHRzLmVycm9ycy5wdXNoKFxuICAgICAgICAgIGBDb3N0byBkZSBlbnbDrW8gaW5jb3JyZWN0by4gRXNwZXJhZG86ICQke2V4cGVjdGVkU2hpcHBpbmd9LCBSZWNpYmlkbzogJCR7dmFsaWRhdGVkRGF0YS50b3RhbHMuc2hpcHBpbmd9YFxuICAgICAgICApXG4gICAgICAgIHZhbGlkYXRpb25SZXN1bHRzLmlzVmFsaWQgPSBmYWxzZVxuICAgICAgfVxuXG4gICAgICAvLyA0LiBWYWxpZGFyIHRvdGFsIGZpbmFsXG4gICAgICBjb25zdCBleHBlY3RlZFRvdGFsID0gY2FsY3VsYXRlZFN1YnRvdGFsICsgZXhwZWN0ZWRTaGlwcGluZyAtIHZhbGlkYXRlZERhdGEudG90YWxzLmRpc2NvdW50XG4gICAgICBpZiAoTWF0aC5hYnMoZXhwZWN0ZWRUb3RhbCAtIHZhbGlkYXRlZERhdGEudG90YWxzLnRvdGFsKSA+IDAuMDEpIHtcbiAgICAgICAgdmFsaWRhdGlvblJlc3VsdHMuZXJyb3JzLnB1c2goXG4gICAgICAgICAgYFRvdGFsIGluY29ycmVjdG8uIEVzcGVyYWRvOiAkJHtleHBlY3RlZFRvdGFsfSwgUmVjaWJpZG86ICQke3ZhbGlkYXRlZERhdGEudG90YWxzLnRvdGFsfWBcbiAgICAgICAgKVxuICAgICAgICB2YWxpZGF0aW9uUmVzdWx0cy5pc1ZhbGlkID0gZmFsc2VcbiAgICAgIH1cblxuICAgICAgLy8gNS4gVmFsaWRhY2lvbmVzIGRlIGRpcmVjY2nDs25cbiAgICAgIGlmIChcbiAgICAgICAgdmFsaWRhdGVkRGF0YS5zaGlwcGluZ0FkZHJlc3Muc3RhdGUgPT09ICdDQUJBJyAmJlxuICAgICAgICAhdmFsaWRhdGVkRGF0YS5zaGlwcGluZ0FkZHJlc3MuemlwQ29kZS5zdGFydHNXaXRoKCdDJylcbiAgICAgICkge1xuICAgICAgICB2YWxpZGF0aW9uUmVzdWx0cy53YXJuaW5ncy5wdXNoKCdFbCBjw7NkaWdvIHBvc3RhbCBubyBwYXJlY2UgY29ycmVzcG9uZGVyIGEgQ0FCQScpXG4gICAgICB9XG5cbiAgICAgIC8vIDYuIFN1Z2VyZW5jaWFzIGJhc2FkYXMgZW4gb2JzZXJ2YWNpb25lc1xuICAgICAgaWYgKHZhbGlkYXRlZERhdGEuc2hpcHBpbmdBZGRyZXNzLm9ic2VydmF0aW9ucykge1xuICAgICAgICBjb25zdCBvYnMgPSB2YWxpZGF0ZWREYXRhLnNoaXBwaW5nQWRkcmVzcy5vYnNlcnZhdGlvbnMudG9Mb3dlckNhc2UoKVxuICAgICAgICBpZiAob2JzLmluY2x1ZGVzKCdiYXJyaW8nKSB8fCBvYnMuaW5jbHVkZXMoJ3pvbmEnKSkge1xuICAgICAgICAgIHZhbGlkYXRpb25SZXN1bHRzLnN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgICAnRXhjZWxlbnRlISBMYXMgb2JzZXJ2YWNpb25lcyBzb2JyZSBlbCBiYXJyaW8gYXl1ZGFyw6FuIGFsIGRlbGl2ZXJ5J1xuICAgICAgICAgIClcbiAgICAgICAgfVxuICAgICAgICBpZiAob2JzLmluY2x1ZGVzKCdob3JhcmlvJykgfHwgb2JzLmluY2x1ZGVzKCdob3JhJykpIHtcbiAgICAgICAgICB2YWxpZGF0aW9uUmVzdWx0cy5zdWdnZXN0aW9ucy5wdXNoKFxuICAgICAgICAgICAgJ1BlcmZlY3RvISBMb3MgaG9yYXJpb3MgZXNwZWNpZmljYWRvcyBmYWNpbGl0YXLDoW4gbGEgZW50cmVnYSdcbiAgICAgICAgICApXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhbGlkYXRpb25SZXN1bHRzLnN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgJ0NvbnNpZGVyYSBhZ3JlZ2FyIG9ic2VydmFjaW9uZXMgc29icmUgZWwgYmFycmlvIG8gaG9yYXJpb3MgcHJlZmVyaWRvcyBwYXJhIG1lam9yYXIgbGEgZW50cmVnYSdcbiAgICAgICAgKVxuICAgICAgfVxuXG4gICAgICAvLyA3LiBWYWxpZGFyIG3DqXRvZG8gZGUgcGFnb1xuICAgICAgaWYgKHZhbGlkYXRlZERhdGEucGF5bWVudE1ldGhvZCA9PT0gJ2JhbmsnICYmIHZhbGlkYXRlZERhdGEudG90YWxzLnRvdGFsIDwgMTAwMDApIHtcbiAgICAgICAgdmFsaWRhdGlvblJlc3VsdHMud2FybmluZ3MucHVzaChcbiAgICAgICAgICAnUGFyYSBtb250b3MgbWVub3JlcyBhICQxMC4wMDAsIHJlY29tZW5kYW1vcyBNZXJjYWRvUGFnbyBwYXJhIG1heW9yIGNvbW9kaWRhZCdcbiAgICAgICAgKVxuICAgICAgfVxuXG4gICAgICAvLyBMb2cgZGUgdmFsaWRhY2nDs25cbiAgICAgIGNvbnNvbGUubG9nKCfinIUgVmFsaWRhY2nDs24gZGUgY2hlY2tvdXQ6Jywge1xuICAgICAgICBjdXN0b21lcjogYCR7dmFsaWRhdGVkRGF0YS5jdXN0b21lckluZm8uZmlyc3ROYW1lfSAke3ZhbGlkYXRlZERhdGEuY3VzdG9tZXJJbmZvLmxhc3ROYW1lfWAsXG4gICAgICAgIGl0ZW1zOiB2YWxpZGF0ZWREYXRhLml0ZW1zLmxlbmd0aCxcbiAgICAgICAgdG90YWw6IHZhbGlkYXRlZERhdGEudG90YWxzLnRvdGFsLFxuICAgICAgICBpc1ZhbGlkOiB2YWxpZGF0aW9uUmVzdWx0cy5pc1ZhbGlkLFxuICAgICAgICBlcnJvcnM6IHZhbGlkYXRpb25SZXN1bHRzLmVycm9ycy5sZW5ndGgsXG4gICAgICAgIHdhcm5pbmdzOiB2YWxpZGF0aW9uUmVzdWx0cy53YXJuaW5ncy5sZW5ndGgsXG4gICAgICAgIG9ic2VydmF0aW9uczogdmFsaWRhdGVkRGF0YS5zaGlwcGluZ0FkZHJlc3Mub2JzZXJ2YXRpb25zID8gJ1PDrScgOiAnTm8nLFxuICAgICAgfSlcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICB2YWxpZGF0aW9uOiB2YWxpZGF0aW9uUmVzdWx0cyxcbiAgICAgICAgICBlc3RpbWF0ZWREZWxpdmVyeTogY2FsY3VsYXRlRXN0aW1hdGVkRGVsaXZlcnkodmFsaWRhdGVkRGF0YS5zaGlwcGluZ01ldGhvZCksXG4gICAgICAgICAgcmVjb21tZW5kZWRBY3Rpb25zOiBnZW5lcmF0ZVJlY29tbWVuZGF0aW9ucyh2YWxpZGF0ZWREYXRhLCB2YWxpZGF0aW9uUmVzdWx0cyksXG4gICAgICAgIH0sXG4gICAgICAgIG1lc3NhZ2U6IHZhbGlkYXRpb25SZXN1bHRzLmlzVmFsaWQgPyAnQ2hlY2tvdXQgdsOhbGlkbycgOiAnQ2hlY2tvdXQgY29uIGVycm9yZXMnLFxuICAgICAgfVxuXG4gICAgICAvLyBMb2cgZGUgdmFsaWRhY2nDs24gZXhpdG9zYVxuICAgICAgc2VjdXJpdHlMb2dnZXIubG9nKHtcbiAgICAgICAgdHlwZTogJ2NoZWNrb3V0X3ZhbGlkYXRpb24nLFxuICAgICAgICBpc1ZhbGlkOiB2YWxpZGF0aW9uUmVzdWx0cy5pc1ZhbGlkLFxuICAgICAgICBlcnJvcnNDb3VudDogdmFsaWRhdGlvblJlc3VsdHMuZXJyb3JzLmxlbmd0aCxcbiAgICAgICAgd2FybmluZ3NDb3VudDogdmFsaWRhdGlvblJlc3VsdHMud2FybmluZ3MubGVuZ3RoLFxuICAgICAgICB0b3RhbDogdmFsaWRhdGVkRGF0YS50b3RhbHMudG90YWwsXG4gICAgICAgIHBheW1lbnRNZXRob2Q6IHZhbGlkYXRlZERhdGEucGF5bWVudE1ldGhvZCxcbiAgICAgIH0pXG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihyZXNwb25zZSwge1xuICAgICAgICBzdGF0dXM6IHZhbGlkYXRpb25SZXN1bHRzLmlzVmFsaWQgPyAyMDAgOiA0MDAsXG4gICAgICB9KVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyb3IgdmFsaWRhbmRvIGNoZWNrb3V0OicsIGVycm9yKVxuXG4gICAgICAvLyBMb2cgZGUgZXJyb3IgZGUgc2VndXJpZGFkXG4gICAgICBzZWN1cml0eUxvZ2dlci5sb2dBcGlFcnJvcihcbiAgICAgICAgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICcvYXBpL2NoZWNrb3V0L3ZhbGlkYXRlJ1xuICAgICAgKVxuXG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiB6LlpvZEVycm9yKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICB7XG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIGVycm9yOiAnRGF0b3MgZGUgZW50cmFkYSBpbnbDoWxpZG9zJyxcbiAgICAgICAgICAgIGRldGFpbHM6IGVycm9yLmVycm9ycy5tYXAoZXJyID0+ICh7XG4gICAgICAgICAgICAgIGZpZWxkOiBlcnIucGF0aC5qb2luKCcuJyksXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IGVyci5tZXNzYWdlLFxuICAgICAgICAgICAgfSkpLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICAgIClcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6ICdFcnJvciBpbnRlcm5vIGRlbCBzZXJ2aWRvcicsXG4gICAgICAgIH0sXG4gICAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICAgKVxuICAgIH1cbiAgfSlcblxuICAvLyBNYW5lamFyIHJhdGUgbGltaXQgZXhjZWRpZG9cbiAgaWYgKHJhdGVMaW1pdFJlc3VsdCBpbnN0YW5jZW9mIE5leHRSZXNwb25zZSkge1xuICAgIHNlY3VyaXR5TG9nZ2VyLmxvZ1JhdGVMaW1pdEV4Y2VlZGVkKHNlY3VyaXR5TG9nZ2VyLmNvbnRleHQsIHtcbiAgICAgIGVuZHBvaW50OiAnL2FwaS9jaGVja291dC92YWxpZGF0ZScsXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICB9KVxuICAgIHJldHVybiByYXRlTGltaXRSZXN1bHRcbiAgfVxuXG4gIHJldHVybiByYXRlTGltaXRSZXN1bHRcbn1cblxuLy8gRnVuY2nDs24gYXV4aWxpYXIgcGFyYSBjYWxjdWxhciBjb3N0byBkZSBlbnbDrW9cbmZ1bmN0aW9uIGNhbGN1bGF0ZVNoaXBwaW5nQ29zdChtZXRob2Q6IHN0cmluZywgc3VidG90YWw6IG51bWJlciwgc3RhdGU6IHN0cmluZyk6IG51bWJlciB7XG4gIGlmIChtZXRob2QgPT09ICdwaWNrdXAnKSB7XG4gICAgcmV0dXJuIDBcbiAgfVxuICBpZiAobWV0aG9kID09PSAnZnJlZScgJiYgc3VidG90YWwgPj0gMjUwMDApIHtcbiAgICByZXR1cm4gMFxuICB9XG5cbiAgY29uc3QgYmFzZUNvc3QgPSBtZXRob2QgPT09ICdleHByZXNzJyA/IDUwMDAgOiAyNTAwXG5cbiAgLy8gQ29zdG8gYWRpY2lvbmFsIHBvciBwcm92aW5jaWFcbiAgY29uc3Qgc3RhdGVTdXJjaGFyZ2UgPSBzdGF0ZSA9PT0gJ0NBQkEnID8gMCA6IDUwMFxuXG4gIHJldHVybiBiYXNlQ29zdCArIHN0YXRlU3VyY2hhcmdlXG59XG5cbi8vIEZ1bmNpw7NuIGF1eGlsaWFyIHBhcmEgY2FsY3VsYXIgZmVjaGEgZXN0aW1hZGEgZGUgZW50cmVnYVxuZnVuY3Rpb24gY2FsY3VsYXRlRXN0aW1hdGVkRGVsaXZlcnkoc2hpcHBpbmdNZXRob2Q6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcbiAgbGV0IGRheXNUb0FkZCA9IDdcblxuICBzd2l0Y2ggKHNoaXBwaW5nTWV0aG9kKSB7XG4gICAgY2FzZSAnZXhwcmVzcyc6XG4gICAgICBkYXlzVG9BZGQgPSAyXG4gICAgICBicmVha1xuICAgIGNhc2UgJ2ZyZWUnOlxuICAgICAgZGF5c1RvQWRkID0gN1xuICAgICAgYnJlYWtcbiAgICBjYXNlICdwaWNrdXAnOlxuICAgICAgZGF5c1RvQWRkID0gMVxuICAgICAgYnJlYWtcbiAgfVxuXG4gIGNvbnN0IGVzdGltYXRlZERhdGUgPSBuZXcgRGF0ZShub3cuZ2V0VGltZSgpICsgZGF5c1RvQWRkICogMjQgKiA2MCAqIDYwICogMTAwMClcbiAgcmV0dXJuIGVzdGltYXRlZERhdGUudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdIC8vIFNvbG8gZmVjaGFcbn1cblxuLy8gRnVuY2nDs24gYXV4aWxpYXIgcGFyYSBnZW5lcmFyIHJlY29tZW5kYWNpb25lc1xuZnVuY3Rpb24gZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbnMoZGF0YTogYW55LCB2YWxpZGF0aW9uOiBhbnkpOiBzdHJpbmdbXSB7XG4gIGNvbnN0IHJlY29tbWVuZGF0aW9ucyA9IFtdXG5cbiAgaWYgKCF2YWxpZGF0aW9uLmlzVmFsaWQpIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnQ29ycmlnZSBsb3MgZXJyb3JlcyBhbnRlcyBkZSBjb250aW51YXInKVxuICB9XG5cbiAgaWYgKGRhdGEudG90YWxzLnRvdGFsID4gNTAwMDApIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnQ29uc2lkZXJhIGRpdmlkaXIgbGEgY29tcHJhIGVuIG3Dumx0aXBsZXMgw7NyZGVuZXMgcGFyYSBtYXlvciBzZWd1cmlkYWQnKVxuICB9XG5cbiAgaWYgKGRhdGEucGF5bWVudE1ldGhvZCA9PT0gJ2Nhc2gnICYmIGRhdGEudG90YWxzLnRvdGFsID4gMzAwMDApIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnUGFyYSBtb250b3MgYWx0b3MsIHJlY29tZW5kYW1vcyBwYWdvIGRpZ2l0YWwgcG9yIHNlZ3VyaWRhZCcpXG4gIH1cblxuICBpZiAoIWRhdGEuc2hpcHBpbmdBZGRyZXNzLm9ic2VydmF0aW9ucykge1xuICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdBZ3JlZ2Egb2JzZXJ2YWNpb25lcyBwYXJhIGZhY2lsaXRhciBsYSBlbnRyZWdhJylcbiAgfVxuXG4gIHJldHVybiByZWNvbW1lbmRhdGlvbnNcbn1cblxuLy8gTcOpdG9kbyBPUFRJT05TIHBhcmEgQ09SU1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIE9QVElPTlMoKSB7XG4gIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKG51bGwsIHtcbiAgICBzdGF0dXM6IDIwMCxcbiAgICBoZWFkZXJzOiB7XG4gICAgICAnQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luJzogJyonLFxuICAgICAgJ0FjY2Vzcy1Db250cm9sLUFsbG93LU1ldGhvZHMnOiAnUE9TVCwgT1BUSU9OUycsXG4gICAgICAnQWNjZXNzLUNvbnRyb2wtQWxsb3ctSGVhZGVycyc6ICdDb250ZW50LVR5cGUsIEF1dGhvcml6YXRpb24nLFxuICAgIH0sXG4gIH0pXG59XG4iXSwibmFtZXMiOlsiT1BUSU9OUyIsIlBPU1QiLCJydW50aW1lIiwiY2hlY2tvdXRWYWxpZGF0aW9uU2NoZW1hIiwieiIsIm9iamVjdCIsImN1c3RvbWVySW5mbyIsImZpcnN0TmFtZSIsInN0cmluZyIsIm1pbiIsImxhc3ROYW1lIiwiZW1haWwiLCJwaG9uZSIsInNoaXBwaW5nQWRkcmVzcyIsInN0cmVldEFkZHJlc3MiLCJhcGFydG1lbnQiLCJvcHRpb25hbCIsImNpdHkiLCJzdGF0ZSIsInppcENvZGUiLCJjb3VudHJ5IiwiZGVmYXVsdCIsIm9ic2VydmF0aW9ucyIsIml0ZW1zIiwiYXJyYXkiLCJpZCIsIm5hbWUiLCJwcmljZSIsIm51bWJlciIsInBvc2l0aXZlIiwicXVhbnRpdHkiLCJpbnQiLCJzdG9jayIsIm5vbm5lZ2F0aXZlIiwicGF5bWVudE1ldGhvZCIsImVudW0iLCJzaGlwcGluZ01ldGhvZCIsInRvdGFscyIsInN1YnRvdGFsIiwic2hpcHBpbmciLCJkaXNjb3VudCIsInRvdGFsIiwicmVxdWVzdCIsInNlY3VyaXR5TG9nZ2VyIiwiY3JlYXRlU2VjdXJpdHlMb2dnZXIiLCJyYXRlTGltaXRSZXN1bHQiLCJ3aXRoUmF0ZUxpbWl0IiwiUkFURV9MSU1JVF9DT05GSUdTIiwiY2hlY2tvdXQiLCJsb2ciLCJ0eXBlIiwiZW5kcG9pbnQiLCJtZXRob2QiLCJ1c2VyQWdlbnQiLCJoZWFkZXJzIiwiZ2V0IiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiYm9keSIsImpzb24iLCJ2YWxpZGF0ZWREYXRhIiwicGFyc2UiLCJ2YWxpZGF0aW9uUmVzdWx0cyIsImlzVmFsaWQiLCJlcnJvcnMiLCJ3YXJuaW5ncyIsInN1Z2dlc3Rpb25zIiwiaXRlbSIsInNpbXVsYXRlZFN0b2NrIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwicHVzaCIsImNhbGN1bGF0ZWRTdWJ0b3RhbCIsInJlZHVjZSIsInN1bSIsImFicyIsImV4cGVjdGVkU2hpcHBpbmciLCJjYWxjdWxhdGVTaGlwcGluZ0Nvc3QiLCJleHBlY3RlZFRvdGFsIiwic3RhcnRzV2l0aCIsIm9icyIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJjb25zb2xlIiwiY3VzdG9tZXIiLCJsZW5ndGgiLCJyZXNwb25zZSIsInN1Y2Nlc3MiLCJkYXRhIiwidmFsaWRhdGlvbiIsImVzdGltYXRlZERlbGl2ZXJ5IiwiY2FsY3VsYXRlRXN0aW1hdGVkRGVsaXZlcnkiLCJyZWNvbW1lbmRlZEFjdGlvbnMiLCJnZW5lcmF0ZVJlY29tbWVuZGF0aW9ucyIsIm1lc3NhZ2UiLCJlcnJvcnNDb3VudCIsIndhcm5pbmdzQ291bnQiLCJOZXh0UmVzcG9uc2UiLCJzdGF0dXMiLCJlcnJvciIsImxvZ0FwaUVycm9yIiwiRXJyb3IiLCJab2RFcnJvciIsImRldGFpbHMiLCJtYXAiLCJlcnIiLCJmaWVsZCIsInBhdGgiLCJqb2luIiwibG9nUmF0ZUxpbWl0RXhjZWVkZWQiLCJjb250ZXh0IiwiYmFzZUNvc3QiLCJzdGF0ZVN1cmNoYXJnZSIsIm5vdyIsImRheXNUb0FkZCIsImVzdGltYXRlZERhdGUiLCJnZXRUaW1lIiwic3BsaXQiLCJyZWNvbW1lbmRhdGlvbnMiXSwibWFwcGluZ3MiOiJBQUFBLHFDQUFxQzs7Ozs7Ozs7Ozs7O1FBK1NmQTtlQUFBQTs7UUE1UEFDO2VBQUFBOztRQWxEVEM7ZUFBQUE7Ozt3QkFFNkI7cUJBQ3hCOzZCQUtnQztnQ0FFYjtBQVY5QixNQUFNQSxVQUFVO0FBWXZCLHFDQUFxQztBQUNyQyxNQUFNQywyQkFBMkJDLE1BQUMsQ0FBQ0MsTUFBTSxDQUFDO0lBQ3hDQyxjQUFjRixNQUFDLENBQUNDLE1BQU0sQ0FBQztRQUNyQkUsV0FBV0gsTUFBQyxDQUFDSSxNQUFNLEdBQUdDLEdB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