{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\__tests__\\lib\\alert-system.test.ts"],"sourcesContent":["// ===================================\r\n// PINTEYA E-COMMERCE - ALERT SYSTEM TESTS\r\n// ===================================\r\n\r\nimport {\r\n  EnterpriseAlertSystem,\r\n  AlertLevel,\r\n  NotificationType,\r\n  AlertStatus,\r\n  enterpriseAlertSystem\r\n} from '@/lib/monitoring/alert-system';\r\n\r\n// Mock logger\r\njest.mock('@/lib/enterprise/logger', () => ({\r\n  logger: {\r\n    info: jest.fn(),\r\n    warn: jest.fn(),\r\n    error: jest.fn(),\r\n    log: jest.fn(),\r\n  },\r\n  LogLevel: {\r\n    INFO: 'info',\r\n    WARN: 'warn',\r\n    ERROR: 'error',\r\n  },\r\n  LogCategory: {\r\n    SYSTEM: 'system',\r\n  },\r\n}));\r\n\r\n// Mock Supabase\r\nconst mockSupabaseInsert = jest.fn();\r\nconst mockSupabaseUpdate = jest.fn();\r\nconst mockSupabaseFrom = jest.fn(() => ({\r\n  insert: mockSupabaseInsert,\r\n  update: mockSupabaseUpdate,\r\n}));\r\n\r\njest.mock('@/lib/supabase', () => ({\r\n  getSupabaseClient: jest.fn(() => ({\r\n    from: mockSupabaseFrom,\r\n  })),\r\n}));\r\n\r\n// Mock cache\r\njest.mock('@/lib/cache-manager', () => ({\r\n  CacheUtils: {\r\n    get: jest.fn(),\r\n    set: jest.fn(),\r\n  },\r\n}));\r\n\r\n// Mock fetch global\r\nconst mockFetch = jest.fn();\r\nglobal.fetch = mockFetch;\r\n\r\ndescribe('Enterprise Alert System', () => {\r\n  let alertSystem: EnterpriseAlertSystem;\r\n\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n    jest.useFakeTimers();\r\n    alertSystem = new EnterpriseAlertSystem();\r\n    \r\n    // Mock successful database operations\r\n    mockSupabaseInsert.mockResolvedValue({ error: null });\r\n    mockSupabaseUpdate.mockResolvedValue({ error: null });\r\n    mockFetch.mockResolvedValue({\r\n      ok: true,\r\n      status: 200,\r\n      statusText: 'OK'\r\n    });\r\n  });\r\n\r\n  afterEach(() => {\r\n    jest.useRealTimers();\r\n    alertSystem.destroy();\r\n  });\r\n\r\n  describe('Configuración de canales', () => {\r\n    test('debe configurar canal de notificación', () => {\r\n      const channel = {\r\n        id: 'test_email',\r\n        type: NotificationType.EMAIL,\r\n        name: 'Test Email Channel',\r\n        config: { to: 'admin@pinteya.com' },\r\n        enabled: true,\r\n        levels: [AlertLevel.CRITICAL, AlertLevel.EMERGENCY]\r\n      };\r\n\r\n      alertSystem.setNotificationChannel(channel);\r\n\r\n      // Verificar que no hay errores\r\n      expect(true).toBe(true);\r\n    });\r\n\r\n    test('debe configurar regla de escalamiento', () => {\r\n      const rule = {\r\n        id: 'test_escalation',\r\n        name: 'Test Escalation',\r\n        enabled: true,\r\n        conditions: {\r\n          level: AlertLevel.CRITICAL,\r\n          duration: 10\r\n        },\r\n        actions: {\r\n          escalateToLevel: AlertLevel.EMERGENCY,\r\n          notifyChannels: ['test_email']\r\n        }\r\n      };\r\n\r\n      alertSystem.setEscalationRule(rule);\r\n\r\n      // Verificar que no hay errores\r\n      expect(true).toBe(true);\r\n    });\r\n\r\n    test('debe configurar regla de alerta', () => {\r\n      const rule = {\r\n        id: 'test_alert',\r\n        name: 'Test Alert',\r\n        description: 'Test alert rule',\r\n        enabled: true,\r\n        metricName: 'test.metric',\r\n        condition: 'gt' as const,\r\n        threshold: 100,\r\n        level: AlertLevel.WARNING,\r\n        cooldownMinutes: 5,\r\n        channels: ['default_log'],\r\n        escalationRules: [],\r\n        tags: { environment: 'test' }\r\n      };\r\n\r\n      alertSystem.setAlertRule(rule);\r\n\r\n      // Verificar que no hay errores\r\n      expect(true).toBe(true);\r\n    });\r\n  });\r\n\r\n  describe('Disparar alertas', () => {\r\n    beforeEach(() => {\r\n      // Configurar regla de alerta para tests\r\n      alertSystem.setAlertRule({\r\n        id: 'test_rule',\r\n        name: 'Test Rule',\r\n        description: 'Test alert rule',\r\n        enabled: true,\r\n        metricName: 'test.metric',\r\n        condition: 'gt',\r\n        threshold: 100,\r\n        level: AlertLevel.WARNING,\r\n        cooldownMinutes: 5,\r\n        channels: ['default_log'],\r\n        escalationRules: [],\r\n        tags: {}\r\n      });\r\n    });\r\n\r\n    test('debe disparar alerta cuando se cumple condición', async () => {\r\n      const alert = await alertSystem.triggerAlert(\r\n        'test_rule',\r\n        'test.metric',\r\n        150,\r\n        'Test alert message'\r\n      );\r\n\r\n      expect(alert).toBeTruthy();\r\n      expect(alert?.level).toBe(AlertLevel.WARNING);\r\n      expect(alert?.value).toBe(150);\r\n      expect(alert?.threshold).toBe(100);\r\n      expect(alert?.status).toBe(AlertStatus.ACTIVE);\r\n    });\r\n\r\n    test('no debe disparar alerta si la regla está deshabilitada', async () => {\r\n      // Deshabilitar regla\r\n      alertSystem.setAlertRule({\r\n        id: 'disabled_rule',\r\n        name: 'Disabled Rule',\r\n        description: 'Disabled rule',\r\n        enabled: false,\r\n        metricName: 'test.metric',\r\n        condition: 'gt',\r\n        threshold: 100,\r\n        level: AlertLevel.WARNING,\r\n        cooldownMinutes: 5,\r\n        channels: ['default_log'],\r\n        escalationRules: [],\r\n        tags: {}\r\n      });\r\n\r\n      const alert = await alertSystem.triggerAlert(\r\n        'disabled_rule',\r\n        'test.metric',\r\n        150\r\n      );\r\n\r\n      expect(alert).toBeNull();\r\n    });\r\n\r\n    test('no debe disparar alerta si está en cooldown', async () => {\r\n      // Disparar primera alerta\r\n      const alert1 = await alertSystem.triggerAlert(\r\n        'test_rule',\r\n        'test.metric',\r\n        150\r\n      );\r\n\r\n      expect(alert1).toBeTruthy();\r\n\r\n      // Intentar disparar segunda alerta inmediatamente\r\n      const alert2 = await alertSystem.triggerAlert(\r\n        'test_rule',\r\n        'test.metric',\r\n        160\r\n      );\r\n\r\n      expect(alert2).toBeNull();\r\n    });\r\n  });\r\n\r\n  describe('Gestión de alertas', () => {\r\n    let testAlert: any;\r\n\r\n    beforeEach(async () => {\r\n      // Configurar y disparar alerta para tests\r\n      alertSystem.setAlertRule({\r\n        id: 'test_rule',\r\n        name: 'Test Rule',\r\n        description: 'Test rule',\r\n        enabled: true,\r\n        metricName: 'test.metric',\r\n        condition: 'gt',\r\n        threshold: 100,\r\n        level: AlertLevel.WARNING,\r\n        cooldownMinutes: 5,\r\n        channels: ['default_log'],\r\n        escalationRules: [],\r\n        tags: {}\r\n      });\r\n\r\n      testAlert = await alertSystem.triggerAlert(\r\n        'test_rule',\r\n        'test.metric',\r\n        150\r\n      );\r\n    });\r\n\r\n    test('debe reconocer alerta', async () => {\r\n      const success = await alertSystem.acknowledgeAlert(testAlert.id, 'admin-user');\r\n\r\n      expect(success).toBe(true);\r\n    });\r\n\r\n    test('debe resolver alerta', async () => {\r\n      const success = await alertSystem.resolveAlert(testAlert.id, 'admin-user');\r\n\r\n      expect(success).toBe(true);\r\n    });\r\n\r\n    test('no debe reconocer alerta inexistente', async () => {\r\n      const success = await alertSystem.acknowledgeAlert('nonexistent', 'admin-user');\r\n\r\n      expect(success).toBe(false);\r\n    });\r\n\r\n    test('no debe resolver alerta inexistente', async () => {\r\n      const success = await alertSystem.resolveAlert('nonexistent', 'admin-user');\r\n\r\n      expect(success).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('Notificaciones', () => {\r\n    test('debe enviar notificación por log', async () => {\r\n      // Configurar canal de log\r\n      alertSystem.setNotificationChannel({\r\n        id: 'test_log',\r\n        type: NotificationType.LOG,\r\n        name: 'Test Log',\r\n        config: {},\r\n        enabled: true,\r\n        levels: [AlertLevel.WARNING]\r\n      });\r\n\r\n      // Configurar regla con canal de log\r\n      alertSystem.setAlertRule({\r\n        id: 'log_rule',\r\n        name: 'Log Rule',\r\n        description: 'Log rule',\r\n        enabled: true,\r\n        metricName: 'test.metric',\r\n        condition: 'gt',\r\n        threshold: 100,\r\n        level: AlertLevel.WARNING,\r\n        cooldownMinutes: 5,\r\n        channels: ['test_log'],\r\n        escalationRules: [],\r\n        tags: {}\r\n      });\r\n\r\n      const alert = await alertSystem.triggerAlert(\r\n        'log_rule',\r\n        'test.metric',\r\n        150\r\n      );\r\n\r\n      expect(alert).toBeTruthy();\r\n      expect(alert?.notificationsSent.length).toBeGreaterThan(0);\r\n    });\r\n\r\n    test('debe enviar notificación por webhook', async () => {\r\n      // Configurar canal de webhook\r\n      alertSystem.setNotificationChannel({\r\n        id: 'test_webhook',\r\n        type: NotificationType.WEBHOOK,\r\n        name: 'Test Webhook',\r\n        config: { url: 'https://example.com/webhook' },\r\n        enabled: true,\r\n        levels: [AlertLevel.CRITICAL]\r\n      });\r\n\r\n      // Configurar regla con canal de webhook\r\n      alertSystem.setAlertRule({\r\n        id: 'webhook_rule',\r\n        name: 'Webhook Rule',\r\n        description: 'Webhook rule',\r\n        enabled: true,\r\n        metricName: 'test.metric',\r\n        condition: 'gt',\r\n        threshold: 100,\r\n        level: AlertLevel.CRITICAL,\r\n        cooldownMinutes: 5,\r\n        channels: ['test_webhook'],\r\n        escalationRules: [],\r\n        tags: {}\r\n      });\r\n\r\n      const alert = await alertSystem.triggerAlert(\r\n        'webhook_rule',\r\n        'test.metric',\r\n        150\r\n      );\r\n\r\n      expect(alert).toBeTruthy();\r\n      expect(mockFetch).toHaveBeenCalledWith(\r\n        'https://example.com/webhook',\r\n        expect.objectContaining({\r\n          method: 'POST',\r\n          headers: expect.objectContaining({\r\n            'Content-Type': 'application/json'\r\n          }),\r\n          body: expect.stringContaining('\"source\":\"pinteya-ecommerce\"')\r\n        })\r\n      );\r\n    });\r\n\r\n    test('no debe enviar notificación si el canal está deshabilitado', async () => {\r\n      // Configurar canal deshabilitado\r\n      alertSystem.setNotificationChannel({\r\n        id: 'disabled_channel',\r\n        type: NotificationType.EMAIL,\r\n        name: 'Disabled Channel',\r\n        config: { to: 'test@example.com' },\r\n        enabled: false,\r\n        levels: [AlertLevel.WARNING]\r\n      });\r\n\r\n      // Configurar regla con canal deshabilitado\r\n      alertSystem.setAlertRule({\r\n        id: 'disabled_rule',\r\n        name: 'Disabled Rule',\r\n        description: 'Rule with disabled channel',\r\n        enabled: true,\r\n        metricName: 'test.metric',\r\n        condition: 'gt',\r\n        threshold: 100,\r\n        level: AlertLevel.WARNING,\r\n        cooldownMinutes: 5,\r\n        channels: ['disabled_channel'],\r\n        escalationRules: [],\r\n        tags: {}\r\n      });\r\n\r\n      const alert = await alertSystem.triggerAlert(\r\n        'disabled_rule',\r\n        'test.metric',\r\n        150\r\n      );\r\n\r\n      expect(alert).toBeTruthy();\r\n      expect(alert?.notificationsSent.length).toBe(0);\r\n    });\r\n  });\r\n\r\n  describe('Escalamiento', () => {\r\n    test('debe escalar alerta después del tiempo configurado', async () => {\r\n      // Configurar regla de escalamiento\r\n      alertSystem.setEscalationRule({\r\n        id: 'test_escalation',\r\n        name: 'Test Escalation',\r\n        enabled: true,\r\n        conditions: {\r\n          level: AlertLevel.WARNING,\r\n          duration: 1 // 1 minuto\r\n        },\r\n        actions: {\r\n          escalateToLevel: AlertLevel.CRITICAL,\r\n          notifyChannels: ['default_log']\r\n        }\r\n      });\r\n\r\n      // Configurar regla de alerta con escalamiento\r\n      alertSystem.setAlertRule({\r\n        id: 'escalation_rule',\r\n        name: 'Escalation Rule',\r\n        description: 'Rule with escalation',\r\n        enabled: true,\r\n        metricName: 'test.metric',\r\n        condition: 'gt',\r\n        threshold: 100,\r\n        level: AlertLevel.WARNING,\r\n        cooldownMinutes: 5,\r\n        channels: ['default_log'],\r\n        escalationRules: ['test_escalation'],\r\n        tags: {}\r\n      });\r\n\r\n      // Disparar alerta\r\n      const alert = await alertSystem.triggerAlert(\r\n        'escalation_rule',\r\n        'test.metric',\r\n        150\r\n      );\r\n\r\n      expect(alert).toBeTruthy();\r\n      expect(alert?.level).toBe(AlertLevel.WARNING);\r\n\r\n      // Avanzar tiempo para activar escalamiento\r\n      jest.advanceTimersByTime(2 * 60 * 1000); // 2 minutos\r\n\r\n      // El escalamiento se verifica automáticamente\r\n      expect(true).toBe(true);\r\n    });\r\n  });\r\n\r\n  describe('Instancia singleton', () => {\r\n    test('debe retornar la misma instancia', () => {\r\n      const instance1 = EnterpriseAlertSystem.getInstance();\r\n      const instance2 = EnterpriseAlertSystem.getInstance();\r\n\r\n      expect(instance1).toBe(instance2);\r\n    });\r\n\r\n    test('debe usar la instancia global', () => {\r\n      expect(enterpriseAlertSystem).toBeInstanceOf(EnterpriseAlertSystem);\r\n    });\r\n  });\r\n\r\n  describe('Limpieza de recursos', () => {\r\n    test('debe limpiar recursos correctamente', () => {\r\n      const system = new EnterpriseAlertSystem();\r\n      \r\n      expect(() => system.destroy()).not.toThrow();\r\n    });\r\n  });\r\n});\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":["jest","mock","logger","info","fn","warn","error","log","LogLevel","INFO","WARN","ERROR","LogCategory","SYSTEM","getSupabaseClient","from","mockSupabaseFrom","CacheUtils","get","set","mockSupabaseInsert","mockSupabaseUpdate","insert","update","mockFetch","global","fetch","describe","alertSystem","beforeEach","clearAllMocks","useFakeTimers","EnterpriseAlertSystem","mockResolvedValue","ok","status","statusText","afterEach","useRealTimers","destroy","test","channel","id","type","NotificationType","EMAIL","name","config","to","enabled","levels","AlertLevel","CRITICAL","EMERGENCY","setNotificationChannel","expect","toBe","rule","conditions","level","duration","actions","escalateToLevel","notifyChannels","setEscalationRule","description","metricName","condition","threshold","WARNING","cooldownMinutes","channels","escalationRules","tags","environment","setAlertRule","alert","triggerAlert","toBeTruthy","value","AlertStatus","ACTIVE","toBeNull","alert1","alert2","testAlert","success","acknowledgeAlert","resolveAlert","LOG","notificationsSent","length","toBeGreaterThan","WEBHOOK","url","toHaveBeenCalledWith","objectContaining","method","headers","body","stringContaining","advanceTimersByTime","instance1","getInstance","instance2","enterpriseAlertSystem","toBeInstanceOf","system","not","toThrow"],"mappings":"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"}