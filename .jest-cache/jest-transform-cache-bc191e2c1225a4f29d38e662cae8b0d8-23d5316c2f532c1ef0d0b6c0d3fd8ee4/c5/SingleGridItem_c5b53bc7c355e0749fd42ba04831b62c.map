{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\components\\Shop\\SingleGridItem.tsx"],"sourcesContent":["'use client'\nimport React from 'react'\nimport { Product } from '@/types/product'\nimport { updateQuickView } from '@/redux/features/quickView-slice'\nimport { addItemToCart } from '@/redux/features/cart-slice'\nimport { addItemToWishlist } from '@/redux/features/wishlist-slice'\nimport { useDispatch } from 'react-redux'\nimport { AppDispatch } from '@/redux/store'\nimport Link from 'next/link'\nimport Image from 'next/image'\nimport { CommercialProductCard } from '@/components/ui/product-card-commercial'\nimport { ExtendedProduct, calculateProductFeatures } from '@/lib/adapters/productAdapter'\nimport { useCartWithBackend } from '@/hooks/useCartWithBackend'\nimport { useCartActions } from '@/hooks/useCartActions'\nimport { useAnalytics } from '@/hooks/useAnalytics'\nimport { Badge } from '@/components/ui/badge'\nimport { Button } from '@/components/ui/button'\nimport { ShoppingCart, Eye } from 'lucide-react'\n\nconst SingleGridItem = ({ item }: { item: ExtendedProduct }) => {\n  const dispatch = useDispatch<AppDispatch>()\n\n  // Hook para carrito con backend\n  const { addItem, loading } = useCartWithBackend()\n\n  // update the QuickView state\n  const handleQuickViewUpdate = () => {\n    dispatch(updateQuickView({ ...item }))\n  }\n\n  // add to cart - Conectado con backend\n  const handleAddToCart = async () => {\n    // Intentar agregar al backend primero\n    const success = await addItem(item.id, 1)\n\n    if (success) {\n      // Si el backend funciona, también actualizar Redux para compatibilidad\n      dispatch(\n        addItemToCart({\n          ...item,\n          quantity: 1,\n        })\n      )\n    } else {\n      // Si falla el backend, solo usar Redux (fallback)\n      dispatch(\n        addItemToCart({\n          ...item,\n          quantity: 1,\n        })\n      )\n    }\n  }\n\n  const handleItemToWishList = () => {\n    dispatch(\n      addItemToWishlist({\n        ...item,\n        status: 'available',\n        quantity: 1,\n      })\n    )\n  }\n\n  // Calcular características del producto usando el adaptador\n  const features = calculateProductFeatures(item)\n\n  // FIX DIRECTO: Limpiar \"Poxipol\" del título si está presente\n  let cleanTitle = item.name || item.title\n  if (cleanTitle && cleanTitle.includes('Poximix') && cleanTitle.includes('Poxipol')) {\n    cleanTitle = cleanTitle.replace(/\\s*Poxipol\\s*$/, '').trim()\n  }\n\n  return (\n    <CommercialProductCard\n      className='bg-white' // Forzar fondo blanco\n      image={\n        item.images?.previews?.[0] || item.imgs?.previews?.[0] || '/images/products/placeholder.svg'\n      }\n      title={cleanTitle}\n      brand={item.brand}\n      price={\n        features.discount\n          ? Math.round(item.price * (1 - features.discount / 100))\n          : features.currentPrice\n      }\n      originalPrice={features.discount ? item.price : undefined}\n      discount={features.discount ? `${features.discount}%` : undefined}\n      isNew={features.isNew}\n      stock={features.stock}\n      productId={item.id}\n      cta='Agregar al carrito'\n      onAddToCart={handleAddToCart}\n      showCartAnimation={true}\n      // Información de cuotas automática\n      installments={\n        features.currentPrice >= 5000\n          ? {\n              quantity: 3,\n              amount: Math.round(features.currentPrice / 3),\n              interestFree: true,\n            }\n          : undefined\n      }\n      // Envío gratis automático para productos >= $15000\n      freeShipping={features.freeShipping || features.currentPrice >= 15000}\n      shippingText={\n        features.freeShipping ? 'Envío gratis' : features.fastShipping ? 'Envío rápido' : undefined\n      }\n    />\n  )\n}\n\nexport default SingleGridItem\n"],"names":["SingleGridItem","item","dispatch","useDispatch","addItem","loading","useCartWithBackend","handleQuickViewUpdate","updateQuickView","handleAddToCart","success","id","addItemToCart","quantity","handleItemToWishList","addItemToWishlist","status","features","calculateProductFeatures","cleanTitle","name","title","includes","replace","trim","CommercialProductCard","className","image","images","previews","imgs","brand","price","discount","Math","round","currentPrice","originalPrice","undefined","isNew","stock","productId","cta","onAddToCart","showCartAnimation","installments","amount","interestFree","freeShipping","shippingText","fastShipping"],"mappings":"AAAA;;;;;+BAiHA;;;eAAA;;;;8DAhHkB;gCAEc;2BACF;+BACI;4BACN;uCAIU;gCACoB;oCACvB;;;;;;AAOnC,MAAMA,iBAAiB,CAAC,EAAEC,IAAI,EAA6B;IACzD,MAAMC,WAAWC,IAAAA,uBAAW;IAE5B,gCAAgC;IAChC,MAAM,EAAEC,OAAO,EAAEC,OAAO,EAAE,GAAGC,IAAAA,sCAAkB;IAE/C,6BAA6B;IAC7B,MAAMC,wBAAwB;QAC5BL,SAASM,IAAAA,+BAAe,EAAC;YAAE,GAAGP,IAAI;QAAC;IACrC;IAEA,sCAAsC;IACtC,MAAMQ,kBAAkB;QACtB,sCAAsC;QACtC,MAAMC,UAAU,MAAMN,QAAQH,KAAKU,EAAE,EAAE;QAEvC,IAAID,SAAS;YACX,uEAAuE;YACvER,SACEU,IAAAA,wBAAa,EAAC;gBACZ,GAAGX,IAAI;gBACPY,UAAU;YACZ;QAEJ,OAAO;YACL,kDAAkD;YAClDX,SACEU,IAAAA,wBAAa,EAAC;gBACZ,GAAGX,IAAI;gBACPY,UAAU;YACZ;QAEJ;IACF;IAEA,MAAMC,uBAAuB;QAC3BZ,SACEa,IAAAA,gCAAiB,EAAC;YAChB,GAAGd,IAAI;YACPe,QAAQ;YACRH,UAAU;QACZ;IAEJ;IAEA,4DAA4D;IAC5D,MAAMI,WAAWC,IAAAA,wCAAwB,EAACjB;IAE1C,6DAA6D;IAC7D,IAAIkB,aAAalB,KAAKmB,IAAI,IAAInB,KAAKoB,KAAK;IACxC,IAAIF,cAAcA,WAAWG,QAAQ,CAAC,cAAcH,WAAWG,QAAQ,CAAC,YAAY;QAClFH,aAAaA,WAAWI,OAAO,CAAC,kBAAkB,IAAIC,IAAI;IAC5D;IAEA,qBACE,qBAACC,4CAAqB;QACpBC,WAAU;QACVC,OACE1B,KAAK2B,MAAM,EAAEC,UAAU,CAAC,EAAE,IAAI5B,KAAK6B,IAAI,EAAED,UAAU,CAAC,EAAE,IAAI;QAE5DR,OAAOF;QACPY,OAAO9B,KAAK8B,KAAK;QACjBC,OACEf,SAASgB,QAAQ,GACbC,KAAKC,KAAK,CAAClC,KAAK+B,KAAK,GAAI,CAAA,IAAIf,SAASgB,QAAQ,GAAG,GAAE,KACnDhB,SAASmB,YAAY;QAE3BC,eAAepB,SAASgB,QAAQ,GAAGhC,KAAK+B,KAAK,GAAGM;QAChDL,UAAUhB,SAASgB,QAAQ,GAAG,GAAGhB,SAASgB,QAAQ,CAAC,CAAC,CAAC,GAAGK;QACxDC,OAAOtB,SAASsB,KAAK;QACrBC,OAAOvB,SAASuB,KAAK;QACrBC,WAAWxC,KAAKU,EAAE;QAClB+B,KAAI;QACJC,aAAalC;QACbmC,mBAAmB;QACnB,mCAAmC;QACnCC,cACE5B,SAASmB,YAAY,IAAI,OACrB;YACEvB,UAAU;YACViC,QAAQZ,KAAKC,KAAK,CAAClB,SAASmB,YAAY,GAAG;YAC3CW,cAAc;QAChB,IACAT;QAEN,mDAAmD;QACnDU,cAAc/B,SAAS+B,YAAY,IAAI/B,SAASmB,YAAY,IAAI;QAChEa,cACEhC,SAAS+B,YAAY,GAAG,iBAAiB/B,SAASiC,YAAY,GAAG,iBAAiBZ;;AAI1F;MAEA,WAAetC"}