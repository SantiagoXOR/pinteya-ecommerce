a3b0e4d10e7cdd336201786328a6283f
// ===================================
// PINTEYA E-COMMERCE - ENTERPRISE ALERT SYSTEM
// ===================================
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get AlertLevel () {
        return AlertLevel;
    },
    get AlertStatus () {
        return AlertStatus;
    },
    get EnterpriseAlertSystem () {
        return EnterpriseAlertSystem;
    },
    get NotificationType () {
        return NotificationType;
    },
    get acknowledgeAlert () {
        return acknowledgeAlert;
    },
    get enterpriseAlertSystem () {
        return enterpriseAlertSystem;
    },
    get resolveAlert () {
        return resolveAlert;
    },
    get triggerAlert () {
        return triggerAlert;
    }
});
const _logger = require("../enterprise/logger");
const _supabase = require("../integrations/supabase");
const _email = require("../notifications/email");
const _slack = require("../notifications/slack");
// ✅ IMPORT CONDICIONAL: Solo cargar CacheUtils en servidor para evitar errores de ioredis en cliente
let CacheUtils = null;
if (typeof window === 'undefined') {
    // Solo en servidor
    try {
        CacheUtils = require('@/lib/cache-manager').CacheUtils;
    } catch (error) {
        console.warn('[EnterpriseAlertSystem] CacheUtils not available:', error);
    }
}
var AlertLevel = /*#__PURE__*/ function(AlertLevel) {
    AlertLevel["INFO"] = "info";
    AlertLevel["WARNING"] = "warning";
    AlertLevel["CRITICAL"] = "critical";
    AlertLevel["EMERGENCY"] = "emergency";
    return AlertLevel;
}({});
var NotificationType = /*#__PURE__*/ function(NotificationType) {
    NotificationType["EMAIL"] = "email";
    NotificationType["SLACK"] = "slack";
    NotificationType["WEBHOOK"] = "webhook";
    NotificationType["SMS"] = "sms";
    NotificationType["PUSH"] = "push";
    NotificationType["LOG"] = "log";
    return NotificationType;
}({});
var AlertStatus = /*#__PURE__*/ function(AlertStatus) {
    AlertStatus["ACTIVE"] = "active";
    AlertStatus["ACKNOWLEDGED"] = "acknowledged";
    AlertStatus["RESOLVED"] = "resolved";
    AlertStatus["SUPPRESSED"] = "suppressed";
    return AlertStatus;
}({});
class EnterpriseAlertSystem {
    constructor(){
        this.alertRules = new Map();
        this.notificationChannels = new Map();
        this.escalationRules = new Map();
        this.activeAlerts = new Map();
        this.escalationInterval = null;
        this.initializeDefaultChannels();
        this.initializeDefaultRules();
        this.startEscalationMonitoring();
    }
    static getInstance() {
        if (!EnterpriseAlertSystem.instance) {
            EnterpriseAlertSystem.instance = new EnterpriseAlertSystem();
        }
        return EnterpriseAlertSystem.instance;
    }
    /**
   * Configura un canal de notificación
   */ setNotificationChannel(channel) {
        this.notificationChannels.set(channel.id, channel);
        _logger.logger.info(_logger.LogLevel.INFO, `Notification channel configured: ${channel.id}`, {
            type: channel.type,
            enabled: channel.enabled,
            levels: channel.levels
        }, _logger.LogCategory.SYSTEM);
    }
    /**
   * Configura una regla de escalamiento
   */ setEscalationRule(rule) {
        this.escalationRules.set(rule.id, rule);
        _logger.logger.info(_logger.LogLevel.INFO, `Escalation rule configured: ${rule.id}`, {
            level: rule.conditions.level,
            duration: rule.conditions.duration,
            enabled: rule.enabled
        }, _logger.LogCategory.SYSTEM);
    }
    /**
   * Configura una regla de alerta
   */ setAlertRule(rule) {
        this.alertRules.set(rule.id, rule);
        _logger.logger.info(_logger.LogLevel.INFO, `Alert rule configured: ${rule.id}`, {
            metricName: rule.metricName,
            threshold: rule.threshold,
            level: rule.level,
            enabled: rule.enabled
        }, _logger.LogCategory.SYSTEM);
    }
    /**
   * Dispara una alerta
   */ async triggerAlert(ruleId, metricName, value, message) {
        const rule = this.alertRules.get(ruleId);
        if (!rule || !rule.enabled) {
            return null;
        }
        // Verificar cooldown
        const existingAlert = Array.from(this.activeAlerts.values()).find((alert)=>alert.ruleId === ruleId && alert.status === "active");
        if (existingAlert) {
            const cooldownEnd = new Date(existingAlert.triggeredAt);
            cooldownEnd.setMinutes(cooldownEnd.getMinutes() + rule.cooldownMinutes);
            if (new Date() < cooldownEnd) {
                return null // Aún en cooldown
                ;
            }
        }
        // Crear nueva alerta
        const alert = {
            id: this.generateAlertId(),
            ruleId: rule.id,
            ruleName: rule.name,
            level: rule.level,
            status: "active",
            message: message || `${rule.description} - Value: ${value}, Threshold: ${rule.threshold}`,
            metricName,
            value,
            threshold: rule.threshold,
            triggeredAt: new Date().toISOString(),
            notificationsSent: [],
            tags: rule.tags,
            metadata: rule.metadata
        };
        this.activeAlerts.set(alert.id, alert);
        // Enviar notificaciones
        await this.sendNotifications(alert, rule.channels);
        // Almacenar en base de datos
        await this.storeAlert(alert);
        _logger.logger.warn(_logger.LogLevel.WARN, `Alert triggered: ${rule.name}`, {
            alertId: alert.id,
            level: alert.level,
            metricName: alert.metricName,
            value: alert.value,
            threshold: alert.threshold
        }, _logger.LogCategory.SYSTEM);
        return alert;
    }
    /**
   * Reconoce una alerta
   */ async acknowledgeAlert(alertId, userId) {
        const alert = this.activeAlerts.get(alertId);
        if (!alert || alert.status !== "active") {
            return false;
        }
        alert.status = "acknowledged";
        alert.acknowledgedAt = new Date().toISOString();
        alert.acknowledgedBy = userId;
        await this.updateAlert(alert);
        _logger.logger.info(_logger.LogLevel.INFO, `Alert acknowledged: ${alertId}`, {
            userId,
            level: alert.level,
            ruleName: alert.ruleName
        }, _logger.LogCategory.SYSTEM);
        return true;
    }
    /**
   * Resuelve una alerta
   */ async resolveAlert(alertId, userId) {
        const alert = this.activeAlerts.get(alertId);
        if (!alert) {
            return false;
        }
        alert.status = "resolved";
        alert.resolvedAt = new Date().toISOString();
        alert.resolvedBy = userId;
        await this.updateAlert(alert);
        this.activeAlerts.delete(alertId);
        _logger.logger.info(_logger.LogLevel.INFO, `Alert resolved: ${alertId}`, {
            userId,
            level: alert.level,
            ruleName: alert.ruleName,
            duration: this.calculateDuration(alert.triggeredAt, alert.resolvedAt)
        }, _logger.LogCategory.SYSTEM);
        return true;
    }
    /**
   * Envía notificaciones para una alerta
   */ async sendNotifications(alert, channelIds) {
        const notifications = await Promise.allSettled(channelIds.map((channelId)=>this.sendNotification(alert, channelId)));
        // Log resultados
        notifications.forEach((result, index)=>{
            const channelId = channelIds[index];
            if (result.status === 'fulfilled' && result.value) {
                alert.notificationsSent.push(result.value);
            } else if (result.status === 'rejected') {
                _logger.logger.error(_logger.LogLevel.ERROR, `Failed to send notification to channel: ${channelId}`, {
                    alertId: alert.id,
                    error: result.reason
                }, _logger.LogCategory.SYSTEM);
            }
        });
    }
    /**
   * Envía notificación a un canal específico
   */ async sendNotification(alert, channelId) {
        const channel = this.notificationChannels.get(channelId);
        if (!channel || !channel.enabled || !channel.levels.includes(alert.level)) {
            return null;
        }
        // Verificar rate limiting
        if (channel.rateLimit && !await this.checkRateLimit(channelId, channel.rateLimit)) {
            _logger.logger.warn(_logger.LogLevel.WARN, `Rate limit exceeded for channel: ${channelId}`, {
                alertId: alert.id
            }, _logger.LogCategory.SYSTEM);
            return null;
        }
        const startTime = Date.now();
        let success = false;
        let error;
        try {
            switch(channel.type){
                case "email":
                    await this.sendEmailNotification(alert, channel);
                    break;
                case "slack":
                    await this.sendSlackNotification(alert, channel);
                    break;
                case "webhook":
                    await this.sendWebhookNotification(alert, channel);
                    break;
                case "sms":
                    await this.sendSMSNotification(alert, channel);
                    break;
                case "log":
                    await this.sendLogNotification(alert, channel);
                    break;
                default:
                    throw new Error(`Unsupported notification type: ${channel.type}`);
            }
            success = true;
        } catch (err) {
            error = err instanceof Error ? err.message : 'Unknown error';
        }
        const notificationLog = {
            id: this.generateNotificationId(),
            channelId,
            channelType: channel.type,
            sentAt: new Date().toISOString(),
            success,
            error,
            responseTime: Date.now() - startTime
        };
        return notificationLog;
    }
    /**
   * Monitoreo de escalamiento automático
   */ async checkEscalations() {
        for (const alert of this.activeAlerts.values()){
            if (alert.status !== "active") {
                continue;
            }
            const rule = this.alertRules.get(alert.ruleId);
            if (!rule) {
                continue;
            }
            // Verificar reglas de escalamiento
            for (const escalationRuleId of rule.escalationRules){
                const escalationRule = this.escalationRules.get(escalationRuleId);
                if (!escalationRule || !escalationRule.enabled) {
                    continue;
                }
                // Verificar condiciones de escalamiento
                if (this.shouldEscalate(alert, escalationRule)) {
                    await this.escalateAlert(alert, escalationRule);
                }
            }
        }
    }
    /**
   * Verifica si una alerta debe escalarse
   */ shouldEscalate(alert, rule) {
        // Verificar nivel
        if (alert.level !== rule.conditions.level) {
            return false;
        }
        // Verificar duración
        const alertAge = Date.now() - new Date(alert.triggeredAt).getTime();
        const requiredDuration = rule.conditions.duration * 60 * 1000 // convertir a ms
        ;
        if (alertAge < requiredDuration) {
            return false;
        }
        // Verificar si ya fue escalada
        if (alert.escalatedAt) {
            return false;
        }
        return true;
    }
    /**
   * Escala una alerta
   */ async escalateAlert(alert, rule) {
        const originalLevel = alert.level;
        // Actualizar nivel si es necesario
        if (rule.actions.escalateToLevel) {
            alert.level = rule.actions.escalateToLevel;
            alert.escalatedFrom = originalLevel;
        }
        alert.escalatedAt = new Date().toISOString();
        // Enviar notificaciones de escalamiento
        await this.sendNotifications(alert, rule.actions.notifyChannels);
        // Asignar a usuario si es necesario
        if (rule.actions.assignToUser) {
            alert.metadata = {
                ...alert.metadata,
                assignedTo: rule.actions.assignToUser
            };
        }
        await this.updateAlert(alert);
        _logger.logger.error(_logger.LogLevel.ERROR, `Alert escalated: ${alert.id}`, {
            originalLevel,
            newLevel: alert.level,
            escalationRule: rule.name,
            duration: this.calculateDuration(alert.triggeredAt, alert.escalatedAt)
        }, _logger.LogCategory.SYSTEM);
    }
    /**
   * Implementaciones de notificación específicas
   */ async sendEmailNotification(alert, channel) {
        try {
            const subject = `[${alert.level.toUpperCase()}] ${alert.ruleName}`;
            const emailData = {
                to: channel.config.to || [
                    'admin@example.com'
                ],
                subject,
                template: 'alert-notification',
                data: {
                    alert,
                    level: alert.level.toUpperCase(),
                    timestamp: new Date(alert.triggeredAt).toLocaleString(),
                    message: alert.message,
                    metricName: alert.metricName,
                    value: alert.value,
                    threshold: alert.threshold
                },
                priority: alert.level === "critical" || alert.level === "emergency" ? 'high' : 'normal'
            };
            await _email.emailService.sendNotification(emailData);
            _logger.logger.info(_logger.LogLevel.INFO, `Email notification sent successfully`, {
                alertId: alert.id,
                to: channel.config.to,
                subject
            }, _logger.LogCategory.SYSTEM);
        } catch (error) {
            _logger.logger.error(_logger.LogLevel.ERROR, `Failed to send email notification`, {
                alertId: alert.id,
                error: error instanceof Error ? error.message : 'Unknown error'
            }, _logger.LogCategory.SYSTEM);
            throw error;
        }
    }
    async sendSlackNotification(alert, channel) {
        try {
            const alertData = {
                title: `${alert.level.toUpperCase()}: ${alert.ruleName}`,
                message: alert.message,
                severity: alert.level === "critical" || alert.level === "emergency" ? 'error' : alert.level === "warning" ? 'warning' : 'info',
                details: {
                    'Alert ID': alert.id,
                    Timestamp: new Date(alert.triggeredAt).toLocaleString(),
                    Metric: alert.metricName,
                    Value: alert.value?.toString() || 'N/A',
                    Threshold: alert.threshold?.toString() || 'N/A',
                    Status: alert.status,
                    ...alert.tags
                }
            };
            await _slack.slackService.sendSystemAlert(alertData);
            _logger.logger.info(_logger.LogLevel.INFO, `Slack notification sent successfully`, {
                alertId: alert.id,
                channel: channel.config.channel,
                webhook: channel.config.webhookUrl ? 'configured' : 'missing'
            }, _logger.LogCategory.SYSTEM);
        } catch (error) {
            _logger.logger.error(_logger.LogLevel.ERROR, `Failed to send Slack notification`, {
                alertId: alert.id,
                error: error instanceof Error ? error.message : 'Unknown error'
            }, _logger.LogCategory.SYSTEM);
            throw error;
        }
    }
    async sendWebhookNotification(alert, channel) {
        if (!channel.config.url) {
            throw new Error('Webhook URL not configured');
        }
        const response = await fetch(channel.config.url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                ...channel.config.headers || {}
            },
            body: JSON.stringify({
                alert,
                timestamp: new Date().toISOString(),
                source: 'pinteya-ecommerce'
            })
        });
        if (!response.ok) {
            throw new Error(`Webhook failed: ${response.status} ${response.statusText}`);
        }
    }
    async sendSMSNotification(alert, channel) {
        // TODO: Implementar envío de SMS
        _logger.logger.info(_logger.LogLevel.INFO, `SMS notification sent`, {
            alertId: alert.id,
            to: channel.config.phoneNumber
        }, _logger.LogCategory.SYSTEM);
    }
    async sendLogNotification(alert, channel) {
        const logLevel = alert.level === "emergency" || alert.level === "critical" ? _logger.LogLevel.ERROR : _logger.LogLevel.WARN;
        _logger.logger.log(logLevel, `ALERT: ${alert.message}`, {
            alertId: alert.id,
            level: alert.level,
            metricName: alert.metricName,
            value: alert.value,
            threshold: alert.threshold,
            ruleName: alert.ruleName
        }, _logger.LogCategory.SYSTEM);
    }
    /**
   * Inicializa canales por defecto
   */ initializeDefaultChannels() {
        // Canal de log por defecto
        this.setNotificationChannel({
            id: 'default_log',
            type: "log",
            name: 'Default Log Channel',
            config: {},
            enabled: true,
            levels: [
                "info",
                "warning",
                "critical",
                "emergency"
            ]
        });
        // Canal de webhook por defecto (deshabilitado)
        this.setNotificationChannel({
            id: 'default_webhook',
            type: "webhook",
            name: 'Default Webhook Channel',
            config: {
                url: process.env.ALERT_WEBHOOK_URL || ''
            },
            enabled: false,
            levels: [
                "critical",
                "emergency"
            ],
            rateLimit: {
                maxPerHour: 10,
                maxPerDay: 50
            }
        });
    }
    /**
   * Inicializa reglas por defecto
   */ initializeDefaultRules() {
        // Regla de escalamiento para alertas críticas
        this.setEscalationRule({
            id: 'critical_escalation',
            name: 'Critical Alert Escalation',
            enabled: true,
            conditions: {
                level: "critical",
                duration: 15
            },
            actions: {
                escalateToLevel: "emergency",
                notifyChannels: [
                    'default_log',
                    'default_webhook'
                ]
            }
        });
    }
    /**
   * Inicia monitoreo de escalamiento
   */ startEscalationMonitoring() {
        this.escalationInterval = setInterval(()=>{
            this.checkEscalations();
        }, 60000); // Verificar cada minuto
    }
    /**
   * Funciones auxiliares
   */ generateAlertId() {
        return `alert_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    }
    generateNotificationId() {
        return `notif_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    }
    calculateDuration(start, end) {
        return Math.round((new Date(end).getTime() - new Date(start).getTime()) / 1000 / 60) // minutos
        ;
    }
    async checkRateLimit(channelId, rateLimit) {
        // TODO: Implementar verificación de rate limiting con Redis
        return true;
    }
    async storeAlert(alert) {
        try {
            const supabase = (0, _supabase.getSupabaseClient)(true);
            if (!supabase) {
                return;
            }
            await supabase.from('enterprise_alerts').insert({
                id: alert.id,
                rule_id: alert.ruleId,
                rule_name: alert.ruleName,
                level: alert.level,
                status: alert.status,
                message: alert.message,
                metric_name: alert.metricName,
                value: alert.value,
                threshold: alert.threshold,
                triggered_at: alert.triggeredAt,
                acknowledged_at: alert.acknowledgedAt,
                acknowledged_by: alert.acknowledgedBy,
                resolved_at: alert.resolvedAt,
                resolved_by: alert.resolvedBy,
                escalated_at: alert.escalatedAt,
                escalated_from: alert.escalatedFrom,
                notifications_sent: alert.notificationsSent,
                tags: alert.tags,
                metadata: alert.metadata
            });
        } catch (error) {
            _logger.logger.error(_logger.LogLevel.ERROR, 'Failed to store alert', {
                error: error instanceof Error ? error.message : 'Unknown error',
                alertId: alert.id
            }, _logger.LogCategory.SYSTEM);
        }
    }
    async updateAlert(alert) {
        try {
            const supabase = (0, _supabase.getSupabaseClient)(true);
            if (!supabase) {
                return;
            }
            await supabase.from('enterprise_alerts').update({
                level: alert.level,
                status: alert.status,
                acknowledged_at: alert.acknowledgedAt,
                acknowledged_by: alert.acknowledgedBy,
                resolved_at: alert.resolvedAt,
                resolved_by: alert.resolvedBy,
                escalated_at: alert.escalatedAt,
                escalated_from: alert.escalatedFrom,
                notifications_sent: alert.notificationsSent,
                metadata: alert.metadata
            }).eq('id', alert.id);
        } catch (error) {
            _logger.logger.error(_logger.LogLevel.ERROR, 'Failed to update alert', {
                error: error instanceof Error ? error.message : 'Unknown error',
                alertId: alert.id
            }, _logger.LogCategory.SYSTEM);
        }
    }
    /**
   * Limpia recursos
   */ destroy() {
        if (this.escalationInterval) {
            clearInterval(this.escalationInterval);
            this.escalationInterval = null;
        }
    }
}
const enterpriseAlertSystem = EnterpriseAlertSystem.getInstance();
const triggerAlert = enterpriseAlertSystem.triggerAlert.bind(enterpriseAlertSystem);
const acknowledgeAlert = enterpriseAlertSystem.acknowledgeAlert.bind(enterpriseAlertSystem);
const resolveAlert = enterpriseAlertSystem.resolveAlert.bind(enterpriseAlertSystem);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcbGliXFxtb25pdG9yaW5nXFxhbGVydC1zeXN0ZW0udHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBJTlRFWUEgRS1DT01NRVJDRSAtIEVOVEVSUFJJU0UgQUxFUlQgU1lTVEVNXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgeyBsb2dnZXIsIExvZ0xldmVsLCBMb2dDYXRlZ29yeSB9IGZyb20gJ0AvbGliL2VudGVycHJpc2UvbG9nZ2VyJ1xuaW1wb3J0IHsgZ2V0U3VwYWJhc2VDbGllbnQgfSBmcm9tICdAL2xpYi9pbnRlZ3JhdGlvbnMvc3VwYWJhc2UnXG5pbXBvcnQgeyBlbWFpbFNlcnZpY2UgfSBmcm9tICdAL2xpYi9ub3RpZmljYXRpb25zL2VtYWlsJ1xuaW1wb3J0IHsgc2xhY2tTZXJ2aWNlIH0gZnJvbSAnQC9saWIvbm90aWZpY2F0aW9ucy9zbGFjaydcblxuLy8g4pyFIElNUE9SVCBDT05ESUNJT05BTDogU29sbyBjYXJnYXIgQ2FjaGVVdGlscyBlbiBzZXJ2aWRvciBwYXJhIGV2aXRhciBlcnJvcmVzIGRlIGlvcmVkaXMgZW4gY2xpZW50ZVxubGV0IENhY2hlVXRpbHM6IGFueSA9IG51bGxcbmlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xuICAvLyBTb2xvIGVuIHNlcnZpZG9yXG4gIHRyeSB7XG4gICAgQ2FjaGVVdGlscyA9IHJlcXVpcmUoJ0AvbGliL2NhY2hlLW1hbmFnZXInKS5DYWNoZVV0aWxzXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS53YXJuKCdbRW50ZXJwcmlzZUFsZXJ0U3lzdGVtXSBDYWNoZVV0aWxzIG5vdCBhdmFpbGFibGU6JywgZXJyb3IpXG4gIH1cbn1cblxuLy8gTml2ZWxlcyBkZSBhbGVydGEgY29uIGVzY2FsYW1pZW50b1xuZXhwb3J0IGVudW0gQWxlcnRMZXZlbCB7XG4gIElORk8gPSAnaW5mbycsXG4gIFdBUk5JTkcgPSAnd2FybmluZycsXG4gIENSSVRJQ0FMID0gJ2NyaXRpY2FsJyxcbiAgRU1FUkdFTkNZID0gJ2VtZXJnZW5jeScsXG59XG5cbi8vIFRpcG9zIGRlIG5vdGlmaWNhY2nDs25cbmV4cG9ydCBlbnVtIE5vdGlmaWNhdGlvblR5cGUge1xuICBFTUFJTCA9ICdlbWFpbCcsXG4gIFNMQUNLID0gJ3NsYWNrJyxcbiAgV0VCSE9PSyA9ICd3ZWJob29rJyxcbiAgU01TID0gJ3NtcycsXG4gIFBVU0ggPSAncHVzaCcsXG4gIExPRyA9ICdsb2cnLFxufVxuXG4vLyBFc3RhZG9zIGRlIGFsZXJ0YVxuZXhwb3J0IGVudW0gQWxlcnRTdGF0dXMge1xuICBBQ1RJVkUgPSAnYWN0aXZlJyxcbiAgQUNLTk9XTEVER0VEID0gJ2Fja25vd2xlZGdlZCcsXG4gIFJFU09MVkVEID0gJ3Jlc29sdmVkJyxcbiAgU1VQUFJFU1NFRCA9ICdzdXBwcmVzc2VkJyxcbn1cblxuLy8gQ29uZmlndXJhY2nDs24gZGUgY2FuYWwgZGUgbm90aWZpY2FjacOzblxuZXhwb3J0IGludGVyZmFjZSBOb3RpZmljYXRpb25DaGFubmVsIHtcbiAgaWQ6IHN0cmluZ1xuICB0eXBlOiBOb3RpZmljYXRpb25UeXBlXG4gIG5hbWU6IHN0cmluZ1xuICBjb25maWc6IFJlY29yZDxzdHJpbmcsIGFueT5cbiAgZW5hYmxlZDogYm9vbGVhblxuICBsZXZlbHM6IEFsZXJ0TGV2ZWxbXVxuICByYXRlTGltaXQ/OiB7XG4gICAgbWF4UGVySG91cjogbnVtYmVyXG4gICAgbWF4UGVyRGF5OiBudW1iZXJcbiAgfVxufVxuXG4vLyBSZWdsYSBkZSBlc2NhbGFtaWVudG9cbmV4cG9ydCBpbnRlcmZhY2UgRXNjYWxhdGlvblJ1bGUge1xuICBpZDogc3RyaW5nXG4gIG5hbWU6IHN0cmluZ1xuICBlbmFibGVkOiBib29sZWFuXG4gIGNvbmRpdGlvbnM6IHtcbiAgICBsZXZlbDogQWxlcnRMZXZlbFxuICAgIGR1cmF0aW9uOiBudW1iZXIgLy8gbWludXRvcyBzaW4gcmVzb2x1Y2nDs25cbiAgICByZXBlYXRDb3VudD86IG51bWJlciAvLyBuw7ptZXJvIGRlIHJlcGV0aWNpb25lc1xuICB9XG4gIGFjdGlvbnM6IHtcbiAgICBlc2NhbGF0ZVRvTGV2ZWw/OiBBbGVydExldmVsXG4gICAgbm90aWZ5Q2hhbm5lbHM6IHN0cmluZ1tdIC8vIElEcyBkZSBjYW5hbGVzXG4gICAgYXNzaWduVG9Vc2VyPzogc3RyaW5nXG4gIH1cbn1cblxuLy8gQ29uZmlndXJhY2nDs24gZGUgYWxlcnRhXG5leHBvcnQgaW50ZXJmYWNlIEFsZXJ0UnVsZSB7XG4gIGlkOiBzdHJpbmdcbiAgbmFtZTogc3RyaW5nXG4gIGRlc2NyaXB0aW9uOiBzdHJpbmdcbiAgZW5hYmxlZDogYm9vbGVhblxuICBtZXRyaWNOYW1lOiBzdHJpbmdcbiAgY29uZGl0aW9uOiAnZ3QnIHwgJ2x0JyB8ICdlcScgfCAnZ3RlJyB8ICdsdGUnXG4gIHRocmVzaG9sZDogbnVtYmVyXG4gIGxldmVsOiBBbGVydExldmVsXG4gIGNvb2xkb3duTWludXRlczogbnVtYmVyXG4gIGNoYW5uZWxzOiBzdHJpbmdbXSAvLyBJRHMgZGUgY2FuYWxlcyBkZSBub3RpZmljYWNpw7NuXG4gIGVzY2FsYXRpb25SdWxlczogc3RyaW5nW10gLy8gSURzIGRlIHJlZ2xhcyBkZSBlc2NhbGFtaWVudG9cbiAgdGFnczogUmVjb3JkPHN0cmluZywgc3RyaW5nPlxuICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT5cbn1cblxuLy8gQWxlcnRhIGFjdGl2YVxuZXhwb3J0IGludGVyZmFjZSBBbGVydCB7XG4gIGlkOiBzdHJpbmdcbiAgcnVsZUlkOiBzdHJpbmdcbiAgcnVsZU5hbWU6IHN0cmluZ1xuICBsZXZlbDogQWxlcnRMZXZlbFxuICBzdGF0dXM6IEFsZXJ0U3RhdHVzXG4gIG1lc3NhZ2U6IHN0cmluZ1xuICBtZXRyaWNOYW1lOiBzdHJpbmdcbiAgdmFsdWU6IG51bWJlclxuICB0aHJlc2hvbGQ6IG51bWJlclxuICB0cmlnZ2VyZWRBdDogc3RyaW5nXG4gIGFja25vd2xlZGdlZEF0Pzogc3RyaW5nXG4gIGFja25vd2xlZGdlZEJ5Pzogc3RyaW5nXG4gIHJlc29sdmVkQXQ/OiBzdHJpbmdcbiAgcmVzb2x2ZWRCeT86IHN0cmluZ1xuICBlc2NhbGF0ZWRBdD86IHN0cmluZ1xuICBlc2NhbGF0ZWRGcm9tPzogQWxlcnRMZXZlbFxuICBub3RpZmljYXRpb25zU2VudDogTm90aWZpY2F0aW9uTG9nW11cbiAgdGFnczogUmVjb3JkPHN0cmluZywgc3RyaW5nPlxuICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT5cbn1cblxuLy8gTG9nIGRlIG5vdGlmaWNhY2nDs25cbmV4cG9ydCBpbnRlcmZhY2UgTm90aWZpY2F0aW9uTG9nIHtcbiAgaWQ6IHN0cmluZ1xuICBjaGFubmVsSWQ6IHN0cmluZ1xuICBjaGFubmVsVHlwZTogTm90aWZpY2F0aW9uVHlwZVxuICBzZW50QXQ6IHN0cmluZ1xuICBzdWNjZXNzOiBib29sZWFuXG4gIGVycm9yPzogc3RyaW5nXG4gIHJlc3BvbnNlVGltZTogbnVtYmVyXG59XG5cbi8qKlxuICogU2lzdGVtYSBkZSBBbGVydGFzIEVudGVycHJpc2UgY29uIGVzY2FsYW1pZW50byBhdXRvbcOhdGljb1xuICovXG5leHBvcnQgY2xhc3MgRW50ZXJwcmlzZUFsZXJ0U3lzdGVtIHtcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IEVudGVycHJpc2VBbGVydFN5c3RlbVxuICBwcml2YXRlIGFsZXJ0UnVsZXM6IE1hcDxzdHJpbmcsIEFsZXJ0UnVsZT4gPSBuZXcgTWFwKClcbiAgcHJpdmF0ZSBub3RpZmljYXRpb25DaGFubmVsczogTWFwPHN0cmluZywgTm90aWZpY2F0aW9uQ2hhbm5lbD4gPSBuZXcgTWFwKClcbiAgcHJpdmF0ZSBlc2NhbGF0aW9uUnVsZXM6IE1hcDxzdHJpbmcsIEVzY2FsYXRpb25SdWxlPiA9IG5ldyBNYXAoKVxuICBwcml2YXRlIGFjdGl2ZUFsZXJ0czogTWFwPHN0cmluZywgQWxlcnQ+ID0gbmV3IE1hcCgpXG4gIHByaXZhdGUgZXNjYWxhdGlvbkludGVydmFsOiBOb2RlSlMuVGltZW91dCB8IG51bGwgPSBudWxsXG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5pbml0aWFsaXplRGVmYXVsdENoYW5uZWxzKClcbiAgICB0aGlzLmluaXRpYWxpemVEZWZhdWx0UnVsZXMoKVxuICAgIHRoaXMuc3RhcnRFc2NhbGF0aW9uTW9uaXRvcmluZygpXG4gIH1cblxuICBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogRW50ZXJwcmlzZUFsZXJ0U3lzdGVtIHtcbiAgICBpZiAoIUVudGVycHJpc2VBbGVydFN5c3RlbS5pbnN0YW5jZSkge1xuICAgICAgRW50ZXJwcmlzZUFsZXJ0U3lzdGVtLmluc3RhbmNlID0gbmV3IEVudGVycHJpc2VBbGVydFN5c3RlbSgpXG4gICAgfVxuICAgIHJldHVybiBFbnRlcnByaXNlQWxlcnRTeXN0ZW0uaW5zdGFuY2VcbiAgfVxuXG4gIC8qKlxuICAgKiBDb25maWd1cmEgdW4gY2FuYWwgZGUgbm90aWZpY2FjacOzblxuICAgKi9cbiAgc2V0Tm90aWZpY2F0aW9uQ2hhbm5lbChjaGFubmVsOiBOb3RpZmljYXRpb25DaGFubmVsKTogdm9pZCB7XG4gICAgdGhpcy5ub3RpZmljYXRpb25DaGFubmVscy5zZXQoY2hhbm5lbC5pZCwgY2hhbm5lbClcbiAgICBsb2dnZXIuaW5mbyhcbiAgICAgIExvZ0xldmVsLklORk8sXG4gICAgICBgTm90aWZpY2F0aW9uIGNoYW5uZWwgY29uZmlndXJlZDogJHtjaGFubmVsLmlkfWAsXG4gICAgICB7XG4gICAgICAgIHR5cGU6IGNoYW5uZWwudHlwZSxcbiAgICAgICAgZW5hYmxlZDogY2hhbm5lbC5lbmFibGVkLFxuICAgICAgICBsZXZlbHM6IGNoYW5uZWwubGV2ZWxzLFxuICAgICAgfSxcbiAgICAgIExvZ0NhdGVnb3J5LlNZU1RFTVxuICAgIClcbiAgfVxuXG4gIC8qKlxuICAgKiBDb25maWd1cmEgdW5hIHJlZ2xhIGRlIGVzY2FsYW1pZW50b1xuICAgKi9cbiAgc2V0RXNjYWxhdGlvblJ1bGUocnVsZTogRXNjYWxhdGlvblJ1bGUpOiB2b2lkIHtcbiAgICB0aGlzLmVzY2FsYXRpb25SdWxlcy5zZXQocnVsZS5pZCwgcnVsZSlcbiAgICBsb2dnZXIuaW5mbyhcbiAgICAgIExvZ0xldmVsLklORk8sXG4gICAgICBgRXNjYWxhdGlvbiBydWxlIGNvbmZpZ3VyZWQ6ICR7cnVsZS5pZH1gLFxuICAgICAge1xuICAgICAgICBsZXZlbDogcnVsZS5jb25kaXRpb25zLmxldmVsLFxuICAgICAgICBkdXJhdGlvbjogcnVsZS5jb25kaXRpb25zLmR1cmF0aW9uLFxuICAgICAgICBlbmFibGVkOiBydWxlLmVuYWJsZWQsXG4gICAgICB9LFxuICAgICAgTG9nQ2F0ZWdvcnkuU1lTVEVNXG4gICAgKVxuICB9XG5cbiAgLyoqXG4gICAqIENvbmZpZ3VyYSB1bmEgcmVnbGEgZGUgYWxlcnRhXG4gICAqL1xuICBzZXRBbGVydFJ1bGUocnVsZTogQWxlcnRSdWxlKTogdm9pZCB7XG4gICAgdGhpcy5hbGVydFJ1bGVzLnNldChydWxlLmlkLCBydWxlKVxuICAgIGxvZ2dlci5pbmZvKFxuICAgICAgTG9nTGV2ZWwuSU5GTyxcbiAgICAgIGBBbGVydCBydWxlIGNvbmZpZ3VyZWQ6ICR7cnVsZS5pZH1gLFxuICAgICAge1xuICAgICAgICBtZXRyaWNOYW1lOiBydWxlLm1ldHJpY05hbWUsXG4gICAgICAgIHRocmVzaG9sZDogcnVsZS50aHJlc2hvbGQsXG4gICAgICAgIGxldmVsOiBydWxlLmxldmVsLFxuICAgICAgICBlbmFibGVkOiBydWxlLmVuYWJsZWQsXG4gICAgICB9LFxuICAgICAgTG9nQ2F0ZWdvcnkuU1lTVEVNXG4gICAgKVxuICB9XG5cbiAgLyoqXG4gICAqIERpc3BhcmEgdW5hIGFsZXJ0YVxuICAgKi9cbiAgYXN5bmMgdHJpZ2dlckFsZXJ0KFxuICAgIHJ1bGVJZDogc3RyaW5nLFxuICAgIG1ldHJpY05hbWU6IHN0cmluZyxcbiAgICB2YWx1ZTogbnVtYmVyLFxuICAgIG1lc3NhZ2U/OiBzdHJpbmdcbiAgKTogUHJvbWlzZTxBbGVydCB8IG51bGw+IHtcbiAgICBjb25zdCBydWxlID0gdGhpcy5hbGVydFJ1bGVzLmdldChydWxlSWQpXG4gICAgaWYgKCFydWxlIHx8ICFydWxlLmVuYWJsZWQpIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuXG4gICAgLy8gVmVyaWZpY2FyIGNvb2xkb3duXG4gICAgY29uc3QgZXhpc3RpbmdBbGVydCA9IEFycmF5LmZyb20odGhpcy5hY3RpdmVBbGVydHMudmFsdWVzKCkpLmZpbmQoXG4gICAgICBhbGVydCA9PiBhbGVydC5ydWxlSWQgPT09IHJ1bGVJZCAmJiBhbGVydC5zdGF0dXMgPT09IEFsZXJ0U3RhdHVzLkFDVElWRVxuICAgIClcblxuICAgIGlmIChleGlzdGluZ0FsZXJ0KSB7XG4gICAgICBjb25zdCBjb29sZG93bkVuZCA9IG5ldyBEYXRlKGV4aXN0aW5nQWxlcnQudHJpZ2dlcmVkQXQpXG4gICAgICBjb29sZG93bkVuZC5zZXRNaW51dGVzKGNvb2xkb3duRW5kLmdldE1pbnV0ZXMoKSArIHJ1bGUuY29vbGRvd25NaW51dGVzKVxuXG4gICAgICBpZiAobmV3IERhdGUoKSA8IGNvb2xkb3duRW5kKSB7XG4gICAgICAgIHJldHVybiBudWxsIC8vIEHDum4gZW4gY29vbGRvd25cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBDcmVhciBudWV2YSBhbGVydGFcbiAgICBjb25zdCBhbGVydDogQWxlcnQgPSB7XG4gICAgICBpZDogdGhpcy5nZW5lcmF0ZUFsZXJ0SWQoKSxcbiAgICAgIHJ1bGVJZDogcnVsZS5pZCxcbiAgICAgIHJ1bGVOYW1lOiBydWxlLm5hbWUsXG4gICAgICBsZXZlbDogcnVsZS5sZXZlbCxcbiAgICAgIHN0YXR1czogQWxlcnRTdGF0dXMuQUNUSVZFLFxuICAgICAgbWVzc2FnZTogbWVzc2FnZSB8fCBgJHtydWxlLmRlc2NyaXB0aW9ufSAtIFZhbHVlOiAke3ZhbHVlfSwgVGhyZXNob2xkOiAke3J1bGUudGhyZXNob2xkfWAsXG4gICAgICBtZXRyaWNOYW1lLFxuICAgICAgdmFsdWUsXG4gICAgICB0aHJlc2hvbGQ6IHJ1bGUudGhyZXNob2xkLFxuICAgICAgdHJpZ2dlcmVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIG5vdGlmaWNhdGlvbnNTZW50OiBbXSxcbiAgICAgIHRhZ3M6IHJ1bGUudGFncyxcbiAgICAgIG1ldGFkYXRhOiBydWxlLm1ldGFkYXRhLFxuICAgIH1cblxuICAgIHRoaXMuYWN0aXZlQWxlcnRzLnNldChhbGVydC5pZCwgYWxlcnQpXG5cbiAgICAvLyBFbnZpYXIgbm90aWZpY2FjaW9uZXNcbiAgICBhd2FpdCB0aGlzLnNlbmROb3RpZmljYXRpb25zKGFsZXJ0LCBydWxlLmNoYW5uZWxzKVxuXG4gICAgLy8gQWxtYWNlbmFyIGVuIGJhc2UgZGUgZGF0b3NcbiAgICBhd2FpdCB0aGlzLnN0b3JlQWxlcnQoYWxlcnQpXG5cbiAgICBsb2dnZXIud2FybihcbiAgICAgIExvZ0xldmVsLldBUk4sXG4gICAgICBgQWxlcnQgdHJpZ2dlcmVkOiAke3J1bGUubmFtZX1gLFxuICAgICAge1xuICAgICAgICBhbGVydElkOiBhbGVydC5pZCxcbiAgICAgICAgbGV2ZWw6IGFsZXJ0LmxldmVsLFxuICAgICAgICBtZXRyaWNOYW1lOiBhbGVydC5tZXRyaWNOYW1lLFxuICAgICAgICB2YWx1ZTogYWxlcnQudmFsdWUsXG4gICAgICAgIHRocmVzaG9sZDogYWxlcnQudGhyZXNob2xkLFxuICAgICAgfSxcbiAgICAgIExvZ0NhdGVnb3J5LlNZU1RFTVxuICAgIClcblxuICAgIHJldHVybiBhbGVydFxuICB9XG5cbiAgLyoqXG4gICAqIFJlY29ub2NlIHVuYSBhbGVydGFcbiAgICovXG4gIGFzeW5jIGFja25vd2xlZGdlQWxlcnQoYWxlcnRJZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IGFsZXJ0ID0gdGhpcy5hY3RpdmVBbGVydHMuZ2V0KGFsZXJ0SWQpXG4gICAgaWYgKCFhbGVydCB8fCBhbGVydC5zdGF0dXMgIT09IEFsZXJ0U3RhdHVzLkFDVElWRSkge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgYWxlcnQuc3RhdHVzID0gQWxlcnRTdGF0dXMuQUNLTk9XTEVER0VEXG4gICAgYWxlcnQuYWNrbm93bGVkZ2VkQXQgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICBhbGVydC5hY2tub3dsZWRnZWRCeSA9IHVzZXJJZFxuXG4gICAgYXdhaXQgdGhpcy51cGRhdGVBbGVydChhbGVydClcblxuICAgIGxvZ2dlci5pbmZvKFxuICAgICAgTG9nTGV2ZWwuSU5GTyxcbiAgICAgIGBBbGVydCBhY2tub3dsZWRnZWQ6ICR7YWxlcnRJZH1gLFxuICAgICAge1xuICAgICAgICB1c2VySWQsXG4gICAgICAgIGxldmVsOiBhbGVydC5sZXZlbCxcbiAgICAgICAgcnVsZU5hbWU6IGFsZXJ0LnJ1bGVOYW1lLFxuICAgICAgfSxcbiAgICAgIExvZ0NhdGVnb3J5LlNZU1RFTVxuICAgIClcblxuICAgIHJldHVybiB0cnVlXG4gIH1cblxuICAvKipcbiAgICogUmVzdWVsdmUgdW5hIGFsZXJ0YVxuICAgKi9cbiAgYXN5bmMgcmVzb2x2ZUFsZXJ0KGFsZXJ0SWQ6IHN0cmluZywgdXNlcklkPzogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgYWxlcnQgPSB0aGlzLmFjdGl2ZUFsZXJ0cy5nZXQoYWxlcnRJZClcbiAgICBpZiAoIWFsZXJ0KSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICBhbGVydC5zdGF0dXMgPSBBbGVydFN0YXR1cy5SRVNPTFZFRFxuICAgIGFsZXJ0LnJlc29sdmVkQXQgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICBhbGVydC5yZXNvbHZlZEJ5ID0gdXNlcklkXG5cbiAgICBhd2FpdCB0aGlzLnVwZGF0ZUFsZXJ0KGFsZXJ0KVxuICAgIHRoaXMuYWN0aXZlQWxlcnRzLmRlbGV0ZShhbGVydElkKVxuXG4gICAgbG9nZ2VyLmluZm8oXG4gICAgICBMb2dMZXZlbC5JTkZPLFxuICAgICAgYEFsZXJ0IHJlc29sdmVkOiAke2FsZXJ0SWR9YCxcbiAgICAgIHtcbiAgICAgICAgdXNlcklkLFxuICAgICAgICBsZXZlbDogYWxlcnQubGV2ZWwsXG4gICAgICAgIHJ1bGVOYW1lOiBhbGVydC5ydWxlTmFtZSxcbiAgICAgICAgZHVyYXRpb246IHRoaXMuY2FsY3VsYXRlRHVyYXRpb24oYWxlcnQudHJpZ2dlcmVkQXQsIGFsZXJ0LnJlc29sdmVkQXQhKSxcbiAgICAgIH0sXG4gICAgICBMb2dDYXRlZ29yeS5TWVNURU1cbiAgICApXG5cbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgLyoqXG4gICAqIEVudsOtYSBub3RpZmljYWNpb25lcyBwYXJhIHVuYSBhbGVydGFcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgc2VuZE5vdGlmaWNhdGlvbnMoYWxlcnQ6IEFsZXJ0LCBjaGFubmVsSWRzOiBzdHJpbmdbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IG5vdGlmaWNhdGlvbnMgPSBhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQoXG4gICAgICBjaGFubmVsSWRzLm1hcChjaGFubmVsSWQgPT4gdGhpcy5zZW5kTm90aWZpY2F0aW9uKGFsZXJ0LCBjaGFubmVsSWQpKVxuICAgIClcblxuICAgIC8vIExvZyByZXN1bHRhZG9zXG4gICAgbm90aWZpY2F0aW9ucy5mb3JFYWNoKChyZXN1bHQsIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBjaGFubmVsSWQgPSBjaGFubmVsSWRzW2luZGV4XVxuICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09ICdmdWxmaWxsZWQnICYmIHJlc3VsdC52YWx1ZSkge1xuICAgICAgICBhbGVydC5ub3RpZmljYXRpb25zU2VudC5wdXNoKHJlc3VsdC52YWx1ZSlcbiAgICAgIH0gZWxzZSBpZiAocmVzdWx0LnN0YXR1cyA9PT0gJ3JlamVjdGVkJykge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXG4gICAgICAgICAgTG9nTGV2ZWwuRVJST1IsXG4gICAgICAgICAgYEZhaWxlZCB0byBzZW5kIG5vdGlmaWNhdGlvbiB0byBjaGFubmVsOiAke2NoYW5uZWxJZH1gLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGFsZXJ0SWQ6IGFsZXJ0LmlkLFxuICAgICAgICAgICAgZXJyb3I6IHJlc3VsdC5yZWFzb24sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBMb2dDYXRlZ29yeS5TWVNURU1cbiAgICAgICAgKVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICAvKipcbiAgICogRW52w61hIG5vdGlmaWNhY2nDs24gYSB1biBjYW5hbCBlc3BlY8OtZmljb1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBzZW5kTm90aWZpY2F0aW9uKGFsZXJ0OiBBbGVydCwgY2hhbm5lbElkOiBzdHJpbmcpOiBQcm9taXNlPE5vdGlmaWNhdGlvbkxvZyB8IG51bGw+IHtcbiAgICBjb25zdCBjaGFubmVsID0gdGhpcy5ub3RpZmljYXRpb25DaGFubmVscy5nZXQoY2hhbm5lbElkKVxuICAgIGlmICghY2hhbm5lbCB8fCAhY2hhbm5lbC5lbmFibGVkIHx8ICFjaGFubmVsLmxldmVscy5pbmNsdWRlcyhhbGVydC5sZXZlbCkpIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuXG4gICAgLy8gVmVyaWZpY2FyIHJhdGUgbGltaXRpbmdcbiAgICBpZiAoY2hhbm5lbC5yYXRlTGltaXQgJiYgIShhd2FpdCB0aGlzLmNoZWNrUmF0ZUxpbWl0KGNoYW5uZWxJZCwgY2hhbm5lbC5yYXRlTGltaXQpKSkge1xuICAgICAgbG9nZ2VyLndhcm4oXG4gICAgICAgIExvZ0xldmVsLldBUk4sXG4gICAgICAgIGBSYXRlIGxpbWl0IGV4Y2VlZGVkIGZvciBjaGFubmVsOiAke2NoYW5uZWxJZH1gLFxuICAgICAgICB7XG4gICAgICAgICAgYWxlcnRJZDogYWxlcnQuaWQsXG4gICAgICAgIH0sXG4gICAgICAgIExvZ0NhdGVnb3J5LlNZU1RFTVxuICAgICAgKVxuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG5cbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpXG4gICAgbGV0IHN1Y2Nlc3MgPSBmYWxzZVxuICAgIGxldCBlcnJvcjogc3RyaW5nIHwgdW5kZWZpbmVkXG5cbiAgICB0cnkge1xuICAgICAgc3dpdGNoIChjaGFubmVsLnR5cGUpIHtcbiAgICAgICAgY2FzZSBOb3RpZmljYXRpb25UeXBlLkVNQUlMOlxuICAgICAgICAgIGF3YWl0IHRoaXMuc2VuZEVtYWlsTm90aWZpY2F0aW9uKGFsZXJ0LCBjaGFubmVsKVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgTm90aWZpY2F0aW9uVHlwZS5TTEFDSzpcbiAgICAgICAgICBhd2FpdCB0aGlzLnNlbmRTbGFja05vdGlmaWNhdGlvbihhbGVydCwgY2hhbm5lbClcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlIE5vdGlmaWNhdGlvblR5cGUuV0VCSE9PSzpcbiAgICAgICAgICBhd2FpdCB0aGlzLnNlbmRXZWJob29rTm90aWZpY2F0aW9uKGFsZXJ0LCBjaGFubmVsKVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgTm90aWZpY2F0aW9uVHlwZS5TTVM6XG4gICAgICAgICAgYXdhaXQgdGhpcy5zZW5kU01TTm90aWZpY2F0aW9uKGFsZXJ0LCBjaGFubmVsKVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgTm90aWZpY2F0aW9uVHlwZS5MT0c6XG4gICAgICAgICAgYXdhaXQgdGhpcy5zZW5kTG9nTm90aWZpY2F0aW9uKGFsZXJ0LCBjaGFubmVsKVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBub3RpZmljYXRpb24gdHlwZTogJHtjaGFubmVsLnR5cGV9YClcbiAgICAgIH1cbiAgICAgIHN1Y2Nlc3MgPSB0cnVlXG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBlcnJvciA9IGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICB9XG5cbiAgICBjb25zdCBub3RpZmljYXRpb25Mb2c6IE5vdGlmaWNhdGlvbkxvZyA9IHtcbiAgICAgIGlkOiB0aGlzLmdlbmVyYXRlTm90aWZpY2F0aW9uSWQoKSxcbiAgICAgIGNoYW5uZWxJZCxcbiAgICAgIGNoYW5uZWxUeXBlOiBjaGFubmVsLnR5cGUsXG4gICAgICBzZW50QXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIHN1Y2Nlc3MsXG4gICAgICBlcnJvcixcbiAgICAgIHJlc3BvbnNlVGltZTogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSxcbiAgICB9XG5cbiAgICByZXR1cm4gbm90aWZpY2F0aW9uTG9nXG4gIH1cblxuICAvKipcbiAgICogTW9uaXRvcmVvIGRlIGVzY2FsYW1pZW50byBhdXRvbcOhdGljb1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBjaGVja0VzY2FsYXRpb25zKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGZvciAoY29uc3QgYWxlcnQgb2YgdGhpcy5hY3RpdmVBbGVydHMudmFsdWVzKCkpIHtcbiAgICAgIGlmIChhbGVydC5zdGF0dXMgIT09IEFsZXJ0U3RhdHVzLkFDVElWRSkge1xuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuXG4gICAgICBjb25zdCBydWxlID0gdGhpcy5hbGVydFJ1bGVzLmdldChhbGVydC5ydWxlSWQpXG4gICAgICBpZiAoIXJ1bGUpIHtcbiAgICAgICAgY29udGludWVcbiAgICAgIH1cblxuICAgICAgLy8gVmVyaWZpY2FyIHJlZ2xhcyBkZSBlc2NhbGFtaWVudG9cbiAgICAgIGZvciAoY29uc3QgZXNjYWxhdGlvblJ1bGVJZCBvZiBydWxlLmVzY2FsYXRpb25SdWxlcykge1xuICAgICAgICBjb25zdCBlc2NhbGF0aW9uUnVsZSA9IHRoaXMuZXNjYWxhdGlvblJ1bGVzLmdldChlc2NhbGF0aW9uUnVsZUlkKVxuICAgICAgICBpZiAoIWVzY2FsYXRpb25SdWxlIHx8ICFlc2NhbGF0aW9uUnVsZS5lbmFibGVkKSB7XG4gICAgICAgICAgY29udGludWVcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZlcmlmaWNhciBjb25kaWNpb25lcyBkZSBlc2NhbGFtaWVudG9cbiAgICAgICAgaWYgKHRoaXMuc2hvdWxkRXNjYWxhdGUoYWxlcnQsIGVzY2FsYXRpb25SdWxlKSkge1xuICAgICAgICAgIGF3YWl0IHRoaXMuZXNjYWxhdGVBbGVydChhbGVydCwgZXNjYWxhdGlvblJ1bGUpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2Egc2kgdW5hIGFsZXJ0YSBkZWJlIGVzY2FsYXJzZVxuICAgKi9cbiAgcHJpdmF0ZSBzaG91bGRFc2NhbGF0ZShhbGVydDogQWxlcnQsIHJ1bGU6IEVzY2FsYXRpb25SdWxlKTogYm9vbGVhbiB7XG4gICAgLy8gVmVyaWZpY2FyIG5pdmVsXG4gICAgaWYgKGFsZXJ0LmxldmVsICE9PSBydWxlLmNvbmRpdGlvbnMubGV2ZWwpIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cblxuICAgIC8vIFZlcmlmaWNhciBkdXJhY2nDs25cbiAgICBjb25zdCBhbGVydEFnZSA9IERhdGUubm93KCkgLSBuZXcgRGF0ZShhbGVydC50cmlnZ2VyZWRBdCkuZ2V0VGltZSgpXG4gICAgY29uc3QgcmVxdWlyZWREdXJhdGlvbiA9IHJ1bGUuY29uZGl0aW9ucy5kdXJhdGlvbiAqIDYwICogMTAwMCAvLyBjb252ZXJ0aXIgYSBtc1xuXG4gICAgaWYgKGFsZXJ0QWdlIDwgcmVxdWlyZWREdXJhdGlvbikge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgLy8gVmVyaWZpY2FyIHNpIHlhIGZ1ZSBlc2NhbGFkYVxuICAgIGlmIChhbGVydC5lc2NhbGF0ZWRBdCkge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWVcbiAgfVxuXG4gIC8qKlxuICAgKiBFc2NhbGEgdW5hIGFsZXJ0YVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBlc2NhbGF0ZUFsZXJ0KGFsZXJ0OiBBbGVydCwgcnVsZTogRXNjYWxhdGlvblJ1bGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBvcmlnaW5hbExldmVsID0gYWxlcnQubGV2ZWxcblxuICAgIC8vIEFjdHVhbGl6YXIgbml2ZWwgc2kgZXMgbmVjZXNhcmlvXG4gICAgaWYgKHJ1bGUuYWN0aW9ucy5lc2NhbGF0ZVRvTGV2ZWwpIHtcbiAgICAgIGFsZXJ0LmxldmVsID0gcnVsZS5hY3Rpb25zLmVzY2FsYXRlVG9MZXZlbFxuICAgICAgYWxlcnQuZXNjYWxhdGVkRnJvbSA9IG9yaWdpbmFsTGV2ZWxcbiAgICB9XG5cbiAgICBhbGVydC5lc2NhbGF0ZWRBdCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuXG4gICAgLy8gRW52aWFyIG5vdGlmaWNhY2lvbmVzIGRlIGVzY2FsYW1pZW50b1xuICAgIGF3YWl0IHRoaXMuc2VuZE5vdGlmaWNhdGlvbnMoYWxlcnQsIHJ1bGUuYWN0aW9ucy5ub3RpZnlDaGFubmVscylcblxuICAgIC8vIEFzaWduYXIgYSB1c3VhcmlvIHNpIGVzIG5lY2VzYXJpb1xuICAgIGlmIChydWxlLmFjdGlvbnMuYXNzaWduVG9Vc2VyKSB7XG4gICAgICBhbGVydC5tZXRhZGF0YSA9IHtcbiAgICAgICAgLi4uYWxlcnQubWV0YWRhdGEsXG4gICAgICAgIGFzc2lnbmVkVG86IHJ1bGUuYWN0aW9ucy5hc3NpZ25Ub1VzZXIsXG4gICAgICB9XG4gICAgfVxuXG4gICAgYXdhaXQgdGhpcy51cGRhdGVBbGVydChhbGVydClcblxuICAgIGxvZ2dlci5lcnJvcihcbiAgICAgIExvZ0xldmVsLkVSUk9SLFxuICAgICAgYEFsZXJ0IGVzY2FsYXRlZDogJHthbGVydC5pZH1gLFxuICAgICAge1xuICAgICAgICBvcmlnaW5hbExldmVsLFxuICAgICAgICBuZXdMZXZlbDogYWxlcnQubGV2ZWwsXG4gICAgICAgIGVzY2FsYXRpb25SdWxlOiBydWxlLm5hbWUsXG4gICAgICAgIGR1cmF0aW9uOiB0aGlzLmNhbGN1bGF0ZUR1cmF0aW9uKGFsZXJ0LnRyaWdnZXJlZEF0LCBhbGVydC5lc2NhbGF0ZWRBdCksXG4gICAgICB9LFxuICAgICAgTG9nQ2F0ZWdvcnkuU1lTVEVNXG4gICAgKVxuICB9XG5cbiAgLyoqXG4gICAqIEltcGxlbWVudGFjaW9uZXMgZGUgbm90aWZpY2FjacOzbiBlc3BlY8OtZmljYXNcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgc2VuZEVtYWlsTm90aWZpY2F0aW9uKGFsZXJ0OiBBbGVydCwgY2hhbm5lbDogTm90aWZpY2F0aW9uQ2hhbm5lbCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzdWJqZWN0ID0gYFske2FsZXJ0LmxldmVsLnRvVXBwZXJDYXNlKCl9XSAke2FsZXJ0LnJ1bGVOYW1lfWBcbiAgICAgIGNvbnN0IGVtYWlsRGF0YSA9IHtcbiAgICAgICAgdG86IGNoYW5uZWwuY29uZmlnLnRvIHx8IFsnYWRtaW5AZXhhbXBsZS5jb20nXSxcbiAgICAgICAgc3ViamVjdCxcbiAgICAgICAgdGVtcGxhdGU6ICdhbGVydC1ub3RpZmljYXRpb24nLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgYWxlcnQsXG4gICAgICAgICAgbGV2ZWw6IGFsZXJ0LmxldmVsLnRvVXBwZXJDYXNlKCksXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZShhbGVydC50cmlnZ2VyZWRBdCkudG9Mb2NhbGVTdHJpbmcoKSxcbiAgICAgICAgICBtZXNzYWdlOiBhbGVydC5tZXNzYWdlLFxuICAgICAgICAgIG1ldHJpY05hbWU6IGFsZXJ0Lm1ldHJpY05hbWUsXG4gICAgICAgICAgdmFsdWU6IGFsZXJ0LnZhbHVlLFxuICAgICAgICAgIHRocmVzaG9sZDogYWxlcnQudGhyZXNob2xkLFxuICAgICAgICB9LFxuICAgICAgICBwcmlvcml0eTpcbiAgICAgICAgICBhbGVydC5sZXZlbCA9PT0gQWxlcnRMZXZlbC5DUklUSUNBTCB8fCBhbGVydC5sZXZlbCA9PT0gQWxlcnRMZXZlbC5FTUVSR0VOQ1lcbiAgICAgICAgICAgID8gKCdoaWdoJyBhcyBjb25zdClcbiAgICAgICAgICAgIDogKCdub3JtYWwnIGFzIGNvbnN0KSxcbiAgICAgIH1cblxuICAgICAgYXdhaXQgZW1haWxTZXJ2aWNlLnNlbmROb3RpZmljYXRpb24oZW1haWxEYXRhKVxuXG4gICAgICBsb2dnZXIuaW5mbyhcbiAgICAgICAgTG9nTGV2ZWwuSU5GTyxcbiAgICAgICAgYEVtYWlsIG5vdGlmaWNhdGlvbiBzZW50IHN1Y2Nlc3NmdWxseWAsXG4gICAgICAgIHtcbiAgICAgICAgICBhbGVydElkOiBhbGVydC5pZCxcbiAgICAgICAgICB0bzogY2hhbm5lbC5jb25maWcudG8sXG4gICAgICAgICAgc3ViamVjdCxcbiAgICAgICAgfSxcbiAgICAgICAgTG9nQ2F0ZWdvcnkuU1lTVEVNXG4gICAgICApXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcbiAgICAgICAgTG9nTGV2ZWwuRVJST1IsXG4gICAgICAgIGBGYWlsZWQgdG8gc2VuZCBlbWFpbCBub3RpZmljYXRpb25gLFxuICAgICAgICB7XG4gICAgICAgICAgYWxlcnRJZDogYWxlcnQuaWQsXG4gICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICB9LFxuICAgICAgICBMb2dDYXRlZ29yeS5TWVNURU1cbiAgICAgIClcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBzZW5kU2xhY2tOb3RpZmljYXRpb24oYWxlcnQ6IEFsZXJ0LCBjaGFubmVsOiBOb3RpZmljYXRpb25DaGFubmVsKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGFsZXJ0RGF0YSA9IHtcbiAgICAgICAgdGl0bGU6IGAke2FsZXJ0LmxldmVsLnRvVXBwZXJDYXNlKCl9OiAke2FsZXJ0LnJ1bGVOYW1lfWAsXG4gICAgICAgIG1lc3NhZ2U6IGFsZXJ0Lm1lc3NhZ2UsXG4gICAgICAgIHNldmVyaXR5OlxuICAgICAgICAgIGFsZXJ0LmxldmVsID09PSBBbGVydExldmVsLkNSSVRJQ0FMIHx8IGFsZXJ0LmxldmVsID09PSBBbGVydExldmVsLkVNRVJHRU5DWVxuICAgICAgICAgICAgPyAoJ2Vycm9yJyBhcyBjb25zdClcbiAgICAgICAgICAgIDogYWxlcnQubGV2ZWwgPT09IEFsZXJ0TGV2ZWwuV0FSTklOR1xuICAgICAgICAgICAgICA/ICgnd2FybmluZycgYXMgY29uc3QpXG4gICAgICAgICAgICAgIDogKCdpbmZvJyBhcyBjb25zdCksXG4gICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICAnQWxlcnQgSUQnOiBhbGVydC5pZCxcbiAgICAgICAgICBUaW1lc3RhbXA6IG5ldyBEYXRlKGFsZXJ0LnRyaWdnZXJlZEF0KS50b0xvY2FsZVN0cmluZygpLFxuICAgICAgICAgIE1ldHJpYzogYWxlcnQubWV0cmljTmFtZSxcbiAgICAgICAgICBWYWx1ZTogYWxlcnQudmFsdWU/LnRvU3RyaW5nKCkgfHwgJ04vQScsXG4gICAgICAgICAgVGhyZXNob2xkOiBhbGVydC50aHJlc2hvbGQ/LnRvU3RyaW5nKCkgfHwgJ04vQScsXG4gICAgICAgICAgU3RhdHVzOiBhbGVydC5zdGF0dXMsXG4gICAgICAgICAgLi4uYWxlcnQudGFncyxcbiAgICAgICAgfSxcbiAgICAgIH1cblxuICAgICAgYXdhaXQgc2xhY2tTZXJ2aWNlLnNlbmRTeXN0ZW1BbGVydChhbGVydERhdGEpXG5cbiAgICAgIGxvZ2dlci5pbmZvKFxuICAgICAgICBMb2dMZXZlbC5JTkZPLFxuICAgICAgICBgU2xhY2sgbm90aWZpY2F0aW9uIHNlbnQgc3VjY2Vzc2Z1bGx5YCxcbiAgICAgICAge1xuICAgICAgICAgIGFsZXJ0SWQ6IGFsZXJ0LmlkLFxuICAgICAgICAgIGNoYW5uZWw6IGNoYW5uZWwuY29uZmlnLmNoYW5uZWwsXG4gICAgICAgICAgd2ViaG9vazogY2hhbm5lbC5jb25maWcud2ViaG9va1VybCA/ICdjb25maWd1cmVkJyA6ICdtaXNzaW5nJyxcbiAgICAgICAgfSxcbiAgICAgICAgTG9nQ2F0ZWdvcnkuU1lTVEVNXG4gICAgICApXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcbiAgICAgICAgTG9nTGV2ZWwuRVJST1IsXG4gICAgICAgIGBGYWlsZWQgdG8gc2VuZCBTbGFjayBub3RpZmljYXRpb25gLFxuICAgICAgICB7XG4gICAgICAgICAgYWxlcnRJZDogYWxlcnQuaWQsXG4gICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICB9LFxuICAgICAgICBMb2dDYXRlZ29yeS5TWVNURU1cbiAgICAgIClcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBzZW5kV2ViaG9va05vdGlmaWNhdGlvbihhbGVydDogQWxlcnQsIGNoYW5uZWw6IE5vdGlmaWNhdGlvbkNoYW5uZWwpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIWNoYW5uZWwuY29uZmlnLnVybCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdXZWJob29rIFVSTCBub3QgY29uZmlndXJlZCcpXG4gICAgfVxuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChjaGFubmVsLmNvbmZpZy51cmwsIHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAuLi4oY2hhbm5lbC5jb25maWcuaGVhZGVycyB8fCB7fSksXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhbGVydCxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIHNvdXJjZTogJ3BpbnRleWEtZWNvbW1lcmNlJyxcbiAgICAgIH0pLFxuICAgIH0pXG5cbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFdlYmhvb2sgZmFpbGVkOiAke3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBzZW5kU01TTm90aWZpY2F0aW9uKGFsZXJ0OiBBbGVydCwgY2hhbm5lbDogTm90aWZpY2F0aW9uQ2hhbm5lbCk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIFRPRE86IEltcGxlbWVudGFyIGVudsOtbyBkZSBTTVNcbiAgICBsb2dnZXIuaW5mbyhcbiAgICAgIExvZ0xldmVsLklORk8sXG4gICAgICBgU01TIG5vdGlmaWNhdGlvbiBzZW50YCxcbiAgICAgIHtcbiAgICAgICAgYWxlcnRJZDogYWxlcnQuaWQsXG4gICAgICAgIHRvOiBjaGFubmVsLmNvbmZpZy5waG9uZU51bWJlcixcbiAgICAgIH0sXG4gICAgICBMb2dDYXRlZ29yeS5TWVNURU1cbiAgICApXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHNlbmRMb2dOb3RpZmljYXRpb24oYWxlcnQ6IEFsZXJ0LCBjaGFubmVsOiBOb3RpZmljYXRpb25DaGFubmVsKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgbG9nTGV2ZWwgPVxuICAgICAgYWxlcnQubGV2ZWwgPT09IEFsZXJ0TGV2ZWwuRU1FUkdFTkNZIHx8IGFsZXJ0LmxldmVsID09PSBBbGVydExldmVsLkNSSVRJQ0FMXG4gICAgICAgID8gTG9nTGV2ZWwuRVJST1JcbiAgICAgICAgOiBMb2dMZXZlbC5XQVJOXG5cbiAgICBsb2dnZXIubG9nKFxuICAgICAgbG9nTGV2ZWwsXG4gICAgICBgQUxFUlQ6ICR7YWxlcnQubWVzc2FnZX1gLFxuICAgICAge1xuICAgICAgICBhbGVydElkOiBhbGVydC5pZCxcbiAgICAgICAgbGV2ZWw6IGFsZXJ0LmxldmVsLFxuICAgICAgICBtZXRyaWNOYW1lOiBhbGVydC5tZXRyaWNOYW1lLFxuICAgICAgICB2YWx1ZTogYWxlcnQudmFsdWUsXG4gICAgICAgIHRocmVzaG9sZDogYWxlcnQudGhyZXNob2xkLFxuICAgICAgICBydWxlTmFtZTogYWxlcnQucnVsZU5hbWUsXG4gICAgICB9LFxuICAgICAgTG9nQ2F0ZWdvcnkuU1lTVEVNXG4gICAgKVxuICB9XG5cbiAgLyoqXG4gICAqIEluaWNpYWxpemEgY2FuYWxlcyBwb3IgZGVmZWN0b1xuICAgKi9cbiAgcHJpdmF0ZSBpbml0aWFsaXplRGVmYXVsdENoYW5uZWxzKCk6IHZvaWQge1xuICAgIC8vIENhbmFsIGRlIGxvZyBwb3IgZGVmZWN0b1xuICAgIHRoaXMuc2V0Tm90aWZpY2F0aW9uQ2hhbm5lbCh7XG4gICAgICBpZDogJ2RlZmF1bHRfbG9nJyxcbiAgICAgIHR5cGU6IE5vdGlmaWNhdGlvblR5cGUuTE9HLFxuICAgICAgbmFtZTogJ0RlZmF1bHQgTG9nIENoYW5uZWwnLFxuICAgICAgY29uZmlnOiB7fSxcbiAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICBsZXZlbHM6IFtBbGVydExldmVsLklORk8sIEFsZXJ0TGV2ZWwuV0FSTklORywgQWxlcnRMZXZlbC5DUklUSUNBTCwgQWxlcnRMZXZlbC5FTUVSR0VOQ1ldLFxuICAgIH0pXG5cbiAgICAvLyBDYW5hbCBkZSB3ZWJob29rIHBvciBkZWZlY3RvIChkZXNoYWJpbGl0YWRvKVxuICAgIHRoaXMuc2V0Tm90aWZpY2F0aW9uQ2hhbm5lbCh7XG4gICAgICBpZDogJ2RlZmF1bHRfd2ViaG9vaycsXG4gICAgICB0eXBlOiBOb3RpZmljYXRpb25UeXBlLldFQkhPT0ssXG4gICAgICBuYW1lOiAnRGVmYXVsdCBXZWJob29rIENoYW5uZWwnLFxuICAgICAgY29uZmlnOiB7XG4gICAgICAgIHVybDogcHJvY2Vzcy5lbnYuQUxFUlRfV0VCSE9PS19VUkwgfHwgJycsXG4gICAgICB9LFxuICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgICBsZXZlbHM6IFtBbGVydExldmVsLkNSSVRJQ0FMLCBBbGVydExldmVsLkVNRVJHRU5DWV0sXG4gICAgICByYXRlTGltaXQ6IHtcbiAgICAgICAgbWF4UGVySG91cjogMTAsXG4gICAgICAgIG1heFBlckRheTogNTAsXG4gICAgICB9LFxuICAgIH0pXG4gIH1cblxuICAvKipcbiAgICogSW5pY2lhbGl6YSByZWdsYXMgcG9yIGRlZmVjdG9cbiAgICovXG4gIHByaXZhdGUgaW5pdGlhbGl6ZURlZmF1bHRSdWxlcygpOiB2b2lkIHtcbiAgICAvLyBSZWdsYSBkZSBlc2NhbGFtaWVudG8gcGFyYSBhbGVydGFzIGNyw610aWNhc1xuICAgIHRoaXMuc2V0RXNjYWxhdGlvblJ1bGUoe1xuICAgICAgaWQ6ICdjcml0aWNhbF9lc2NhbGF0aW9uJyxcbiAgICAgIG5hbWU6ICdDcml0aWNhbCBBbGVydCBFc2NhbGF0aW9uJyxcbiAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICBjb25kaXRpb25zOiB7XG4gICAgICAgIGxldmVsOiBBbGVydExldmVsLkNSSVRJQ0FMLFxuICAgICAgICBkdXJhdGlvbjogMTUsIC8vIDE1IG1pbnV0b3NcbiAgICAgIH0sXG4gICAgICBhY3Rpb25zOiB7XG4gICAgICAgIGVzY2FsYXRlVG9MZXZlbDogQWxlcnRMZXZlbC5FTUVSR0VOQ1ksXG4gICAgICAgIG5vdGlmeUNoYW5uZWxzOiBbJ2RlZmF1bHRfbG9nJywgJ2RlZmF1bHRfd2ViaG9vayddLFxuICAgICAgfSxcbiAgICB9KVxuICB9XG5cbiAgLyoqXG4gICAqIEluaWNpYSBtb25pdG9yZW8gZGUgZXNjYWxhbWllbnRvXG4gICAqL1xuICBwcml2YXRlIHN0YXJ0RXNjYWxhdGlvbk1vbml0b3JpbmcoKTogdm9pZCB7XG4gICAgdGhpcy5lc2NhbGF0aW9uSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICB0aGlzLmNoZWNrRXNjYWxhdGlvbnMoKVxuICAgIH0sIDYwMDAwKSAvLyBWZXJpZmljYXIgY2FkYSBtaW51dG9cbiAgfVxuXG4gIC8qKlxuICAgKiBGdW5jaW9uZXMgYXV4aWxpYXJlc1xuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZUFsZXJ0SWQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYGFsZXJ0XyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YFxuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZU5vdGlmaWNhdGlvbklkKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBub3RpZl8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWBcbiAgfVxuXG4gIHByaXZhdGUgY2FsY3VsYXRlRHVyYXRpb24oc3RhcnQ6IHN0cmluZywgZW5kOiBzdHJpbmcpOiBudW1iZXIge1xuICAgIHJldHVybiBNYXRoLnJvdW5kKChuZXcgRGF0ZShlbmQpLmdldFRpbWUoKSAtIG5ldyBEYXRlKHN0YXJ0KS5nZXRUaW1lKCkpIC8gMTAwMCAvIDYwKSAvLyBtaW51dG9zXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGNoZWNrUmF0ZUxpbWl0KFxuICAgIGNoYW5uZWxJZDogc3RyaW5nLFxuICAgIHJhdGVMaW1pdDogeyBtYXhQZXJIb3VyOiBudW1iZXI7IG1heFBlckRheTogbnVtYmVyIH1cbiAgKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgLy8gVE9ETzogSW1wbGVtZW50YXIgdmVyaWZpY2FjacOzbiBkZSByYXRlIGxpbWl0aW5nIGNvbiBSZWRpc1xuICAgIHJldHVybiB0cnVlXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHN0b3JlQWxlcnQoYWxlcnQ6IEFsZXJ0KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VDbGllbnQodHJ1ZSlcbiAgICAgIGlmICghc3VwYWJhc2UpIHtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIGF3YWl0IHN1cGFiYXNlLmZyb20oJ2VudGVycHJpc2VfYWxlcnRzJykuaW5zZXJ0KHtcbiAgICAgICAgaWQ6IGFsZXJ0LmlkLFxuICAgICAgICBydWxlX2lkOiBhbGVydC5ydWxlSWQsXG4gICAgICAgIHJ1bGVfbmFtZTogYWxlcnQucnVsZU5hbWUsXG4gICAgICAgIGxldmVsOiBhbGVydC5sZXZlbCxcbiAgICAgICAgc3RhdHVzOiBhbGVydC5zdGF0dXMsXG4gICAgICAgIG1lc3NhZ2U6IGFsZXJ0Lm1lc3NhZ2UsXG4gICAgICAgIG1ldHJpY19uYW1lOiBhbGVydC5tZXRyaWNOYW1lLFxuICAgICAgICB2YWx1ZTogYWxlcnQudmFsdWUsXG4gICAgICAgIHRocmVzaG9sZDogYWxlcnQudGhyZXNob2xkLFxuICAgICAgICB0cmlnZ2VyZWRfYXQ6IGFsZXJ0LnRyaWdnZXJlZEF0LFxuICAgICAgICBhY2tub3dsZWRnZWRfYXQ6IGFsZXJ0LmFja25vd2xlZGdlZEF0LFxuICAgICAgICBhY2tub3dsZWRnZWRfYnk6IGFsZXJ0LmFja25vd2xlZGdlZEJ5LFxuICAgICAgICByZXNvbHZlZF9hdDogYWxlcnQucmVzb2x2ZWRBdCxcbiAgICAgICAgcmVzb2x2ZWRfYnk6IGFsZXJ0LnJlc29sdmVkQnksXG4gICAgICAgIGVzY2FsYXRlZF9hdDogYWxlcnQuZXNjYWxhdGVkQXQsXG4gICAgICAgIGVzY2FsYXRlZF9mcm9tOiBhbGVydC5lc2NhbGF0ZWRGcm9tLFxuICAgICAgICBub3RpZmljYXRpb25zX3NlbnQ6IGFsZXJ0Lm5vdGlmaWNhdGlvbnNTZW50LFxuICAgICAgICB0YWdzOiBhbGVydC50YWdzLFxuICAgICAgICBtZXRhZGF0YTogYWxlcnQubWV0YWRhdGEsXG4gICAgICB9KVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoXG4gICAgICAgIExvZ0xldmVsLkVSUk9SLFxuICAgICAgICAnRmFpbGVkIHRvIHN0b3JlIGFsZXJ0JyxcbiAgICAgICAge1xuICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICBhbGVydElkOiBhbGVydC5pZCxcbiAgICAgICAgfSxcbiAgICAgICAgTG9nQ2F0ZWdvcnkuU1lTVEVNXG4gICAgICApXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyB1cGRhdGVBbGVydChhbGVydDogQWxlcnQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZUNsaWVudCh0cnVlKVxuICAgICAgaWYgKCFzdXBhYmFzZSkge1xuICAgICAgICByZXR1cm5cbiAgICAgIH1cblxuICAgICAgYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2VudGVycHJpc2VfYWxlcnRzJylcbiAgICAgICAgLnVwZGF0ZSh7XG4gICAgICAgICAgbGV2ZWw6IGFsZXJ0LmxldmVsLFxuICAgICAgICAgIHN0YXR1czogYWxlcnQuc3RhdHVzLFxuICAgICAgICAgIGFja25vd2xlZGdlZF9hdDogYWxlcnQuYWNrbm93bGVkZ2VkQXQsXG4gICAgICAgICAgYWNrbm93bGVkZ2VkX2J5OiBhbGVydC5hY2tub3dsZWRnZWRCeSxcbiAgICAgICAgICByZXNvbHZlZF9hdDogYWxlcnQucmVzb2x2ZWRBdCxcbiAgICAgICAgICByZXNvbHZlZF9ieTogYWxlcnQucmVzb2x2ZWRCeSxcbiAgICAgICAgICBlc2NhbGF0ZWRfYXQ6IGFsZXJ0LmVzY2FsYXRlZEF0LFxuICAgICAgICAgIGVzY2FsYXRlZF9mcm9tOiBhbGVydC5lc2NhbGF0ZWRGcm9tLFxuICAgICAgICAgIG5vdGlmaWNhdGlvbnNfc2VudDogYWxlcnQubm90aWZpY2F0aW9uc1NlbnQsXG4gICAgICAgICAgbWV0YWRhdGE6IGFsZXJ0Lm1ldGFkYXRhLFxuICAgICAgICB9KVxuICAgICAgICAuZXEoJ2lkJywgYWxlcnQuaWQpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcbiAgICAgICAgTG9nTGV2ZWwuRVJST1IsXG4gICAgICAgICdGYWlsZWQgdG8gdXBkYXRlIGFsZXJ0JyxcbiAgICAgICAge1xuICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICBhbGVydElkOiBhbGVydC5pZCxcbiAgICAgICAgfSxcbiAgICAgICAgTG9nQ2F0ZWdvcnkuU1lTVEVNXG4gICAgICApXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIExpbXBpYSByZWN1cnNvc1xuICAgKi9cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5lc2NhbGF0aW9uSW50ZXJ2YWwpIHtcbiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5lc2NhbGF0aW9uSW50ZXJ2YWwpXG4gICAgICB0aGlzLmVzY2FsYXRpb25JbnRlcnZhbCA9IG51bGxcbiAgICB9XG4gIH1cbn1cblxuLy8gSW5zdGFuY2lhIHNpbmdsZXRvblxuZXhwb3J0IGNvbnN0IGVudGVycHJpc2VBbGVydFN5c3RlbSA9IEVudGVycHJpc2VBbGVydFN5c3RlbS5nZXRJbnN0YW5jZSgpXG5cbi8vIEZ1bmNpb25lcyBkZSBjb252ZW5pZW5jaWFcbmV4cG9ydCBjb25zdCB0cmlnZ2VyQWxlcnQgPSBlbnRlcnByaXNlQWxlcnRTeXN0ZW0udHJpZ2dlckFsZXJ0LmJpbmQoZW50ZXJwcmlzZUFsZXJ0U3lzdGVtKVxuZXhwb3J0IGNvbnN0IGFja25vd2xlZGdlQWxlcnQgPSBlbnRlcnByaXNlQWxlcnRTeXN0ZW0uYWNrbm93bGVkZ2VBbGVydC5iaW5kKGVudGVycHJpc2VBbGVydFN5c3RlbSlcbmV4cG9ydCBjb25zdCByZXNvbHZlQWxlcnQgPSBlbnRlcnByaXNlQWxlcnRTeXN0ZW0ucmVzb2x2ZUFsZXJ0LmJpbmQoZW50ZXJwcmlzZUFsZXJ0U3lzdGVtKVxuIl0sIm5hbWVzIjpbIkFsZXJ0TGV2ZWwiLCJBbGVydFN0YXR1cyIsIkVudGVycHJpc2VBbGVydFN5c3RlbSIsIk5vdGlmaWNhdGlvblR5cGUiLCJhY2tub3dsZWRnZUFsZXJ0IiwiZW50ZXJwcmlzZUFsZXJ0U3lzdGVtIiwicmVzb2x2ZUFsZXJ0IiwidHJpZ2dlckFsZXJ0IiwiQ2FjaGVVdGlscyIsIndpbmRvdyIsInJlcXVpcmUiLCJlcnJvciIsImNvbnNvbGUiLCJ3YXJuIiwiYWxlcnRSdWxlcyIsIk1hcCIsIm5vdGlmaWNhdGlvbkNoYW5uZWxzIiwiZXNjYWxhdGlvblJ1bGVzIiwiYWN0aXZlQWxlcnRzIiwiZXNjYWxhdGlvbkludGVydmFsIiwiaW5pdGlhbGl6ZURlZmF1bHRDaGFubmVscyIsImluaXRpYWxpemVEZWZhdWx0UnVsZXMiLCJzdGFydEVzY2FsYXRpb25Nb25pdG9yaW5nIiwiZ2V0SW5zdGFuY2UiLCJpbnN0YW5jZSIsInNldE5vdGlmaWNhdGlvbkNoYW5uZWwiLCJjaGFubmVsIiwic2V0IiwiaWQiLCJsb2dnZXIiLCJpbmZvIiwiTG9nTGV2ZWwiLCJJTkZPIiwidHlwZSIsImVuYWJsZWQiLCJsZXZlbHMiLCJMb2dDYXRlZ29yeSIsIlNZU1RFTSIsInNldEVzY2FsYXRpb25SdWxlIiwicnVsZSIsImxldmVsIiwiY29uZGl0aW9ucyIsImR1cmF0aW9uIiwic2V0QWxlcnRSdWxlIiwibWV0cmljTmFtZSIsInRocmVzaG9sZCIsInJ1bGVJZCIsInZhbHVlIiwibWVzc2FnZSIsImdldCIsImV4aXN0aW5nQWxlcnQiLCJBcnJheSIsImZyb20iLCJ2YWx1ZXMiLCJmaW5kIiwiYWxlcnQiLCJzdGF0dXMiLCJjb29sZG93bkVuZCIsIkRhdGUiLCJ0cmlnZ2VyZWRBdCIsInNldE1pbnV0ZXMiLCJnZXRNaW51dGVzIiwiY29vbGRvd25NaW51dGVzIiwiZ2VuZXJhdGVBbGVydElkIiwicnVsZU5hbWUiLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJ0b0lTT1N0cmluZyIsIm5vdGlmaWNhdGlvbnNTZW50IiwidGFncyIsIm1ldGFkYXRhIiwic2VuZE5vdGlmaWNhdGlvbnMiLCJjaGFubmVscyIsInN0b3JlQWxlcnQiLCJXQVJOIiwiYWxlcnRJZCIsInVzZXJJZCIsImFja25vd2xlZGdlZEF0IiwiYWNrbm93bGVkZ2VkQnkiLCJ1cGRhdGVBbGVydCIsInJlc29sdmVkQXQiLCJyZXNvbHZlZEJ5IiwiZGVsZXRlIiwiY2FsY3VsYXRlRHVyYXRpb24iLCJjaGFubmVsSWRzIiwibm90aWZpY2F0aW9ucyIsIlByb21pc2UiLCJhbGxTZXR0bGVkIiwibWFwIiwiY2hhbm5lbElkIiwic2VuZE5vdGlmaWNhdGlvbiIsImZvckVhY2giLCJyZXN1bHQiLCJpbmRleCIsInB1c2giLCJFUlJPUiIsInJlYXNvbiIsImluY2x1ZGVzIiwicmF0ZUxpbWl0IiwiY2hlY2tSYXRlTGltaXQiLCJzdGFydFRpbWUiLCJub3ciLCJzdWNjZXNzIiwic2VuZEVtYWlsTm90aWZpY2F0aW9uIiwic2VuZFNsYWNrTm90aWZpY2F0aW9uIiwic2VuZFdlYmhvb2tOb3RpZmljYXRpb24iLCJzZW5kU01TTm90aWZpY2F0aW9uIiwic2VuZExvZ05vdGlmaWNhdGlvbiIsIkVycm9yIiwiZXJyIiwibm90aWZpY2F0aW9uTG9nIiwiZ2VuZXJhdGVOb3RpZmljYXRpb25JZCIsImNoYW5uZWxUeXBlIiwic2VudEF0IiwicmVzcG9uc2VUaW1lIiwiY2hlY2tFc2NhbGF0aW9ucyIsImVzY2FsYXRpb25SdWxlSWQiLCJlc2NhbGF0aW9uUnVsZSIsInNob3VsZEVzY2FsYXRlIiwiZXNjYWxhdGVBbGVydCIsImFsZXJ0QWdlIiwiZ2V0VGltZSIsInJlcXVpcmVkRHVyYXRpb24iLCJlc2NhbGF0ZWRBdCIsIm9yaWdpbmFsTGV2ZWwiLCJhY3Rpb25zIiwiZXNjYWxhdGVUb0xldmVsIiwiZXNjYWxhdGVkRnJvbSIsIm5vdGlmeUNoYW5uZWxzIiwiYXNzaWduVG9Vc2VyIiwiYXNzaWduZWRUbyIsIm5ld0xldmVsIiwic3ViamVjdCIsInRvVXBwZXJDYXNlIiwiZW1haWxEYXRhIiwidG8iLCJjb25maWciLCJ0ZW1wbGF0ZSIsImRhdGEiLCJ0aW1lc3RhbXAiLCJ0b0xvY2FsZVN0cmluZyIsInByaW9yaXR5IiwiZW1haWxTZXJ2aWNlIiwiYWxlcnREYXRhIiwidGl0bGUiLCJzZXZlcml0eSIsImRldGFpbHMiLCJUaW1lc3RhbXAiLCJNZXRyaWMiLCJWYWx1ZSIsInRvU3RyaW5nIiwiVGhyZXNob2xkIiwiU3RhdHVzIiwic2xhY2tTZXJ2aWNlIiwic2VuZFN5c3RlbUFsZXJ0Iiwid2ViaG9vayIsIndlYmhvb2tVcmwiLCJ1cmwiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5Iiwic291cmNlIiwib2siLCJzdGF0dXNUZXh0IiwicGhvbmVOdW1iZXIiLCJsb2dMZXZlbCIsImxvZyIsInByb2Nlc3MiLCJlbnYiLCJBTEVSVF9XRUJIT09LX1VSTCIsIm1heFBlckhvdXIiLCJtYXhQZXJEYXkiLCJzZXRJbnRlcnZhbCIsIk1hdGgiLCJyYW5kb20iLCJzdWJzdHIiLCJzdGFydCIsImVuZCIsInJvdW5kIiwic3VwYWJhc2UiLCJnZXRTdXBhYmFzZUNsaWVudCIsImluc2VydCIsInJ1bGVfaWQiLCJydWxlX25hbWUiLCJtZXRyaWNfbmFtZSIsInRyaWdnZXJlZF9hdCIsImFja25vd2xlZGdlZF9hdCIsImFja25vd2xlZGdlZF9ieSIsInJlc29sdmVkX2F0IiwicmVzb2x2ZWRfYnkiLCJlc2NhbGF0ZWRfYXQiLCJlc2NhbGF0ZWRfZnJvbSIsIm5vdGlmaWNhdGlvbnNfc2VudCIsInVwZGF0ZSIsImVxIiwi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