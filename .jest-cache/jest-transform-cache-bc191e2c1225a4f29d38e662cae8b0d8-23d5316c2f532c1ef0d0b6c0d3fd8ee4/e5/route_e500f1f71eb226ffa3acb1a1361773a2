55590d8b998f7f69af29dac31563a96d
// ConfiguraciÃ³n para Node.js Runtime
"use strict";

/* istanbul ignore next */
function cov_2gernf09q() {
  var path = "C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\app\\api\\cart\\update\\route.ts";
  var hash = "1e76543b81a9f2a57066094047cda089eca7bf0c";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\app\\api\\cart\\update\\route.ts",
    statementMap: {
      "0": {
        start: {
          line: 3,
          column: 0
        },
        end: {
          line: 5,
          column: 3
        }
      },
      "1": {
        start: {
          line: 7,
          column: 4
        },
        end: {
          line: 10,
          column: 7
        }
      },
      "2": {
        start: {
          line: 7,
          column: 24
        },
        end: {
          line: 10,
          column: 7
        }
      },
      "3": {
        start: {
          line: 12,
          column: 0
        },
        end: {
          line: 28,
          column: 3
        }
      },
      "4": {
        start: {
          line: 14,
          column: 8
        },
        end: {
          line: 14,
          column: 19
        }
      },
      "5": {
        start: {
          line: 17,
          column: 8
        },
        end: {
          line: 17,
          column: 21
        }
      },
      "6": {
        start: {
          line: 20,
          column: 8
        },
        end: {
          line: 20,
          column: 20
        }
      },
      "7": {
        start: {
          line: 23,
          column: 8
        },
        end: {
          line: 23,
          column: 19
        }
      },
      "8": {
        start: {
          line: 26,
          column: 8
        },
        end: {
          line: 26,
          column: 23
        }
      },
      "9": {
        start: {
          line: 29,
          column: 16
        },
        end: {
          line: 29,
          column: 38
        }
      },
      "10": {
        start: {
          line: 30,
          column: 18
        },
        end: {
          line: 30,
          column: 66
        }
      },
      "11": {
        start: {
          line: 31,
          column: 16
        },
        end: {
          line: 31,
          column: 54
        }
      },
      "12": {
        start: {
          line: 32,
          column: 16
        },
        end: {
          line: 32,
          column: 24
        }
      },
      "13": {
        start: {
          line: 34,
          column: 4
        },
        end: {
          line: 201,
          column: 5
        }
      },
      "14": {
        start: {
          line: 35,
          column: 8
        },
        end: {
          line: 35,
          column: 79
        }
      },
      "15": {
        start: {
          line: 37,
          column: 24
        },
        end: {
          line: 37,
          column: 49
        }
      },
      "16": {
        start: {
          line: 38,
          column: 8
        },
        end: {
          line: 47,
          column: 9
        }
      },
      "17": {
        start: {
          line: 39,
          column: 12
        },
        end: {
          line: 39,
          column: 69
        }
      },
      "18": {
        start: {
          line: 40,
          column: 12
        },
        end: {
          line: 46,
          column: 15
        }
      },
      "19": {
        start: {
          line: 48,
          column: 23
        },
        end: {
          line: 48,
          column: 38
        }
      },
      "20": {
        start: {
          line: 50,
          column: 21
        },
        end: {
          line: 50,
          column: 41
        }
      },
      "21": {
        start: {
          line: 51,
          column: 40
        },
        end: {
          line: 51,
          column: 44
        }
      },
      "22": {
        start: {
          line: 53,
          column: 8
        },
        end: {
          line: 61,
          column: 9
        }
      },
      "23": {
        start: {
          line: 54,
          column: 12
        },
        end: {
          line: 60,
          column: 15
        }
      },
      "24": {
        start: {
          line: 62,
          column: 8
        },
        end: {
          line: 70,
          column: 9
        }
      },
      "25": {
        start: {
          line: 63,
          column: 12
        },
        end: {
          line: 69,
          column: 15
        }
      },
      "26": {
        start: {
          line: 71,
          column: 8
        },
        end: {
          line: 71,
          column: 124
        }
      },
      "27": {
        start: {
          line: 73,
          column: 25
        },
        end: {
          line: 73,
          column: 63
        }
      },
      "28": {
        start: {
          line: 74,
          column: 8
        },
        end: {
          line: 82,
          column: 9
        }
      },
      "29": {
        start: {
          line: 75,
          column: 12
        },
        end: {
          line: 75,
          column: 82
        }
      },
      "30": {
        start: {
          line: 76,
          column: 12
        },
        end: {
          line: 81,
          column: 15
        }
      },
      "31": {
        start: {
          line: 84,
          column: 55
        },
        end: {
          line: 84,
          column: 166
        }
      },
      "32": {
        start: {
          line: 85,
          column: 8
        },
        end: {
          line: 94,
          column: 9
        }
      },
      "33": {
        start: {
          line: 86,
          column: 12
        },
        end: {
          line: 86,
          column: 82
        }
      },
      "34": {
        start: {
          line: 87,
          column: 12
        },
        end: {
          line: 93,
          column: 15
        }
      },
      "35": {
        start: {
          line: 96,
          column: 8
        },
        end: {
          line: 107,
          column: 9
        }
      },
      "36": {
        start: {
          line: 97,
          column: 12
        },
        end: {
          line: 97,
          column: 142
        }
      },
      "37": {
        start: {
          line: 98,
          column: 12
        },
        end: {
          line: 106,
          column: 15
        }
      },
      "38": {
        start: {
          line: 109,
          column: 61
        },
        end: {
          line: 109,
          column: 176
        }
      },
      "39": {
        start: {
          line: 110,
          column: 8
        },
        end: {
          line: 119,
          column: 9
        }
      },
      "40": {
        start: {
          line: 111,
          column: 12
        },
        end: {
          line: 111,
          column: 90
        }
      },
      "41": {
        start: {
          line: 112,
          column: 12
        },
        end: {
          line: 118,
          column: 15
        }
      },
      "42": {
        start: {
          line: 120,
          column: 24
        },
        end: {
          line: 120,
          column: 26
        }
      },
      "43": {
        start: {
          line: 121,
          column: 30
        },
        end: {
          line: 121,
          column: 32
        }
      },
      "44": {
        start: {
          line: 122,
          column: 8
        },
        end: {
          line: 191,
          column: 9
        }
      },
      "45": {
        start: {
          line: 124,
          column: 43
        },
        end: {
          line: 124,
          column: 111
        }
      },
      "46": {
        start: {
          line: 125,
          column: 12
        },
        end: {
          line: 134,
          column: 13
        }
      },
      "47": {
        start: {
          line: 126,
          column: 16
        },
        end: {
          line: 126,
          column: 95
        }
      },
      "48": {
        start: {
          line: 127,
          column: 16
        },
        end: {
          line: 133,
          column: 19
        }
      },
      "49": {
        start: {
          line: 135,
          column: 12
        },
        end: {
          line: 135,
          column: 34
        }
      },
      "50": {
        start: {
          line: 136,
          column: 12
        },
        end: {
          line: 136,
          column: 69
        }
      },
      "51": {
        start: {
          line: 137,
          column: 12
        },
        end: {
          line: 137,
          column: 85
        }
      },
      "52": {
        start: {
          line: 138,
          column: 12
        },
        end: {
          line: 148,
          column: 15
        }
      },
      "53": {
        start: {
          line: 151,
          column: 62
        },
        end: {
          line: 159,
          column: 19
        }
      },
      "54": {
        start: {
          line: 160,
          column: 12
        },
        end: {
          line: 169,
          column: 13
        }
      },
      "55": {
        start: {
          line: 161,
          column: 16
        },
        end: {
          line: 161,
          column: 94
        }
      },
      "56": {
        start: {
          line: 162,
          column: 16
        },
        end: {
          line: 168,
          column: 19
        }
      },
      "57": {
        start: {
          line: 170,
          column: 12
        },
        end: {
          line: 176,
          column: 13
        }
      },
      "58": {
        start: {
          line: 171,
          column: 16
        },
        end: {
          line: 171,
          column: 40
        }
      },
      "59": {
        start: {
          line: 172,
          column: 16
        },
        end: {
          line: 172,
          column: 88
        }
      },
      "60": {
        start: {
          line: 174,
          column: 16
        },
        end: {
          line: 174,
          column: 40
        }
      },
      "61": {
        start: {
          line: 175,
          column: 16
        },
        end: {
          line: 175,
          column: 87
        }
      },
      "62": {
        start: {
          line: 177,
          column: 12
        },
        end: {
          line: 177,
          column: 88
        }
      },
      "63": {
        start: {
          line: 178,
          column: 12
        },
        end: {
          line: 190,
          column: 15
        }
      },
      "64": {
        start: {
          line: 193,
          column: 8
        },
        end: {
          line: 193,
          column: 69
        }
      },
      "65": {
        start: {
          line: 194,
          column: 8
        },
        end: {
          line: 200,
          column: 11
        }
      },
      "66": {
        start: {
          line: 204,
          column: 4
        },
        end: {
          line: 204,
          column: 24
        }
      },
      "67": {
        start: {
          line: 207,
          column: 4
        },
        end: {
          line: 207,
          column: 24
        }
      },
      "68": {
        start: {
          line: 210,
          column: 4
        },
        end: {
          line: 240,
          column: 7
        }
      }
    },
    fnMap: {
      "0": {
        name: "_export",
        decl: {
          start: {
            line: 6,
            column: 9
          },
          end: {
            line: 6,
            column: 16
          }
        },
        loc: {
          start: {
            line: 6,
            column: 30
          },
          end: {
            line: 11,
            column: 1
          }
        },
        line: 6
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 13,
            column: 4
          },
          end: {
            line: 13,
            column: 5
          }
        },
        loc: {
          start: {
            line: 13,
            column: 15
          },
          end: {
            line: 15,
            column: 5
          }
        },
        line: 13
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 16,
            column: 4
          },
          end: {
            line: 16,
            column: 5
          }
        },
        loc: {
          start: {
            line: 16,
            column: 17
          },
          end: {
            line: 18,
            column: 5
          }
        },
        line: 16
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 19,
            column: 4
          },
          end: {
            line: 19,
            column: 5
          }
        },
        loc: {
          start: {
            line: 19,
            column: 16
          },
          end: {
            line: 21,
            column: 5
          }
        },
        line: 19
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 22,
            column: 4
          },
          end: {
            line: 22,
            column: 5
          }
        },
        loc: {
          start: {
            line: 22,
            column: 15
          },
          end: {
            line: 24,
            column: 5
          }
        },
        line: 22
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 25,
            column: 4
          },
          end: {
            line: 25,
            column: 5
          }
        },
        loc: {
          start: {
            line: 25,
            column: 19
          },
          end: {
            line: 27,
            column: 5
          }
        },
        line: 25
      },
      "6": {
        name: "PUT",
        decl: {
          start: {
            line: 33,
            column: 15
          },
          end: {
            line: 33,
            column: 18
          }
        },
        loc: {
          start: {
            line: 33,
            column: 28
          },
          end: {
            line: 202,
            column: 1
          }
        },
        line: 33
      },
      "7": {
        name: "PATCH",
        decl: {
          start: {
            line: 203,
            column: 15
          },
          end: {
            line: 203,
            column: 20
          }
        },
        loc: {
          start: {
            line: 203,
            column: 30
          },
          end: {
            line: 205,
            column: 1
          }
        },
        line: 203
      },
      "8": {
        name: "POST",
        decl: {
          start: {
            line: 206,
            column: 15
          },
          end: {
            line: 206,
            column: 19
          }
        },
        loc: {
          start: {
            line: 206,
            column: 29
          },
          end: {
            line: 208,
            column: 1
          }
        },
        line: 206
      },
      "9": {
        name: "GET",
        decl: {
          start: {
            line: 209,
            column: 15
          },
          end: {
            line: 209,
            column: 18
          }
        },
        loc: {
          start: {
            line: 209,
            column: 21
          },
          end: {
            line: 241,
            column: 1
          }
        },
        line: 209
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 38,
            column: 8
          },
          end: {
            line: 47,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 38,
            column: 8
          },
          end: {
            line: 47,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 38
      },
      "1": {
        loc: {
          start: {
            line: 53,
            column: 8
          },
          end: {
            line: 61,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 53,
            column: 8
          },
          end: {
            line: 61,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 53
      },
      "2": {
        loc: {
          start: {
            line: 62,
            column: 8
          },
          end: {
            line: 70,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 62,
            column: 8
          },
          end: {
            line: 70,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 62
      },
      "3": {
        loc: {
          start: {
            line: 62,
            column: 12
          },
          end: {
            line: 62,
            column: 72
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 62,
            column: 12
          },
          end: {
            line: 62,
            column: 39
          }
        }, {
          start: {
            line: 62,
            column: 43
          },
          end: {
            line: 62,
            column: 55
          }
        }, {
          start: {
            line: 62,
            column: 59
          },
          end: {
            line: 62,
            column: 72
          }
        }],
        line: 62
      },
      "4": {
        loc: {
          start: {
            line: 74,
            column: 8
          },
          end: {
            line: 82,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 74,
            column: 8
          },
          end: {
            line: 82,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 74
      },
      "5": {
        loc: {
          start: {
            line: 85,
            column: 8
          },
          end: {
            line: 94,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 85,
            column: 8
          },
          end: {
            line: 94,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 85
      },
      "6": {
        loc: {
          start: {
            line: 85,
            column: 12
          },
          end: {
            line: 85,
            column: 36
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 85,
            column: 12
          },
          end: {
            line: 85,
            column: 24
          }
        }, {
          start: {
            line: 85,
            column: 28
          },
          end: {
            line: 85,
            column: 36
          }
        }],
        line: 85
      },
      "7": {
        loc: {
          start: {
            line: 96,
            column: 8
          },
          end: {
            line: 107,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 96,
            column: 8
          },
          end: {
            line: 107,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 96
      },
      "8": {
        loc: {
          start: {
            line: 110,
            column: 8
          },
          end: {
            line: 119,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 110,
            column: 8
          },
          end: {
            line: 119,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 110
      },
      "9": {
        loc: {
          start: {
            line: 110,
            column: 12
          },
          end: {
            line: 110,
            column: 42
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 110,
            column: 12
          },
          end: {
            line: 110,
            column: 25
          }
        }, {
          start: {
            line: 110,
            column: 29
          },
          end: {
            line: 110,
            column: 42
          }
        }],
        line: 110
      },
      "10": {
        loc: {
          start: {
            line: 122,
            column: 8
          },
          end: {
            line: 191,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 122,
            column: 8
          },
          end: {
            line: 191,
            column: 9
          }
        }, {
          start: {
            line: 149,
            column: 15
          },
          end: {
            line: 191,
            column: 9
          }
        }],
        line: 122
      },
      "11": {
        loc: {
          start: {
            line: 125,
            column: 12
          },
          end: {
            line: 134,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 125,
            column: 12
          },
          end: {
            line: 134,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 125
      },
      "12": {
        loc: {
          start: {
            line: 160,
            column: 12
          },
          end: {
            line: 169,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 160,
            column: 12
          },
          end: {
            line: 169,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 160
      },
      "13": {
        loc: {
          start: {
            line: 170,
            column: 12
          },
          end: {
            line: 176,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 170,
            column: 12
          },
          end: {
            line: 176,
            column: 13
          }
        }, {
          start: {
            line: 173,
            column: 19
          },
          end: {
            line: 176,
            column: 13
          }
        }],
        line: 170
      },
      "14": {
        loc: {
          start: {
            line: 188,
            column: 27
          },
          end: {
            line: 188,
            column: 68
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 188,
            column: 27
          },
          end: {
            line: 188,
            column: 51
          }
        }, {
          start: {
            line: 188,
            column: 55
          },
          end: {
            line: 188,
            column: 68
          }
        }],
        line: 188
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0,
      "39": 0,
      "40": 0,
      "41": 0,
      "42": 0,
      "43": 0,
      "44": 0,
      "45": 0,
      "46": 0,
      "47": 0,
      "48": 0,
      "49": 0,
      "50": 0,
      "51": 0,
      "52": 0,
      "53": 0,
      "54": 0,
      "55": 0,
      "56": 0,
      "57": 0,
      "58": 0,
      "59": 0,
      "60": 0,
      "61": 0,
      "62": 0,
      "63": 0,
      "64": 0,
      "65": 0,
      "66": 0,
      "67": 0,
      "68": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0, 0],
      "9": [0, 0],
      "10": [0, 0],
      "11": [0, 0],
      "12": [0, 0],
      "13": [0, 0],
      "14": [0, 0]
    },
    inputSourceMap: {
      version: 3,
      sources: ["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\app\\api\\cart\\update\\route.ts"],
      sourcesContent: ["// Configuraci\xF3n para Node.js Runtime\r\nexport const runtime = 'nodejs';\r\n\r\n// ===================================\r\n// PINTEYA E-COMMERCE - API ACTUALIZAR CARRITO\r\n// ===================================\r\n// Endpoint para actualizar cantidades en el carrito\r\n\r\nimport { NextRequest, NextResponse } from 'next/server';\r\nimport { getSupabaseClient } from '@/lib/integrations/supabase';\r\nimport { auth } from '@/lib/auth/config';\r\n\r\n/**\r\n * PUT /api/cart/update\r\n * Actualizar cantidad de un producto en el carrito\r\n */\r\nexport async function PUT(request: NextRequest) {\r\n  try {\r\n    console.log('\uD83D\uDED2 Cart Update API: Iniciando actualizaci\xF3n de cantidad');\r\n\r\n    // Verificar autenticaci\xF3n\r\n    const session = await auth();\r\n    if (!session?.user?.id) {\r\n      console.log('\u274C Cart Update API: Usuario no autenticado');\r\n      return NextResponse.json(\r\n        { \r\n          success: false, \r\n          error: 'Usuario no autenticado',\r\n          requiresAuth: true\r\n        }, \r\n        { status: 401 }\r\n      );\r\n    }\r\n\r\n    const userId = session.user.id;\r\n\r\n    // Obtener datos del request\r\n    const body = await request.json();\r\n    const { productId, quantity } = body;\r\n\r\n    // Validaciones\r\n    if (!productId) {\r\n      return NextResponse.json(\r\n        { \r\n          success: false, \r\n          error: 'ID del producto es requerido',\r\n          field: 'productId'\r\n        }, \r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    if (!Number.isInteger(quantity) || quantity < 0 || quantity > 99) {\r\n      return NextResponse.json(\r\n        { \r\n          success: false, \r\n          error: 'La cantidad debe ser un n\xFAmero entero entre 0 y 99',\r\n          field: 'quantity'\r\n        }, \r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    console.log(`\uD83D\uDD0D Cart Update API: Actualizando producto ${productId} a cantidad ${quantity} para usuario ${userId}`);\r\n\r\n    // Obtener cliente de Supabase\r\n    const supabase = getSupabaseClient(true);\r\n    if (!supabase) {\r\n      console.error('\u274C Cart Update API: Cliente de Supabase no disponible');\r\n      return NextResponse.json(\r\n        { \r\n          success: false, \r\n          error: 'Servicio de base de datos no disponible'\r\n        }, \r\n        { status: 503 }\r\n      );\r\n    }\r\n\r\n    // Verificar que el producto existe y obtener stock\r\n    const { data: product, error: productError } = await supabase\r\n      .from('products')\r\n      .select('id, name, stock, price, discounted_price')\r\n      .eq('id', productId)\r\n      .single();\r\n\r\n    if (productError || !product) {\r\n      console.log(`\u274C Cart Update API: Producto ${productId} no encontrado`);\r\n      return NextResponse.json(\r\n        { \r\n          success: false, \r\n          error: 'Producto no encontrado',\r\n          productId\r\n        }, \r\n        { status: 404 }\r\n      );\r\n    }\r\n\r\n    // Verificar stock disponible\r\n    if (quantity > product.stock) {\r\n      console.log(`\u274C Cart Update API: Stock insuficiente para producto ${productId}. Stock: ${product.stock}, Solicitado: ${quantity}`);\r\n      return NextResponse.json(\r\n        { \r\n          success: false, \r\n          error: `Stock insuficiente. Solo hay ${product.stock} unidades disponibles`,\r\n          availableStock: product.stock,\r\n          requestedQuantity: quantity,\r\n          productName: product.name\r\n        }, \r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Verificar que el item existe en el carrito\r\n    const { data: existingItem, error: existingError } = await supabase\r\n      .from('cart_items')\r\n      .select('id, quantity')\r\n      .eq('user_id', userId)\r\n      .eq('product_id', productId)\r\n      .single();\r\n\r\n    if (existingError || !existingItem) {\r\n      console.log(`\u274C Cart Update API: Producto ${productId} no est\xE1 en el carrito`);\r\n      return NextResponse.json(\r\n        { \r\n          success: false, \r\n          error: 'El producto no est\xE1 en tu carrito',\r\n          productId\r\n        }, \r\n        { status: 404 }\r\n      );\r\n    }\r\n\r\n    let operation = '';\r\n    let responseMessage = '';\r\n\r\n    if (quantity === 0) {\r\n      // Remover completamente del carrito\r\n      const { error: deleteError } = await supabase\r\n        .from('cart_items')\r\n        .delete()\r\n        .eq('id', existingItem.id);\r\n\r\n      if (deleteError) {\r\n        console.error('\u274C Cart Update API: Error removiendo del carrito:', deleteError);\r\n        return NextResponse.json(\r\n          { \r\n            success: false, \r\n            error: 'Error removiendo producto del carrito',\r\n            details: deleteError.message\r\n          }, \r\n          { status: 500 }\r\n        );\r\n      }\r\n\r\n      operation = 'removed';\r\n      responseMessage = `${product.name} removido del carrito`;\r\n      \r\n      console.log(`\u2705 Cart Update API: Producto removido - ${responseMessage}`);\r\n\r\n      return NextResponse.json({\r\n        success: true,\r\n        message: responseMessage,\r\n        operation,\r\n        item: {\r\n          productId: productId,\r\n          productName: product.name,\r\n          previousQuantity: existingItem.quantity,\r\n          newQuantity: 0\r\n        }\r\n      });\r\n\r\n    } else {\r\n      // Actualizar cantidad\r\n      const { data: updatedItem, error: updateError } = await supabase\r\n        .from('cart_items')\r\n        .update({ quantity: quantity })\r\n        .eq('id', existingItem.id)\r\n        .select(`\r\n          id,\r\n          user_id,\r\n          product_id,\r\n          quantity,\r\n          updated_at\r\n        `)\r\n        .single();\r\n\r\n      if (updateError) {\r\n        console.error('\u274C Cart Update API: Error actualizando cantidad:', updateError);\r\n        return NextResponse.json(\r\n          { \r\n            success: false, \r\n            error: 'Error actualizando cantidad en el carrito',\r\n            details: updateError.message\r\n          }, \r\n          { status: 500 }\r\n        );\r\n      }\r\n\r\n      if (quantity > existingItem.quantity) {\r\n        operation = 'increased';\r\n        responseMessage = `Cantidad de ${product.name} aumentada a ${quantity}`;\r\n      } else {\r\n        operation = 'decreased';\r\n        responseMessage = `Cantidad de ${product.name} reducida a ${quantity}`;\r\n      }\r\n      \r\n      console.log(`\u2705 Cart Update API: Cantidad actualizada - ${responseMessage}`);\r\n\r\n      return NextResponse.json({\r\n        success: true,\r\n        message: responseMessage,\r\n        operation,\r\n        item: {\r\n          id: updatedItem.id,\r\n          productId: productId,\r\n          productName: product.name,\r\n          previousQuantity: existingItem.quantity,\r\n          newQuantity: quantity,\r\n          price: product.discounted_price || product.price\r\n        }\r\n      });\r\n    }\r\n\r\n  } catch (error: any) {\r\n    console.error('\u274C Cart Update API: Error inesperado:', error);\r\n    return NextResponse.json(\r\n      { \r\n        success: false, \r\n        error: 'Error interno del servidor',\r\n        details: error.message\r\n      }, \r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\n/**\r\n * PATCH /api/cart/update\r\n * Alias para PUT (para compatibilidad)\r\n */\r\nexport async function PATCH(request: NextRequest) {\r\n  return PUT(request);\r\n}\r\n\r\n/**\r\n * POST /api/cart/update\r\n * Alias para PUT (para compatibilidad)\r\n */\r\nexport async function POST(request: NextRequest) {\r\n  return PUT(request);\r\n}\r\n\r\n/**\r\n * GET /api/cart/update\r\n * Informaci\xF3n sobre c\xF3mo usar este endpoint\r\n */\r\nexport async function GET() {\r\n  return NextResponse.json({\r\n    endpoint: '/api/cart/update',\r\n    methods: ['PUT', 'PATCH', 'POST'],\r\n    description: 'Actualizar cantidad de productos en el carrito',\r\n    parameters: {\r\n      productId: 'number - ID del producto a actualizar (requerido)',\r\n      quantity: 'number - Nueva cantidad (0-99). Si es 0, se remueve del carrito (requerido)'\r\n    },\r\n    examples: {\r\n      updateQuantity: {\r\n        productId: 123,\r\n        quantity: 3\r\n      },\r\n      removeProduct: {\r\n        productId: 123,\r\n        quantity: 0\r\n      }\r\n    },\r\n    authentication: 'Requerida - Usuario debe estar autenticado',\r\n    responses: {\r\n      200: 'Cantidad actualizada exitosamente',\r\n      400: 'Datos inv\xE1lidos o stock insuficiente',\r\n      401: 'Usuario no autenticado',\r\n      404: 'Producto no encontrado o no est\xE1 en el carrito',\r\n      500: 'Error interno del servidor'\r\n    }\r\n  });\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],
      names: ["GET", "PATCH", "POST", "PUT", "runtime", "request", "console", "log", "session", "auth", "user", "id", "NextResponse", "json", "success", "error", "requiresAuth", "status", "userId", "body", "productId", "quantity", "field", "Number", "isInteger", "supabase", "getSupabaseClient", "data", "product", "productError", "from", "select", "eq", "single", "stock", "availableStock", "requestedQuantity", "productName", "name", "existingItem", "existingError", "operation", "responseMessage", "deleteError", "delete", "details", "message", "item", "previousQuantity", "newQuantity", "updatedItem", "updateError", "update", "price", "discounted_price", "endpoint", "methods", "description", "parameters", "examples", "updateQuantity", "removeProduct", "authentication", "responses"],
      mappings: "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"
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "1e76543b81a9f2a57066094047cda089eca7bf0c"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_2gernf09q = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_2gernf09q();
cov_2gernf09q().s[0]++;
Object.defineProperty(exports, "__esModule", {
  value: true
});
function _export(target, all) {
  /* istanbul ignore next */
  cov_2gernf09q().f[0]++;
  cov_2gernf09q().s[1]++;
  for (var name in all) {
    /* istanbul ignore next */
    cov_2gernf09q().s[2]++;
    Object.defineProperty(target, name, {
      enumerable: true,
      get: Object.getOwnPropertyDescriptor(all, name).get
    });
  }
}
/* istanbul ignore next */
cov_2gernf09q().s[3]++;
_export(exports, {
  get GET() {
    /* istanbul ignore next */
    cov_2gernf09q().f[1]++;
    cov_2gernf09q().s[4]++;
    return GET;
  },
  get PATCH() {
    /* istanbul ignore next */
    cov_2gernf09q().f[2]++;
    cov_2gernf09q().s[5]++;
    return PATCH;
  },
  get POST() {
    /* istanbul ignore next */
    cov_2gernf09q().f[3]++;
    cov_2gernf09q().s[6]++;
    return POST;
  },
  get PUT() {
    /* istanbul ignore next */
    cov_2gernf09q().f[4]++;
    cov_2gernf09q().s[7]++;
    return PUT;
  },
  get runtime() {
    /* istanbul ignore next */
    cov_2gernf09q().f[5]++;
    cov_2gernf09q().s[8]++;
    return runtime;
  }
});
const _server =
/* istanbul ignore next */
(cov_2gernf09q().s[9]++, require("next/server"));
const _supabase =
/* istanbul ignore next */
(cov_2gernf09q().s[10]++, require("../../../../lib/integrations/supabase"));
const _config =
/* istanbul ignore next */
(cov_2gernf09q().s[11]++, require("../../../../lib/auth/config"));
const runtime =
/* istanbul ignore next */
(cov_2gernf09q().s[12]++, 'nodejs');
async function PUT(request) {
  /* istanbul ignore next */
  cov_2gernf09q().f[6]++;
  cov_2gernf09q().s[13]++;
  try {
    /* istanbul ignore next */
    cov_2gernf09q().s[14]++;
    console.log('ğ Cart Update API: Iniciando actualizaciÃ³n de cantidad');
    // Verificar autenticaciÃ³n
    const session =
    /* istanbul ignore next */
    (cov_2gernf09q().s[15]++, await (0, _config.auth)());
    /* istanbul ignore next */
    cov_2gernf09q().s[16]++;
    if (!session?.user?.id) {
      /* istanbul ignore next */
      cov_2gernf09q().b[0][0]++;
      cov_2gernf09q().s[17]++;
      console.log('â Cart Update API: Usuario no autenticado');
      /* istanbul ignore next */
      cov_2gernf09q().s[18]++;
      return _server.NextResponse.json({
        success: false,
        error: 'Usuario no autenticado',
        requiresAuth: true
      }, {
        status: 401
      });
    } else
    /* istanbul ignore next */
    {
      cov_2gernf09q().b[0][1]++;
    }
    const userId =
    /* istanbul ignore next */
    (cov_2gernf09q().s[19]++, session.user.id);
    // Obtener datos del request
    const body =
    /* istanbul ignore next */
    (cov_2gernf09q().s[20]++, await request.json());
    const {
      productId,
      quantity
    } =
    /* istanbul ignore next */
    (cov_2gernf09q().s[21]++, body);
    // Validaciones
    /* istanbul ignore next */
    cov_2gernf09q().s[22]++;
    if (!productId) {
      /* istanbul ignore next */
      cov_2gernf09q().b[1][0]++;
      cov_2gernf09q().s[23]++;
      return _server.NextResponse.json({
        success: false,
        error: 'ID del producto es requerido',
        field: 'productId'
      }, {
        status: 400
      });
    } else
    /* istanbul ignore next */
    {
      cov_2gernf09q().b[1][1]++;
    }
    cov_2gernf09q().s[24]++;
    if (
    /* istanbul ignore next */
    (cov_2gernf09q().b[3][0]++, !Number.isInteger(quantity)) ||
    /* istanbul ignore next */
    (cov_2gernf09q().b[3][1]++, quantity < 0) ||
    /* istanbul ignore next */
    (cov_2gernf09q().b[3][2]++, quantity > 99)) {
      /* istanbul ignore next */
      cov_2gernf09q().b[2][0]++;
      cov_2gernf09q().s[25]++;
      return _server.NextResponse.json({
        success: false,
        error: 'La cantidad debe ser un nÃºmero entero entre 0 y 99',
        field: 'quantity'
      }, {
        status: 400
      });
    } else
    /* istanbul ignore next */
    {
      cov_2gernf09q().b[2][1]++;
    }
    cov_2gernf09q().s[26]++;
    console.log(`ğ Cart Update API: Actualizando producto ${productId} a cantidad ${quantity} para usuario ${userId}`);
    // Obtener cliente de Supabase
    const supabase =
    /* istanbul ignore next */
    (cov_2gernf09q().s[27]++, (0, _supabase.getSupabaseClient)(true));
    /* istanbul ignore next */
    cov_2gernf09q().s[28]++;
    if (!supabase) {
      /* istanbul ignore next */
      cov_2gernf09q().b[4][0]++;
      cov_2gernf09q().s[29]++;
      console.error('â Cart Update API: Cliente de Supabase no disponible');
      /* istanbul ignore next */
      cov_2gernf09q().s[30]++;
      return _server.NextResponse.json({
        success: false,
        error: 'Servicio de base de datos no disponible'
      }, {
        status: 503
      });
    } else
    /* istanbul ignore next */
    {
      cov_2gernf09q().b[4][1]++;
    }
    // Verificar que el producto existe y obtener stock
    const {
      data: product,
      error: productError
    } =
    /* istanbul ignore next */
    (cov_2gernf09q().s[31]++, await supabase.from('products').select('id, name, stock, price, discounted_price').eq('id', productId).single());
    /* istanbul ignore next */
    cov_2gernf09q().s[32]++;
    if (
    /* istanbul ignore next */
    (cov_2gernf09q().b[6][0]++, productError) ||
    /* istanbul ignore next */
    (cov_2gernf09q().b[6][1]++, !product)) {
      /* istanbul ignore next */
      cov_2gernf09q().b[5][0]++;
      cov_2gernf09q().s[33]++;
      console.log(`â Cart Update API: Producto ${productId} no encontrado`);
      /* istanbul ignore next */
      cov_2gernf09q().s[34]++;
      return _server.NextResponse.json({
        success: false,
        error: 'Producto no encontrado',
        productId
      }, {
        status: 404
      });
    } else
    /* istanbul ignore next */
    {
      cov_2gernf09q().b[5][1]++;
    }
    // Verificar stock disponible
    cov_2gernf09q().s[35]++;
    if (quantity > product.stock) {
      /* istanbul ignore next */
      cov_2gernf09q().b[7][0]++;
      cov_2gernf09q().s[36]++;
      console.log(`â Cart Update API: Stock insuficiente para producto ${productId}. Stock: ${product.stock}, Solicitado: ${quantity}`);
      /* istanbul ignore next */
      cov_2gernf09q().s[37]++;
      return _server.NextResponse.json({
        success: false,
        error: `Stock insuficiente. Solo hay ${product.stock} unidades disponibles`,
        availableStock: product.stock,
        requestedQuantity: quantity,
        productName: product.name
      }, {
        status: 400
      });
    } else
    /* istanbul ignore next */
    {
      cov_2gernf09q().b[7][1]++;
    }
    // Verificar que el item existe en el carrito
    const {
      data: existingItem,
      error: existingError
    } =
    /* istanbul ignore next */
    (cov_2gernf09q().s[38]++, await supabase.from('cart_items').select('id, quantity').eq('user_id', userId).eq('product_id', productId).single());
    /* istanbul ignore next */
    cov_2gernf09q().s[39]++;
    if (
    /* istanbul ignore next */
    (cov_2gernf09q().b[9][0]++, existingError) ||
    /* istanbul ignore next */
    (cov_2gernf09q().b[9][1]++, !existingItem)) {
      /* istanbul ignore next */
      cov_2gernf09q().b[8][0]++;
      cov_2gernf09q().s[40]++;
      console.log(`â Cart Update API: Producto ${productId} no estÃ¡ en el carrito`);
      /* istanbul ignore next */
      cov_2gernf09q().s[41]++;
      return _server.NextResponse.json({
        success: false,
        error: 'El producto no estÃ¡ en tu carrito',
        productId
      }, {
        status: 404
      });
    } else
    /* istanbul ignore next */
    {
      cov_2gernf09q().b[8][1]++;
    }
    let operation =
    /* istanbul ignore next */
    (cov_2gernf09q().s[42]++, '');
    let responseMessage =
    /* istanbul ignore next */
    (cov_2gernf09q().s[43]++, '');
    /* istanbul ignore next */
    cov_2gernf09q().s[44]++;
    if (quantity === 0) {
      /* istanbul ignore next */
      cov_2gernf09q().b[10][0]++;
      // Remover completamente del carrito
      const {
        error: deleteError
      } =
      /* istanbul ignore next */
      (cov_2gernf09q().s[45]++, await supabase.from('cart_items').delete().eq('id', existingItem.id));
      /* istanbul ignore next */
      cov_2gernf09q().s[46]++;
      if (deleteError) {
        /* istanbul ignore next */
        cov_2gernf09q().b[11][0]++;
        cov_2gernf09q().s[47]++;
        console.error('â Cart Update API: Error removiendo del carrito:', deleteError);
        /* istanbul ignore next */
        cov_2gernf09q().s[48]++;
        return _server.NextResponse.json({
          success: false,
          error: 'Error removiendo producto del carrito',
          details: deleteError.message
        }, {
          status: 500
        });
      } else
      /* istanbul ignore next */
      {
        cov_2gernf09q().b[11][1]++;
      }
      cov_2gernf09q().s[49]++;
      operation = 'removed';
      /* istanbul ignore next */
      cov_2gernf09q().s[50]++;
      responseMessage = `${product.name} removido del carrito`;
      /* istanbul ignore next */
      cov_2gernf09q().s[51]++;
      console.log(`â Cart Update API: Producto removido - ${responseMessage}`);
      /* istanbul ignore next */
      cov_2gernf09q().s[52]++;
      return _server.NextResponse.json({
        success: true,
        message: responseMessage,
        operation,
        item: {
          productId: productId,
          productName: product.name,
          previousQuantity: existingItem.quantity,
          newQuantity: 0
        }
      });
    } else {
      /* istanbul ignore next */
      cov_2gernf09q().b[10][1]++;
      // Actualizar cantidad
      const {
        data: updatedItem,
        error: updateError
      } =
      /* istanbul ignore next */
      (cov_2gernf09q().s[53]++, await supabase.from('cart_items').update({
        quantity: quantity
      }).eq('id', existingItem.id).select(`
          id,
          user_id,
          product_id,
          quantity,
          updated_at
        `).single());
      /* istanbul ignore next */
      cov_2gernf09q().s[54]++;
      if (updateError) {
        /* istanbul ignore next */
        cov_2gernf09q().b[12][0]++;
        cov_2gernf09q().s[55]++;
        console.error('â Cart Update API: Error actualizando cantidad:', updateError);
        /* istanbul ignore next */
        cov_2gernf09q().s[56]++;
        return _server.NextResponse.json({
          success: false,
          error: 'Error actualizando cantidad en el carrito',
          details: updateError.message
        }, {
          status: 500
        });
      } else
      /* istanbul ignore next */
      {
        cov_2gernf09q().b[12][1]++;
      }
      cov_2gernf09q().s[57]++;
      if (quantity > existingItem.quantity) {
        /* istanbul ignore next */
        cov_2gernf09q().b[13][0]++;
        cov_2gernf09q().s[58]++;
        operation = 'increased';
        /* istanbul ignore next */
        cov_2gernf09q().s[59]++;
        responseMessage = `Cantidad de ${product.name} aumentada a ${quantity}`;
      } else {
        /* istanbul ignore next */
        cov_2gernf09q().b[13][1]++;
        cov_2gernf09q().s[60]++;
        operation = 'decreased';
        /* istanbul ignore next */
        cov_2gernf09q().s[61]++;
        responseMessage = `Cantidad de ${product.name} reducida a ${quantity}`;
      }
      /* istanbul ignore next */
      cov_2gernf09q().s[62]++;
      console.log(`â Cart Update API: Cantidad actualizada - ${responseMessage}`);
      /* istanbul ignore next */
      cov_2gernf09q().s[63]++;
      return _server.NextResponse.json({
        success: true,
        message: responseMessage,
        operation,
        item: {
          id: updatedItem.id,
          productId: productId,
          productName: product.name,
          previousQuantity: existingItem.quantity,
          newQuantity: quantity,
          price:
          /* istanbul ignore next */
          (cov_2gernf09q().b[14][0]++, product.discounted_price) ||
          /* istanbul ignore next */
          (cov_2gernf09q().b[14][1]++, product.price)
        }
      });
    }
  } catch (error) {
    /* istanbul ignore next */
    cov_2gernf09q().s[64]++;
    console.error('â Cart Update API: Error inesperado:', error);
    /* istanbul ignore next */
    cov_2gernf09q().s[65]++;
    return _server.NextResponse.json({
      success: false,
      error: 'Error interno del servidor',
      details: error.message
    }, {
      status: 500
    });
  }
}
async function PATCH(request) {
  /* istanbul ignore next */
  cov_2gernf09q().f[7]++;
  cov_2gernf09q().s[66]++;
  return PUT(request);
}
async function POST(request) {
  /* istanbul ignore next */
  cov_2gernf09q().f[8]++;
  cov_2gernf09q().s[67]++;
  return PUT(request);
}
async function GET() {
  /* istanbul ignore next */
  cov_2gernf09q().f[9]++;
  cov_2gernf09q().s[68]++;
  return _server.NextResponse.json({
    endpoint: '/api/cart/update',
    methods: ['PUT', 'PATCH', 'POST'],
    description: 'Actualizar cantidad de productos en el carrito',
    parameters: {
      productId: 'number - ID del producto a actualizar (requerido)',
      quantity: 'number - Nueva cantidad (0-99). Si es 0, se remueve del carrito (requerido)'
    },
    examples: {
      updateQuantity: {
        productId: 123,
        quantity: 3
      },
      removeProduct: {
        productId: 123,
        quantity: 0
      }
    },
    authentication: 'Requerida - Usuario debe estar autenticado',
    responses: {
      200: 'Cantidad actualizada exitosamente',
      400: 'Datos invÃ¡lidos o stock insuficiente',
      401: 'Usuario no autenticado',
      404: 'Producto no encontrado o no estÃ¡ en el carrito',
      500: 'Error interno del servidor'
    }
  });
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMmdlcm5mMDlxIiwiYWN0dWFsQ292ZXJhZ2UiLCJzIiwiR0VUIiwiZiIsIlBBVENIIiwiUE9TVCIsIlBVVCIsInJ1bnRpbWUiLCJyZXF1ZXN0IiwiY29uc29sZSIsImxvZyIsInNlc3Npb24iLCJfY29uZmlnIiwiYXV0aCIsInVzZXIiLCJpZCIsImIiLCJfc2VydmVyIiwiTmV4dFJlc3BvbnNlIiwianNvbiIsInN1Y2Nlc3MiLCJlcnJvciIsInJlcXVpcmVzQXV0aCIsInN0YXR1cyIsInVzZXJJZCIsImJvZHkiLCJwcm9kdWN0SWQiLCJxdWFudGl0eSIsImZpZWxkIiwiTnVtYmVyIiwiaXNJbnRlZ2VyIiwic3VwYWJhc2UiLCJfc3VwYWJhc2UiLCJnZXRTdXBhYmFzZUNsaWVudCIsImRhdGEiLCJwcm9kdWN0IiwicHJvZHVjdEVycm9yIiwiZnJvbSIsInNlbGVjdCIsImVxIiwic2luZ2xlIiwic3RvY2siLCJhdmFpbGFibGVTdG9jayIsInJlcXVlc3RlZFF1YW50aXR5IiwicHJvZHVjdE5hbWUiLCJuYW1lIiwiZXhpc3RpbmdJdGVtIiwiZXhpc3RpbmdFcnJvciIsIm9wZXJhdGlvbiIsInJlc3BvbnNlTWVzc2FnZSIsImRlbGV0ZUVycm9yIiwiZGVsZXRlIiwiZGV0YWlscyIsIm1lc3NhZ2UiLCJpdGVtIiwicHJldmlvdXNRdWFudGl0eSIsIm5ld1F1YW50aXR5IiwidXBkYXRlZEl0ZW0iLCJ1cGRhdGVFcnJvciIsInVwZGF0ZSIsInByaWNlIiwiZGlzY291bnRlZF9wcmljZSIsImVuZHBvaW50IiwibWV0aG9kcyIsImRlc2NyaXB0aW9uIiwicGFyYW1ldGVycyIsImV4YW1wbGVzIiwidXBkYXRlUXVhbnRpdHkiLCJyZW1vdmVQcm9kdWN0IiwiYXV0aGVudGljYXRpb24iLCJyZXNwb25zZXMiXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXG1hcnRpXFxEZXNrdG9wXFxERVNBUlJPTExPU1dcXEJPSUxFUlBMQVRURSBFLUNPTU1FUkNFXFxzcmNcXGFwcFxcYXBpXFxjYXJ0XFx1cGRhdGVcXHJvdXRlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvbmZpZ3VyYWNpw7NuIHBhcmEgTm9kZS5qcyBSdW50aW1lXHJcbmV4cG9ydCBjb25zdCBydW50aW1lID0gJ25vZGVqcyc7XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQSU5URVlBIEUtQ09NTUVSQ0UgLSBBUEkgQUNUVUFMSVpBUiBDQVJSSVRPXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEVuZHBvaW50IHBhcmEgYWN0dWFsaXphciBjYW50aWRhZGVzIGVuIGVsIGNhcnJpdG9cclxuXHJcbmltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XHJcbmltcG9ydCB7IGdldFN1cGFiYXNlQ2xpZW50IH0gZnJvbSAnQC9saWIvaW50ZWdyYXRpb25zL3N1cGFiYXNlJztcclxuaW1wb3J0IHsgYXV0aCB9IGZyb20gJ0AvbGliL2F1dGgvY29uZmlnJztcclxuXHJcbi8qKlxyXG4gKiBQVVQgL2FwaS9jYXJ0L3VwZGF0ZVxyXG4gKiBBY3R1YWxpemFyIGNhbnRpZGFkIGRlIHVuIHByb2R1Y3RvIGVuIGVsIGNhcnJpdG9cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQVVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coJ/Cfm5IgQ2FydCBVcGRhdGUgQVBJOiBJbmljaWFuZG8gYWN0dWFsaXphY2nDs24gZGUgY2FudGlkYWQnKTtcclxuXHJcbiAgICAvLyBWZXJpZmljYXIgYXV0ZW50aWNhY2nDs25cclxuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBhdXRoKCk7XHJcbiAgICBpZiAoIXNlc3Npb24/LnVzZXI/LmlkKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfinYwgQ2FydCBVcGRhdGUgQVBJOiBVc3VhcmlvIG5vIGF1dGVudGljYWRvJyk7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IFxyXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsIFxyXG4gICAgICAgICAgZXJyb3I6ICdVc3VhcmlvIG5vIGF1dGVudGljYWRvJyxcclxuICAgICAgICAgIHJlcXVpcmVzQXV0aDogdHJ1ZVxyXG4gICAgICAgIH0sIFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDEgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHVzZXJJZCA9IHNlc3Npb24udXNlci5pZDtcclxuXHJcbiAgICAvLyBPYnRlbmVyIGRhdG9zIGRlbCByZXF1ZXN0XHJcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XHJcbiAgICBjb25zdCB7IHByb2R1Y3RJZCwgcXVhbnRpdHkgfSA9IGJvZHk7XHJcblxyXG4gICAgLy8gVmFsaWRhY2lvbmVzXHJcbiAgICBpZiAoIXByb2R1Y3RJZCkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcclxuICAgICAgICAgIGVycm9yOiAnSUQgZGVsIHByb2R1Y3RvIGVzIHJlcXVlcmlkbycsXHJcbiAgICAgICAgICBmaWVsZDogJ3Byb2R1Y3RJZCdcclxuICAgICAgICB9LCBcclxuICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIU51bWJlci5pc0ludGVnZXIocXVhbnRpdHkpIHx8IHF1YW50aXR5IDwgMCB8fCBxdWFudGl0eSA+IDk5KSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IFxyXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsIFxyXG4gICAgICAgICAgZXJyb3I6ICdMYSBjYW50aWRhZCBkZWJlIHNlciB1biBuw7ptZXJvIGVudGVybyBlbnRyZSAwIHkgOTknLFxyXG4gICAgICAgICAgZmllbGQ6ICdxdWFudGl0eSdcclxuICAgICAgICB9LCBcclxuICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zb2xlLmxvZyhg8J+UjSBDYXJ0IFVwZGF0ZSBBUEk6IEFjdHVhbGl6YW5kbyBwcm9kdWN0byAke3Byb2R1Y3RJZH0gYSBjYW50aWRhZCAke3F1YW50aXR5fSBwYXJhIHVzdWFyaW8gJHt1c2VySWR9YCk7XHJcblxyXG4gICAgLy8gT2J0ZW5lciBjbGllbnRlIGRlIFN1cGFiYXNlXHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQ2xpZW50KHRydWUpO1xyXG4gICAgaWYgKCFzdXBhYmFzZSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgQ2FydCBVcGRhdGUgQVBJOiBDbGllbnRlIGRlIFN1cGFiYXNlIG5vIGRpc3BvbmlibGUnKTtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgXHJcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSwgXHJcbiAgICAgICAgICBlcnJvcjogJ1NlcnZpY2lvIGRlIGJhc2UgZGUgZGF0b3Mgbm8gZGlzcG9uaWJsZSdcclxuICAgICAgICB9LCBcclxuICAgICAgICB7IHN0YXR1czogNTAzIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBWZXJpZmljYXIgcXVlIGVsIHByb2R1Y3RvIGV4aXN0ZSB5IG9idGVuZXIgc3RvY2tcclxuICAgIGNvbnN0IHsgZGF0YTogcHJvZHVjdCwgZXJyb3I6IHByb2R1Y3RFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ3Byb2R1Y3RzJylcclxuICAgICAgLnNlbGVjdCgnaWQsIG5hbWUsIHN0b2NrLCBwcmljZSwgZGlzY291bnRlZF9wcmljZScpXHJcbiAgICAgIC5lcSgnaWQnLCBwcm9kdWN0SWQpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICBpZiAocHJvZHVjdEVycm9yIHx8ICFwcm9kdWN0KSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDinYwgQ2FydCBVcGRhdGUgQVBJOiBQcm9kdWN0byAke3Byb2R1Y3RJZH0gbm8gZW5jb250cmFkb2ApO1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcclxuICAgICAgICAgIGVycm9yOiAnUHJvZHVjdG8gbm8gZW5jb250cmFkbycsXHJcbiAgICAgICAgICBwcm9kdWN0SWRcclxuICAgICAgICB9LCBcclxuICAgICAgICB7IHN0YXR1czogNDA0IH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBWZXJpZmljYXIgc3RvY2sgZGlzcG9uaWJsZVxyXG4gICAgaWYgKHF1YW50aXR5ID4gcHJvZHVjdC5zdG9jaykge1xyXG4gICAgICBjb25zb2xlLmxvZyhg4p2MIENhcnQgVXBkYXRlIEFQSTogU3RvY2sgaW5zdWZpY2llbnRlIHBhcmEgcHJvZHVjdG8gJHtwcm9kdWN0SWR9LiBTdG9jazogJHtwcm9kdWN0LnN0b2NrfSwgU29saWNpdGFkbzogJHtxdWFudGl0eX1gKTtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgXHJcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSwgXHJcbiAgICAgICAgICBlcnJvcjogYFN0b2NrIGluc3VmaWNpZW50ZS4gU29sbyBoYXkgJHtwcm9kdWN0LnN0b2NrfSB1bmlkYWRlcyBkaXNwb25pYmxlc2AsXHJcbiAgICAgICAgICBhdmFpbGFibGVTdG9jazogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgIHJlcXVlc3RlZFF1YW50aXR5OiBxdWFudGl0eSxcclxuICAgICAgICAgIHByb2R1Y3ROYW1lOiBwcm9kdWN0Lm5hbWVcclxuICAgICAgICB9LCBcclxuICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBWZXJpZmljYXIgcXVlIGVsIGl0ZW0gZXhpc3RlIGVuIGVsIGNhcnJpdG9cclxuICAgIGNvbnN0IHsgZGF0YTogZXhpc3RpbmdJdGVtLCBlcnJvcjogZXhpc3RpbmdFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2NhcnRfaXRlbXMnKVxyXG4gICAgICAuc2VsZWN0KCdpZCwgcXVhbnRpdHknKVxyXG4gICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXHJcbiAgICAgIC5lcSgncHJvZHVjdF9pZCcsIHByb2R1Y3RJZClcclxuICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChleGlzdGluZ0Vycm9yIHx8ICFleGlzdGluZ0l0ZW0pIHtcclxuICAgICAgY29uc29sZS5sb2coYOKdjCBDYXJ0IFVwZGF0ZSBBUEk6IFByb2R1Y3RvICR7cHJvZHVjdElkfSBubyBlc3TDoSBlbiBlbCBjYXJyaXRvYCk7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IFxyXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsIFxyXG4gICAgICAgICAgZXJyb3I6ICdFbCBwcm9kdWN0byBubyBlc3TDoSBlbiB0dSBjYXJyaXRvJyxcclxuICAgICAgICAgIHByb2R1Y3RJZFxyXG4gICAgICAgIH0sIFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDQgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBvcGVyYXRpb24gPSAnJztcclxuICAgIGxldCByZXNwb25zZU1lc3NhZ2UgPSAnJztcclxuXHJcbiAgICBpZiAocXVhbnRpdHkgPT09IDApIHtcclxuICAgICAgLy8gUmVtb3ZlciBjb21wbGV0YW1lbnRlIGRlbCBjYXJyaXRvXHJcbiAgICAgIGNvbnN0IHsgZXJyb3I6IGRlbGV0ZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAgIC5mcm9tKCdjYXJ0X2l0ZW1zJylcclxuICAgICAgICAuZGVsZXRlKClcclxuICAgICAgICAuZXEoJ2lkJywgZXhpc3RpbmdJdGVtLmlkKTtcclxuXHJcbiAgICAgIGlmIChkZWxldGVFcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBDYXJ0IFVwZGF0ZSBBUEk6IEVycm9yIHJlbW92aWVuZG8gZGVsIGNhcnJpdG86JywgZGVsZXRlRXJyb3IpO1xyXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICAgIHsgXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcclxuICAgICAgICAgICAgZXJyb3I6ICdFcnJvciByZW1vdmllbmRvIHByb2R1Y3RvIGRlbCBjYXJyaXRvJyxcclxuICAgICAgICAgICAgZGV0YWlsczogZGVsZXRlRXJyb3IubWVzc2FnZVxyXG4gICAgICAgICAgfSwgXHJcbiAgICAgICAgICB7IHN0YXR1czogNTAwIH1cclxuICAgICAgICApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBvcGVyYXRpb24gPSAncmVtb3ZlZCc7XHJcbiAgICAgIHJlc3BvbnNlTWVzc2FnZSA9IGAke3Byb2R1Y3QubmFtZX0gcmVtb3ZpZG8gZGVsIGNhcnJpdG9gO1xyXG4gICAgICBcclxuICAgICAgY29uc29sZS5sb2coYOKchSBDYXJ0IFVwZGF0ZSBBUEk6IFByb2R1Y3RvIHJlbW92aWRvIC0gJHtyZXNwb25zZU1lc3NhZ2V9YCk7XHJcblxyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgbWVzc2FnZTogcmVzcG9uc2VNZXNzYWdlLFxyXG4gICAgICAgIG9wZXJhdGlvbixcclxuICAgICAgICBpdGVtOiB7XHJcbiAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3RJZCxcclxuICAgICAgICAgIHByb2R1Y3ROYW1lOiBwcm9kdWN0Lm5hbWUsXHJcbiAgICAgICAgICBwcmV2aW91c1F1YW50aXR5OiBleGlzdGluZ0l0ZW0ucXVhbnRpdHksXHJcbiAgICAgICAgICBuZXdRdWFudGl0eTogMFxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcblxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gQWN0dWFsaXphciBjYW50aWRhZFxyXG4gICAgICBjb25zdCB7IGRhdGE6IHVwZGF0ZWRJdGVtLCBlcnJvcjogdXBkYXRlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgLmZyb20oJ2NhcnRfaXRlbXMnKVxyXG4gICAgICAgIC51cGRhdGUoeyBxdWFudGl0eTogcXVhbnRpdHkgfSlcclxuICAgICAgICAuZXEoJ2lkJywgZXhpc3RpbmdJdGVtLmlkKVxyXG4gICAgICAgIC5zZWxlY3QoYFxyXG4gICAgICAgICAgaWQsXHJcbiAgICAgICAgICB1c2VyX2lkLFxyXG4gICAgICAgICAgcHJvZHVjdF9pZCxcclxuICAgICAgICAgIHF1YW50aXR5LFxyXG4gICAgICAgICAgdXBkYXRlZF9hdFxyXG4gICAgICAgIGApXHJcbiAgICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgICAgaWYgKHVwZGF0ZUVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIENhcnQgVXBkYXRlIEFQSTogRXJyb3IgYWN0dWFsaXphbmRvIGNhbnRpZGFkOicsIHVwZGF0ZUVycm9yKTtcclxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgICB7IFxyXG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSwgXHJcbiAgICAgICAgICAgIGVycm9yOiAnRXJyb3IgYWN0dWFsaXphbmRvIGNhbnRpZGFkIGVuIGVsIGNhcnJpdG8nLFxyXG4gICAgICAgICAgICBkZXRhaWxzOiB1cGRhdGVFcnJvci5tZXNzYWdlXHJcbiAgICAgICAgICB9LCBcclxuICAgICAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChxdWFudGl0eSA+IGV4aXN0aW5nSXRlbS5xdWFudGl0eSkge1xyXG4gICAgICAgIG9wZXJhdGlvbiA9ICdpbmNyZWFzZWQnO1xyXG4gICAgICAgIHJlc3BvbnNlTWVzc2FnZSA9IGBDYW50aWRhZCBkZSAke3Byb2R1Y3QubmFtZX0gYXVtZW50YWRhIGEgJHtxdWFudGl0eX1gO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIG9wZXJhdGlvbiA9ICdkZWNyZWFzZWQnO1xyXG4gICAgICAgIHJlc3BvbnNlTWVzc2FnZSA9IGBDYW50aWRhZCBkZSAke3Byb2R1Y3QubmFtZX0gcmVkdWNpZGEgYSAke3F1YW50aXR5fWA7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIGNvbnNvbGUubG9nKGDinIUgQ2FydCBVcGRhdGUgQVBJOiBDYW50aWRhZCBhY3R1YWxpemFkYSAtICR7cmVzcG9uc2VNZXNzYWdlfWApO1xyXG5cclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgIG1lc3NhZ2U6IHJlc3BvbnNlTWVzc2FnZSxcclxuICAgICAgICBvcGVyYXRpb24sXHJcbiAgICAgICAgaXRlbToge1xyXG4gICAgICAgICAgaWQ6IHVwZGF0ZWRJdGVtLmlkLFxyXG4gICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0SWQsXHJcbiAgICAgICAgICBwcm9kdWN0TmFtZTogcHJvZHVjdC5uYW1lLFxyXG4gICAgICAgICAgcHJldmlvdXNRdWFudGl0eTogZXhpc3RpbmdJdGVtLnF1YW50aXR5LFxyXG4gICAgICAgICAgbmV3UXVhbnRpdHk6IHF1YW50aXR5LFxyXG4gICAgICAgICAgcHJpY2U6IHByb2R1Y3QuZGlzY291bnRlZF9wcmljZSB8fCBwcm9kdWN0LnByaWNlXHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcign4p2MIENhcnQgVXBkYXRlIEFQSTogRXJyb3IgaW5lc3BlcmFkbzonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHsgXHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsIFxyXG4gICAgICAgIGVycm9yOiAnRXJyb3IgaW50ZXJubyBkZWwgc2Vydmlkb3InLFxyXG4gICAgICAgIGRldGFpbHM6IGVycm9yLm1lc3NhZ2VcclxuICAgICAgfSwgXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBQQVRDSCAvYXBpL2NhcnQvdXBkYXRlXHJcbiAqIEFsaWFzIHBhcmEgUFVUIChwYXJhIGNvbXBhdGliaWxpZGFkKVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBBVENIKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgcmV0dXJuIFBVVChyZXF1ZXN0KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFBPU1QgL2FwaS9jYXJ0L3VwZGF0ZVxyXG4gKiBBbGlhcyBwYXJhIFBVVCAocGFyYSBjb21wYXRpYmlsaWRhZClcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgcmV0dXJuIFBVVChyZXF1ZXN0KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEdFVCAvYXBpL2NhcnQvdXBkYXRlXHJcbiAqIEluZm9ybWFjacOzbiBzb2JyZSBjw7NtbyB1c2FyIGVzdGUgZW5kcG9pbnRcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQoKSB7XHJcbiAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgIGVuZHBvaW50OiAnL2FwaS9jYXJ0L3VwZGF0ZScsXHJcbiAgICBtZXRob2RzOiBbJ1BVVCcsICdQQVRDSCcsICdQT1NUJ10sXHJcbiAgICBkZXNjcmlwdGlvbjogJ0FjdHVhbGl6YXIgY2FudGlkYWQgZGUgcHJvZHVjdG9zIGVuIGVsIGNhcnJpdG8nLFxyXG4gICAgcGFyYW1ldGVyczoge1xyXG4gICAgICBwcm9kdWN0SWQ6ICdudW1iZXIgLSBJRCBkZWwgcHJvZHVjdG8gYSBhY3R1YWxpemFyIChyZXF1ZXJpZG8pJyxcclxuICAgICAgcXVhbnRpdHk6ICdudW1iZXIgLSBOdWV2YSBjYW50aWRhZCAoMC05OSkuIFNpIGVzIDAsIHNlIHJlbXVldmUgZGVsIGNhcnJpdG8gKHJlcXVlcmlkbyknXHJcbiAgICB9LFxyXG4gICAgZXhhbXBsZXM6IHtcclxuICAgICAgdXBkYXRlUXVhbnRpdHk6IHtcclxuICAgICAgICBwcm9kdWN0SWQ6IDEyMyxcclxuICAgICAgICBxdWFudGl0eTogM1xyXG4gICAgICB9LFxyXG4gICAgICByZW1vdmVQcm9kdWN0OiB7XHJcbiAgICAgICAgcHJvZHVjdElkOiAxMjMsXHJcbiAgICAgICAgcXVhbnRpdHk6IDBcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIGF1dGhlbnRpY2F0aW9uOiAnUmVxdWVyaWRhIC0gVXN1YXJpbyBkZWJlIGVzdGFyIGF1dGVudGljYWRvJyxcclxuICAgIHJlc3BvbnNlczoge1xyXG4gICAgICAyMDA6ICdDYW50aWRhZCBhY3R1YWxpemFkYSBleGl0b3NhbWVudGUnLFxyXG4gICAgICA0MDA6ICdEYXRvcyBpbnbDoWxpZG9zIG8gc3RvY2sgaW5zdWZpY2llbnRlJyxcclxuICAgICAgNDAxOiAnVXN1YXJpbyBubyBhdXRlbnRpY2FkbycsXHJcbiAgICAgIDQwNDogJ1Byb2R1Y3RvIG5vIGVuY29udHJhZG8gbyBubyBlc3TDoSBlbiBlbCBjYXJyaXRvJyxcclxuICAgICAgNTAwOiAnRXJyb3IgaW50ZXJubyBkZWwgc2Vydmlkb3InXHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFnUHNCO0lBQUFBLGFBQUEsWUFBQUEsQ0FBQTtNQUFBLE9BQUFDLGNBQUE7SUFBQTtFQUFBO0VBQUEsT0FBQUEsY0FBQTtBQUFBO0FBQUFELGFBQUE7QUFBQUEsYUFBQSxHQUFBRSxDQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztNQWdCQUMsSUFBQTtJQUFBO0lBQUFILGFBQUEsR0FBQUksQ0FBQTtJQUFBSixhQUFBLEdBQUFFLENBQUE7V0FBQUMsR0FBQTs7TUFoQkFFLE1BQUE7SUFBQTtJQUFBTCxhQUFBLEdBQUFJLENBQUE7SUFBQUosYUFBQSxHQUFBRSxDQUFBO1dBQUFHLEtBQUE7O01BUUFDLEtBQUE7SUFB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