{"version":3,"names":["cov_1nlw09ezmi","actualCoverage","s","GET","f","runtime","request","console","log","userResult","_adminauth","getAuthenticatedUser","adminResult","getAuthenticatedAdmin","directAuth","_config","auth","authError","error","message","_server","NextResponse","json","success","userId","migration","status","version","methods","sessionId","isAdmin","usesHeaders","usesOfficialClerkMethods","debug","migrationNotes","hasRequest","deprecatedHeader","b","headers","get","errorMessage","Error"],"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\app\\api\\debug\\get-authenticated-user\\route.ts"],"sourcesContent":["// Configuraci√≥n para Node.js Runtime\r\nexport const runtime = 'nodejs';\r\n\r\nimport { NextRequest, NextResponse } from 'next/server';\r\nimport { getAuthenticatedUser, getAuthenticatedAdmin } from '@/lib/auth/admin-auth';\r\nimport { auth } from '@/lib/auth/config';\r\n\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    console.log('üîç Debug getAuthenticatedUser: Testing MIGRATED authentication methods');\r\n\r\n    // Test 1: Funci√≥n migrada getAuthenticatedUser\r\n    const userResult = await getAuthenticatedUser(request);\r\n\r\n    // Test 2: Funci√≥n nueva getAuthenticatedAdmin\r\n    const adminResult = await getAuthenticatedAdmin(request);\r\n\r\n    // Test 3: auth() directo\r\n    let directAuth;\r\n    try {\r\n      directAuth = await auth();\r\n    } catch (authError) {\r\n      directAuth = { error: authError.message };\r\n    }\r\n\r\n    console.log('üîç Resultados de migraci√≥n:', {\r\n      userResult,\r\n      adminResult,\r\n      directAuth\r\n    });\r\n\r\n    return NextResponse.json({\r\n      success: !!userResult.userId,\r\n      migration: {\r\n        status: 'COMPLETED',\r\n        version: '2.0',\r\n        methods: {\r\n          getAuthenticatedUser: {\r\n            userId: userResult.userId,\r\n            sessionId: userResult.sessionId,\r\n            isAdmin: userResult.isAdmin,\r\n            error: userResult.error,\r\n            usesHeaders: false,\r\n            usesOfficialClerkMethods: true\r\n          },\r\n          getAuthenticatedAdmin: {\r\n            userId: adminResult.userId,\r\n            sessionId: adminResult.sessionId,\r\n            isAdmin: adminResult.isAdmin,\r\n            error: adminResult.error,\r\n            status: adminResult.status\r\n          },\r\n          directAuth: {\r\n            userId: directAuth.userId,\r\n            sessionId: directAuth.sessionId,\r\n            error: directAuth.error\r\n          }\r\n        }\r\n      },\r\n      debug: {\r\n        migrationNotes: [\r\n          '‚úÖ MIGRADO: Ya no usa headers x-clerk-user-id',\r\n          '‚úÖ MIGRADO: Usa getAuth(req) y auth() oficiales',\r\n          '‚úÖ NUEVO: Funci√≥n getAuthenticatedAdmin() combinada',\r\n          '‚úÖ NUEVO: Detecci√≥n autom√°tica de admin desde token',\r\n          '‚ö†Ô∏è DEPRECADO: Fallbacks a headers eliminados'\r\n        ],\r\n        hasRequest: !!request,\r\n        deprecatedHeader: request.headers.get('x-clerk-user-id') || 'Not used anymore'\r\n      }\r\n    });\r\n\r\n  } catch (error) {\r\n    console.error('üîç Debug getAuthenticatedUser: Error:', error);\r\n    return NextResponse.json({\r\n      success: false,\r\n      error: 'Unexpected error',\r\n      debug: {\r\n        errorMessage: error instanceof Error ? error.message : 'Unknown error'\r\n      }\r\n    }, { status: 500 });\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]}