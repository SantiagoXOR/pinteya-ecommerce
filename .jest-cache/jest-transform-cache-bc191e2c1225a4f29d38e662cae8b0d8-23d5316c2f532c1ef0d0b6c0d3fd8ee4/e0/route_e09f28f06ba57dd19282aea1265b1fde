649cbf46600b0048339818529cdbdc81
// ConfiguraciÃ³n para Node.js Runtime
"use strict";

/* istanbul ignore next */
function cov_1uhfcmk0k() {
  var path = "C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\app\\api\\user\\profile\\route.ts";
  var hash = "4bf53e6fdfc4c7a375d6efef58c4d61195aa00c3";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\app\\api\\user\\profile\\route.ts",
    statementMap: {
      "0": {
        start: {
          line: 3,
          column: 0
        },
        end: {
          line: 5,
          column: 3
        }
      },
      "1": {
        start: {
          line: 7,
          column: 4
        },
        end: {
          line: 10,
          column: 7
        }
      },
      "2": {
        start: {
          line: 7,
          column: 24
        },
        end: {
          line: 10,
          column: 7
        }
      },
      "3": {
        start: {
          line: 12,
          column: 0
        },
        end: {
          line: 22,
          column: 3
        }
      },
      "4": {
        start: {
          line: 14,
          column: 8
        },
        end: {
          line: 14,
          column: 19
        }
      },
      "5": {
        start: {
          line: 17,
          column: 8
        },
        end: {
          line: 17,
          column: 19
        }
      },
      "6": {
        start: {
          line: 20,
          column: 8
        },
        end: {
          line: 20,
          column: 23
        }
      },
      "7": {
        start: {
          line: 23,
          column: 16
        },
        end: {
          line: 23,
          column: 38
        }
      },
      "8": {
        start: {
          line: 24,
          column: 18
        },
        end: {
          line: 24,
          column: 66
        }
      },
      "9": {
        start: {
          line: 25,
          column: 16
        },
        end: {
          line: 25,
          column: 54
        }
      },
      "10": {
        start: {
          line: 26,
          column: 24
        },
        end: {
          line: 26,
          column: 74
        }
      },
      "11": {
        start: {
          line: 27,
          column: 21
        },
        end: {
          line: 27,
          column: 74
        }
      },
      "12": {
        start: {
          line: 28,
          column: 21
        },
        end: {
          line: 28,
          column: 67
        }
      },
      "13": {
        start: {
          line: 29,
          column: 24
        },
        end: {
          line: 29,
          column: 74
        }
      },
      "14": {
        start: {
          line: 30,
          column: 16
        },
        end: {
          line: 30,
          column: 24
        }
      },
      "15": {
        start: {
          line: 33,
          column: 27
        },
        end: {
          line: 33,
          column: 77
        }
      },
      "16": {
        start: {
          line: 35,
          column: 28
        },
        end: {
          line: 138,
          column: 6
        }
      },
      "17": {
        start: {
          line: 37,
          column: 8
        },
        end: {
          line: 42,
          column: 11
        }
      },
      "18": {
        start: {
          line: 43,
          column: 8
        },
        end: {
          line: 137,
          column: 9
        }
      },
      "19": {
        start: {
          line: 45,
          column: 12
        },
        end: {
          line: 57,
          column: 13
        }
      },
      "20": {
        start: {
          line: 46,
          column: 16
        },
        end: {
          line: 46,
          column: 107
        }
      },
      "21": {
        start: {
          line: 48,
          column: 16
        },
        end: {
          line: 51,
          column: 19
        }
      },
      "22": {
        start: {
          line: 52,
          column: 16
        },
        end: {
          line: 56,
          column: 19
        }
      },
      "23": {
        start: {
          line: 59,
          column: 28
        },
        end: {
          line: 59,
          column: 53
        }
      },
      "24": {
        start: {
          line: 60,
          column: 12
        },
        end: {
          line: 74,
          column: 13
        }
      },
      "25": {
        start: {
          line: 62,
          column: 16
        },
        end: {
          line: 65,
          column: 19
        }
      },
      "26": {
        start: {
          line: 66,
          column: 38
        },
        end: {
          line: 70,
          column: 17
        }
      },
      "27": {
        start: {
          line: 71,
          column: 16
        },
        end: {
          line: 73,
          column: 19
        }
      },
      "28": {
        start: {
          line: 76,
          column: 27
        },
        end: {
          line: 76,
          column: 42
        }
      },
      "29": {
        start: {
          line: 77,
          column: 42
        },
        end: {
          line: 77,
          column: 204
        }
      },
      "30": {
        start: {
          line: 78,
          column: 12
        },
        end: {
          line: 92,
          column: 13
        }
      },
      "31": {
        start: {
          line: 79,
          column: 16
        },
        end: {
          line: 79,
          column: 66
        }
      },
      "32": {
        start: {
          line: 81,
          column: 16
        },
        end: {
          line: 86,
          column: 19
        }
      },
      "33": {
        start: {
          line: 87,
          column: 16
        },
        end: {
          line: 91,
          column: 19
        }
      },
      "34": {
        start: {
          line: 94,
          column: 12
        },
        end: {
          line: 114,
          column: 13
        }
      },
      "35": {
        start: {
          line: 95,
          column: 62
        },
        end: {
          line: 101,
          column: 36
        }
      },
      "36": {
        start: {
          line: 102,
          column: 16
        },
        end: {
          line: 109,
          column: 17
        }
      },
      "37": {
        start: {
          line: 103,
          column: 20
        },
        end: {
          line: 103,
          column: 79
        }
      },
      "38": {
        start: {
          line: 104,
          column: 20
        },
        end: {
          line: 108,
          column: 23
        }
      },
      "39": {
        start: {
          line: 110,
          column: 16
        },
        end: {
          line: 113,
          column: 19
        }
      },
      "40": {
        start: {
          line: 116,
          column: 12
        },
        end: {
          line: 119,
          column: 15
        }
      },
      "41": {
        start: {
          line: 120,
          column: 12
        },
        end: {
          line: 123,
          column: 15
        }
      },
      "42": {
        start: {
          line: 125,
          column: 12
        },
        end: {
          line: 125,
          column: 68
        }
      },
      "43": {
        start: {
          line: 127,
          column: 12
        },
        end: {
          line: 131,
          column: 15
        }
      },
      "44": {
        start: {
          line: 132,
          column: 12
        },
        end: {
          line: 136,
          column: 15
        }
      },
      "45": {
        start: {
          line: 140,
          column: 4
        },
        end: {
          line: 146,
          column: 5
        }
      },
      "46": {
        start: {
          line: 141,
          column: 8
        },
        end: {
          line: 144,
          column: 11
        }
      },
      "47": {
        start: {
          line: 145,
          column: 8
        },
        end: {
          line: 145,
          column: 31
        }
      },
      "48": {
        start: {
          line: 147,
          column: 4
        },
        end: {
          line: 147,
          column: 27
        }
      },
      "49": {
        start: {
          line: 150,
          column: 4
        },
        end: {
          line: 218,
          column: 5
        }
      },
      "50": {
        start: {
          line: 152,
          column: 8
        },
        end: {
          line: 159,
          column: 9
        }
      },
      "51": {
        start: {
          line: 153,
          column: 12
        },
        end: {
          line: 153,
          column: 103
        }
      },
      "52": {
        start: {
          line: 154,
          column: 12
        },
        end: {
          line: 158,
          column: 15
        }
      },
      "53": {
        start: {
          line: 161,
          column: 24
        },
        end: {
          line: 161,
          column: 49
        }
      },
      "54": {
        start: {
          line: 162,
          column: 8
        },
        end: {
          line: 171,
          column: 9
        }
      },
      "55": {
        start: {
          line: 163,
          column: 34
        },
        end: {
          line: 167,
          column: 13
        }
      },
      "56": {
        start: {
          line: 168,
          column: 12
        },
        end: {
          line: 170,
          column: 15
        }
      },
      "57": {
        start: {
          line: 172,
          column: 23
        },
        end: {
          line: 172,
          column: 38
        }
      },
      "58": {
        start: {
          line: 173,
          column: 21
        },
        end: {
          line: 173,
          column: 41
        }
      },
      "59": {
        start: {
          line: 175,
          column: 39
        },
        end: {
          line: 175,
          column: 43
        }
      },
      "60": {
        start: {
          line: 176,
          column: 8
        },
        end: {
          line: 182,
          column: 9
        }
      },
      "61": {
        start: {
          line: 177,
          column: 12
        },
        end: {
          line: 181,
          column: 15
        }
      },
      "62": {
        start: {
          line: 184,
          column: 45
        },
        end: {
          line: 189,
          column: 51
        }
      },
      "63": {
        start: {
          line: 190,
          column: 8
        },
        end: {
          line: 197,
          column: 9
        }
      },
      "64": {
        start: {
          line: 191,
          column: 12
        },
        end: {
          line: 191,
          column: 65
        }
      },
      "65": {
        start: {
          line: 192,
          column: 12
        },
        end: {
          line: 196,
          column: 15
        }
      },
      "66": {
        start: {
          line: 199,
          column: 28
        },
        end: {
          line: 199,
          column: 72
        }
      },
      "67": {
        start: {
          line: 200,
          column: 8
        },
        end: {
          line: 205,
          column: 24
        }
      },
      "68": {
        start: {
          line: 206,
          column: 8
        },
        end: {
          line: 210,
          column: 11
        }
      },
      "69": {
        start: {
          line: 212,
          column: 8
        },
        end: {
          line: 212,
          column: 64
        }
      },
      "70": {
        start: {
          line: 213,
          column: 8
        },
        end: {
          line: 217,
          column: 11
        }
      }
    },
    fnMap: {
      "0": {
        name: "_export",
        decl: {
          start: {
            line: 6,
            column: 9
          },
          end: {
            line: 6,
            column: 16
          }
        },
        loc: {
          start: {
            line: 6,
            column: 30
          },
          end: {
            line: 11,
            column: 1
          }
        },
        line: 6
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 13,
            column: 4
          },
          end: {
            line: 13,
            column: 5
          }
        },
        loc: {
          start: {
            line: 13,
            column: 15
          },
          end: {
            line: 15,
            column: 5
          }
        },
        line: 13
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 16,
            column: 4
          },
          end: {
            line: 16,
            column: 5
          }
        },
        loc: {
          start: {
            line: 16,
            column: 15
          },
          end: {
            line: 18,
            column: 5
          }
        },
        line: 16
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 19,
            column: 4
          },
          end: {
            line: 19,
            column: 5
          }
        },
        loc: {
          start: {
            line: 19,
            column: 19
          },
          end: {
            line: 21,
            column: 5
          }
        },
        line: 19
      },
      "4": {
        name: "GET",
        decl: {
          start: {
            line: 31,
            column: 15
          },
          end: {
            line: 31,
            column: 18
          }
        },
        loc: {
          start: {
            line: 31,
            column: 28
          },
          end: {
            line: 148,
            column: 1
          }
        },
        line: 31
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 35,
            column: 113
          },
          end: {
            line: 35,
            column: 114
          }
        },
        loc: {
          start: {
            line: 35,
            column: 123
          },
          end: {
            line: 138,
            column: 5
          }
        },
        line: 35
      },
      "6": {
        name: "PUT",
        decl: {
          start: {
            line: 149,
            column: 15
          },
          end: {
            line: 149,
            column: 18
          }
        },
        loc: {
          start: {
            line: 149,
            column: 28
          },
          end: {
            line: 219,
            column: 1
          }
        },
        line: 149
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 45,
            column: 12
          },
          end: {
            line: 57,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 45,
            column: 12
          },
          end: {
            line: 57,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 45
      },
      "1": {
        loc: {
          start: {
            line: 60,
            column: 12
          },
          end: {
            line: 74,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 60,
            column: 12
          },
          end: {
            line: 74,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 60
      },
      "2": {
        loc: {
          start: {
            line: 78,
            column: 12
          },
          end: {
            line: 92,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 78,
            column: 12
          },
          end: {
            line: 92,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 78
      },
      "3": {
        loc: {
          start: {
            line: 78,
            column: 16
          },
          end: {
            line: 78,
            column: 50
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 78,
            column: 16
          },
          end: {
            line: 78,
            column: 21
          }
        }, {
          start: {
            line: 78,
            column: 25
          },
          end: {
            line: 78,
            column: 50
          }
        }],
        line: 78
      },
      "4": {
        loc: {
          start: {
            line: 94,
            column: 12
          },
          end: {
            line: 114,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 94,
            column: 12
          },
          end: {
            line: 114,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 94
      },
      "5": {
        loc: {
          start: {
            line: 102,
            column: 16
          },
          end: {
            line: 109,
            column: 17
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 102,
            column: 16
          },
          end: {
            line: 109,
            column: 17
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 102
      },
      "6": {
        loc: {
          start: {
            line: 128,
            column: 23
          },
          end: {
            line: 128,
            column: 79
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 128,
            column: 48
          },
          end: {
            line: 128,
            column: 61
          }
        }, {
          start: {
            line: 128,
            column: 64
          },
          end: {
            line: 128,
            column: 79
          }
        }],
        line: 128
      },
      "7": {
        loc: {
          start: {
            line: 130,
            column: 23
          },
          end: {
            line: 130,
            column: 71
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 130,
            column: 48
          },
          end: {
            line: 130,
            column: 59
          }
        }, {
          start: {
            line: 130,
            column: 62
          },
          end: {
            line: 130,
            column: 71
          }
        }],
        line: 130
      },
      "8": {
        loc: {
          start: {
            line: 140,
            column: 4
          },
          end: {
            line: 146,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 140,
            column: 4
          },
          end: {
            line: 146,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 140
      },
      "9": {
        loc: {
          start: {
            line: 152,
            column: 8
          },
          end: {
            line: 159,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 152,
            column: 8
          },
          end: {
            line: 159,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 152
      },
      "10": {
        loc: {
          start: {
            line: 162,
            column: 8
          },
          end: {
            line: 171,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 162,
            column: 8
          },
          end: {
            line: 171,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 162
      },
      "11": {
        loc: {
          start: {
            line: 176,
            column: 8
          },
          end: {
            line: 182,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 176,
            column: 8
          },
          end: {
            line: 182,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 176
      },
      "12": {
        loc: {
          start: {
            line: 176,
            column: 12
          },
          end: {
            line: 176,
            column: 27
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 176,
            column: 12
          },
          end: {
            line: 176,
            column: 17
          }
        }, {
          start: {
            line: 176,
            column: 21
          },
          end: {
            line: 176,
            column: 27
          }
        }],
        line: 176
      },
      "13": {
        loc: {
          start: {
            line: 187,
            column: 19
          },
          end: {
            line: 187,
            column: 32
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 187,
            column: 19
          },
          end: {
            line: 187,
            column: 24
          }
        }, {
          start: {
            line: 187,
            column: 28
          },
          end: {
            line: 187,
            column: 32
          }
        }],
        line: 187
      },
      "14": {
        loc: {
          start: {
            line: 190,
            column: 8
          },
          end: {
            line: 197,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 190,
            column: 8
          },
          end: {
            line: 197,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 190
      },
      "15": {
        loc: {
          start: {
            line: 202,
            column: 27
          },
          end: {
            line: 202,
            column: 78
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 202,
            column: 55
          },
          end: {
            line: 202,
            column: 64
          }
        }, {
          start: {
            line: 202,
            column: 67
          },
          end: {
            line: 202,
            column: 78
          }
        }],
        line: 202
      },
      "16": {
        loc: {
          start: {
            line: 203,
            column: 28
          },
          end: {
            line: 203,
            column: 81
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 203,
            column: 58
          },
          end: {
            line: 203,
            column: 67
          }
        }, {
          start: {
            line: 203,
            column: 70
          },
          end: {
            line: 203,
            column: 81
          }
        }],
        line: 203
      },
      "17": {
        loc: {
          start: {
            line: 204,
            column: 28
          },
          end: {
            line: 204,
            column: 81
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 204,
            column: 58
          },
          end: {
            line: 204,
            column: 67
          }
        }, {
          start: {
            line: 204,
            column: 70
          },
          end: {
            line: 204,
            column: 81
          }
        }],
        line: 204
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0,
      "39": 0,
      "40": 0,
      "41": 0,
      "42": 0,
      "43": 0,
      "44": 0,
      "45": 0,
      "46": 0,
      "47": 0,
      "48": 0,
      "49": 0,
      "50": 0,
      "51": 0,
      "52": 0,
      "53": 0,
      "54": 0,
      "55": 0,
      "56": 0,
      "57": 0,
      "58": 0,
      "59": 0,
      "60": 0,
      "61": 0,
      "62": 0,
      "63": 0,
      "64": 0,
      "65": 0,
      "66": 0,
      "67": 0,
      "68": 0,
      "69": 0,
      "70": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0, 0],
      "9": [0, 0],
      "10": [0, 0],
      "11": [0, 0],
      "12": [0, 0],
      "13": [0, 0],
      "14": [0, 0],
      "15": [0, 0],
      "16": [0, 0],
      "17": [0, 0]
    },
    inputSourceMap: {
      version: 3,
      sources: ["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\app\\api\\user\\profile\\route.ts"],
      sourcesContent: ["// Configuraci\xF3n para Node.js Runtime\r\nexport const runtime = 'nodejs';\r\n\r\n// ===================================\r\n// PINTEYA E-COMMERCE - API DE PERFIL DE USUARIO\r\n// ===================================\r\n\r\nimport { NextRequest, NextResponse } from 'next/server';\r\nimport { supabaseAdmin } from '@/lib/integrations/supabase';\r\nimport { auth } from '@/lib/auth/config';\r\nimport { ApiResponse } from '@/types/api';\r\nimport { logProfileActivity, getRequestInfo } from '@/lib/activity/activityLogger';\r\n\r\n// ===================================\r\n// MEJORAS DE SEGURIDAD - ALTA PRIORIDAD\r\n// ===================================\r\nimport {\r\n  withRateLimit,\r\n  RATE_LIMIT_CONFIGS\r\n} from '@/lib/rate-limiting/rate-limiter';\r\nimport {\r\n  API_TIMEOUTS,\r\n  withDatabaseTimeout,\r\n  getEndpointTimeouts\r\n} from '@/lib/config/api-timeouts';\r\nimport { createSecurityLogger } from '@/lib/logging/security-logger';\r\n\r\n// ===================================\r\n// GET - Obtener perfil de usuario\r\n// ===================================\r\nexport async function GET(request: NextRequest) {\r\n  // Crear logger de seguridad con contexto\r\n  const securityLogger = createSecurityLogger(request);\r\n\r\n  // Aplicar rate limiting para APIs de usuario\r\n  const rateLimitResult = await withRateLimit(\r\n    request,\r\n    RATE_LIMIT_CONFIGS.auth,\r\n    async () => {\r\n      // Log de acceso a la API\r\n      securityLogger.logEvent('api_access', 'low', {\r\n        endpoint: '/api/user/profile',\r\n        method: 'GET',\r\n        userAgent: request.headers.get('user-agent'),\r\n        timestamp: new Date().toISOString()\r\n      });\r\n\r\n      try {\r\n        // Verificar que el cliente administrativo est\xE9 disponible\r\n        if (!supabaseAdmin) {\r\n          console.error('Cliente administrativo de Supabase no disponible en GET /api/user/profile');\r\n\r\n          // Log de error de seguridad\r\n          securityLogger.logEvent('service_unavailable', 'high', {\r\n            service: 'supabase_admin',\r\n            endpoint: '/api/user/profile'\r\n          });\r\n\r\n          return NextResponse.json(\r\n            { error: 'Servicio de base de datos no disponible' },\r\n            { status: 503 }\r\n          );\r\n        }\r\n\r\n        // Autenticaci\xF3n con Clerk\r\n        const session = await auth();\r\n        if (!session?.user) {\r\n          // Log de intento de acceso no autorizado\r\n          securityLogger.logEvent('unauthorized_access', 'medium', {\r\n            endpoint: '/api/user/profile',\r\n            reason: 'no_session'\r\n          });\r\n\r\n          const errorResponse: ApiResponse<null> = {\r\n            data: null,\r\n            success: false,\r\n            error: 'Usuario no autenticado',\r\n          };\r\n          return NextResponse.json(errorResponse, { status: 401 });\r\n        }\r\n\r\n        // Buscar usuario en Supabase\r\n        const userId = session.user.id;\r\n        const { data: user, error } = await withDatabaseTimeout(\r\n          supabaseAdmin\r\n            .from('users')\r\n            .select('*')\r\n            .eq('clerk_id', userId)\r\n            .single(),\r\n          API_TIMEOUTS.database\r\n        );\r\n\r\n        if (error && error.code !== 'PGRST116') {\r\n          console.error('Error al obtener usuario:', error);\r\n\r\n          // Log de error de base de datos\r\n          securityLogger.logEvent('database_error', 'medium', {\r\n            error: error.message,\r\n            endpoint: '/api/user/profile',\r\n            operation: 'select_user',\r\n            userId: userId\r\n          });\r\n\r\n          return NextResponse.json(\r\n            { error: 'Error al obtener perfil de usuario' },\r\n            { status: 500 }\r\n          );\r\n        }\r\n\r\n        // Si no existe el usuario, crear uno demo\r\n        if (!user) {\r\n      const { data: newUser, error: createError } = await supabaseAdmin\r\n        .from('users')\r\n        .insert([\r\n          {\r\n            clerk_id: userId,\r\n            email: 'usuario@demo.com',\r\n            name: 'Usuario Demo',\r\n          },\r\n        ])\r\n        .select()\r\n        .single();\r\n\r\n      if (createError) {\r\n        console.error('Error al crear usuario demo:', createError);\r\n        return NextResponse.json(\r\n          { error: 'Error al crear perfil de usuario' },\r\n          { status: 500 }\r\n        );\r\n      }\r\n\r\n      return NextResponse.json({\r\n        success: true,\r\n        user: newUser,\r\n      });\r\n    }\r\n\r\n        // Log de operaci\xF3n exitosa\r\n        securityLogger.logEvent('user_profile_retrieved', 'low', {\r\n          userId: userId,\r\n          hasUser: !!user\r\n        });\r\n\r\n        return NextResponse.json({\r\n          success: true,\r\n          user,\r\n        });\r\n\r\n      } catch (error) {\r\n        console.error('Error en GET /api/user/profile:', error);\r\n\r\n        // Log de error de seguridad\r\n        securityLogger.logEvent('api_error', 'high', {\r\n          error: error instanceof Error ? error.message : 'Unknown error',\r\n          endpoint: '/api/user/profile',\r\n          stack: error instanceof Error ? error.stack : undefined\r\n        });\r\n\r\n        return NextResponse.json(\r\n          { error: 'Error interno del servidor' },\r\n          { status: 500 }\r\n        );\r\n      }\r\n    }\r\n  );\r\n\r\n  // Manejar rate limit excedido\r\n  if (rateLimitResult instanceof NextResponse) {\r\n    securityLogger.logRateLimitExceeded(\r\n      securityLogger.context,\r\n      { endpoint: '/api/user/profile', method: 'GET' }\r\n    );\r\n    return rateLimitResult;\r\n  }\r\n\r\n  return rateLimitResult;\r\n}\r\n\r\n// ===================================\r\n// PUT - Actualizar perfil de usuario\r\n// ===================================\r\nexport async function PUT(request: NextRequest) {\r\n  try {\r\n    // Verificar que el cliente administrativo est\xE9 disponible\r\n    if (!supabaseAdmin) {\r\n      console.error('Cliente administrativo de Supabase no disponible en PUT /api/user/profile');\r\n      return NextResponse.json(\r\n        { error: 'Servicio de base de datos no disponible' },\r\n        { status: 503 }\r\n      );\r\n    }\r\n\r\n    // Autenticaci\xF3n con Clerk\r\n    const session = await auth();\r\n    if (!session?.user) {\r\n      const errorResponse: ApiResponse<null> = {\r\n        data: null,\r\n        success: false,\r\n        error: 'Usuario no autenticado',\r\n      };\r\n      return NextResponse.json(errorResponse, { status: 401 });\r\n    }\r\n    const userId = session.user.id;\r\n    const body = await request.json();\r\n\r\n    // Validar datos requeridos\r\n    const { name, email, phone } = body;\r\n    if (!name || !email) {\r\n      return NextResponse.json(\r\n        { error: 'Nombre y email son requeridos' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Actualizar usuario en Supabase\r\n    const { data: updatedUser, error } = await supabaseAdmin\r\n      .from('users')\r\n      .update({\r\n        name,\r\n        email,\r\n        phone: phone || null,\r\n        updated_at: new Date().toISOString(),\r\n      })\r\n      .eq('clerk_id', userId)\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      console.error('Error al actualizar usuario:', error);\r\n      return NextResponse.json(\r\n        { error: 'Error al actualizar perfil de usuario' },\r\n        { status: 500 }\r\n      );\r\n    }\r\n\r\n    // Registrar actividad de actualizaci\xF3n de perfil\r\n    const requestInfo = getRequestInfo(request);\r\n    await logProfileActivity(\r\n      updatedUser.id,\r\n      'update_profile',\r\n      {\r\n        fields_updated: Object.keys(body),\r\n        previous_name: updatedUser.name !== name ? 'changed' : 'unchanged',\r\n        previous_email: updatedUser.email !== email ? 'changed' : 'unchanged',\r\n        previous_phone: updatedUser.phone !== phone ? 'changed' : 'unchanged',\r\n      },\r\n      requestInfo\r\n    );\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      user: updatedUser,\r\n      message: 'Perfil actualizado correctamente',\r\n    });\r\n  } catch (error) {\r\n    console.error('Error en PUT /api/user/profile:', error);\r\n    return NextResponse.json(\r\n      { error: 'Error interno del servidor' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],
      names: ["GET", "PUT", "runtime", "request", "securityLogger", "createSecurityLogger", "rateLimitResult", "withRateLimit", "RATE_LIMIT_CONFIGS", "auth", "logEvent", "endpoint", "method", "userAgent", "headers", "get", "timestamp", "Date", "toISOString", "supabaseAdmin", "console", "error", "service", "NextResponse", "json", "status", "session", "user", "reason", "errorResponse", "data", "success", "userId", "id", "withDatabaseTimeout", "from", "select", "eq", "single", "API_TIMEOUTS", "database", "code", "message", "operation", "newUser", "createError", "insert", "clerk_id", "email", "name", "hasUser", "Error", "stack", "undefined", "logRateLimitExceeded", "context", "body", "phone", "updatedUser", "update", "updated_at", "requestInfo", "getRequestInfo", "logProfileActivity", "fields_updated", "Object", "keys", "previous_name", "previous_email", "previous_phone"],
      mappings: "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"
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "4bf53e6fdfc4c7a375d6efef58c4d61195aa00c3"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_1uhfcmk0k = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_1uhfcmk0k();
cov_1uhfcmk0k().s[0]++;
Object.defineProperty(exports, "__esModule", {
  value: true
});
function _export(target, all) {
  /* istanbul ignore next */
  cov_1uhfcmk0k().f[0]++;
  cov_1uhfcmk0k().s[1]++;
  for (var name in all) {
    /* istanbul ignore next */
    cov_1uhfcmk0k().s[2]++;
    Object.defineProperty(target, name, {
      enumerable: true,
      get: Object.getOwnPropertyDescriptor(all, name).get
    });
  }
}
/* istanbul ignore next */
cov_1uhfcmk0k().s[3]++;
_export(exports, {
  get GET() {
    /* istanbul ignore next */
    cov_1uhfcmk0k().f[1]++;
    cov_1uhfcmk0k().s[4]++;
    return GET;
  },
  get PUT() {
    /* istanbul ignore next */
    cov_1uhfcmk0k().f[2]++;
    cov_1uhfcmk0k().s[5]++;
    return PUT;
  },
  get runtime() {
    /* istanbul ignore next */
    cov_1uhfcmk0k().f[3]++;
    cov_1uhfcmk0k().s[6]++;
    return runtime;
  }
});
const _server =
/* istanbul ignore next */
(cov_1uhfcmk0k().s[7]++, require("next/server"));
const _supabase =
/* istanbul ignore next */
(cov_1uhfcmk0k().s[8]++, require("../../../../lib/integrations/supabase"));
const _config =
/* istanbul ignore next */
(cov_1uhfcmk0k().s[9]++, require("../../../../lib/auth/config"));
const _activityLogger =
/* istanbul ignore next */
(cov_1uhfcmk0k().s[10]++, require("../../../../lib/activity/activityLogger"));
const _ratelimiter =
/* istanbul ignore next */
(cov_1uhfcmk0k().s[11]++, require("../../../../lib/rate-limiting/rate-limiter"));
const _apitimeouts =
/* istanbul ignore next */
(cov_1uhfcmk0k().s[12]++, require("../../../../lib/config/api-timeouts"));
const _securitylogger =
/* istanbul ignore next */
(cov_1uhfcmk0k().s[13]++, require("../../../../lib/logging/security-logger"));
const runtime =
/* istanbul ignore next */
(cov_1uhfcmk0k().s[14]++, 'nodejs');
async function GET(request) {
  /* istanbul ignore next */
  cov_1uhfcmk0k().f[4]++;
  // Crear logger de seguridad con contexto
  const securityLogger =
  /* istanbul ignore next */
  (cov_1uhfcmk0k().s[15]++, (0, _securitylogger.createSecurityLogger)(request));
  // Aplicar rate limiting para APIs de usuario
  const rateLimitResult =
  /* istanbul ignore next */
  (cov_1uhfcmk0k().s[16]++, await (0, _ratelimiter.withRateLimit)(request, _ratelimiter.RATE_LIMIT_CONFIGS.auth, async () => {
    /* istanbul ignore next */
    cov_1uhfcmk0k().f[5]++;
    cov_1uhfcmk0k().s[17]++;
    // Log de acceso a la API
    securityLogger.logEvent('api_access', 'low', {
      endpoint: '/api/user/profile',
      method: 'GET',
      userAgent: request.headers.get('user-agent'),
      timestamp: new Date().toISOString()
    });
    /* istanbul ignore next */
    cov_1uhfcmk0k().s[18]++;
    try {
      /* istanbul ignore next */
      cov_1uhfcmk0k().s[19]++;
      // Verificar que el cliente administrativo estÃ© disponible
      if (!_supabase.supabaseAdmin) {
        /* istanbul ignore next */
        cov_1uhfcmk0k().b[0][0]++;
        cov_1uhfcmk0k().s[20]++;
        console.error('Cliente administrativo de Supabase no disponible en GET /api/user/profile');
        // Log de error de seguridad
        /* istanbul ignore next */
        cov_1uhfcmk0k().s[21]++;
        securityLogger.logEvent('service_unavailable', 'high', {
          service: 'supabase_admin',
          endpoint: '/api/user/profile'
        });
        /* istanbul ignore next */
        cov_1uhfcmk0k().s[22]++;
        return _server.NextResponse.json({
          error: 'Servicio de base de datos no disponible'
        }, {
          status: 503
        });
      } else
      /* istanbul ignore next */
      {
        cov_1uhfcmk0k().b[0][1]++;
      }
      // AutenticaciÃ³n con Clerk
      const session =
      /* istanbul ignore next */
      (cov_1uhfcmk0k().s[23]++, await (0, _config.auth)());
      /* istanbul ignore next */
      cov_1uhfcmk0k().s[24]++;
      if (!session?.user) {
        /* istanbul ignore next */
        cov_1uhfcmk0k().b[1][0]++;
        cov_1uhfcmk0k().s[25]++;
        // Log de intento de acceso no autorizado
        securityLogger.logEvent('unauthorized_access', 'medium', {
          endpoint: '/api/user/profile',
          reason: 'no_session'
        });
        const errorResponse =
        /* istanbul ignore next */
        (cov_1uhfcmk0k().s[26]++, {
          data: null,
          success: false,
          error: 'Usuario no autenticado'
        });
        /* istanbul ignore next */
        cov_1uhfcmk0k().s[27]++;
        return _server.NextResponse.json(errorResponse, {
          status: 401
        });
      } else
      /* istanbul ignore next */
      {
        cov_1uhfcmk0k().b[1][1]++;
      }
      // Buscar usuario en Supabase
      const userId =
      /* istanbul ignore next */
      (cov_1uhfcmk0k().s[28]++, session.user.id);
      const {
        data: user,
        error
      } =
      /* istanbul ignore next */
      (cov_1uhfcmk0k().s[29]++, await (0, _apitimeouts.withDatabaseTimeout)(_supabase.supabaseAdmin.from('users').select('*').eq('clerk_id', userId).single(), _apitimeouts.API_TIMEOUTS.database));
      /* istanbul ignore next */
      cov_1uhfcmk0k().s[30]++;
      if (
      /* istanbul ignore next */
      (cov_1uhfcmk0k().b[3][0]++, error) &&
      /* istanbul ignore next */
      (cov_1uhfcmk0k().b[3][1]++, error.code !== 'PGRST116')) {
        /* istanbul ignore next */
        cov_1uhfcmk0k().b[2][0]++;
        cov_1uhfcmk0k().s[31]++;
        console.error('Error al obtener usuario:', error);
        // Log de error de base de datos
        /* istanbul ignore next */
        cov_1uhfcmk0k().s[32]++;
        securityLogger.logEvent('database_error', 'medium', {
          error: error.message,
          endpoint: '/api/user/profile',
          operation: 'select_user',
          userId: userId
        });
        /* istanbul ignore next */
        cov_1uhfcmk0k().s[33]++;
        return _server.NextResponse.json({
          error: 'Error al obtener perfil de usuario'
        }, {
          status: 500
        });
      } else
      /* istanbul ignore next */
      {
        cov_1uhfcmk0k().b[2][1]++;
      }
      // Si no existe el usuario, crear uno demo
      cov_1uhfcmk0k().s[34]++;
      if (!user) {
        /* istanbul ignore next */
        cov_1uhfcmk0k().b[4][0]++;
        const {
          data: newUser,
          error: createError
        } =
        /* istanbul ignore next */
        (cov_1uhfcmk0k().s[35]++, await _supabase.supabaseAdmin.from('users').insert([{
          clerk_id: userId,
          email: 'usuario@demo.com',
          name: 'Usuario Demo'
        }]).select().single());
        /* istanbul ignore next */
        cov_1uhfcmk0k().s[36]++;
        if (createError) {
          /* istanbul ignore next */
          cov_1uhfcmk0k().b[5][0]++;
          cov_1uhfcmk0k().s[37]++;
          console.error('Error al crear usuario demo:', createError);
          /* istanbul ignore next */
          cov_1uhfcmk0k().s[38]++;
          return _server.NextResponse.json({
            error: 'Error al crear perfil de usuario'
          }, {
            status: 500
          });
        } else
        /* istanbul ignore next */
        {
          cov_1uhfcmk0k().b[5][1]++;
        }
        cov_1uhfcmk0k().s[39]++;
        return _server.NextResponse.json({
          success: true,
          user: newUser
        });
      } else
      /* istanbul ignore next */
      {
        cov_1uhfcmk0k().b[4][1]++;
      }
      // Log de operaciÃ³n exitosa
      cov_1uhfcmk0k().s[40]++;
      securityLogger.logEvent('user_profile_retrieved', 'low', {
        userId: userId,
        hasUser: !!user
      });
      /* istanbul ignore next */
      cov_1uhfcmk0k().s[41]++;
      return _server.NextResponse.json({
        success: true,
        user
      });
    } catch (error) {
      /* istanbul ignore next */
      cov_1uhfcmk0k().s[42]++;
      console.error('Error en GET /api/user/profile:', error);
      // Log de error de seguridad
      /* istanbul ignore next */
      cov_1uhfcmk0k().s[43]++;
      securityLogger.logEvent('api_error', 'high', {
        error: error instanceof Error ?
        /* istanbul ignore next */
        (cov_1uhfcmk0k().b[6][0]++, error.message) :
        /* istanbul ignore next */
        (cov_1uhfcmk0k().b[6][1]++, 'Unknown error'),
        endpoint: '/api/user/profile',
        stack: error instanceof Error ?
        /* istanbul ignore next */
        (cov_1uhfcmk0k().b[7][0]++, error.stack) :
        /* istanbul ignore next */
        (cov_1uhfcmk0k().b[7][1]++, undefined)
      });
      /* istanbul ignore next */
      cov_1uhfcmk0k().s[44]++;
      return _server.NextResponse.json({
        error: 'Error interno del servidor'
      }, {
        status: 500
      });
    }
  }));
  // Manejar rate limit excedido
  /* istanbul ignore next */
  cov_1uhfcmk0k().s[45]++;
  if (rateLimitResult instanceof _server.NextResponse) {
    /* istanbul ignore next */
    cov_1uhfcmk0k().b[8][0]++;
    cov_1uhfcmk0k().s[46]++;
    securityLogger.logRateLimitExceeded(securityLogger.context, {
      endpoint: '/api/user/profile',
      method: 'GET'
    });
    /* istanbul ignore next */
    cov_1uhfcmk0k().s[47]++;
    return rateLimitResult;
  } else
  /* istanbul ignore next */
  {
    cov_1uhfcmk0k().b[8][1]++;
  }
  cov_1uhfcmk0k().s[48]++;
  return rateLimitResult;
}
async function PUT(request) {
  /* istanbul ignore next */
  cov_1uhfcmk0k().f[6]++;
  cov_1uhfcmk0k().s[49]++;
  try {
    /* istanbul ignore next */
    cov_1uhfcmk0k().s[50]++;
    // Verificar que el cliente administrativo estÃ© disponible
    if (!_supabase.supabaseAdmin) {
      /* istanbul ignore next */
      cov_1uhfcmk0k().b[9][0]++;
      cov_1uhfcmk0k().s[51]++;
      console.error('Cliente administrativo de Supabase no disponible en PUT /api/user/profile');
      /* istanbul ignore next */
      cov_1uhfcmk0k().s[52]++;
      return _server.NextResponse.json({
        error: 'Servicio de base de datos no disponible'
      }, {
        status: 503
      });
    } else
    /* istanbul ignore next */
    {
      cov_1uhfcmk0k().b[9][1]++;
    }
    // AutenticaciÃ³n con Clerk
    const session =
    /* istanbul ignore next */
    (cov_1uhfcmk0k().s[53]++, await (0, _config.auth)());
    /* istanbul ignore next */
    cov_1uhfcmk0k().s[54]++;
    if (!session?.user) {
      /* istanbul ignore next */
      cov_1uhfcmk0k().b[10][0]++;
      const errorResponse =
      /* istanbul ignore next */
      (cov_1uhfcmk0k().s[55]++, {
        data: null,
        success: false,
        error: 'Usuario no autenticado'
      });
      /* istanbul ignore next */
      cov_1uhfcmk0k().s[56]++;
      return _server.NextResponse.json(errorResponse, {
        status: 401
      });
    } else
    /* istanbul ignore next */
    {
      cov_1uhfcmk0k().b[10][1]++;
    }
    const userId =
    /* istanbul ignore next */
    (cov_1uhfcmk0k().s[57]++, session.user.id);
    const body =
    /* istanbul ignore next */
    (cov_1uhfcmk0k().s[58]++, await request.json());
    // Validar datos requeridos
    const {
      name,
      email,
      phone
    } =
    /* istanbul ignore next */
    (cov_1uhfcmk0k().s[59]++, body);
    /* istanbul ignore next */
    cov_1uhfcmk0k().s[60]++;
    if (
    /* istanbul ignore next */
    (cov_1uhfcmk0k().b[12][0]++, !name) ||
    /* istanbul ignore next */
    (cov_1uhfcmk0k().b[12][1]++, !email)) {
      /* istanbul ignore next */
      cov_1uhfcmk0k().b[11][0]++;
      cov_1uhfcmk0k().s[61]++;
      return _server.NextResponse.json({
        error: 'Nombre y email son requeridos'
      }, {
        status: 400
      });
    } else
    /* istanbul ignore next */
    {
      cov_1uhfcmk0k().b[11][1]++;
    }
    // Actualizar usuario en Supabase
    const {
      data: updatedUser,
      error
    } =
    /* istanbul ignore next */
    (cov_1uhfcmk0k().s[62]++, await _supabase.supabaseAdmin.from('users').update({
      name,
      email,
      phone:
      /* istanbul ignore next */
      (cov_1uhfcmk0k().b[13][0]++, phone) ||
      /* istanbul ignore next */
      (cov_1uhfcmk0k().b[13][1]++, null),
      updated_at: new Date().toISOString()
    }).eq('clerk_id', userId).select().single());
    /* istanbul ignore next */
    cov_1uhfcmk0k().s[63]++;
    if (error) {
      /* istanbul ignore next */
      cov_1uhfcmk0k().b[14][0]++;
      cov_1uhfcmk0k().s[64]++;
      console.error('Error al actualizar usuario:', error);
      /* istanbul ignore next */
      cov_1uhfcmk0k().s[65]++;
      return _server.NextResponse.json({
        error: 'Error al actualizar perfil de usuario'
      }, {
        status: 500
      });
    } else
    /* istanbul ignore next */
    {
      cov_1uhfcmk0k().b[14][1]++;
    }
    // Registrar actividad de actualizaciÃ³n de perfil
    const requestInfo =
    /* istanbul ignore next */
    (cov_1uhfcmk0k().s[66]++, (0, _activityLogger.getRequestInfo)(request));
    /* istanbul ignore next */
    cov_1uhfcmk0k().s[67]++;
    await (0, _activityLogger.logProfileActivity)(updatedUser.id, 'update_profile', {
      fields_updated: Object.keys(body),
      previous_name: updatedUser.name !== name ?
      /* istanbul ignore next */
      (cov_1uhfcmk0k().b[15][0]++, 'changed') :
      /* istanbul ignore next */
      (cov_1uhfcmk0k().b[15][1]++, 'unchanged'),
      previous_email: updatedUser.email !== email ?
      /* istanbul ignore next */
      (cov_1uhfcmk0k().b[16][0]++, 'changed') :
      /* istanbul ignore next */
      (cov_1uhfcmk0k().b[16][1]++, 'unchanged'),
      previous_phone: updatedUser.phone !== phone ?
      /* istanbul ignore next */
      (cov_1uhfcmk0k().b[17][0]++, 'changed') :
      /* istanbul ignore next */
      (cov_1uhfcmk0k().b[17][1]++, 'unchanged')
    }, requestInfo);
    /* istanbul ignore next */
    cov_1uhfcmk0k().s[68]++;
    return _server.NextResponse.json({
      success: true,
      user: updatedUser,
      message: 'Perfil actualizado correctamente'
    });
  } catch (error) {
    /* istanbul ignore next */
    cov_1uhfcmk0k().s[69]++;
    console.error('Error en PUT /api/user/profile:', error);
    /* istanbul ignore next */
    cov_1uhfcmk0k().s[70]++;
    return _server.NextResponse.json({
      error: 'Error interno del servidor'
    }, {
      status: 500
    });
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMXVoZmNtazBrIiwiYWN0dWFsQ292ZXJhZ2UiLCJzIiwiR0VUIiwiZiIsIlBVVCIsInJ1bnRpbWUiLCJyZXF1ZXN0Iiwic2VjdXJpdHlMb2dnZXIiLCJfc2VjdXJpdHlsb2dnZXIiLCJjcmVhdGVTZWN1cml0eUxvZ2dlciIsInJhdGVMaW1pdFJlc3VsdCIsIl9yYXRlbGltaXRlciIsIndpdGhSYXRlTGltaXQiLCJSQVRFX0xJTUlUX0NPTkZJR1MiLCJhdXRoIiwibG9nRXZlbnQiLCJlbmRwb2ludCIsIm1ldGhvZCIsInVzZXJBZ2VudCIsImhlYWRlcnMiLCJnZXQiLCJ0aW1lc3RhbXAiLCJEYXRlIiwidG9JU09TdHJpbmciLCJfc3VwYWJhc2UiLCJzdXBhYmFzZUFkbWluIiwiYiIsImNvbnNvbGUiLCJlcnJvciIsInNlcnZpY2UiLCJfc2VydmVyIiwiTmV4dFJlc3BvbnNlIiwianNvbiIsInN0YXR1cyIsInNlc3Npb24iLCJfY29uZmlnIiwidXNlciIsInJlYXNvbiIsImVycm9yUmVzcG9uc2UiLCJkYXRhIiwic3VjY2VzcyIsInVzZXJJZCIsImlkIiwiX2FwaXRpbWVvdXRzIiwid2l0aERhdGFiYXNlVGltZW91dCIsImZyb20iLCJzZWxlY3QiLCJlcSIsInNpbmdsZSIsIkFQSV9USU1FT1VUUyIsImRhdGFiYXNlIiwiY29kZSIsIm1lc3NhZ2UiLCJvcGVyYXRpb24iLCJuZXdVc2VyIiwiY3JlYXRlRXJyb3IiLCJpbnNlcnQiLCJjbGVya19pZCIsImVtYWlsIiwibmFtZSIsImhhc1VzZXIiLCJFcnJvciIsInN0YWNrIiwidW5kZWZpbmVkIiwibG9nUmF0ZUxpbWl0RXhjZWVkZWQiLCJjb250ZXh0IiwiYm9keSIsInBob25lIiwidXBkYXRlZFVzZXIiLCJ1cGRhdGUiLCJ1cGRhdGVkX2F0IiwicmVxdWVzdEluZm8iLCJfYWN0aXZpdHlMb2dnZXIiLCJnZXRSZXF1ZXN0SW5mbyIsImxvZ1Byb2ZpbGVBY3Rpdml0eSIsImZpZWxkc191cGRhdGVkIiwiT2JqZWN0Iiwia2V5cyIsInByZXZpb3VzX25hbWUiLCJwcmV2aW91c19lbWFpbCIsInByZXZpb3VzX3Bob25lIl0sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxtYXJ0aVxcRGVza3RvcFxcREVTQVJST0xMT1NXXFxCT0lMRVJQTEFUVEUgRS1DT01NRVJDRVxcc3JjXFxhcHBcXGFwaVxcdXNlclxccHJvZmlsZVxccm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29uZmlndXJhY2nDs24gcGFyYSBOb2RlLmpzIFJ1bnRpbWVcclxuZXhwb3J0IGNvbnN0IHJ1bnRpbWUgPSAnbm9kZWpzJztcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBJTlRFWUEgRS1DT01NRVJDRSAtIEFQSSBERSBQRVJGSUwgREUgVVNVQVJJT1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcclxuaW1wb3J0IHsgc3VwYWJhc2VBZG1pbiB9IGZyb20gJ0AvbGliL2ludGVncmF0aW9ucy9zdXBhYmFzZSc7XHJcbmltcG9ydCB7IGF1dGggfSBmcm9tICdAL2xpYi9hdXRoL2NvbmZpZyc7XHJcbmltcG9ydCB7IEFwaVJlc3BvbnNlIH0gZnJvbSAnQC90eXBlcy9hcGknO1xyXG5pbXBvcnQgeyBsb2dQcm9maWxlQWN0aXZpdHksIGdldFJlcXVlc3RJbmZvIH0gZnJvbSAnQC9saWIvYWN0aXZpdHkvYWN0aXZpdHlMb2dnZXInO1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gTUVKT1JBUyBERSBTRUdVUklEQUQgLSBBTFRBIFBSSU9SSURBRFxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5pbXBvcnQge1xyXG4gIHdpdGhSYXRlTGltaXQsXHJcbiAgUkFURV9MSU1JVF9DT05GSUdTXHJcbn0gZnJvbSAnQC9saWIvcmF0ZS1saW1pdGluZy9yYXRlLWxpbWl0ZXInO1xyXG5pbXBvcnQge1xyXG4gIEFQSV9USU1FT1VUUyxcclxuICB3aXRoRGF0YWJhc2VUaW1lb3V0LFxyXG4gIGdldEVuZHBvaW50VGltZW91dHNcclxufSBmcm9tICdAL2xpYi9jb25maWcvYXBpLXRpbWVvdXRzJztcclxuaW1wb3J0IHsgY3JlYXRlU2VjdXJpdHlMb2dnZXIgfSBmcm9tICdAL2xpYi9sb2dnaW5nL3NlY3VyaXR5LWxvZ2dlcic7XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBHRVQgLSBPYnRlbmVyIHBlcmZpbCBkZSB1c3VhcmlvXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICAvLyBDcmVhciBsb2dnZXIgZGUgc2VndXJpZGFkIGNvbiBjb250ZXh0b1xyXG4gIGNvbnN0IHNlY3VyaXR5TG9nZ2VyID0gY3JlYXRlU2VjdXJpdHlMb2dnZXIocmVxdWVzdCk7XHJcblxyXG4gIC8vIEFwbGljYXIgcmF0ZSBsaW1pdGluZyBwYXJhIEFQSXMgZGUgdXN1YXJpb1xyXG4gIGNvbnN0IHJhdGVMaW1pdFJlc3VsdCA9IGF3YWl0IHdpdGhSYXRlTGltaXQoXHJcbiAgICByZXF1ZXN0LFxyXG4gICAgUkFURV9MSU1JVF9DT05GSUdTLmF1dGgsXHJcbiAgICBhc3luYyAoKSA9PiB7XHJcbiAgICAgIC8vIExvZyBkZSBhY2Nlc28gYSBsYSBBUElcclxuICAgICAgc2VjdXJpdHlMb2dnZXIubG9nRXZlbnQoJ2FwaV9hY2Nlc3MnLCAnbG93Jywge1xyXG4gICAgICAgIGVuZHBvaW50OiAnL2FwaS91c2VyL3Byb2ZpbGUnLFxyXG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgICAgdXNlckFnZW50OiByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd1c2VyLWFnZW50JyksXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgfSk7XHJcblxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIC8vIFZlcmlmaWNhciBxdWUgZWwgY2xpZW50ZSBhZG1pbmlzdHJhdGl2byBlc3TDqSBkaXNwb25pYmxlXHJcbiAgICAgICAgaWYgKCFzdXBhYmFzZUFkbWluKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdDbGllbnRlIGFkbWluaXN0cmF0aXZvIGRlIFN1cGFiYXNlIG5vIGRpc3BvbmlibGUgZW4gR0VUIC9hcGkvdXNlci9wcm9maWxlJyk7XHJcblxyXG4gICAgICAgICAgLy8gTG9nIGRlIGVycm9yIGRlIHNlZ3VyaWRhZFxyXG4gICAgICAgICAgc2VjdXJpdHlMb2dnZXIubG9nRXZlbnQoJ3NlcnZpY2VfdW5hdmFpbGFibGUnLCAnaGlnaCcsIHtcclxuICAgICAgICAgICAgc2VydmljZTogJ3N1cGFiYXNlX2FkbWluJyxcclxuICAgICAgICAgICAgZW5kcG9pbnQ6ICcvYXBpL3VzZXIvcHJvZmlsZSdcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICAgICAgeyBlcnJvcjogJ1NlcnZpY2lvIGRlIGJhc2UgZGUgZGF0b3Mgbm8gZGlzcG9uaWJsZScgfSxcclxuICAgICAgICAgICAgeyBzdGF0dXM6IDUwMyB9XHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQXV0ZW50aWNhY2nDs24gY29uIENsZXJrXHJcbiAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGF1dGgoKTtcclxuICAgICAgICBpZiAoIXNlc3Npb24/LnVzZXIpIHtcclxuICAgICAgICAgIC8vIExvZyBkZSBpbnRlbnRvIGRlIGFjY2VzbyBubyBhdXRvcml6YWRvXHJcbiAgICAgICAgICBzZWN1cml0eUxvZ2dlci5sb2dFdmVudCgndW5hdXRob3JpemVkX2FjY2VzcycsICdtZWRpdW0nLCB7XHJcbiAgICAgICAgICAgIGVuZHBvaW50OiAnL2FwaS91c2VyL3Byb2ZpbGUnLFxyXG4gICAgICAgICAgICByZWFzb246ICdub19zZXNzaW9uJ1xyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgY29uc3QgZXJyb3JSZXNwb25zZTogQXBpUmVzcG9uc2U8bnVsbD4gPSB7XHJcbiAgICAgICAgICAgIGRhdGE6IG51bGwsXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgICBlcnJvcjogJ1VzdWFyaW8gbm8gYXV0ZW50aWNhZG8nLFxyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihlcnJvclJlc3BvbnNlLCB7IHN0YXR1czogNDAxIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQnVzY2FyIHVzdWFyaW8gZW4gU3VwYWJhc2VcclxuICAgICAgICBjb25zdCB1c2VySWQgPSBzZXNzaW9uLnVzZXIuaWQ7XHJcbiAgICAgICAgY29uc3QgeyBkYXRhOiB1c2VyLCBlcnJvciB9ID0gYXdhaXQgd2l0aERhdGFiYXNlVGltZW91dChcclxuICAgICAgICAgIHN1cGFiYXNlQWRtaW5cclxuICAgICAgICAgICAgLmZyb20oJ3VzZXJzJylcclxuICAgICAgICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgICAgICAgIC5lcSgnY2xlcmtfaWQnLCB1c2VySWQpXHJcbiAgICAgICAgICAgIC5zaW5nbGUoKSxcclxuICAgICAgICAgIEFQSV9USU1FT1VUUy5kYXRhYmFzZVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGlmIChlcnJvciAmJiBlcnJvci5jb2RlICE9PSAnUEdSU1QxMTYnKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBhbCBvYnRlbmVyIHVzdWFyaW86JywgZXJyb3IpO1xyXG5cclxuICAgICAgICAgIC8vIExvZyBkZSBlcnJvciBkZSBiYXNlIGRlIGRhdG9zXHJcbiAgICAgICAgICBzZWN1cml0eUxvZ2dlci5sb2dFdmVudCgnZGF0YWJhc2VfZXJyb3InLCAnbWVkaXVtJywge1xyXG4gICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgICAgICAgICAgZW5kcG9pbnQ6ICcvYXBpL3VzZXIvcHJvZmlsZScsXHJcbiAgICAgICAgICAgIG9wZXJhdGlvbjogJ3NlbGVjdF91c2VyJyxcclxuICAgICAgICAgICAgdXNlcklkOiB1c2VySWRcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICAgICAgeyBlcnJvcjogJ0Vycm9yIGFsIG9idGVuZXIgcGVyZmlsIGRlIHVzdWFyaW8nIH0sXHJcbiAgICAgICAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFNpIG5vIGV4aXN0ZSBlbCB1c3VhcmlvLCBjcmVhciB1bm8gZGVtb1xyXG4gICAgICAgIGlmICghdXNlcikge1xyXG4gICAgICBjb25zdCB7IGRhdGE6IG5ld1VzZXIsIGVycm9yOiBjcmVhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxyXG4gICAgICAgIC5mcm9tKCd1c2VycycpXHJcbiAgICAgICAgLmluc2VydChbXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIGNsZXJrX2lkOiB1c2VySWQsXHJcbiAgICAgICAgICAgIGVtYWlsOiAndXN1YXJpb0BkZW1vLmNvbScsXHJcbiAgICAgICAgICAgIG5hbWU6ICdVc3VhcmlvIERlbW8nLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICBdKVxyXG4gICAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICAgIGlmIChjcmVhdGVFcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGFsIGNyZWFyIHVzdWFyaW8gZGVtbzonLCBjcmVhdGVFcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgICAgeyBlcnJvcjogJ0Vycm9yIGFsIGNyZWFyIHBlcmZpbCBkZSB1c3VhcmlvJyB9LFxyXG4gICAgICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICAgICAgKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgIHVzZXI6IG5ld1VzZXIsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgICAgICAvLyBMb2cgZGUgb3BlcmFjacOzbiBleGl0b3NhXHJcbiAgICAgICAgc2VjdXJpdHlMb2dnZXIubG9nRXZlbnQoJ3VzZXJfcHJvZmlsZV9yZXRyaWV2ZWQnLCAnbG93Jywge1xyXG4gICAgICAgICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICAgICAgICBoYXNVc2VyOiAhIXVzZXJcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICB1c2VyLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBlbiBHRVQgL2FwaS91c2VyL3Byb2ZpbGU6JywgZXJyb3IpO1xyXG5cclxuICAgICAgICAvLyBMb2cgZGUgZXJyb3IgZGUgc2VndXJpZGFkXHJcbiAgICAgICAgc2VjdXJpdHlMb2dnZXIubG9nRXZlbnQoJ2FwaV9lcnJvcicsICdoaWdoJywge1xyXG4gICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxyXG4gICAgICAgICAgZW5kcG9pbnQ6ICcvYXBpL3VzZXIvcHJvZmlsZScsXHJcbiAgICAgICAgICBzdGFjazogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLnN0YWNrIDogdW5kZWZpbmVkXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICAgIHsgZXJyb3I6ICdFcnJvciBpbnRlcm5vIGRlbCBzZXJ2aWRvcicgfSxcclxuICAgICAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICApO1xyXG5cclxuICAvLyBNYW5lamFyIHJhdGUgbGltaXQgZXhjZWRpZG9cclxuICBpZiAocmF0ZUxpbWl0UmVzdWx0IGluc3RhbmNlb2YgTmV4dFJlc3BvbnNlKSB7XHJcbiAgICBzZWN1cml0eUxvZ2dlci5sb2dSYXRlTGltaXRFeGNlZWRlZChcclxuICAgICAgc2VjdXJpdHlMb2dnZXIuY29udGV4dCxcclxuICAgICAgeyBlbmRwb2ludDogJy9hcGkvdXNlci9wcm9maWxlJywgbWV0aG9kOiAnR0VUJyB9XHJcbiAgICApO1xyXG4gICAgcmV0dXJuIHJhdGVMaW1pdFJlc3VsdDtcclxuICB9XHJcblxyXG4gIHJldHVybiByYXRlTGltaXRSZXN1bHQ7XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVVCAtIEFjdHVhbGl6YXIgcGVyZmlsIGRlIHVzdWFyaW9cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBVVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBWZXJpZmljYXIgcXVlIGVsIGNsaWVudGUgYWRtaW5pc3RyYXRpdm8gZXN0w6kgZGlzcG9uaWJsZVxyXG4gICAgaWYgKCFzdXBhYmFzZUFkbWluKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0NsaWVudGUgYWRtaW5pc3RyYXRpdm8gZGUgU3VwYWJhc2Ugbm8gZGlzcG9uaWJsZSBlbiBQVVQgL2FwaS91c2VyL3Byb2ZpbGUnKTtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgZXJyb3I6ICdTZXJ2aWNpbyBkZSBiYXNlIGRlIGRhdG9zIG5vIGRpc3BvbmlibGUnIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDUwMyB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQXV0ZW50aWNhY2nDs24gY29uIENsZXJrXHJcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgYXV0aCgpO1xyXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyKSB7XHJcbiAgICAgIGNvbnN0IGVycm9yUmVzcG9uc2U6IEFwaVJlc3BvbnNlPG51bGw+ID0ge1xyXG4gICAgICAgIGRhdGE6IG51bGwsXHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdVc3VhcmlvIG5vIGF1dGVudGljYWRvJyxcclxuICAgICAgfTtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKGVycm9yUmVzcG9uc2UsIHsgc3RhdHVzOiA0MDEgfSk7XHJcbiAgICB9XHJcbiAgICBjb25zdCB1c2VySWQgPSBzZXNzaW9uLnVzZXIuaWQ7XHJcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XHJcblxyXG4gICAgLy8gVmFsaWRhciBkYXRvcyByZXF1ZXJpZG9zXHJcbiAgICBjb25zdCB7IG5hbWUsIGVtYWlsLCBwaG9uZSB9ID0gYm9keTtcclxuICAgIGlmICghbmFtZSB8fCAhZW1haWwpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgZXJyb3I6ICdOb21icmUgeSBlbWFpbCBzb24gcmVxdWVyaWRvcycgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBBY3R1YWxpemFyIHVzdWFyaW8gZW4gU3VwYWJhc2VcclxuICAgIGNvbnN0IHsgZGF0YTogdXBkYXRlZFVzZXIsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXHJcbiAgICAgIC5mcm9tKCd1c2VycycpXHJcbiAgICAgIC51cGRhdGUoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgZW1haWwsXHJcbiAgICAgICAgcGhvbmU6IHBob25lIHx8IG51bGwsXHJcbiAgICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICB9KVxyXG4gICAgICAuZXEoJ2NsZXJrX2lkJywgdXNlcklkKVxyXG4gICAgICAuc2VsZWN0KClcclxuICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBhbCBhY3R1YWxpemFyIHVzdWFyaW86JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogJ0Vycm9yIGFsIGFjdHVhbGl6YXIgcGVyZmlsIGRlIHVzdWFyaW8nIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmVnaXN0cmFyIGFjdGl2aWRhZCBkZSBhY3R1YWxpemFjacOzbiBkZSBwZXJmaWxcclxuICAgIGNvbnN0IHJlcXVlc3RJbmZvID0gZ2V0UmVxdWVzdEluZm8ocmVxdWVzdCk7XHJcbiAgICBhd2FpdCBsb2dQcm9maWxlQWN0aXZpdHkoXHJcbiAgICAgIHVwZGF0ZWRVc2VyLmlkLFxyXG4gICAgICAndXBkYXRlX3Byb2ZpbGUnLFxyXG4gICAgICB7XHJcbiAgICAgICAgZmllbGRzX3VwZGF0ZWQ6IE9iamVjdC5rZXlzKGJvZHkpLFxyXG4gICAgICAgIHByZXZpb3VzX25hbWU6IHVwZGF0ZWRVc2VyLm5hbWUgIT09IG5hbWUgPyAnY2hhbmdlZCcgOiAndW5jaGFuZ2VkJyxcclxuICAgICAgICBwcmV2aW91c19lbWFpbDogdXBkYXRlZFVzZXIuZW1haWwgIT09IGVtYWlsID8gJ2NoYW5nZWQnIDogJ3VuY2hhbmdlZCcsXHJcbiAgICAgICAgcHJldmlvdXNfcGhvbmU6IHVwZGF0ZWRVc2VyLnBob25lICE9PSBwaG9uZSA/ICdjaGFuZ2VkJyA6ICd1bmNoYW5nZWQnLFxyXG4gICAgICB9LFxyXG4gICAgICByZXF1ZXN0SW5mb1xyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICB1c2VyOiB1cGRhdGVkVXNlcixcclxuICAgICAgbWVzc2FnZTogJ1BlcmZpbCBhY3R1YWxpemFkbyBjb3JyZWN0YW1lbnRlJyxcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBlbiBQVVQgL2FwaS91c2VyL3Byb2ZpbGU6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7IGVycm9yOiAnRXJyb3IgaW50ZXJubyBkZWwgc2Vydmlkb3InIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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