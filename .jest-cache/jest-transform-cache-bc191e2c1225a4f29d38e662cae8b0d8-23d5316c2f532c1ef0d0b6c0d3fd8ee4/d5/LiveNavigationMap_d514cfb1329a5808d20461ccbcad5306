34942cc0f6c2a3eeb58edd32a52df19b
/**
 * Componente de navegación GPS en tiempo real para drivers
 */ 'use client';
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return LiveNavigationMap;
    }
});
const _jsxruntime = require("react/jsx-runtime");
const _react = /*#__PURE__*/ _interop_require_wildcard(require("react"));
const _api = require("@react-google-maps/api");
const _card = require("../ui/card");
const _button = require("../ui/button");
const _badge = require("../ui/badge");
const _lucidereact = require("lucide-react");
const _sonner = require("sonner");
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
const mapContainerStyle = {
    width: '100%',
    height: '400px'
};
const defaultCenter = {
    lat: -31.4201,
    lng: -64.1888
};
function LiveNavigationMap({ stops, onCompleteDelivery, onNavigationUpdate }) {
    const [currentLocation, setCurrentLocation] = (0, _react.useState)(null);
    const [directions, setDirections] = (0, _react.useState)(null);
    const [currentStopIndex, setCurrentStopIndex] = (0, _react.useState)(0);
    const [selectedStop, setSelectedStop] = (0, _react.useState)(null);
    const [isNavigating, setIsNavigating] = (0, _react.useState)(false);
    const [watchId, setWatchId] = (0, _react.useState)(null);
    const [isGoogleMapsLoaded, setIsGoogleMapsLoaded] = (0, _react.useState)(false);
    const mapRef = (0, _react.useRef)(null);
    (0, _react.useEffect)(()=>{
        // Verificar si Google Maps está cargado
        const checkGoogleMaps = ()=>{
            if (window.google && window.google.maps) {
                setIsGoogleMapsLoaded(true);
            } else {
                setTimeout(checkGoogleMaps, 100);
            }
        };
        checkGoogleMaps();
    }, []);
    (0, _react.useEffect)(()=>{
        // Solicitar ubicación actual
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition((position)=>{
                const location = {
                    lat: position.coords.latitude,
                    lng: position.coords.longitude
                };
                setCurrentLocation(location);
                if (onNavigationUpdate) {
                    onNavigationUpdate(location);
                }
            }, (error)=>{
                console.error('Error getting location:', error);
                _sonner.toast.error('No se pudo obtener la ubicación actual');
                // Usar ubicación por defecto (Córdoba)
                setCurrentLocation(defaultCenter);
            });
        }
    }, [
        onNavigationUpdate
    ]);
    (0, _react.useEffect)(()=>{
        if (currentLocation && stops.length > 0) {
            calculateRoute();
        }
    }, [
        currentLocation,
        stops,
        currentStopIndex
    ]);
    const calculateRoute = async ()=>{
        if (!currentLocation || !window.google || !window.google.maps) return;
        const directionsService = new google.maps.DirectionsService();
        const currentStop = stops.find((stop)=>stop.status === 'current');
        if (!currentStop || !currentStop.coordinates) {
            setDirections(null);
            return;
        }
        console.log('🗺️ Calculando ruta GPS desde:', currentLocation, 'hacia:', currentStop.coordinates);
        try {
            const result = await directionsService.route({
                origin: currentLocation,
                destination: currentStop.coordinates,
                travelMode: google.maps.TravelMode.DRIVING,
                optimizeWaypoints: false,
                avoidHighways: false,
                avoidTolls: false,
                unitSystem: google.maps.UnitSystem.METRIC,
                language: 'es',
                region: 'AR'
            });
            console.log('✅ Ruta GPS calculada exitosamente:', result);
            setDirections(result);
            // Extraer información de navegación
            const route = result.routes[0];
            const leg = route.legs[0];
            console.log('📊 Información de ruta:', {
                distance: leg.distance?.text,
                duration: leg.duration?.text,
                steps: leg.steps.length
            });
        } catch (error) {
            console.error('❌ Error calculating route:', error);
            _sonner.toast.error('Error al calcular la ruta GPS');
        }
    };
    const startNavigation = ()=>{
        if (!navigator.geolocation) {
            _sonner.toast.error('Geolocalización no disponible');
            return;
        }
        setIsNavigating(true);
        const id = navigator.geolocation.watchPosition((position)=>{
            const location = {
                lat: position.coords.latitude,
                lng: position.coords.longitude
            };
            setCurrentLocation(location);
            if (onNavigationUpdate) {
                onNavigationUpdate(location);
            }
            // Verificar si llegamos cerca del destino actual
            const currentStop = stops.find((stop)=>stop.status === 'current' || stop.status === 'pending' && stop.sequence === currentStopIndex + 1);
            if (currentStop && currentStop.coordinates) {
                const distance = calculateDistance(location, currentStop.coordinates);
                if (distance < 0.1) {
                    // 100 metros
                    _sonner.toast.success(`Has llegado a ${currentStop.address}`);
                }
            }
        }, (error)=>{
            console.error('Error watching location:', error);
            _sonner.toast.error('Error al seguir la ubicación');
        }, {
            enableHighAccuracy: true,
            timeout: 10000,
            maximumAge: 60000
        });
        setWatchId(id);
        _sonner.toast.success('Navegación iniciada');
    };
    const stopNavigation = ()=>{
        if (watchId) {
            navigator.geolocation.clearWatch(watchId);
            setWatchId(null);
        }
        setIsNavigating(false);
        _sonner.toast.info('Navegación detenida');
    };
    const handleCompleteDelivery = async (stop)=>{
        try {
            const response = await fetch('/api/driver/complete-delivery', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    orderId: stop.orderId,
                    deliveryLocation: currentLocation,
                    deliveryTime: new Date().toISOString(),
                    deliveryNotes: `Entregado en ${stop.address}`
                })
            });
            if (!response.ok) {
                throw new Error('Error al completar la entrega');
            }
            const result = await response.json();
            if (result.success) {
                _sonner.toast.success(`Entrega completada: ${stop.orderNumber}`);
                onCompleteDelivery(stop.orderId);
                setCurrentStopIndex((prev)=>prev + 1);
                setSelectedStop(null);
            } else {
                throw new Error(result.error || 'Error desconocido');
            }
        } catch (error) {
            console.error('Error completing delivery:', error);
            _sonner.toast.error('Error al completar la entrega');
        }
    };
    const calculateDistance = (pos1, pos2)=>{
        const R = 6371 // Radio de la Tierra en km
        ;
        const dLat = (pos2.lat - pos1.lat) * Math.PI / 180;
        const dLon = (pos2.lng - pos1.lng) * Math.PI / 180;
        const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(pos1.lat * Math.PI / 180) * Math.cos(pos2.lat * Math.PI / 180) * Math.sin(dLon / 2) * Math.sin(dLon / 2);
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
        return R * c;
    };
    const formatCurrency = (amount)=>{
        return new Intl.NumberFormat('es-AR', {
            style: 'currency',
            currency: 'ARS'
        }).format(amount);
    };
    return /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
        className: "space-y-4",
        children: [
            /*#__PURE__*/ (0, _jsxruntime.jsxs)(_card.Card, {
                children: [
                    /*#__PURE__*/ (0, _jsxruntime.jsx)(_card.CardHeader, {
                        children: /*#__PURE__*/ (0, _jsxruntime.jsxs)(_card.CardTitle, {
                            className: "flex items-center justify-between",
                            children: [
                                /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                    className: "flex items-center gap-2",
                                    children: [
                                        /*#__PURE__*/ (0, _jsxruntime.jsx)(_lucidereact.Navigation, {
                                            className: "h-5 w-5"
                                        }),
                                        /*#__PURE__*/ (0, _jsxruntime.jsxs)("span", {
                                            className: "font-medium",
                                            children: [
                                                selectedOrders.size,
                                                " de ",
                                                orders.length,
                                                " \xf3rdenes seleccionadas"
                                            ]
                                        })
                                    ]
                                }),
                                /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                    className: "flex gap-2",
                                    children: !isNavigating ? /*#__PURE__*/ (0, _jsxruntime.jsx)(_button.Button, {
                                        onClick: startNavigation,
                                        size: "sm",
                                        children: "Iniciar Navegaci\xf3n"
                                    }) : /*#__PURE__*/ (0, _jsxruntime.jsx)(_button.Button, {
                                        onClick: stopNavigation,
                                        variant: "outline",
                                        size: "sm",
                                        children: "Detener"
                                    })
                                })
                            ]
                        })
                    }),
                    /*#__PURE__*/ (0, _jsxruntime.jsx)(_card.CardContent, {
                        children: /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                            className: "flex items-center justify-between text-sm",
                            children: [
                                /*#__PURE__*/ (0, _jsxruntime.jsxs)("span", {
                                    children: [
                                        "Paradas restantes: ",
                                        stops.filter((s)=>s.status === 'pending').length
                                    ]
                                }),
                                /*#__PURE__*/ (0, _jsxruntime.jsxs)("span", {
                                    children: [
                                        "Completadas: ",
                                        stops.filter((s)=>s.status === 'completed').length
                                    ]
                                })
                            ]
                        })
                    })
                ]
            }),
            /*#__PURE__*/ (0, _jsxruntime.jsx)(_card.Card, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_card.CardContent, {
                    className: "p-0",
                    children: /*#__PURE__*/ (0, _jsxruntime.jsxs)(_api.GoogleMap, {
                        mapContainerStyle: mapContainerStyle,
                        center: currentLocation || defaultCenter,
                        zoom: 13,
                        onLoad: (map)=>{
                            mapRef.current = map;
                        },
                        children: [
                            directions && /*#__PURE__*/ (0, _jsxruntime.jsx)(_api.DirectionsRenderer, {
                                directions: directions,
                                options: {
                                    suppressMarkers: false,
                                    polylineOptions: {
                                        strokeColor: '#2563eb',
                                        strokeWeight: 4
                                    }
                                }
                            }),
                            currentLocation && window.google && window.google.maps && /*#__PURE__*/ (0, _jsxruntime.jsx)(_api.Marker, {
                                position: currentLocation,
                                icon: {
                                    url: '/icons/current-location.png',
                                    scaledSize: new google.maps.Size(30, 30)
                                },
                                title: "Tu ubicaci\xf3n"
                            }),
                            window.google && window.google.maps && stops.map((stop)=>/*#__PURE__*/ (0, _jsxruntime.jsx)(_api.Marker, {
                                    position: stop.coordinates || {
                                        lat: 0,
                                        lng: 0
                                    },
                                    onClick: ()=>setSelectedStop(stop),
                                    icon: {
                                        url: stop.status === 'completed' ? '/icons/marker-green.png' : stop.status === 'current' ? '/icons/marker-blue.png' : '/icons/marker-red.png',
                                        scaledSize: new google.maps.Size(25, 25)
                                    },
                                    title: `${stop.orderNumber} - ${stop.address}`
                                }, stop.orderId)),
                            selectedStop && selectedStop.coordinates && /*#__PURE__*/ (0, _jsxruntime.jsx)(_api.InfoWindow, {
                                position: selectedStop.coordinates,
                                onCloseClick: ()=>setSelectedStop(null),
                                children: /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                    className: "p-2 max-w-xs",
                                    children: [
                                        /*#__PURE__*/ (0, _jsxruntime.jsx)("h3", {
                                            className: "font-semibold",
                                            children: selectedStop.orderNumber
                                        }),
                                        /*#__PURE__*/ (0, _jsxruntime.jsx)("p", {
                                            className: "text-sm text-gray-600",
                                            children: selectedStop.address
                                        }),
                                        /*#__PURE__*/ (0, _jsxruntime.jsxs)("p", {
                                            className: "text-sm",
                                            children: [
                                                "Total: ",
                                                formatCurrency(selectedStop.total)
                                            ]
                                        }),
                                        /*#__PURE__*/ (0, _jsxruntime.jsxs)("p", {
                                            className: "text-sm",
                                            children: [
                                                "Items: ",
                                                selectedStop.items
                                            ]
                                        }),
                                        selectedStop.status === 'pending' && /*#__PURE__*/ (0, _jsxruntime.jsxs)(_button.Button, {
                                            size: "sm",
                                            className: "mt-2 w-full",
                                            onClick: ()=>handleCompleteDelivery(selectedStop),
                                            children: [
                                                /*#__PURE__*/ (0, _jsxruntime.jsx)(_lucidereact.CheckCircle, {
                                                    className: "h-4 w-4 mr-1"
                                                }),
                                                "Completar Entrega"
                                            ]
                                        })
                                    ]
                                })
                            })
                        ]
                    })
                })
            }),
            /*#__PURE__*/ (0, _jsxruntime.jsxs)(_card.Card, {
                children: [
                    /*#__PURE__*/ (0, _jsxruntime.jsx)(_card.CardHeader, {
                        children: /*#__PURE__*/ (0, _jsxruntime.jsxs)(_card.CardTitle, {
                            className: "flex items-center gap-2",
                            children: [
                                /*#__PURE__*/ (0, _jsxruntime.jsx)(_lucidereact.Navigation, {
                                    className: "h-5 w-5"
                                }),
                                "Paradas del Recorrido"
                            ]
                        })
                    }),
                    /*#__PURE__*/ (0, _jsxruntime.jsx)(_card.CardContent, {
                        children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                            className: "space-y-3",
                            children: stops.map((stop, index)=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                    className: `p-3 rounded-lg border ${stop.status === 'completed' ? 'bg-green-50 border-green-200' : stop.status === 'current' ? 'bg-blue-50 border-blue-200' : 'bg-gray-50 border-gray-200'}`,
                                    children: /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                        className: "flex items-center justify-between",
                                        children: [
                                            /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                                className: "flex items-center gap-3",
                                                children: [
                                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                                        className: `w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${stop.status === 'completed' ? 'bg-green-500 text-white' : stop.status === 'current' ? 'bg-blue-500 text-white' : 'bg-gray-300 text-gray-700'}`,
                                                        children: stop.sequence
                                                    }),
                                                    /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                                        children: [
                                                            /*#__PURE__*/ (0, _jsxruntime.jsx)("p", {
                                                                className: "font-medium",
                                                                children: stop.orderNumber
                                                            }),
                                                            /*#__PURE__*/ (0, _jsxruntime.jsx)("p", {
                                                                className: "text-sm text-gray-600",
                                                                children: stop.address
                                                            }),
                                                            /*#__PURE__*/ (0, _jsxruntime.jsxs)("p", {
                                                                className: "text-sm",
                                                                children: [
                                                                    formatCurrency(stop.total),
                                                                    " • ",
                                                                    stop.items,
                                                                    " items"
                                                                ]
                                                            })
                                                        ]
                                                    })
                                                ]
                                            }),
                                            /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                                className: "flex items-center gap-2",
                                                children: [
                                                    /*#__PURE__*/ (0, _jsxruntime.jsx)(_badge.Badge, {
                                                        variant: stop.status === 'completed' ? 'default' : stop.status === 'current' ? 'secondary' : 'outline',
                                                        children: stop.status === 'completed' ? 'Completada' : stop.status === 'current' ? 'Actual' : 'Pendiente'
                                                    }),
                                                    stop.status === 'pending' && /*#__PURE__*/ (0, _jsxruntime.jsx)(_button.Button, {
                                                        size: "sm",
                                                        variant: "outline",
                                                        onClick: ()=>handleCompleteDelivery(stop),
                                                        children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_lucidereact.CheckCircle, {
                                                            className: "h-4 w-4"
                                                        })
                                                    })
                                                ]
                                            })
                                        ]
                                    })
                                }, stop.orderId))
                        })
                    })
                ]
            })
        ]
    });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcY29tcG9uZW50c1xcZHJpdmVyXFxMaXZlTmF2aWdhdGlvbk1hcC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb21wb25lbnRlIGRlIG5hdmVnYWNpw7NuIEdQUyBlbiB0aWVtcG8gcmVhbCBwYXJhIGRyaXZlcnNcbiAqL1xuXG4ndXNlIGNsaWVudCdcblxuaW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QsIHVzZVJlZiB9IGZyb20gJ3JlYWN0J1xuaW1wb3J0IHsgR29vZ2xlTWFwLCBEaXJlY3Rpb25zUmVuZGVyZXIsIE1hcmtlciwgSW5mb1dpbmRvdyB9IGZyb20gJ0ByZWFjdC1nb29nbGUtbWFwcy9hcGknXG5pbXBvcnQgeyBDYXJkLCBDYXJkQ29udGVudCwgQ2FyZEhlYWRlciwgQ2FyZFRpdGxlIH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2NhcmQnXG5pbXBvcnQgeyBCdXR0b24gfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvYnV0dG9uJ1xuaW1wb3J0IHsgQmFkZ2UgfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvYmFkZ2UnXG5pbXBvcnQgeyBOYXZpZ2F0aW9uLCBNYXBQaW4sIENoZWNrQ2lyY2xlLCBDbG9jaywgQWxlcnRUcmlhbmdsZSwgUGhvbmUsIFBhY2thZ2UgfSBmcm9tICdsdWNpZGUtcmVhY3QnXG5pbXBvcnQgeyB0b2FzdCB9IGZyb20gJ3Nvbm5lcidcblxuaW50ZXJmYWNlIERlbGl2ZXJ5U3RvcCB7XG4gIG9yZGVySWQ6IG51bWJlclxuICBvcmRlck51bWJlcjogc3RyaW5nXG4gIGFkZHJlc3M6IHN0cmluZ1xuICBjb29yZGluYXRlcz86IHtcbiAgICBsYXQ6IG51bWJlclxuICAgIGxuZzogbnVtYmVyXG4gIH1cbiAgc2VxdWVuY2U6IG51bWJlclxuICBzdGF0dXM6ICdwZW5kaW5nJyB8ICdjdXJyZW50JyB8ICdjb21wbGV0ZWQnXG4gIGVzdGltYXRlZEFycml2YWw/OiBzdHJpbmdcbiAgdG90YWw6IG51bWJlclxuICBpdGVtczogbnVtYmVyXG4gIG5vdGVzPzogc3RyaW5nXG59XG5cbmludGVyZmFjZSBMaXZlTmF2aWdhdGlvbk1hcFByb3BzIHtcbiAgc3RvcHM6IERlbGl2ZXJ5U3RvcFtdXG4gIG9uQ29tcGxldGVEZWxpdmVyeTogKG9yZGVySWQ6IG51bWJlcikgPT4gdm9pZFxuICBvbk5hdmlnYXRpb25VcGRhdGU/OiAoY3VycmVudExvY2F0aW9uOiB7IGxhdDogbnVtYmVyOyBsbmc6IG51bWJlciB9KSA9PiB2b2lkXG59XG5cbmNvbnN0IG1hcENvbnRhaW5lclN0eWxlID0ge1xuICB3aWR0aDogJzEwMCUnLFxuICBoZWlnaHQ6ICc0MDBweCcsXG59XG5cbmNvbnN0IGRlZmF1bHRDZW50ZXIgPSB7XG4gIGxhdDogLTMxLjQyMDEsXG4gIGxuZzogLTY0LjE4ODgsXG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIExpdmVOYXZpZ2F0aW9uTWFwKHtcbiAgc3RvcHMsXG4gIG9uQ29tcGxldGVEZWxpdmVyeSxcbiAgb25OYXZpZ2F0aW9uVXBkYXRlLFxufTogTGl2ZU5hdmlnYXRpb25NYXBQcm9wcykge1xuICBjb25zdCBbY3VycmVudExvY2F0aW9uLCBzZXRDdXJyZW50TG9jYXRpb25dID0gdXNlU3RhdGU8eyBsYXQ6IG51bWJlcjsgbG5nOiBudW1iZXIgfSB8IG51bGw+KG51bGwpXG4gIGNvbnN0IFtkaXJlY3Rpb25zLCBzZXREaXJlY3Rpb25zXSA9IHVzZVN0YXRlPGdvb2dsZS5tYXBzLkRpcmVjdGlvbnNSZXN1bHQgfCBudWxsPihudWxsKVxuICBjb25zdCBbY3VycmVudFN0b3BJbmRleCwgc2V0Q3VycmVudFN0b3BJbmRleF0gPSB1c2VTdGF0ZSgwKVxuICBjb25zdCBbc2VsZWN0ZWRTdG9wLCBzZXRTZWxlY3RlZFN0b3BdID0gdXNlU3RhdGU8RGVsaXZlcnlTdG9wIHwgbnVsbD4obnVsbClcbiAgY29uc3QgW2lzTmF2aWdhdGluZywgc2V0SXNOYXZpZ2F0aW5nXSA9IHVzZVN0YXRlKGZhbHNlKVxuICBjb25zdCBbd2F0Y2hJZCwgc2V0V2F0Y2hJZF0gPSB1c2VTdGF0ZTxudW1iZXIgfCBudWxsPihudWxsKVxuICBjb25zdCBbaXNHb29nbGVNYXBzTG9hZGVkLCBzZXRJc0dvb2dsZU1hcHNMb2FkZWRdID0gdXNlU3RhdGUoZmFsc2UpXG4gIGNvbnN0IG1hcFJlZiA9IHVzZVJlZjxnb29nbGUubWFwcy5NYXAgfCBudWxsPihudWxsKVxuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgLy8gVmVyaWZpY2FyIHNpIEdvb2dsZSBNYXBzIGVzdMOhIGNhcmdhZG9cbiAgICBjb25zdCBjaGVja0dvb2dsZU1hcHMgPSAoKSA9PiB7XG4gICAgICBpZiAod2luZG93Lmdvb2dsZSAmJiB3aW5kb3cuZ29vZ2xlLm1hcHMpIHtcbiAgICAgICAgc2V0SXNHb29nbGVNYXBzTG9hZGVkKHRydWUpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZXRUaW1lb3V0KGNoZWNrR29vZ2xlTWFwcywgMTAwKVxuICAgICAgfVxuICAgIH1cbiAgICBjaGVja0dvb2dsZU1hcHMoKVxuICB9LCBbXSlcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIC8vIFNvbGljaXRhciB1YmljYWNpw7NuIGFjdHVhbFxuICAgIGlmIChuYXZpZ2F0b3IuZ2VvbG9jYXRpb24pIHtcbiAgICAgIG5hdmlnYXRvci5nZW9sb2NhdGlvbi5nZXRDdXJyZW50UG9zaXRpb24oXG4gICAgICAgIHBvc2l0aW9uID0+IHtcbiAgICAgICAgICBjb25zdCBsb2NhdGlvbiA9IHtcbiAgICAgICAgICAgIGxhdDogcG9zaXRpb24uY29vcmRzLmxhdGl0dWRlLFxuICAgICAgICAgICAgbG5nOiBwb3NpdGlvbi5jb29yZHMubG9uZ2l0dWRlLFxuICAgICAgICAgIH1cbiAgICAgICAgICBzZXRDdXJyZW50TG9jYXRpb24obG9jYXRpb24pXG4gICAgICAgICAgaWYgKG9uTmF2aWdhdGlvblVwZGF0ZSkge1xuICAgICAgICAgICAgb25OYXZpZ2F0aW9uVXBkYXRlKGxvY2F0aW9uKVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3IgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgbG9jYXRpb246JywgZXJyb3IpXG4gICAgICAgICAgdG9hc3QuZXJyb3IoJ05vIHNlIHB1ZG8gb2J0ZW5lciBsYSB1YmljYWNpw7NuIGFjdHVhbCcpXG4gICAgICAgICAgLy8gVXNhciB1YmljYWNpw7NuIHBvciBkZWZlY3RvIChDw7NyZG9iYSlcbiAgICAgICAgICBzZXRDdXJyZW50TG9jYXRpb24oZGVmYXVsdENlbnRlcilcbiAgICAgICAgfVxuICAgICAgKVxuICAgIH1cbiAgfSwgW29uTmF2aWdhdGlvblVwZGF0ZV0pXG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoY3VycmVudExvY2F0aW9uICYmIHN0b3BzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNhbGN1bGF0ZVJvdXRlKClcbiAgICB9XG4gIH0sIFtjdXJyZW50TG9jYXRpb24sIHN0b3BzLCBjdXJyZW50U3RvcEluZGV4XSlcblxuICBjb25zdCBjYWxjdWxhdGVSb3V0ZSA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoIWN1cnJlbnRMb2NhdGlvbiB8fCAhd2luZG93Lmdvb2dsZSB8fCAhd2luZG93Lmdvb2dsZS5tYXBzKSByZXR1cm5cblxuICAgIGNvbnN0IGRpcmVjdGlvbnNTZXJ2aWNlID0gbmV3IGdvb2dsZS5tYXBzLkRpcmVjdGlvbnNTZXJ2aWNlKClcbiAgICBjb25zdCBjdXJyZW50U3RvcCA9IHN0b3BzLmZpbmQoc3RvcCA9PiBzdG9wLnN0YXR1cyA9PT0gJ2N1cnJlbnQnKVxuXG4gICAgaWYgKCFjdXJyZW50U3RvcCB8fCAhY3VycmVudFN0b3AuY29vcmRpbmF0ZXMpIHtcbiAgICAgIHNldERpcmVjdGlvbnMobnVsbClcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKCfwn5e677iPIENhbGN1bGFuZG8gcnV0YSBHUFMgZGVzZGU6JywgY3VycmVudExvY2F0aW9uLCAnaGFjaWE6JywgY3VycmVudFN0b3AuY29vcmRpbmF0ZXMpXG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGlyZWN0aW9uc1NlcnZpY2Uucm91dGUoe1xuICAgICAgICBvcmlnaW46IGN1cnJlbnRMb2NhdGlvbixcbiAgICAgICAgZGVzdGluYXRpb246IGN1cnJlbnRTdG9wLmNvb3JkaW5hdGVzLFxuICAgICAgICB0cmF2ZWxNb2RlOiBnb29nbGUubWFwcy5UcmF2ZWxNb2RlLkRSSVZJTkcsXG4gICAgICAgIG9wdGltaXplV2F5cG9pbnRzOiBmYWxzZSxcbiAgICAgICAgYXZvaWRIaWdod2F5czogZmFsc2UsXG4gICAgICAgIGF2b2lkVG9sbHM6IGZhbHNlLFxuICAgICAgICB1bml0U3lzdGVtOiBnb29nbGUubWFwcy5Vbml0U3lzdGVtLk1FVFJJQyxcbiAgICAgICAgbGFuZ3VhZ2U6ICdlcycsXG4gICAgICAgIHJlZ2lvbjogJ0FSJyxcbiAgICAgIH0pXG5cbiAgICAgIGNvbnNvbGUubG9nKCfinIUgUnV0YSBHUFMgY2FsY3VsYWRhIGV4aXRvc2FtZW50ZTonLCByZXN1bHQpXG4gICAgICBzZXREaXJlY3Rpb25zKHJlc3VsdClcblxuICAgICAgLy8gRXh0cmFlciBpbmZvcm1hY2nDs24gZGUgbmF2ZWdhY2nDs25cbiAgICAgIGNvbnN0IHJvdXRlID0gcmVzdWx0LnJvdXRlc1swXVxuICAgICAgY29uc3QgbGVnID0gcm91dGUubGVnc1swXVxuXG4gICAgICBjb25zb2xlLmxvZygn8J+TiiBJbmZvcm1hY2nDs24gZGUgcnV0YTonLCB7XG4gICAgICAgIGRpc3RhbmNlOiBsZWcuZGlzdGFuY2U/LnRleHQsXG4gICAgICAgIGR1cmF0aW9uOiBsZWcuZHVyYXRpb24/LnRleHQsXG4gICAgICAgIHN0ZXBzOiBsZWcuc3RlcHMubGVuZ3RoLFxuICAgICAgfSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIGNhbGN1bGF0aW5nIHJvdXRlOicsIGVycm9yKVxuICAgICAgdG9hc3QuZXJyb3IoJ0Vycm9yIGFsIGNhbGN1bGFyIGxhIHJ1dGEgR1BTJylcbiAgICB9XG4gIH1cbiAgY29uc3Qgc3RhcnROYXZpZ2F0aW9uID0gKCkgPT4ge1xuICAgIGlmICghbmF2aWdhdG9yLmdlb2xvY2F0aW9uKSB7XG4gICAgICB0b2FzdC5lcnJvcignR2VvbG9jYWxpemFjacOzbiBubyBkaXNwb25pYmxlJylcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIHNldElzTmF2aWdhdGluZyh0cnVlKVxuXG4gICAgY29uc3QgaWQgPSBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24ud2F0Y2hQb3NpdGlvbihcbiAgICAgIHBvc2l0aW9uID0+IHtcbiAgICAgICAgY29uc3QgbG9jYXRpb24gPSB7XG4gICAgICAgICAgbGF0OiBwb3NpdGlvbi5jb29yZHMubGF0aXR1ZGUsXG4gICAgICAgICAgbG5nOiBwb3NpdGlvbi5jb29yZHMubG9uZ2l0dWRlLFxuICAgICAgICB9XG4gICAgICAgIHNldEN1cnJlbnRMb2NhdGlvbihsb2NhdGlvbilcblxuICAgICAgICBpZiAob25OYXZpZ2F0aW9uVXBkYXRlKSB7XG4gICAgICAgICAgb25OYXZpZ2F0aW9uVXBkYXRlKGxvY2F0aW9uKVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gVmVyaWZpY2FyIHNpIGxsZWdhbW9zIGNlcmNhIGRlbCBkZXN0aW5vIGFjdHVhbFxuICAgICAgICBjb25zdCBjdXJyZW50U3RvcCA9IHN0b3BzLmZpbmQoXG4gICAgICAgICAgc3RvcCA9PlxuICAgICAgICAgICAgc3RvcC5zdGF0dXMgPT09ICdjdXJyZW50JyB8fFxuICAgICAgICAgICAgKHN0b3Auc3RhdHVzID09PSAncGVuZGluZycgJiYgc3RvcC5zZXF1ZW5jZSA9PT0gY3VycmVudFN0b3BJbmRleCArIDEpXG4gICAgICAgIClcblxuICAgICAgICBpZiAoY3VycmVudFN0b3AgJiYgY3VycmVudFN0b3AuY29vcmRpbmF0ZXMpIHtcbiAgICAgICAgICBjb25zdCBkaXN0YW5jZSA9IGNhbGN1bGF0ZURpc3RhbmNlKGxvY2F0aW9uLCBjdXJyZW50U3RvcC5jb29yZGluYXRlcylcbiAgICAgICAgICBpZiAoZGlzdGFuY2UgPCAwLjEpIHtcbiAgICAgICAgICAgIC8vIDEwMCBtZXRyb3NcbiAgICAgICAgICAgIHRvYXN0LnN1Y2Nlc3MoYEhhcyBsbGVnYWRvIGEgJHtjdXJyZW50U3RvcC5hZGRyZXNzfWApXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZXJyb3IgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB3YXRjaGluZyBsb2NhdGlvbjonLCBlcnJvcilcbiAgICAgICAgdG9hc3QuZXJyb3IoJ0Vycm9yIGFsIHNlZ3VpciBsYSB1YmljYWNpw7NuJylcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGVuYWJsZUhpZ2hBY2N1cmFjeTogdHJ1ZSxcbiAgICAgICAgdGltZW91dDogMTAwMDAsXG4gICAgICAgIG1heGltdW1BZ2U6IDYwMDAwLFxuICAgICAgfVxuICAgIClcblxuICAgIHNldFdhdGNoSWQoaWQpXG4gICAgdG9hc3Quc3VjY2VzcygnTmF2ZWdhY2nDs24gaW5pY2lhZGEnKVxuICB9XG5cbiAgY29uc3Qgc3RvcE5hdmlnYXRpb24gPSAoKSA9PiB7XG4gICAgaWYgKHdhdGNoSWQpIHtcbiAgICAgIG5hdmlnYXRvci5nZW9sb2NhdGlvbi5jbGVhcldhdGNoKHdhdGNoSWQpXG4gICAgICBzZXRXYXRjaElkKG51bGwpXG4gICAgfVxuICAgIHNldElzTmF2aWdhdGluZyhmYWxzZSlcbiAgICB0b2FzdC5pbmZvKCdOYXZlZ2FjacOzbiBkZXRlbmlkYScpXG4gIH1cblxuICBjb25zdCBoYW5kbGVDb21wbGV0ZURlbGl2ZXJ5ID0gYXN5bmMgKHN0b3A6IERlbGl2ZXJ5U3RvcCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCcvYXBpL2RyaXZlci9jb21wbGV0ZS1kZWxpdmVyeScsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgb3JkZXJJZDogc3RvcC5vcmRlcklkLFxuICAgICAgICAgIGRlbGl2ZXJ5TG9jYXRpb246IGN1cnJlbnRMb2NhdGlvbixcbiAgICAgICAgICBkZWxpdmVyeVRpbWU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICBkZWxpdmVyeU5vdGVzOiBgRW50cmVnYWRvIGVuICR7c3RvcC5hZGRyZXNzfWAsXG4gICAgICAgIH0pLFxuICAgICAgfSlcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Vycm9yIGFsIGNvbXBsZXRhciBsYSBlbnRyZWdhJylcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXG5cbiAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICB0b2FzdC5zdWNjZXNzKGBFbnRyZWdhIGNvbXBsZXRhZGE6ICR7c3RvcC5vcmRlck51bWJlcn1gKVxuICAgICAgICBvbkNvbXBsZXRlRGVsaXZlcnkoc3RvcC5vcmRlcklkKVxuICAgICAgICBzZXRDdXJyZW50U3RvcEluZGV4KHByZXYgPT4gcHJldiArIDEpXG4gICAgICAgIHNldFNlbGVjdGVkU3RvcChudWxsKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKHJlc3VsdC5lcnJvciB8fCAnRXJyb3IgZGVzY29ub2NpZG8nKVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjb21wbGV0aW5nIGRlbGl2ZXJ5OicsIGVycm9yKVxuICAgICAgdG9hc3QuZXJyb3IoJ0Vycm9yIGFsIGNvbXBsZXRhciBsYSBlbnRyZWdhJylcbiAgICB9XG4gIH1cblxuICBjb25zdCBjYWxjdWxhdGVEaXN0YW5jZSA9IChcbiAgICBwb3MxOiB7IGxhdDogbnVtYmVyOyBsbmc6IG51bWJlciB9LFxuICAgIHBvczI6IHsgbGF0OiBudW1iZXI7IGxuZzogbnVtYmVyIH1cbiAgKSA9PiB7XG4gICAgY29uc3QgUiA9IDYzNzEgLy8gUmFkaW8gZGUgbGEgVGllcnJhIGVuIGttXG4gICAgY29uc3QgZExhdCA9ICgocG9zMi5sYXQgLSBwb3MxLmxhdCkgKiBNYXRoLlBJKSAvIDE4MFxuICAgIGNvbnN0IGRMb24gPSAoKHBvczIubG5nIC0gcG9zMS5sbmcpICogTWF0aC5QSSkgLyAxODBcbiAgICBjb25zdCBhID1cbiAgICAgIE1hdGguc2luKGRMYXQgLyAyKSAqIE1hdGguc2luKGRMYXQgLyAyKSArXG4gICAgICBNYXRoLmNvcygocG9zMS5sYXQgKiBNYXRoLlBJKSAvIDE4MCkgKlxuICAgICAgICBNYXRoLmNvcygocG9zMi5sYXQgKiBNYXRoLlBJKSAvIDE4MCkgKlxuICAgICAgICBNYXRoLnNpbihkTG9uIC8gMikgKlxuICAgICAgICBNYXRoLnNpbihkTG9uIC8gMilcbiAgICBjb25zdCBjID0gMiAqIE1hdGguYXRhbjIoTWF0aC5zcXJ0KGEpLCBNYXRoLnNxcnQoMSAtIGEpKVxuICAgIHJldHVybiBSICogY1xuICB9XG5cbiAgY29uc3QgZm9ybWF0Q3VycmVuY3kgPSAoYW1vdW50OiBudW1iZXIpID0+IHtcbiAgICByZXR1cm4gbmV3IEludGwuTnVtYmVyRm9ybWF0KCdlcy1BUicsIHtcbiAgICAgIHN0eWxlOiAnY3VycmVuY3knLFxuICAgICAgY3VycmVuY3k6ICdBUlMnLFxuICAgIH0pLmZvcm1hdChhbW91bnQpXG4gIH1cblxuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPSdzcGFjZS15LTQnPlxuICAgICAgey8qIENvbnRyb2xlcyBkZSBuYXZlZ2FjacOzbiAqL31cbiAgICAgIDxDYXJkPlxuICAgICAgICA8Q2FyZEhlYWRlcj5cbiAgICAgICAgICA8Q2FyZFRpdGxlIGNsYXNzTmFtZT0nZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuJz5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMic+XG4gICAgICAgICAgICAgIDxOYXZpZ2F0aW9uIGNsYXNzTmFtZT0naC01IHctNScgLz5cbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSdmb250LW1lZGl1bSc+XG4gICAgICAgICAgICAgICAge3NlbGVjdGVkT3JkZXJzLnNpemV9IGRlIHtvcmRlcnMubGVuZ3RofSDDs3JkZW5lcyBzZWxlY2Npb25hZGFzXG4gICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2ZsZXggZ2FwLTInPlxuICAgICAgICAgICAgICB7IWlzTmF2aWdhdGluZyA/IChcbiAgICAgICAgICAgICAgICA8QnV0dG9uIG9uQ2xpY2s9e3N0YXJ0TmF2aWdhdGlvbn0gc2l6ZT0nc20nPlxuICAgICAgICAgICAgICAgICAgSW5pY2lhciBOYXZlZ2FjacOzblxuICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgIDxCdXR0b24gb25DbGljaz17c3RvcE5hdmlnYXRpb259IHZhcmlhbnQ9J291dGxpbmUnIHNpemU9J3NtJz5cbiAgICAgICAgICAgICAgICAgIERldGVuZXJcbiAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvQ2FyZFRpdGxlPlxuICAgICAgICA8L0NhcmRIZWFkZXI+XG4gICAgICAgIDxDYXJkQ29udGVudD5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIHRleHQtc20nPlxuICAgICAgICAgICAgPHNwYW4+UGFyYWRhcyByZXN0YW50ZXM6IHtzdG9wcy5maWx0ZXIocyA9PiBzLnN0YXR1cyA9PT0gJ3BlbmRpbmcnKS5sZW5ndGh9PC9zcGFuPlxuICAgICAgICAgICAgPHNwYW4+Q29tcGxldGFkYXM6IHtzdG9wcy5maWx0ZXIocyA9PiBzLnN0YXR1cyA9PT0gJ2NvbXBsZXRlZCcpLmxlbmd0aH08L3NwYW4+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvQ2FyZENvbnRlbnQ+XG4gICAgICA8L0NhcmQ+XG5cbiAgICAgIHsvKiBNYXBhICovfVxuICAgICAgPENhcmQ+XG4gICAgICAgIDxDYXJkQ29udGVudCBjbGFzc05hbWU9J3AtMCc+XG4gICAgICAgICAgPEdvb2dsZU1hcFxuICAgICAgICAgICAgbWFwQ29udGFpbmVyU3R5bGU9e21hcENvbnRhaW5lclN0eWxlfVxuICAgICAgICAgICAgY2VudGVyPXtjdXJyZW50TG9jYXRpb24gfHwgZGVmYXVsdENlbnRlcn1cbiAgICAgICAgICAgIHpvb209ezEzfVxuICAgICAgICAgICAgb25Mb2FkPXttYXAgPT4ge1xuICAgICAgICAgICAgICBtYXBSZWYuY3VycmVudCA9IG1hcFxuICAgICAgICAgICAgfX1cbiAgICAgICAgICA+XG4gICAgICAgICAgICB7LyogTW9zdHJhciBydXRhICovfVxuICAgICAgICAgICAge2RpcmVjdGlvbnMgJiYgKFxuICAgICAgICAgICAgICA8RGlyZWN0aW9uc1JlbmRlcmVyXG4gICAgICAgICAgICAgICAgZGlyZWN0aW9ucz17ZGlyZWN0aW9uc31cbiAgICAgICAgICAgICAgICBvcHRpb25zPXt7XG4gICAgICAgICAgICAgICAgICBzdXBwcmVzc01hcmtlcnM6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgcG9seWxpbmVPcHRpb25zOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0cm9rZUNvbG9yOiAnIzI1NjNlYicsXG4gICAgICAgICAgICAgICAgICAgIHN0cm9rZVdlaWdodDogNCxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICl9XG5cbiAgICAgICAgICAgIHsvKiBNYXJjYWRvciBkZSB1YmljYWNpw7NuIGFjdHVhbCAqL31cbiAgICAgICAgICAgIHtjdXJyZW50TG9jYXRpb24gJiYgd2luZG93Lmdvb2dsZSAmJiB3aW5kb3cuZ29vZ2xlLm1hcHMgJiYgKFxuICAgICAgICAgICAgICA8TWFya2VyXG4gICAgICAgICAgICAgICAgcG9zaXRpb249e2N1cnJlbnRMb2NhdGlvbn1cbiAgICAgICAgICAgICAgICBpY29uPXt7XG4gICAgICAgICAgICAgICAgICB1cmw6ICcvaWNvbnMvY3VycmVudC1sb2NhdGlvbi5wbmcnLFxuICAgICAgICAgICAgICAgICAgc2NhbGVkU2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoMzAsIDMwKSxcbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgIHRpdGxlPSdUdSB1YmljYWNpw7NuJ1xuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKX1cblxuICAgICAgICAgICAgey8qIE1hcmNhZG9yZXMgZGUgcGFyYWRhcyAqL31cbiAgICAgICAgICAgIHt3aW5kb3cuZ29vZ2xlICYmXG4gICAgICAgICAgICAgIHdpbmRvdy5nb29nbGUubWFwcyAmJlxuICAgICAgICAgICAgICBzdG9wcy5tYXAoc3RvcCA9PiAoXG4gICAgICAgICAgICAgICAgPE1hcmtlclxuICAgICAgICAgICAgICAgICAga2V5PXtzdG9wLm9yZGVySWR9XG4gICAgICAgICAgICAgICAgICBwb3NpdGlvbj17c3RvcC5jb29yZGluYXRlcyB8fCB7IGxhdDogMCwgbG5nOiAwIH19XG4gICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBzZXRTZWxlY3RlZFN0b3Aoc3RvcCl9XG4gICAgICAgICAgICAgICAgICBpY29uPXt7XG4gICAgICAgICAgICAgICAgICAgIHVybDpcbiAgICAgICAgICAgICAgICAgICAgICBzdG9wLnN0YXR1cyA9PT0gJ2NvbXBsZXRlZCdcbiAgICAgICAgICAgICAgICAgICAgICAgID8gJy9pY29ucy9tYXJrZXItZ3JlZW4ucG5nJ1xuICAgICAgICAgICAgICAgICAgICAgICAgOiBzdG9wLnN0YXR1cyA9PT0gJ2N1cnJlbnQnXG4gICAgICAgICAgICAgICAgICAgICAgICAgID8gJy9pY29ucy9tYXJrZXItYmx1ZS5wbmcnXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDogJy9pY29ucy9tYXJrZXItcmVkLnBuZycsXG4gICAgICAgICAgICAgICAgICAgIHNjYWxlZFNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDI1LCAyNSksXG4gICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgdGl0bGU9e2Ake3N0b3Aub3JkZXJOdW1iZXJ9IC0gJHtzdG9wLmFkZHJlc3N9YH1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICApKX1cblxuICAgICAgICAgICAgey8qIEluZm8gd2luZG93IHBhcmEgcGFyYWRhIHNlbGVjY2lvbmFkYSAqL31cbiAgICAgICAgICAgIHtzZWxlY3RlZFN0b3AgJiYgc2VsZWN0ZWRTdG9wLmNvb3JkaW5hdGVzICYmIChcbiAgICAgICAgICAgICAgPEluZm9XaW5kb3dcbiAgICAgICAgICAgICAgICBwb3NpdGlvbj17c2VsZWN0ZWRTdG9wLmNvb3JkaW5hdGVzfVxuICAgICAgICAgICAgICAgIG9uQ2xvc2VDbGljaz17KCkgPT4gc2V0U2VsZWN0ZWRTdG9wKG51bGwpfVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3AtMiBtYXgtdy14cyc+XG4gICAgICAgICAgICAgICAgICA8aDMgY2xhc3NOYW1lPSdmb250LXNlbWlib2xkJz57c2VsZWN0ZWRTdG9wLm9yZGVyTnVtYmVyfTwvaDM+XG4gICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9J3RleHQtc20gdGV4dC1ncmF5LTYwMCc+e3NlbGVjdGVkU3RvcC5hZGRyZXNzfTwvcD5cbiAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0ndGV4dC1zbSc+VG90YWw6IHtmb3JtYXRDdXJyZW5jeShzZWxlY3RlZFN0b3AudG90YWwpfTwvcD5cbiAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0ndGV4dC1zbSc+SXRlbXM6IHtzZWxlY3RlZFN0b3AuaXRlbXN9PC9wPlxuICAgICAgICAgICAgICAgICAge3NlbGVjdGVkU3RvcC5zdGF0dXMgPT09ICdwZW5kaW5nJyAmJiAoXG4gICAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICBzaXplPSdzbSdcbiAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9J210LTIgdy1mdWxsJ1xuICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGhhbmRsZUNvbXBsZXRlRGVsaXZlcnkoc2VsZWN0ZWRTdG9wKX1cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgIDxDaGVja0NpcmNsZSBjbGFzc05hbWU9J2gtNCB3LTQgbXItMScgLz5cbiAgICAgICAgICAgICAgICAgICAgICBDb21wbGV0YXIgRW50cmVnYVxuICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvSW5mb1dpbmRvdz5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgPC9Hb29nbGVNYXA+XG4gICAgICAgIDwvQ2FyZENvbnRlbnQ+XG4gICAgICA8L0NhcmQ+XG5cbiAgICAgIHsvKiBMaXN0YSBkZSBwYXJhZGFzICovfVxuICAgICAgPENhcmQ+XG4gICAgICAgIDxDYXJkSGVhZGVyPlxuICAgICAgICAgIDxDYXJkVGl0bGUgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMic+XG4gICAgICAgICAgICA8TmF2aWdhdGlvbiBjbGFzc05hbWU9J2gtNSB3LTUnIC8+XG4gICAgICAgICAgICBQYXJhZGFzIGRlbCBSZWNvcnJpZG9cbiAgICAgICAgICA8L0NhcmRUaXRsZT5cbiAgICAgICAgPC9DYXJkSGVhZGVyPlxuICAgICAgICA8Q2FyZENvbnRlbnQ+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3NwYWNlLXktMyc+XG4gICAgICAgICAgICB7c3RvcHMubWFwKChzdG9wLCBpbmRleCkgPT4gKFxuICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAga2V5PXtzdG9wLm9yZGVySWR9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgcC0zIHJvdW5kZWQtbGcgYm9yZGVyICR7XG4gICAgICAgICAgICAgICAgICBzdG9wLnN0YXR1cyA9PT0gJ2NvbXBsZXRlZCdcbiAgICAgICAgICAgICAgICAgICAgPyAnYmctZ3JlZW4tNTAgYm9yZGVyLWdyZWVuLTIwMCdcbiAgICAgICAgICAgICAgICAgICAgOiBzdG9wLnN0YXR1cyA9PT0gJ2N1cnJlbnQnXG4gICAgICAgICAgICAgICAgICAgICAgPyAnYmctYmx1ZS01MCBib3JkZXItYmx1ZS0yMDAnXG4gICAgICAgICAgICAgICAgICAgICAgOiAnYmctZ3JheS01MCBib3JkZXItZ3JheS0yMDAnXG4gICAgICAgICAgICAgICAgfWB9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuJz5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMyc+XG4gICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2B3LTggaC04IHJvdW5kZWQtZnVsbCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciB0ZXh0LXNtIGZvbnQtbWVkaXVtICR7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9wLnN0YXR1cyA9PT0gJ2NvbXBsZXRlZCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPyAnYmctZ3JlZW4tNTAwIHRleHQtd2hpdGUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDogc3RvcC5zdGF0dXMgPT09ICdjdXJyZW50J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gJ2JnLWJsdWUtNTAwIHRleHQtd2hpdGUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnYmctZ3JheS0zMDAgdGV4dC1ncmF5LTcwMCdcbiAgICAgICAgICAgICAgICAgICAgICB9YH1cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgIHtzdG9wLnNlcXVlbmNlfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9J2ZvbnQtbWVkaXVtJz57c3RvcC5vcmRlck51bWJlcn08L3A+XG4gICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSd0ZXh0LXNtIHRleHQtZ3JheS02MDAnPntzdG9wLmFkZHJlc3N9PC9wPlxuICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0ndGV4dC1zbSc+XG4gICAgICAgICAgICAgICAgICAgICAgICB7Zm9ybWF0Q3VycmVuY3koc3RvcC50b3RhbCl9IOKAoiB7c3RvcC5pdGVtc30gaXRlbXNcbiAgICAgICAgICAgICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTInPlxuICAgICAgICAgICAgICAgICAgICA8QmFkZ2VcbiAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3Auc3RhdHVzID09PSAnY29tcGxldGVkJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICA/ICdkZWZhdWx0J1xuICAgICAgICAgICAgICAgICAgICAgICAgICA6IHN0b3Auc3RhdHVzID09PSAnY3VycmVudCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/ICdzZWNvbmRhcnknXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnb3V0bGluZSdcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICB7c3RvcC5zdGF0dXMgPT09ICdjb21wbGV0ZWQnXG4gICAgICAgICAgICAgICAgICAgICAgICA/ICdDb21wbGV0YWRhJ1xuICAgICAgICAgICAgICAgICAgICAgICAgOiBzdG9wLnN0YXR1cyA9PT0gJ2N1cnJlbnQnXG4gICAgICAgICAgICAgICAgICAgICAgICAgID8gJ0FjdHVhbCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnUGVuZGllbnRlJ31cbiAgICAgICAgICAgICAgICAgICAgPC9CYWRnZT5cbiAgICAgICAgICAgICAgICAgICAge3N0b3Auc3RhdHVzID09PSAncGVuZGluZycgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9J3NtJ1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudD0nb3V0bGluZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGhhbmRsZUNvbXBsZXRlRGVsaXZlcnkoc3RvcCl9XG4gICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgPENoZWNrQ2lyY2xlIGNsYXNzTmFtZT0naC00IHctNCcgLz5cbiAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICkpfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L0NhcmRDb250ZW50PlxuICAgICAgPC9DYXJkPlxuICAgIDwvZGl2PlxuICApXG59XG4iXSwibmFtZXMiOlsiTGl2ZU5hdmlnYXRpb25NYXAiLCJtYXBDb250YWluZXJTdHlsZSIsIndpZHRoIiwiaGVpZ2h0IiwiZGVmYXVsdENlbnRlciIsImxhdCIsImxuZyIsInN0b3BzIiwib25Db21wbGV0ZURlbGl2ZXJ5Iiwib25OYXZpZ2F0aW9uVXBkYXRlIiwiY3VycmVudExvY2F0aW9uIiwic2V0Q3VycmVudExvY2F0aW9uIiwidXNlU3RhdGUiLCJkaXJlY3Rpb25zIiwic2V0RGlyZWN0aW9ucyIsImN1cnJlbnRTdG9wSW5kZXgiLCJzZXRDdXJyZW50U3RvcEluZGV4Iiwic2VsZWN0ZWRTdG9wIiwic2V0U2VsZWN0ZWRTdG9wIiwiaXNOYXZpZ2F0aW5nIiwic2V0SXNOYXZpZ2F0aW5nIiwid2F0Y2hJZCIsInNldFdhdGNoSWQiLCJpc0dvb2dsZU1hcHNMb2FkZWQiLCJzZXRJc0dvb2dsZU1hcHNMb2FkZWQiLCJtYXBSZWYiLCJ1c2VSZWYiLCJ1c2VFZmZlY3QiLCJjaGVja0dvb2dsZU1hcHMiLCJ3aW5kb3ciLCJnb29nbGUiLCJtYXBzIiwic2V0VGltZW91dCIsIm5hdmlnYXRvciIsImdlb2xvY2F0aW9uIiwiZ2V0Q3VycmVudFBvc2l0aW9uIiwicG9zaXRpb24iLCJsb2NhdGlvbiIsImNvb3JkcyIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwiZXJyb3IiLCJjb25zb2xlIiwidG9hc3QiLCJsZW5ndGgiLCJjYWxjdWxhdGVSb3V0ZSIsImRpcmVjdGlvbnNTZXJ2aWNlIiwiRGlyZWN0aW9uc1NlcnZpY2UiLCJjdXJyZW50U3RvcCIsImZpbmQiLCJzdG9wIiwic3RhdHVzIiwiY29vcmRpbmF0ZXMiLCJsb2ciLCJyZXN1bHQiLCJyb3V0ZSIsIm9yaWdpbiIsImRlc3RpbmF0aW9uIiwidHJhdmVsTW9kZSIsIlRyYXZlbE1vZGUiLCJEUklWSU5HIiwib3B0aW1pemVXYXlwb2ludHMiLCJhdm9pZEhpZ2h3YXlzIiwiYXZvaWRUb2xscyIsInVuaXRTeXN0ZW0iLCJVbml0U3lzdGVtIiwiTUVUUklDIiwibGFuZ3VhZ2UiLCJyZWdpb24iLCJyb3V0ZXMiLCJsZWciLCJsZWdzIiwiZGlzdGFuY2UiLCJ0ZXh0IiwiZHVyYXRpb24iLCJzdGVwcyIsInN0YXJ0TmF2aWdhdGlvbiIsImlkIiwid2F0Y2hQb3NpdGlvbiIsInNlcXVlbmNlIiwiY2FsY3VsYXRlRGlzdGFuY2UiLCJzdWNjZXNzIiwiYWRkcmVzcyIsImVuYWJsZUhpZ2hBY2N1cmFjeSIsInRpbWVvdXQiLCJtYXhpbXVtQWdlIiwic3RvcE5hdmlnYXRpb24iLCJjbGVhcldhdGNoIiwiaW5mbyIsImhhbmRsZUNvbXBsZXRlRGVsaXZlcnkiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5Iiwib3JkZXJJZCIsImRlbGl2ZXJ5TG9jYXRpb24iLCJkZWxpdmVyeVRpbWUiLCJEYXRlIiwidG9JU09TdHJpbmciLCJkZWxpdmVyeU5vdGVzIiwib2siLCJFcnJvciIsImpzb24iLCJvcmRlck51bWJlciIsInByZXYiLCJwb3MxIiwicG9zMiIsIlIiLCJkTGF0IiwiTWF0aCIsIlBJIiwiZExvbiIsImEiLCJzaW4iLCJjb3MiLCJjIiwiYXRhbjIiLCJzcXJ0IiwiZm9ybWF0Q3VycmVuY3kiLCJhbW91bnQiLCJJbnRsIiwiTnVtYmVyRm9ybWF0Iiwic3R5bGUiLCJjdXJyZW5jeSIsImZvcm1hdCIsImRpdiIsImNsYXNzTmFtZSIsIkNhcmQiLCJDYXJkSGVhZGVyIiwiQ2FyZFRpdGxlIiwiTmF2aWdhdGlvbiIsInNwYW4iLCJzZWxlY3RlZE9yZGVycyIsInNpemUiLCJvcmRlcnMiLCJCdXR0b24iLCJvbkNsaWNrIiwidmFyaWFudCIsIkNhcmRDb250ZW50IiwiZmlsdGVyIiwicyIsIkdvb2dsZU1hcCIsImNlbnRlciIsInpvb20iLCJvbkxvYWQiLCJtYXAiLCJjdXJyZW50IiwiRGlyZWN0aW9uc1JlbmRlcmVyIiwib3B0aW9ucyIsInN1cHByZXNzTWFya2VycyIsInBvbHlsaW5lT3B0aW9ucyIsInN0cm9rZUNvbG9yIiwic3Ryb2tlV2VpZ2h0IiwiTWFya2VyIiwiaWNvbiIsInVybCIsInNjYWxlZFNpemUiLCJTaXplIiwidGl0bGUiLCJJbmZvV2luZG93Iiwib25DbG9zZUNsaWNrIiwiaDMiLCJwIiwidG90YWwiLCJpdGVtcyIsIkNoZWNrQ2lyY2xlIiwiaW5kZXgiLCJCYWRnZSJdLCJtYXBwaW5ncyI6IkFBQUE7O0NBRUMsR0FFRDs7Ozs7K0JBMENBOzs7ZUFBd0JBOzs7OytEQXhDMkI7cUJBQ2U7c0JBQ1Q7d0JBQ2xDO3VCQUNEOzZCQUNnRTt3QkFDaEU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXdCdEIsTUFBTUMsb0JBQW9CO0lBQ3hCQyxPQUFPO0lBQ1BDLFFBQVE7QUFDVjtBQUVBLE1BQU1DLGdCQUFnQjtJQUNwQkMsS0FBSyxDQUFDO0lBQ05DLEtBQUssQ0FBQztBQUNSO0FBRWUsU0FBU04sa0JBQWtCLEVBQ3hDTyxLQUFLLEVBQ0xDLGtCQUFrQixFQUNsQkMsa0JBQWtCLEVBQ0s7SUFDdkIsTUFBTSxDQUFDQyxpQkFBaUJDLG1CQUFtQixHQUFHQyxJQUFBQSxlQUFRLEVBQXNDO0lBQzVGLE1BQU0sQ0FBQ0MsWUFBWUMsY0FBYyxHQUFHRixJQUFBQSxlQUFRLEVBQXNDO0lBQ2xGLE1BQU0sQ0FBQ0csa0JBQWtCQyxvQkFBb0IsR0FBR0osSUFBQUEsZUFBUSxFQUFDO0lB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