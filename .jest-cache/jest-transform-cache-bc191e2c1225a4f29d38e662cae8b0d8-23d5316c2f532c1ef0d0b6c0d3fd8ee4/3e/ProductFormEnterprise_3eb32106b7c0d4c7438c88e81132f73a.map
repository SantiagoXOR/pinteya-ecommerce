{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\components\\admin\\products\\ProductFormEnterprise.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect, useCallback } from 'react'\nimport { useForm } from 'react-hook-form'\nimport { zodResolver } from '@hookform/resolvers/zod'\nimport { z } from 'zod'\nimport { useMutation, useQuery } from '@tanstack/react-query'\nimport { AdminCard } from '../ui/AdminCard'\nimport { ProductImageManagerEnterprise } from './ProductImageManagerEnterprise'\nimport { ProductVariantManager } from './ProductVariantManager'\nimport { ProductPricing } from './ProductPricing'\nimport { ProductInventory } from './ProductInventory'\nimport { ProductSeo } from './ProductSeo'\nimport { CategorySelector } from './CategorySelector'\nimport { cn } from '@/lib/core/utils'\nimport { Save, X, Eye, Loader2, Clock, CheckCircle, AlertCircle } from 'lucide-react'\nimport { toast } from 'react-hot-toast'\n\n// Enhanced validation schema\nconst ProductFormEnterpriseSchema = z.object({\n  name: z.string().min(1, 'El nombre es requerido').max(255, 'M√°ximo 255 caracteres'),\n  description: z.string().optional(),\n  short_description: z.string().max(500, 'M√°ximo 500 caracteres').optional(),\n  category_id: z.string().uuid('Selecciona una categor√≠a v√°lida'),\n  status: z.enum(['active', 'inactive', 'draft']),\n\n  // Pricing\n  price: z.number().min(0, 'El precio debe ser mayor a 0'),\n  compare_price: z.number().min(0).optional(),\n  cost_price: z.number().min(0).optional(),\n\n  // Inventory\n  track_inventory: z.boolean().default(true),\n  stock: z.number().min(0, 'El stock debe ser mayor o igual a 0'),\n  low_stock_threshold: z.number().min(0).optional(),\n  allow_backorder: z.boolean().default(false),\n\n  // SEO\n  seo_title: z.string().max(60, 'M√°ximo 60 caracteres').optional(),\n  seo_description: z.string().max(160, 'M√°ximo 160 caracteres').optional(),\n  slug: z.string().optional(),\n\n  // Images\n  images: z\n    .array(\n      z.object({\n        id: z.string().optional(),\n        url: z.string().url(),\n        alt_text: z.string().optional(),\n        is_primary: z.boolean().default(false),\n      })\n    )\n    .optional(),\n\n  // Variants\n  variants: z\n    .array(\n      z.object({\n        name: z.string(),\n        options: z.array(z.string()),\n      })\n    )\n    .optional(),\n})\n\ntype ProductFormEnterpriseData = z.infer<typeof ProductFormEnterpriseSchema>\n\ninterface ProductFormEnterpriseProps {\n  productId?: string\n  initialData?: Partial<ProductFormEnterpriseData>\n  mode?: 'create' | 'edit'\n  onSubmit: (data: ProductFormEnterpriseData) => Promise<void>\n  onCancel?: () => void\n  isLoading?: boolean\n  className?: string\n}\n\n// Auto-save hook\nfunction useAutoSave(data: any, onSave: (data: any) => void, delay: number = 30000) {\n  const [lastSaved, setLastSaved] = useState<Date | null>(null)\n  const [isSaving, setIsSaving] = useState(false)\n\n  useEffect(() => {\n    if (!data || !onSave) {\n      return\n    }\n\n    const timer = setTimeout(async () => {\n      try {\n        setIsSaving(true)\n        await onSave(data)\n        setLastSaved(new Date())\n        toast.success('Guardado autom√°tico completado', { duration: 2000 })\n      } catch (error) {\n        console.error('Auto-save failed:', error)\n        toast.error('Error en guardado autom√°tico')\n      } finally {\n        setIsSaving(false)\n      }\n    }, delay)\n\n    return () => clearTimeout(timer)\n  }, [data, onSave, delay])\n\n  return { lastSaved, isSaving }\n}\n\n// Slug validation API\nasync function validateSlug(slug: string, productId?: string): Promise<boolean> {\n  if (!slug) {\n    return true\n  }\n\n  const response = await fetch(`/api/admin/products/validate-slug`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ slug, productId }),\n  })\n\n  const result = await response.json()\n  return result.available\n}\n\nexport function ProductFormEnterprise({\n  productId,\n  initialData,\n  mode = 'create',\n  onSubmit,\n  onCancel,\n  isLoading = false,\n  className,\n}: ProductFormEnterpriseProps) {\n  const [activeTab, setActiveTab] = useState('general')\n  const [previewMode, setPreviewMode] = useState(false)\n  const [slugValidation, setSlugValidation] = useState<{ isValid: boolean; isChecking: boolean }>({\n    isValid: true,\n    isChecking: false,\n  })\n\n  const form = useForm<ProductFormEnterpriseData>({\n    resolver: zodResolver(ProductFormEnterpriseSchema),\n    defaultValues: {\n      status: 'draft',\n      track_inventory: true,\n      allow_backorder: false,\n      stock: 0,\n      price: 0,\n      images: [],\n      variants: [],\n      ...initialData,\n    },\n  })\n\n  const {\n    handleSubmit,\n    formState: { errors, isDirty },\n    watch,\n    setValue,\n    getValues,\n  } = form\n\n  const watchedData = watch()\n  const watchedName = watch('name')\n  const watchedSlug = watch('slug')\n\n  // Auto-save functionality\n  const handleAutoSave = useCallback(\n    async (data: ProductFormEnterpriseData) => {\n      if (mode === 'edit' && productId && isDirty) {\n        await onSubmit(data)\n      }\n    },\n    [mode, productId, isDirty, onSubmit]\n  )\n\n  const { lastSaved, isSaving } = useAutoSave(watchedData, handleAutoSave)\n\n  // Generate slug from name\n  useEffect(() => {\n    if (watchedName && (!watchedSlug || mode === 'create')) {\n      const generatedSlug = watchedName\n        .toLowerCase()\n        .replace(/[^a-z0-9\\s-]/g, '')\n        .replace(/\\s+/g, '-')\n        .replace(/-+/g, '-')\n        .trim()\n      setValue('slug', generatedSlug)\n    }\n  }, [watchedName, watchedSlug, mode, setValue])\n\n  // Validate slug uniqueness\n  useEffect(() => {\n    if (!watchedSlug) {\n      return\n    }\n\n    const validateSlugUnique = async () => {\n      setSlugValidation({ isValid: true, isChecking: true })\n\n      try {\n        const isValid = await validateSlug(watchedSlug, productId)\n        setSlugValidation({ isValid, isChecking: false })\n      } catch (error) {\n        console.error('Slug validation error:', error)\n        setSlugValidation({ isValid: true, isChecking: false })\n      }\n    }\n\n    const timer = setTimeout(validateSlugUnique, 500)\n    return () => clearTimeout(timer)\n  }, [watchedSlug, productId])\n\n  const tabs = [\n    { id: 'general', label: 'General', icon: 'üìù' },\n    { id: 'pricing', label: 'Precios', icon: 'üí∞' },\n    { id: 'inventory', label: 'Inventario', icon: 'üì¶' },\n    { id: 'images', label: 'Im√°genes', icon: 'üñºÔ∏è' },\n    { id: 'variants', label: 'Variantes', icon: 'üé®' },\n    { id: 'seo', label: 'SEO', icon: 'üîç' },\n  ]\n\n  const handleFormSubmit = async (data: ProductFormEnterpriseData) => {\n    if (!slugValidation.isValid) {\n      toast.error('El slug debe ser √∫nico')\n      return\n    }\n\n    await onSubmit(data)\n  }\n\n  return (\n    <div className={cn('space-y-6', className)}>\n      {/* Header with auto-save status */}\n      <div className='flex items-center justify-between'>\n        <div>\n          <h2 className='text-2xl font-bold text-gray-900'>\n            {mode === 'create' ? 'Crear Producto' : 'Editar Producto'}\n          </h2>\n          {mode === 'edit' && (\n            <div className='flex items-center gap-2 mt-1 text-sm text-gray-500'>\n              {isSaving ? (\n                <>\n                  <Loader2 className='w-4 h-4 animate-spin' />\n                  <span>Guardando autom√°ticamente...</span>\n                </>\n              ) : lastSaved ? (\n                <>\n                  <CheckCircle className='w-4 h-4 text-green-500' />\n                  <span>Guardado autom√°tico: {lastSaved.toLocaleTimeString()}</span>\n                </>\n              ) : (\n                <>\n                  <Clock className='w-4 h-4' />\n                  <span>Auto-guardado cada 30 segundos</span>\n                </>\n              )}\n            </div>\n          )}\n        </div>\n\n        <div className='flex items-center gap-2'>\n          <button\n            type='button'\n            onClick={() => setPreviewMode(!previewMode)}\n            className='flex items-center gap-2 px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors'\n          >\n            <Eye className='w-4 h-4' />\n            {previewMode ? 'Editar' : 'Vista Previa'}\n          </button>\n        </div>\n      </div>\n\n      {/* Tabs */}\n      <div className='border-b border-gray-200'>\n        <nav className='-mb-px flex space-x-8'>\n          {tabs.map(tab => (\n            <button\n              key={tab.id}\n              onClick={() => setActiveTab(tab.id)}\n              className={cn(\n                'py-2 px-1 border-b-2 font-medium text-sm transition-colors',\n                activeTab === tab.id\n                  ? 'border-blaze-orange-500 text-blaze-orange-600'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n              )}\n            >\n              <span className='mr-2'>{tab.icon}</span>\n              {tab.label}\n            </button>\n          ))}\n        </nav>\n      </div>\n\n      {/* Form */}\n      <form onSubmit={handleSubmit(handleFormSubmit)} className='space-y-6'>\n        {/* General Tab */}\n        {activeTab === 'general' && (\n          <AdminCard className='p-6'>\n            <div className='space-y-6'>\n              <h3 className='text-lg font-medium text-gray-900'>Informaci√≥n General</h3>\n\n              <div className='grid grid-cols-1 md:grid-cols-2 gap-6'>\n                {/* Name */}\n                <div>\n                  <label className='block text-sm font-medium text-gray-700 mb-2'>\n                    Nombre del Producto *\n                  </label>\n                  <input\n                    {...form.register('name')}\n                    type='text'\n                    className='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blaze-orange-500 focus:border-transparent'\n                    placeholder='Ingrese el nombre del producto'\n                  />\n                  {errors.name && (\n                    <p className='mt-1 text-sm text-red-600'>{errors.name.message}</p>\n                  )}\n                </div>\n\n                {/* Category */}\n                <div>\n                  <label className='block text-sm font-medium text-gray-700 mb-2'>\n                    Categor√≠a *\n                  </label>\n                  <CategorySelector\n                    value={watchedData.category_id}\n                    onChange={value => setValue('category_id', value)}\n                    error={errors.category_id?.message}\n                  />\n                </div>\n\n                {/* Slug */}\n                <div className='md:col-span-2'>\n                  <label className='block text-sm font-medium text-gray-700 mb-2'>URL Slug</label>\n                  <div className='relative'>\n                    <input\n                      {...form.register('slug')}\n                      type='text'\n                      className={cn(\n                        'w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blaze-orange-500 focus:border-transparent',\n                        !slugValidation.isValid ? 'border-red-300' : 'border-gray-300'\n                      )}\n                      placeholder='url-del-producto'\n                    />\n                    <div className='absolute inset-y-0 right-0 flex items-center pr-3'>\n                      {slugValidation.isChecking ? (\n                        <Loader2 className='w-4 h-4 animate-spin text-gray-400' />\n                      ) : !slugValidation.isValid ? (\n                        <AlertCircle className='w-4 h-4 text-red-500' />\n                      ) : (\n                        <CheckCircle className='w-4 h-4 text-green-500' />\n                      )}\n                    </div>\n                  </div>\n                  {!slugValidation.isValid && (\n                    <p className='mt-1 text-sm text-red-600'>Este slug ya est√° en uso</p>\n                  )}\n                  <p className='mt-1 text-sm text-gray-500'>\n                    URL: /productos/{watchedData.slug || 'url-del-producto'}\n                  </p>\n                </div>\n\n                {/* Status */}\n                <div>\n                  <label className='block text-sm font-medium text-gray-700 mb-2'>Estado</label>\n                  <select\n                    {...form.register('status')}\n                    className='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blaze-orange-500 focus:border-transparent'\n                  >\n                    <option value='draft'>Borrador</option>\n                    <option value='active'>Activo</option>\n                    <option value='inactive'>Inactivo</option>\n                  </select>\n                </div>\n              </div>\n\n              {/* Description */}\n              <div>\n                <label className='block text-sm font-medium text-gray-700 mb-2'>Descripci√≥n</label>\n                <textarea\n                  {...form.register('description')}\n                  rows={4}\n                  className='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blaze-orange-500 focus:border-transparent'\n                  placeholder='Descripci√≥n detallada del producto'\n                />\n              </div>\n\n              {/* Short Description */}\n              <div>\n                <label className='block text-sm font-medium text-gray-700 mb-2'>\n                  Descripci√≥n Corta\n                </label>\n                <textarea\n                  {...form.register('short_description')}\n                  rows={2}\n                  className='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blaze-orange-500 focus:border-transparent'\n                  placeholder='Descripci√≥n breve para listados'\n                />\n                {errors.short_description && (\n                  <p className='mt-1 text-sm text-red-600'>{errors.short_description.message}</p>\n                )}\n              </div>\n            </div>\n          </AdminCard>\n        )}\n\n        {/* Pricing Tab */}\n        {activeTab === 'pricing' && <ProductPricing form={form} errors={errors} />}\n\n        {/* Inventory Tab */}\n        {activeTab === 'inventory' && <ProductInventory form={form} errors={errors} />}\n\n        {/* Images Tab */}\n        {activeTab === 'images' && productId && (\n          <ProductImageManagerEnterprise\n            productId={productId}\n            images={watchedData.images || []}\n            onChange={images => setValue('images', images)}\n          />\n        )}\n\n        {/* Variants Tab */}\n        {activeTab === 'variants' && (\n          <ProductVariantManager\n            variants={watchedData.variants || []}\n            onChange={variants => setValue('variants', variants)}\n          />\n        )}\n\n        {/* SEO Tab */}\n        {activeTab === 'seo' && (\n          <ProductSeo\n            form={form}\n            errors={errors}\n            productName={watchedData.name}\n            productSlug={watchedData.slug}\n          />\n        )}\n\n        {/* Form Actions */}\n        <div className='flex items-center justify-end gap-4 pt-6 border-t border-gray-200'>\n          {onCancel && (\n            <button\n              type='button'\n              onClick={onCancel}\n              className='px-6 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors'\n              disabled={isLoading}\n            >\n              <X className='w-4 h-4 mr-2 inline' />\n              Cancelar\n            </button>\n          )}\n\n          <button\n            type='submit'\n            disabled={isLoading || !slugValidation.isValid || slugValidation.isChecking}\n            className='flex items-center gap-2 px-6 py-2 bg-blaze-orange-600 text-white rounded-lg hover:bg-blaze-orange-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors'\n          >\n            {isLoading ? (\n              <Loader2 className='w-4 h-4 animate-spin' />\n            ) : (\n              <Save className='w-4 h-4' />\n            )}\n            {mode === 'create' ? 'Crear Producto' : 'Guardar Cambios'}\n          </button>\n        </div>\n      </form>\n    </div>\n  )\n}\n"],"names":["ProductFormEnterprise","ProductFormEnterpriseSchema","z","object","name","string","min","max","description","optional","short_description","category_id","uuid","status","enum","price","number","compare_price","cost_price","track_inventory","boolean","default","stock","low_stock_threshold","allow_backorder","seo_title","seo_description","slug","images","array","id","url","alt_text","is_primary","variants","options","useAutoSave","data","onSave","delay","lastSaved","setLastSaved","useState","isSaving","setIsSaving","useEffect","timer","setTimeout","Date","toast","success","duration","error","console","clearTimeout","validateSlug","productId","response","fetch","method","headers","body","JSON","stringify","result","json","available","initialData","mode","onSubmit","onCancel","isLoading","className","activeTab","setActiveTab","previewMode","setPreviewMode","slugValidation","setSlugValidation","isValid","isChecking","form","useForm","resolver","zodResolver","defaultValues","handleSubmit","formState","errors","isDirty","watch","setValue","getValues","watchedData","watchedName","watchedSlug","handleAutoSave","useCallback","generatedSlug","toLowerCase","replace","trim","validateSlugUnique","tabs","label","icon","handleFormSubmit","div","cn","h2","Loader2","span","CheckCircle","toLocaleTimeString","Clock","button","type","onClick","Eye","nav","map","tab","AdminCard","h3","input","register","placeholder","p","message","CategorySelector","value","onChange","AlertCircle","select","option","textarea","rows","ProductPricing","ProductInventory","ProductImageManagerEnterprise","ProductVariantManager","ProductSeo","productName","productSlug","disabled","X","Save"],"mappings":"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"}