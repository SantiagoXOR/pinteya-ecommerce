8c5eac1ac70c444af8ab661f3de16d10
/**
 * Middleware Enterprise de Rate Limiting
 * Integra rate limiting con utilidades enterprise y sistema de autenticación
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get checkRateLimitWithAuth () {
        return checkRateLimitWithAuth;
    },
    get getRateLimitMetrics () {
        return getRateLimitMetrics;
    },
    get resetRateLimitMetrics () {
        return resetRateLimitMetrics;
    },
    get withAdminRateLimit () {
        return withAdminRateLimit;
    },
    get withCriticalAuthRateLimit () {
        return withCriticalAuthRateLimit;
    },
    get withEnterpriseRateLimit () {
        return withEnterpriseRateLimit;
    },
    get withEnterpriseRateLimitAPI () {
        return withEnterpriseRateLimitAPI;
    },
    get withPaymentRateLimit () {
        return withPaymentRateLimit;
    },
    get withPublicRateLimit () {
        return withPublicRateLimit;
    },
    get withWebhookRateLimit () {
        return withWebhookRateLimit;
    }
});
const _server = require("next/server");
const _enterpriseratelimiter = require("./enterprise-rate-limiter");
const _enterpriseauditsystem = require("../security/enterprise-audit-system");
function withEnterpriseRateLimit(options) {
    return function(handler) {
        return async (request, ...args)=>{
            try {
                // Verificar si debe saltarse el rate limiting
                if (options.skipIf && options.skipIf(request)) {
                    return await handler(request, ...args);
                }
                // Verificar rate limit
                const rateLimitResult = await (0, _enterpriseratelimiter.checkEnterpriseRateLimit)(request, options.configName, options.customConfig);
                // Si el límite fue excedido
                if (!rateLimitResult.allowed) {
                    // ENTERPRISE: Registrar evento de seguridad
                    try {
                        await _enterpriseauditsystem.enterpriseAuditSystem.logEnterpriseEvent({
                            user_id: request.headers.get('x-clerk-user-id') || 'anonymous',
                            event_type: 'SECURITY_VIOLATION',
                            event_category: 'suspicious_behavior',
                            severity: 'medium',
                            description: `Rate limit excedido en ${request.nextUrl.pathname}`,
                            metadata: {
                                endpoint: request.nextUrl.pathname,
                                method: request.method,
                                config: options.configName,
                                limit: rateLimitResult.limit,
                                remaining: rateLimitResult.remaining,
                                source: rateLimitResult.source
                            },
                            ip_address: request.headers.get('x-forwarded-for') || 'unknown',
                            user_agent: request.headers.get('user-agent') || 'unknown'
                        }, undefined, request);
                    } catch (auditError) {
                        console.error('[RATE_LIMIT_AUDIT] Error registrando evento:', auditError);
                    }
                    // Callback personalizado
                    if (options.onLimitExceeded) {
                        options.onLimitExceeded(rateLimitResult, request);
                    }
                    // Logging si está habilitado
                    if (options.enableLogging !== false) {
                        console.warn(`[RATE_LIMIT_MIDDLEWARE] Límite excedido para ${request.nextUrl.pathname}`, {
                            ip: request.headers.get('x-forwarded-for') || 'unknown',
                            userAgent: request.headers.get('user-agent'),
                            limit: rateLimitResult.limit,
                            remaining: rateLimitResult.remaining,
                            resetTime: new Date(rateLimitResult.resetTime).toISOString()
                        });
                    }
                    // Crear respuesta de error con headers de rate limiting
                    const response = _server.NextResponse.json({
                        error: _enterpriseratelimiter.ENTERPRISE_RATE_LIMIT_CONFIGS[options.configName].message || 'Rate limit exceeded',
                        code: 'RATE_LIMIT_EXCEEDED',
                        details: {
                            limit: rateLimitResult.limit,
                            remaining: rateLimitResult.remaining,
                            resetTime: rateLimitResult.resetTime,
                            retryAfter: rateLimitResult.retryAfter
                        },
                        enterprise: true,
                        timestamp: new Date().toISOString()
                    }, {
                        status: 429
                    });
                    // Añadir headers de rate limiting
                    addRateLimitHeaders(response, rateLimitResult);
                    return response;
                }
                // Ejecutar handler original
                const response = await handler(request, ...args);
                // Añadir headers de rate limiting a respuesta exitosa
                if (response) {
                    addRateLimitHeaders(response, rateLimitResult);
                }
                return response;
            } catch (error) {
                console.error('[RATE_LIMIT_MIDDLEWARE] Error:', error);
                // En caso de error, ejecutar handler sin rate limiting
                return await handler(request, ...args);
            }
        };
    };
}
function withEnterpriseRateLimitAPI(options) {
    return function(handler) {
        return async (req, res)=>{
            try {
                // Verificar si debe saltarse el rate limiting
                if (options.skipIf && options.skipIf(req)) {
                    return await handler(req, res);
                }
                // Verificar rate limit
                const rateLimitResult = await (0, _enterpriseratelimiter.checkEnterpriseRateLimit)(req, options.configName, options.customConfig);
                // Añadir headers de rate limiting
                addRateLimitHeadersAPI(res, rateLimitResult);
                // Si el límite fue excedido
                if (!rateLimitResult.allowed) {
                    // Callback personalizado
                    if (options.onLimitExceeded) {
                        options.onLimitExceeded(rateLimitResult, req);
                    }
                    // Logging si está habilitado
                    if (options.enableLogging !== false) {
                        console.warn(`[RATE_LIMIT_API] Límite excedido para ${req.url}`, {
                            ip: req.headers['x-forwarded-for'] || req.connection?.remoteAddress || 'unknown',
                            userAgent: req.headers['user-agent'],
                            limit: rateLimitResult.limit,
                            remaining: rateLimitResult.remaining
                        });
                    }
                    // Responder con error 429
                    res.status(429).json({
                        error: _enterpriseratelimiter.ENTERPRISE_RATE_LIMIT_CONFIGS[options.configName].message || 'Rate limit exceeded',
                        code: 'RATE_LIMIT_EXCEEDED',
                        details: {
                            limit: rateLimitResult.limit,
                            remaining: rateLimitResult.remaining,
                            resetTime: rateLimitResult.resetTime,
                            retryAfter: rateLimitResult.retryAfter
                        },
                        enterprise: true,
                        timestamp: new Date().toISOString()
                    });
                    return;
                }
                // Ejecutar handler original
                return await handler(req, res);
            } catch (error) {
                console.error('[RATE_LIMIT_API] Error:', error);
                // En caso de error, ejecutar handler sin rate limiting
                return await handler(req, res);
            }
        };
    };
}
async function checkRateLimitWithAuth(request, enterpriseContext, configName) {
    try {
        // Determinar configuración basada en contexto de autenticación
        let finalConfigName = configName;
        const customConfig = {};
        if (enterpriseContext && !finalConfigName) {
            // Seleccionar configuración basada en rol y permisos
            if (enterpriseContext.role === 'admin') {
                finalConfigName = 'ADMIN_API';
            } else if (enterpriseContext.permissions.includes('payment_access')) {
                finalConfigName = 'PAYMENT_API';
            } else {
                finalConfigName = 'PUBLIC_API';
            }
            // Ajustar límites basado en nivel de seguridad
            if (enterpriseContext.securityLevel === 'critical') {
                customConfig.maxRequests = Math.floor((_enterpriseratelimiter.ENTERPRISE_RATE_LIMIT_CONFIGS[finalConfigName].maxRequests || 50) * 0.5);
            } else if (enterpriseContext.securityLevel === 'high') {
                customConfig.maxRequests = Math.floor((_enterpriseratelimiter.ENTERPRISE_RATE_LIMIT_CONFIGS[finalConfigName].maxRequests || 50) * 0.75);
            }
            // Usar generador de clave por usuario si está autenticado
            customConfig.keyGenerator = (req)=>`user:${enterpriseContext.userId}:${getEndpoint(req)}`;
        }
        if (!finalConfigName) {
            finalConfigName = 'PUBLIC_API';
        }
        // Verificar rate limit
        const result = await (0, _enterpriseratelimiter.checkEnterpriseRateLimit)(request, finalConfigName, customConfig);
        return {
            success: result.allowed,
            result,
            error: result.allowed ? undefined : 'Rate limit exceeded',
            code: result.allowed ? undefined : 'RATE_LIMIT_EXCEEDED'
        };
    } catch (error) {
        console.error('[RATE_LIMIT_AUTH] Error:', error);
        return {
            success: true,
            error: 'Error interno en rate limiting',
            code: 'INTERNAL_ERROR'
        };
    }
}
// =====================================================
// UTILIDADES
// =====================================================
/**
 * Añade headers de rate limiting a NextResponse
 */ function addRateLimitHeaders(response, result) {
    response.headers.set('X-RateLimit-Limit', result.limit.toString());
    response.headers.set('X-RateLimit-Remaining', result.remaining.toString());
    response.headers.set('X-RateLimit-Reset', Math.ceil(result.resetTime / 1000).toString());
    if (result.retryAfter) {
        response.headers.set('Retry-After', result.retryAfter.toString());
    }
    // Headers adicionales enterprise
    response.headers.set('X-RateLimit-Source', result.source);
    if (result.metrics) {
        response.headers.set('X-RateLimit-Response-Time', result.metrics.responseTime.toString());
    }
}
/**
 * Añade headers de rate limiting a NextApiResponse
 */ function addRateLimitHeadersAPI(res, result) {
    res.setHeader('X-RateLimit-Limit', result.limit.toString());
    res.setHeader('X-RateLimit-Remaining', result.remaining.toString());
    res.setHeader('X-RateLimit-Reset', Math.ceil(result.resetTime / 1000).toString());
    if (result.retryAfter) {
        res.setHeader('Retry-After', result.retryAfter.toString());
    }
    // Headers adicionales enterprise
    res.setHeader('X-RateLimit-Source', result.source);
    if (result.metrics) {
        res.setHeader('X-RateLimit-Response-Time', result.metrics.responseTime.toString());
    }
}
/**
 * Obtiene el endpoint de la request
 */ function getEndpoint(request) {
    if ('nextUrl' in request) {
        return request.nextUrl.pathname;
    } else if ('url' in request) {
        try {
            const url = new URL(request.url || '', 'http://localhost');
            return url.pathname;
        } catch  {
            return '/unknown';
        }
    }
    return '/unknown';
}
const withCriticalAuthRateLimit = ()=>withEnterpriseRateLimit({
        configName: 'CRITICAL_AUTH'
    });
const withAdminRateLimit = ()=>withEnterpriseRateLimit({
        configName: 'ADMIN_API'
    });
const withPaymentRateLimit = ()=>withEnterpriseRateLimit({
        configName: 'PAYMENT_API'
    });
const withPublicRateLimit = ()=>withEnterpriseRateLimit({
        configName: 'PUBLIC_API'
    });
const withWebhookRateLimit = ()=>withEnterpriseRateLimit({
        configName: 'WEBHOOK_API'
    });
function getRateLimitMetrics() {
    return _enterpriseratelimiter.metricsCollector.getMetrics();
}
function resetRateLimitMetrics() {
    _enterpriseratelimiter.metricsCollector.reset();
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcbGliXFxyYXRlLWxpbWl0aW5nXFxlbnRlcnByaXNlLW1pZGRsZXdhcmUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIE1pZGRsZXdhcmUgRW50ZXJwcmlzZSBkZSBSYXRlIExpbWl0aW5nXHJcbiAqIEludGVncmEgcmF0ZSBsaW1pdGluZyBjb24gdXRpbGlkYWRlcyBlbnRlcnByaXNlIHkgc2lzdGVtYSBkZSBhdXRlbnRpY2FjacOzblxyXG4gKi9cclxuXHJcbmltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XHJcbmltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xyXG5pbXBvcnQge1xyXG4gIGNoZWNrRW50ZXJwcmlzZVJhdGVMaW1pdCxcclxuICBFTlRFUlBSSVNFX1JBVEVfTElNSVRfQ09ORklHUyxcclxuICB0eXBlIEVudGVycHJpc2VSYXRlTGltaXRDb25maWcsXHJcbiAgdHlwZSBFbnRlcnByaXNlUmF0ZUxpbWl0UmVzdWx0LFxyXG4gIG1ldHJpY3NDb2xsZWN0b3JcclxufSBmcm9tICcuL2VudGVycHJpc2UtcmF0ZS1saW1pdGVyJztcclxuaW1wb3J0IHR5cGUgeyBFbnRlcnByaXNlQXV0aENvbnRleHQgfSBmcm9tICdAL2xpYi9hdXRoL2VudGVycHJpc2UtYXV0aC11dGlscyc7XHJcbmltcG9ydCB7IGVudGVycHJpc2VBdWRpdFN5c3RlbSB9IGZyb20gJ0AvbGliL3NlY3VyaXR5L2VudGVycHJpc2UtYXVkaXQtc3lzdGVtJztcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFRJUE9TIFkgSU5URVJGQUNFU1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBSYXRlTGltaXRNaWRkbGV3YXJlT3B0aW9ucyB7XHJcbiAgY29uZmlnTmFtZToga2V5b2YgdHlwZW9mIEVOVEVSUFJJU0VfUkFURV9MSU1JVF9DT05GSUdTO1xyXG4gIGN1c3RvbUNvbmZpZz86IFBhcnRpYWw8RW50ZXJwcmlzZVJhdGVMaW1pdENvbmZpZz47XHJcbiAgc2tpcElmPzogKHJlcXVlc3Q6IE5leHRSZXF1ZXN0IHwgTmV4dEFwaVJlcXVlc3QpID0+IGJvb2xlYW47XHJcbiAgb25MaW1pdEV4Y2VlZGVkPzogKHJlc3VsdDogRW50ZXJwcmlzZVJhdGVMaW1pdFJlc3VsdCwgcmVxdWVzdDogTmV4dFJlcXVlc3QgfCBOZXh0QXBpUmVxdWVzdCkgPT4gdm9pZDtcclxuICBlbmFibGVFbnRlcnByaXNlSW50ZWdyYXRpb24/OiBib29sZWFuO1xyXG4gIGVuYWJsZU1ldHJpY3M/OiBib29sZWFuO1xyXG4gIGVuYWJsZUxvZ2dpbmc/OiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFJhdGVMaW1pdFJlc3BvbnNlIHtcclxuICBzdWNjZXNzOiBib29sZWFuO1xyXG4gIHJlc3VsdD86IEVudGVycHJpc2VSYXRlTGltaXRSZXN1bHQ7XHJcbiAgcmVzcG9uc2U/OiBOZXh0UmVzcG9uc2U7XHJcbiAgZXJyb3I/OiBzdHJpbmc7XHJcbiAgY29kZT86IHN0cmluZztcclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gTUlERExFV0FSRSBQQVJBIE5FWFQuSlMgQVBQIFJPVVRFUlxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIE1pZGRsZXdhcmUgZGUgcmF0ZSBsaW1pdGluZyBwYXJhIE5leHQuanMgQXBwIFJvdXRlclxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHdpdGhFbnRlcnByaXNlUmF0ZUxpbWl0KG9wdGlvbnM6IFJhdGVMaW1pdE1pZGRsZXdhcmVPcHRpb25zKSB7XHJcbiAgcmV0dXJuIGZ1bmN0aW9uIDxUIGV4dGVuZHMgYW55W10+KFxyXG4gICAgaGFuZGxlcjogKHJlcXVlc3Q6IE5leHRSZXF1ZXN0LCAuLi5hcmdzOiBUKSA9PiBQcm9taXNlPE5leHRSZXNwb25zZT4gfCBOZXh0UmVzcG9uc2VcclxuICApIHtcclxuICAgIHJldHVybiBhc3luYyAocmVxdWVzdDogTmV4dFJlcXVlc3QsIC4uLmFyZ3M6IFQpOiBQcm9taXNlPE5leHRSZXNwb25zZT4gPT4ge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIC8vIFZlcmlmaWNhciBzaSBkZWJlIHNhbHRhcnNlIGVsIHJhdGUgbGltaXRpbmdcclxuICAgICAgICBpZiAob3B0aW9ucy5za2lwSWYgJiYgb3B0aW9ucy5za2lwSWYocmVxdWVzdCkpIHtcclxuICAgICAgICAgIHJldHVybiBhd2FpdCBoYW5kbGVyKHJlcXVlc3QsIC4uLmFyZ3MpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gVmVyaWZpY2FyIHJhdGUgbGltaXRcclxuICAgICAgICBjb25zdCByYXRlTGltaXRSZXN1bHQgPSBhd2FpdCBjaGVja0VudGVycHJpc2VSYXRlTGltaXQoXHJcbiAgICAgICAgICByZXF1ZXN0LFxyXG4gICAgICAgICAgb3B0aW9ucy5jb25maWdOYW1lLFxyXG4gICAgICAgICAgb3B0aW9ucy5jdXN0b21Db25maWdcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAvLyBTaSBlbCBsw61taXRlIGZ1ZSBleGNlZGlkb1xyXG4gICAgICAgIGlmICghcmF0ZUxpbWl0UmVzdWx0LmFsbG93ZWQpIHtcclxuICAgICAgICAgIC8vIEVOVEVSUFJJU0U6IFJlZ2lzdHJhciBldmVudG8gZGUgc2VndXJpZGFkXHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBhd2FpdCBlbnRlcnByaXNlQXVkaXRTeXN0ZW0ubG9nRW50ZXJwcmlzZUV2ZW50KHtcclxuICAgICAgICAgICAgICB1c2VyX2lkOiByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd4LWNsZXJrLXVzZXItaWQnKSB8fCAnYW5vbnltb3VzJyxcclxuICAgICAgICAgICAgICBldmVudF90eXBlOiAnU0VDVVJJVFlfVklPTEFUSU9OJyxcclxuICAgICAgICAgICAgICBldmVudF9jYXRlZ29yeTogJ3N1c3BpY2lvdXNfYmVoYXZpb3InLFxyXG4gICAgICAgICAgICAgIHNldmVyaXR5OiAnbWVkaXVtJyxcclxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYFJhdGUgbGltaXQgZXhjZWRpZG8gZW4gJHtyZXF1ZXN0Lm5leHRVcmwucGF0aG5hbWV9YCxcclxuICAgICAgICAgICAgICBtZXRhZGF0YToge1xyXG4gICAgICAgICAgICAgICAgZW5kcG9pbnQ6IHJlcXVlc3QubmV4dFVybC5wYXRobmFtZSxcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogcmVxdWVzdC5tZXRob2QsXHJcbiAgICAgICAgICAgICAgICBjb25maWc6IG9wdGlvbnMuY29uZmlnTmFtZSxcclxuICAgICAgICAgICAgICAgIGxpbWl0OiByYXRlTGltaXRSZXN1bHQubGltaXQsXHJcbiAgICAgICAgICAgICAgICByZW1haW5pbmc6IHJhdGVMaW1pdFJlc3VsdC5yZW1haW5pbmcsXHJcbiAgICAgICAgICAgICAgICBzb3VyY2U6IHJhdGVMaW1pdFJlc3VsdC5zb3VyY2VcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIGlwX2FkZHJlc3M6IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3gtZm9yd2FyZGVkLWZvcicpIHx8ICd1bmtub3duJyxcclxuICAgICAgICAgICAgICB1c2VyX2FnZW50OiByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd1c2VyLWFnZW50JykgfHwgJ3Vua25vd24nXHJcbiAgICAgICAgICAgIH0sIHVuZGVmaW5lZCwgcmVxdWVzdCk7XHJcbiAgICAgICAgICB9IGNhdGNoIChhdWRpdEVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tSQVRFX0xJTUlUX0FVRElUXSBFcnJvciByZWdpc3RyYW5kbyBldmVudG86JywgYXVkaXRFcnJvcik7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy8gQ2FsbGJhY2sgcGVyc29uYWxpemFkb1xyXG4gICAgICAgICAgaWYgKG9wdGlvbnMub25MaW1pdEV4Y2VlZGVkKSB7XHJcbiAgICAgICAgICAgIG9wdGlvbnMub25MaW1pdEV4Y2VlZGVkKHJhdGVMaW1pdFJlc3VsdCwgcmVxdWVzdCk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy8gTG9nZ2luZyBzaSBlc3TDoSBoYWJpbGl0YWRvXHJcbiAgICAgICAgICBpZiAob3B0aW9ucy5lbmFibGVMb2dnaW5nICE9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYFtSQVRFX0xJTUlUX01JRERMRVdBUkVdIEzDrW1pdGUgZXhjZWRpZG8gcGFyYSAke3JlcXVlc3QubmV4dFVybC5wYXRobmFtZX1gLCB7XHJcbiAgICAgICAgICAgICAgaXA6IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3gtZm9yd2FyZGVkLWZvcicpIHx8ICd1bmtub3duJyxcclxuICAgICAgICAgICAgICB1c2VyQWdlbnQ6IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3VzZXItYWdlbnQnKSxcclxuICAgICAgICAgICAgICBsaW1pdDogcmF0ZUxpbWl0UmVzdWx0LmxpbWl0LFxyXG4gICAgICAgICAgICAgIHJlbWFpbmluZzogcmF0ZUxpbWl0UmVzdWx0LnJlbWFpbmluZyxcclxuICAgICAgICAgICAgICByZXNldFRpbWU6IG5ldyBEYXRlKHJhdGVMaW1pdFJlc3VsdC5yZXNldFRpbWUpLnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy8gQ3JlYXIgcmVzcHVlc3RhIGRlIGVycm9yIGNvbiBoZWFkZXJzIGRlIHJhdGUgbGltaXRpbmdcclxuICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBlcnJvcjogRU5URVJQUklTRV9SQVRFX0xJTUlUX0NPTkZJR1Nbb3B0aW9ucy5jb25maWdOYW1lXS5tZXNzYWdlIHx8ICdSYXRlIGxpbWl0IGV4Y2VlZGVkJyxcclxuICAgICAgICAgICAgICBjb2RlOiAnUkFURV9MSU1JVF9FWENFRURFRCcsXHJcbiAgICAgICAgICAgICAgZGV0YWlsczoge1xyXG4gICAgICAgICAgICAgICAgbGltaXQ6IHJhdGVMaW1pdFJlc3VsdC5saW1pdCxcclxuICAgICAgICAgICAgICAgIHJlbWFpbmluZzogcmF0ZUxpbWl0UmVzdWx0LnJlbWFpbmluZyxcclxuICAgICAgICAgICAgICAgIHJlc2V0VGltZTogcmF0ZUxpbWl0UmVzdWx0LnJlc2V0VGltZSxcclxuICAgICAgICAgICAgICAgIHJldHJ5QWZ0ZXI6IHJhdGVMaW1pdFJlc3VsdC5yZXRyeUFmdGVyXHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBlbnRlcnByaXNlOiB0cnVlLFxyXG4gICAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHsgc3RhdHVzOiA0MjkgfVxyXG4gICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAvLyBBw7FhZGlyIGhlYWRlcnMgZGUgcmF0ZSBsaW1pdGluZ1xyXG4gICAgICAgICAgYWRkUmF0ZUxpbWl0SGVhZGVycyhyZXNwb25zZSwgcmF0ZUxpbWl0UmVzdWx0KTtcclxuXHJcbiAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBFamVjdXRhciBoYW5kbGVyIG9yaWdpbmFsXHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBoYW5kbGVyKHJlcXVlc3QsIC4uLmFyZ3MpO1xyXG5cclxuICAgICAgICAvLyBBw7FhZGlyIGhlYWRlcnMgZGUgcmF0ZSBsaW1pdGluZyBhIHJlc3B1ZXN0YSBleGl0b3NhXHJcbiAgICAgICAgaWYgKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICBhZGRSYXRlTGltaXRIZWFkZXJzKHJlc3BvbnNlLCByYXRlTGltaXRSZXN1bHQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tSQVRFX0xJTUlUX01JRERMRVdBUkVdIEVycm9yOicsIGVycm9yKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBFbiBjYXNvIGRlIGVycm9yLCBlamVjdXRhciBoYW5kbGVyIHNpbiByYXRlIGxpbWl0aW5nXHJcbiAgICAgICAgcmV0dXJuIGF3YWl0IGhhbmRsZXIocmVxdWVzdCwgLi4uYXJncyk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfTtcclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gTUlERExFV0FSRSBQQVJBIFBBR0VTIEFQSVxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIE1pZGRsZXdhcmUgZGUgcmF0ZSBsaW1pdGluZyBwYXJhIFBhZ2VzIEFQSVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHdpdGhFbnRlcnByaXNlUmF0ZUxpbWl0QVBJKG9wdGlvbnM6IFJhdGVMaW1pdE1pZGRsZXdhcmVPcHRpb25zKSB7XHJcbiAgcmV0dXJuIGZ1bmN0aW9uIChcclxuICAgIGhhbmRsZXI6IChyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkgPT4gUHJvbWlzZTx2b2lkPiB8IHZvaWRcclxuICApIHtcclxuICAgIHJldHVybiBhc3luYyAocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpOiBQcm9taXNlPHZvaWQ+ID0+IHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICAvLyBWZXJpZmljYXIgc2kgZGViZSBzYWx0YXJzZSBlbCByYXRlIGxpbWl0aW5nXHJcbiAgICAgICAgaWYgKG9wdGlvbnMuc2tpcElmICYmIG9wdGlvbnMuc2tpcElmKHJlcSkpIHtcclxuICAgICAgICAgIHJldHVybiBhd2FpdCBoYW5kbGVyKHJlcSwgcmVzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFZlcmlmaWNhciByYXRlIGxpbWl0XHJcbiAgICAgICAgY29uc3QgcmF0ZUxpbWl0UmVzdWx0ID0gYXdhaXQgY2hlY2tFbnRlcnByaXNlUmF0ZUxpbWl0KFxyXG4gICAgICAgICAgcmVxLFxyXG4gICAgICAgICAgb3B0aW9ucy5jb25maWdOYW1lLFxyXG4gICAgICAgICAgb3B0aW9ucy5jdXN0b21Db25maWdcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAvLyBBw7FhZGlyIGhlYWRlcnMgZGUgcmF0ZSBsaW1pdGluZ1xyXG4gICAgICAgIGFkZFJhdGVMaW1pdEhlYWRlcnNBUEkocmVzLCByYXRlTGltaXRSZXN1bHQpO1xyXG5cclxuICAgICAgICAvLyBTaSBlbCBsw61taXRlIGZ1ZSBleGNlZGlkb1xyXG4gICAgICAgIGlmICghcmF0ZUxpbWl0UmVzdWx0LmFsbG93ZWQpIHtcclxuICAgICAgICAgIC8vIENhbGxiYWNrIHBlcnNvbmFsaXphZG9cclxuICAgICAgICAgIGlmIChvcHRpb25zLm9uTGltaXRFeGNlZWRlZCkge1xyXG4gICAgICAgICAgICBvcHRpb25zLm9uTGltaXRFeGNlZWRlZChyYXRlTGltaXRSZXN1bHQsIHJlcSk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy8gTG9nZ2luZyBzaSBlc3TDoSBoYWJpbGl0YWRvXHJcbiAgICAgICAgICBpZiAob3B0aW9ucy5lbmFibGVMb2dnaW5nICE9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYFtSQVRFX0xJTUlUX0FQSV0gTMOtbWl0ZSBleGNlZGlkbyBwYXJhICR7cmVxLnVybH1gLCB7XHJcbiAgICAgICAgICAgICAgaXA6IHJlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXSB8fCByZXEuY29ubmVjdGlvbj8ucmVtb3RlQWRkcmVzcyB8fCAndW5rbm93bicsXHJcbiAgICAgICAgICAgICAgdXNlckFnZW50OiByZXEuaGVhZGVyc1sndXNlci1hZ2VudCddLFxyXG4gICAgICAgICAgICAgIGxpbWl0OiByYXRlTGltaXRSZXN1bHQubGltaXQsXHJcbiAgICAgICAgICAgICAgcmVtYWluaW5nOiByYXRlTGltaXRSZXN1bHQucmVtYWluaW5nXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC8vIFJlc3BvbmRlciBjb24gZXJyb3IgNDI5XHJcbiAgICAgICAgICByZXMuc3RhdHVzKDQyOSkuanNvbih7XHJcbiAgICAgICAgICAgIGVycm9yOiBFTlRFUlBSSVNFX1JBVEVfTElNSVRfQ09ORklHU1tvcHRpb25zLmNvbmZpZ05hbWVdLm1lc3NhZ2UgfHwgJ1JhdGUgbGltaXQgZXhjZWVkZWQnLFxyXG4gICAgICAgICAgICBjb2RlOiAnUkFURV9MSU1JVF9FWENFRURFRCcsXHJcbiAgICAgICAgICAgIGRldGFpbHM6IHtcclxuICAgICAgICAgICAgICBsaW1pdDogcmF0ZUxpbWl0UmVzdWx0LmxpbWl0LFxyXG4gICAgICAgICAgICAgIHJlbWFpbmluZzogcmF0ZUxpbWl0UmVzdWx0LnJlbWFpbmluZyxcclxuICAgICAgICAgICAgICByZXNldFRpbWU6IHJhdGVMaW1pdFJlc3VsdC5yZXNldFRpbWUsXHJcbiAgICAgICAgICAgICAgcmV0cnlBZnRlcjogcmF0ZUxpbWl0UmVzdWx0LnJldHJ5QWZ0ZXJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZW50ZXJwcmlzZTogdHJ1ZSxcclxuICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEVqZWN1dGFyIGhhbmRsZXIgb3JpZ2luYWxcclxuICAgICAgICByZXR1cm4gYXdhaXQgaGFuZGxlcihyZXEsIHJlcyk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignW1JBVEVfTElNSVRfQVBJXSBFcnJvcjonLCBlcnJvcik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gRW4gY2FzbyBkZSBlcnJvciwgZWplY3V0YXIgaGFuZGxlciBzaW4gcmF0ZSBsaW1pdGluZ1xyXG4gICAgICAgIHJldHVybiBhd2FpdCBoYW5kbGVyKHJlcSwgcmVzKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9O1xyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBJTlRFR1JBQ0nDk04gQ09OIEVOVEVSUFJJU0UgQVVUSFxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIFJhdGUgbGltaXRpbmcgaW50ZWdyYWRvIGNvbiBhdXRlbnRpY2FjacOzbiBlbnRlcnByaXNlXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2hlY2tSYXRlTGltaXRXaXRoQXV0aChcclxuICByZXF1ZXN0OiBOZXh0UmVxdWVzdCB8IE5leHRBcGlSZXF1ZXN0LFxyXG4gIGVudGVycHJpc2VDb250ZXh0PzogRW50ZXJwcmlzZUF1dGhDb250ZXh0LFxyXG4gIGNvbmZpZ05hbWU/OiBrZXlvZiB0eXBlb2YgRU5URVJQUklTRV9SQVRFX0xJTUlUX0NPTkZJR1NcclxuKTogUHJvbWlzZTxSYXRlTGltaXRSZXNwb25zZT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBEZXRlcm1pbmFyIGNvbmZpZ3VyYWNpw7NuIGJhc2FkYSBlbiBjb250ZXh0byBkZSBhdXRlbnRpY2FjacOzblxyXG4gICAgbGV0IGZpbmFsQ29uZmlnTmFtZSA9IGNvbmZpZ05hbWU7XHJcbiAgICBjb25zdCBjdXN0b21Db25maWc6IFBhcnRpYWw8RW50ZXJwcmlzZVJhdGVMaW1pdENvbmZpZz4gPSB7fTtcclxuXHJcbiAgICBpZiAoZW50ZXJwcmlzZUNvbnRleHQgJiYgIWZpbmFsQ29uZmlnTmFtZSkge1xyXG4gICAgICAvLyBTZWxlY2Npb25hciBjb25maWd1cmFjacOzbiBiYXNhZGEgZW4gcm9sIHkgcGVybWlzb3NcclxuICAgICAgaWYgKGVudGVycHJpc2VDb250ZXh0LnJvbGUgPT09ICdhZG1pbicpIHtcclxuICAgICAgICBmaW5hbENvbmZpZ05hbWUgPSAnQURNSU5fQVBJJztcclxuICAgICAgfSBlbHNlIGlmIChlbnRlcnByaXNlQ29udGV4dC5wZXJtaXNzaW9ucy5pbmNsdWRlcygncGF5bWVudF9hY2Nlc3MnKSkge1xyXG4gICAgICAgIGZpbmFsQ29uZmlnTmFtZSA9ICdQQVlNRU5UX0FQSSc7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZmluYWxDb25maWdOYW1lID0gJ1BVQkxJQ19BUEknO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBBanVzdGFyIGzDrW1pdGVzIGJhc2FkbyBlbiBuaXZlbCBkZSBzZWd1cmlkYWRcclxuICAgICAgaWYgKGVudGVycHJpc2VDb250ZXh0LnNlY3VyaXR5TGV2ZWwgPT09ICdjcml0aWNhbCcpIHtcclxuICAgICAgICBjdXN0b21Db25maWcubWF4UmVxdWVzdHMgPSBNYXRoLmZsb29yKChFTlRFUlBSSVNFX1JBVEVfTElNSVRfQ09ORklHU1tmaW5hbENvbmZpZ05hbWVdLm1heFJlcXVlc3RzIHx8IDUwKSAqIDAuNSk7XHJcbiAgICAgIH0gZWxzZSBpZiAoZW50ZXJwcmlzZUNvbnRleHQuc2VjdXJpdHlMZXZlbCA9PT0gJ2hpZ2gnKSB7XHJcbiAgICAgICAgY3VzdG9tQ29uZmlnLm1heFJlcXVlc3RzID0gTWF0aC5mbG9vcigoRU5URVJQUklTRV9SQVRFX0xJTUlUX0NPTkZJR1NbZmluYWxDb25maWdOYW1lXS5tYXhSZXF1ZXN0cyB8fCA1MCkgKiAwLjc1KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gVXNhciBnZW5lcmFkb3IgZGUgY2xhdmUgcG9yIHVzdWFyaW8gc2kgZXN0w6EgYXV0ZW50aWNhZG9cclxuICAgICAgY3VzdG9tQ29uZmlnLmtleUdlbmVyYXRvciA9IChyZXEpID0+IGB1c2VyOiR7ZW50ZXJwcmlzZUNvbnRleHQudXNlcklkfToke2dldEVuZHBvaW50KHJlcSl9YDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIWZpbmFsQ29uZmlnTmFtZSkge1xyXG4gICAgICBmaW5hbENvbmZpZ05hbWUgPSAnUFVCTElDX0FQSSc7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVmVyaWZpY2FyIHJhdGUgbGltaXRcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNoZWNrRW50ZXJwcmlzZVJhdGVMaW1pdChyZXF1ZXN0LCBmaW5hbENvbmZpZ05hbWUsIGN1c3RvbUNvbmZpZyk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogcmVzdWx0LmFsbG93ZWQsXHJcbiAgICAgIHJlc3VsdCxcclxuICAgICAgZXJyb3I6IHJlc3VsdC5hbGxvd2VkID8gdW5kZWZpbmVkIDogJ1JhdGUgbGltaXQgZXhjZWVkZWQnLFxyXG4gICAgICBjb2RlOiByZXN1bHQuYWxsb3dlZCA/IHVuZGVmaW5lZCA6ICdSQVRFX0xJTUlUX0VYQ0VFREVEJ1xyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignW1JBVEVfTElNSVRfQVVUSF0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLCAvLyBQZXJtaXRpciBlbiBjYXNvIGRlIGVycm9yXHJcbiAgICAgIGVycm9yOiAnRXJyb3IgaW50ZXJubyBlbiByYXRlIGxpbWl0aW5nJyxcclxuICAgICAgY29kZTogJ0lOVEVSTkFMX0VSUk9SJ1xyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFVUSUxJREFERVNcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBBw7FhZGUgaGVhZGVycyBkZSByYXRlIGxpbWl0aW5nIGEgTmV4dFJlc3BvbnNlXHJcbiAqL1xyXG5mdW5jdGlvbiBhZGRSYXRlTGltaXRIZWFkZXJzKHJlc3BvbnNlOiBOZXh0UmVzcG9uc2UsIHJlc3VsdDogRW50ZXJwcmlzZVJhdGVMaW1pdFJlc3VsdCk6IHZvaWQge1xyXG4gIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdYLVJhdGVMaW1pdC1MaW1pdCcsIHJlc3VsdC5saW1pdC50b1N0cmluZygpKTtcclxuICByZXNwb25zZS5oZWFkZXJzLnNldCgnWC1SYXRlTGltaXQtUmVtYWluaW5nJywgcmVzdWx0LnJlbWFpbmluZy50b1N0cmluZygpKTtcclxuICByZXNwb25zZS5oZWFkZXJzLnNldCgnWC1SYXRlTGltaXQtUmVzZXQnLCBNYXRoLmNlaWwocmVzdWx0LnJlc2V0VGltZSAvIDEwMDApLnRvU3RyaW5nKCkpO1xyXG4gIFxyXG4gIGlmIChyZXN1bHQucmV0cnlBZnRlcikge1xyXG4gICAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ1JldHJ5LUFmdGVyJywgcmVzdWx0LnJldHJ5QWZ0ZXIudG9TdHJpbmcoKSk7XHJcbiAgfVxyXG5cclxuICAvLyBIZWFkZXJzIGFkaWNpb25hbGVzIGVudGVycHJpc2VcclxuICByZXNwb25zZS5oZWFkZXJzLnNldCgnWC1SYXRlTGltaXQtU291cmNlJywgcmVzdWx0LnNvdXJjZSk7XHJcbiAgXHJcbiAgaWYgKHJlc3VsdC5tZXRyaWNzKSB7XHJcbiAgICByZXNwb25zZS5oZWFkZXJzLnNldCgnWC1SYXRlTGltaXQtUmVzcG9uc2UtVGltZScsIHJlc3VsdC5tZXRyaWNzLnJlc3BvbnNlVGltZS50b1N0cmluZygpKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBw7FhZGUgaGVhZGVycyBkZSByYXRlIGxpbWl0aW5nIGEgTmV4dEFwaVJlc3BvbnNlXHJcbiAqL1xyXG5mdW5jdGlvbiBhZGRSYXRlTGltaXRIZWFkZXJzQVBJKHJlczogTmV4dEFwaVJlc3BvbnNlLCByZXN1bHQ6IEVudGVycHJpc2VSYXRlTGltaXRSZXN1bHQpOiB2b2lkIHtcclxuICByZXMuc2V0SGVhZGVyKCdYLVJhdGVMaW1pdC1MaW1pdCcsIHJlc3VsdC5saW1pdC50b1N0cmluZygpKTtcclxuICByZXMuc2V0SGVhZGVyKCdYLVJhdGVMaW1pdC1SZW1haW5pbmcnLCByZXN1bHQucmVtYWluaW5nLnRvU3RyaW5nKCkpO1xyXG4gIHJlcy5zZXRIZWFkZXIoJ1gtUmF0ZUxpbWl0LVJlc2V0JywgTWF0aC5jZWlsKHJlc3VsdC5yZXNldFRpbWUgLyAxMDAwKS50b1N0cmluZygpKTtcclxuICBcclxuICBpZiAocmVzdWx0LnJldHJ5QWZ0ZXIpIHtcclxuICAgIHJlcy5zZXRIZWFkZXIoJ1JldHJ5LUFmdGVyJywgcmVzdWx0LnJldHJ5QWZ0ZXIudG9TdHJpbmcoKSk7XHJcbiAgfVxyXG5cclxuICAvLyBIZWFkZXJzIGFkaWNpb25hbGVzIGVudGVycHJpc2VcclxuICByZXMuc2V0SGVhZGVyKCdYLVJhdGVMaW1pdC1Tb3VyY2UnLCByZXN1bHQuc291cmNlKTtcclxuICBcclxuICBpZiAocmVzdWx0Lm1ldHJpY3MpIHtcclxuICAgIHJlcy5zZXRIZWFkZXIoJ1gtUmF0ZUxpbWl0LVJlc3BvbnNlLVRpbWUnLCByZXN1bHQubWV0cmljcy5yZXNwb25zZVRpbWUudG9TdHJpbmcoKSk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogT2J0aWVuZSBlbCBlbmRwb2ludCBkZSBsYSByZXF1ZXN0XHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRFbmRwb2ludChyZXF1ZXN0OiBOZXh0UmVxdWVzdCB8IE5leHRBcGlSZXF1ZXN0KTogc3RyaW5nIHtcclxuICBpZiAoJ25leHRVcmwnIGluIHJlcXVlc3QpIHtcclxuICAgIHJldHVybiAocmVxdWVzdCBhcyBOZXh0UmVxdWVzdCkubmV4dFVybC5wYXRobmFtZTtcclxuICB9IGVsc2UgaWYgKCd1cmwnIGluIHJlcXVlc3QpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoKHJlcXVlc3QgYXMgTmV4dEFwaVJlcXVlc3QpLnVybCB8fCAnJywgJ2h0dHA6Ly9sb2NhbGhvc3QnKTtcclxuICAgICAgcmV0dXJuIHVybC5wYXRobmFtZTtcclxuICAgIH0gY2F0Y2gge1xyXG4gICAgICByZXR1cm4gJy91bmtub3duJztcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuICcvdW5rbm93bic7XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEZVTkNJT05FUyBERSBDT05WRU5JRU5DSUFcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBSYXRlIGxpbWl0aW5nIHBhcmEgQVBJcyBjcsOtdGljYXMgZGUgYXV0ZW50aWNhY2nDs25cclxuICovXHJcbmV4cG9ydCBjb25zdCB3aXRoQ3JpdGljYWxBdXRoUmF0ZUxpbWl0ID0gKCkgPT4gXHJcbiAgd2l0aEVudGVycHJpc2VSYXRlTGltaXQoeyBjb25maWdOYW1lOiAnQ1JJVElDQUxfQVVUSCcgfSk7XHJcblxyXG4vKipcclxuICogUmF0ZSBsaW1pdGluZyBwYXJhIEFQSXMgYWRtaW5pc3RyYXRpdmFzXHJcbiAqL1xyXG5leHBvcnQgY29uc3Qgd2l0aEFkbWluUmF0ZUxpbWl0ID0gKCkgPT4gXHJcbiAgd2l0aEVudGVycHJpc2VSYXRlTGltaXQoeyBjb25maWdOYW1lOiAnQURNSU5fQVBJJyB9KTtcclxuXHJcbi8qKlxyXG4gKiBSYXRlIGxpbWl0aW5nIHBhcmEgQVBJcyBkZSBwYWdvc1xyXG4gKi9cclxuZXhwb3J0IGNvbnN0IHdpdGhQYXltZW50UmF0ZUxpbWl0ID0gKCkgPT4gXHJcbiAgd2l0aEVudGVycHJpc2VSYXRlTGltaXQoeyBjb25maWdOYW1lOiAnUEFZTUVOVF9BUEknIH0pO1xyXG5cclxuLyoqXHJcbiAqIFJhdGUgbGltaXRpbmcgcGFyYSBBUElzIHDDumJsaWNhc1xyXG4gKi9cclxuZXhwb3J0IGNvbnN0IHdpdGhQdWJsaWNSYXRlTGltaXQgPSAoKSA9PiBcclxuICB3aXRoRW50ZXJwcmlzZVJhdGVMaW1pdCh7IGNvbmZpZ05hbWU6ICdQVUJMSUNfQVBJJyB9KTtcclxuXHJcbi8qKlxyXG4gKiBSYXRlIGxpbWl0aW5nIHBhcmEgd2ViaG9va3NcclxuICovXHJcbmV4cG9ydCBjb25zdCB3aXRoV2ViaG9va1JhdGVMaW1pdCA9ICgpID0+IFxyXG4gIHdpdGhFbnRlcnByaXNlUmF0ZUxpbWl0KHsgY29uZmlnTmFtZTogJ1dFQkhPT0tfQVBJJyB9KTtcclxuXHJcbi8qKlxyXG4gKiBPYnRlbmVyIG3DqXRyaWNhcyBkZSByYXRlIGxpbWl0aW5nXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmF0ZUxpbWl0TWV0cmljcygpIHtcclxuICByZXR1cm4gbWV0cmljc0NvbGxlY3Rvci5nZXRNZXRyaWNzKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZXNldGVhciBtw6l0cmljYXMgZGUgcmF0ZSBsaW1pdGluZ1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0UmF0ZUxpbWl0TWV0cmljcygpIHtcclxuICBtZXRyaWNzQ29sbGVjdG9yLnJlc2V0KCk7XHJcbn1cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuIl0sIm5hbWVzIjpbImNoZWNrUmF0ZUxpbWl0V2l0aEF1dGgiLCJnZXRSYXRlTGltaXRNZXRyaWNzIiwicmVzZXRSYXRlTGltaXRNZXRyaWNzIiwid2l0aEFkbWluUmF0ZUxpbWl0Iiwid2l0aENyaXRpY2FsQXV0aFJhdGVMaW1pdCIsIndpdGhFbnRlcnByaXNlUmF0ZUxpbWl0Iiwid2l0aEVudGVycHJpc2VSYXRlTGltaXRBUEkiLCJ3aXRoUGF5bWVudFJhdGVMaW1pdCIsIndpdGhQdWJsaWNSYXRlTGltaXQiLCJ3aXRoV2ViaG9va1JhdGVMaW1pdCIsIm9wdGlvbnMiLCJoYW5kbGVyIiwicmVxdWVzdCIsImFyZ3MiLCJza2lwSWYiLCJyYXRlTGltaXRSZXN1bHQiLCJjaGVja0VudGVycHJpc2VSYXRlTGltaXQiLCJjb25maWdOYW1lIiwiY3VzdG9tQ29uZmlnIiwiYWxsb3dlZCIsImVudGVycHJpc2VBdWRpdFN5c3RlbSIsImxvZ0VudGVycHJpc2VFdmVudCIsInVzZXJfaWQiLCJoZWFkZXJzIiwiZ2V0IiwiZXZlbnRfdHlwZSIsImV2ZW50X2NhdGVnb3J5Iiwic2V2ZXJpdHkiLCJkZXNjcmlwdGlvbiIsIm5leHRVcmwiLCJwYXRobmFtZSIsIm1ldGFkYXRhIiwiZW5kcG9pbnQiLCJtZXRob2QiLCJjb25maWciLCJsaW1pdCIsInJlbWFpbmluZyIsInNvdXJjZSIsImlwX2FkZHJlc3MiLCJ1c2VyX2FnZW50IiwidW5kZWZpbmVkIiwiYXVkaXRFcnJvciIsImNvbnNvbGUiLCJlcnJvciIsIm9uTGltaXRFeGNlZWRlZCIsImVuYWJsZUxvZ2dpbmciLCJ3YXJuIiwiaXAiLCJ1c2VyQWdlbnQiLCJyZXNldFRpbWUiLCJEYXRlIiwidG9JU09TdHJpbmciLCJyZXNwb25zZSIsIk5leHRSZXNwb25zZSIsImpzb24iLCJFTlRFUlBSSVNFX1JBVEVfTElNSVRfQ09ORklHUyIsIm1lc3NhZ2UiLCJjb2RlIiwiZGV0YWlscyIsInJldHJ5QWZ0ZXIiLCJlbnRlcnByaXNlIiwidGltZXN0YW1wIiwic3RhdHVzIiwiYWRkUmF0ZUxpbWl0SGVhZGVycyIsInJlcSIsInJlcyIsImFkZFJhdGVMaW1pdEhlYWRlcnNBUEkiLCJ1cmwiLCJjb25uZWN0aW9uIiwicmVtb3RlQWRkcmVzcyIsImVudGVycHJpc2VDb250ZXh0IiwiZmluYWxDb25maWdOYW1lIiwicm9sZSIsInBlcm1pc3Npb25zIiwiaW5jbHVkZXMiLCJzZWN1cml0eUxldmVsIiwibWF4UmVxdWVzdHMiLCJNYXRoIiwiZmxvb3IiLCJrZXlHZW5lcmF0b3IiLCJ1c2VySWQiLCJnZXRFbmRwb2ludCIsInJlc3VsdCIsInN1Y2Nlc3MiLCJzZXQiLCJ0b1N0cmluZyIsImNlaWwiLCJtZXRyaWNzIiwicmVzcG9uc2VUaW1lIiwic2V0SGVhZGVyIiwiVVJMIiwibWV0cmljc0NvbGxlY3RvciIsImdldE1ldHJpY3MiLCJyZXNldCJdLCJtYXBwaW5ncyI6IkFBQUE7OztDQUdDOzs7Ozs7Ozs7OztRQWlPcUJBO2VBQUFBOztRQTBKTkM7ZUFBQUE7O1FBT0FDO2VBQUFBOztRQS9CSEM7ZUFBQUE7O1FBTkFDO2VBQUFBOztRQWxUR0M7ZUFBQUE7O1FBNEdBQztlQUFBQTs7UUFrTkhDO2VBQUFBOztRQU1BQztlQUFBQTs7UUFNQUM7ZUFBQUE7Ozt3QkFuWDZCO3VDQVFuQzt1Q0FFK0I7QUErQi9CLFNBQVNKLHdCQUF3QkssT0FBbUM7SUFDekUsT0FBTyxTQUNMQyxPQUFtRjtRQUVuRixPQUFPLE9BQU9DLFNBQXNCLEdBQUdDO1lBQ3JDLElBQUk7Z0JBQ0YsOENBQThDO2dCQUM5QyxJQUFJSCxRQUFRSSxNQUFNLElBQUlKLFFBQVFJLE1BQU0sQ0FBQ0YsVUFBVTtvQkFDN0MsT0FBTyxNQUFNRCxRQUFRQyxZQUFZQztnQkFDbkM7Z0JBRUEsdUJBQXVCO2dCQUN2QixN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