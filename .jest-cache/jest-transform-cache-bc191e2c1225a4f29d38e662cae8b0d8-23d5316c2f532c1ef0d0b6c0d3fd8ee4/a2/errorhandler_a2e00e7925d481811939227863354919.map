{"version":3,"names":["cov_2eanr1h61t","actualCoverage","s","ApiError","f","ConflictError","ForbiddenError","NotFoundError","UnauthorizedError","ValidationError","withErrorHandler","Error","constructor","message","statusCode","b","code","details","name","handler","request","context","error","console","_server","NextResponse","json","success","timestamp","Date","toISOString","path","url","status","resource"],"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\lib\\api\\error-handler.ts"],"sourcesContent":["// ðŸ”§ Enterprise Error Handler\r\n\r\nimport { NextRequest, NextResponse } from 'next/server';\r\n\r\nexport class ApiError extends Error {\r\n  constructor(\r\n    message: string,\r\n    public statusCode: number = 500,\r\n    public code: string = 'INTERNAL_ERROR',\r\n    public details?: any\r\n  ) {\r\n    super(message);\r\n    this.name = 'ApiError';\r\n  }\r\n}\r\n\r\nexport function withErrorHandler(handler: Function) {\r\n  return async function (request: NextRequest, context: any) {\r\n    try {\r\n      return await handler(request, context);\r\n    } catch (error) {\r\n      console.error('API Error:', error);\r\n\r\n      if (error instanceof ApiError) {\r\n        return NextResponse.json(\r\n          {\r\n            success: false,\r\n            error: error.message,\r\n            code: error.code,\r\n            details: error.details,\r\n            timestamp: new Date().toISOString(),\r\n            path: request.url\r\n          },\r\n          { status: error.statusCode }\r\n        );\r\n      }\r\n\r\n      // Error no controlado\r\n      return NextResponse.json(\r\n        {\r\n          success: false,\r\n          error: 'Error interno del servidor',\r\n          code: 'INTERNAL_ERROR',\r\n          timestamp: new Date().toISOString(),\r\n          path: request.url\r\n        },\r\n        { status: 500 }\r\n      );\r\n    }\r\n  };\r\n}\r\n\r\n// Errores especÃ­ficos\r\nexport const NotFoundError = (resource: string) => \r\n  new ApiError(`${resource} no encontrado`, 404, 'NOT_FOUND');\r\n\r\nexport const ValidationError = (message: string, details?: any) => \r\n  new ApiError(message, 422, 'VALIDATION_ERROR', details);\r\n\r\nexport const UnauthorizedError = (message: string = 'No autorizado') => \r\n  new ApiError(message, 401, 'UNAUTHORIZED');\r\n\r\nexport const ForbiddenError = (message: string = 'Sin permisos') => \r\n  new ApiError(message, 403, 'FORBIDDEN');\r\n\r\nexport const ConflictError = (message: string, details?: any) => \r\n  new ApiError(message, 409, 'CONFLICT', details);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]}