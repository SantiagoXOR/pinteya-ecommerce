{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\hooks\\useCheckout.ts"],"sourcesContent":["'use client'\n\nimport { useState, useCallback, useEffect, useMemo } from 'react'\nimport { useAppDispatch, useAppSelector } from '@/redux/store'\nimport {\n  selectCartItems,\n  selectTotalPrice,\n  removeAllItemsFromCart,\n} from '@/redux/features/cart-slice'\nimport {\n  CheckoutFormData,\n  CheckoutState,\n  CreatePreferencePayload,\n  PaymentPreferenceResponse,\n} from '@/types/checkout'\nimport { ApiResponse } from '@/types/api'\nimport { useAuth } from './useAuth'\nimport { validateEmail, validatePhoneNumber, validateDNI } from '@/lib/utils/consolidated-utils'\n\nconst initialFormData: CheckoutFormData = {\n  billing: {\n    firstName: '',\n    lastName: '',\n    dni: '',\n    companyName: '',\n    country: 'Argentina',\n    streetAddress: '',\n    apartment: '',\n    city: '',\n    state: '',\n    zipCode: '',\n    phone: '',\n    email: '',\n    orderNotes: '',\n    observations: '',\n  },\n  shipping: {\n    differentAddress: false,\n  },\n  paymentMethod: 'mercadopago',\n  shippingMethod: 'free',\n  couponCode: '',\n}\n\nexport const useCheckout = () => {\n  const dispatch = useAppDispatch()\n  const cartItems = useAppSelector(selectCartItems)\n  const totalPrice = useAppSelector(selectTotalPrice)\n  const { user, isLoaded } = useAuth()\n\n  const [checkoutState, setCheckoutState] = useState<CheckoutState>({\n    formData: initialFormData,\n    isLoading: false,\n    errors: {},\n    step: 'form',\n    preferenceId: undefined,\n    initPoint: undefined,\n  })\n\n  // Estado para cupones\n  const [appliedCoupon, setAppliedCoupon] = useState<{\n    code: string\n    discount: number\n    type: 'percentage' | 'fixed'\n  } | null>(null)\n\n  // ===================================\n  // AUTO-COMPLETAR DATOS DEL USUARIO AUTENTICADO\n  // ===================================\n  useEffect(() => {\n    if (isLoaded && user) {\n      const userEmail = user.email || ''\n      const fullName = user.name || ''\n      const [firstName, ...lastNameParts] = fullName.split(' ')\n      const lastName = lastNameParts.join(' ')\n\n      // Solo actualizar si los datos han cambiado para evitar recursión\n      setCheckoutState(prev => {\n        const currentBilling = prev.formData.billing\n\n        // Verificar si realmente necesitamos actualizar\n        const shouldUpdateFirstName = !currentBilling.firstName && firstName\n        const shouldUpdateLastName = !currentBilling.lastName && lastName\n        const shouldUpdateEmail = !currentBilling.email && userEmail\n\n        if (!shouldUpdateFirstName && !shouldUpdateLastName && !shouldUpdateEmail) {\n          return prev\n        }\n\n        return {\n          ...prev,\n          formData: {\n            ...prev.formData,\n            billing: {\n              ...currentBilling,\n              firstName: shouldUpdateFirstName ? firstName : currentBilling.firstName,\n              lastName: shouldUpdateLastName ? lastName : currentBilling.lastName,\n              email: shouldUpdateEmail ? userEmail : currentBilling.email,\n            },\n          },\n        }\n      })\n    }\n  }, [isLoaded, user?.email, user?.name])\n\n  // ===================================\n  // FUNCIONES DE CÁLCULO\n  // ===================================\n  const calculateShippingCost = useCallback(() => {\n    const { shippingMethod } = checkoutState.formData\n\n    switch (shippingMethod) {\n      case 'free':\n        return 0\n      case 'standard':\n        return totalPrice > 50000 ? 0 : 5000 // Envío gratis por compras mayores a $50,000\n      case 'express':\n        return 8000\n      default:\n        return 0\n    }\n  }, [checkoutState.formData.shippingMethod, totalPrice])\n\n  const calculateDiscount = useCallback(() => {\n    if (!appliedCoupon) {\n      return 0\n    }\n\n    if (appliedCoupon.type === 'percentage') {\n      return Math.round((totalPrice * appliedCoupon.discount) / 100)\n    } else {\n      return appliedCoupon.discount\n    }\n  }, [appliedCoupon, totalPrice])\n\n  const calculateTotal = useCallback(() => {\n    const shipping = calculateShippingCost()\n    const discount = calculateDiscount()\n    const total = Math.max(0, totalPrice + shipping - discount)\n    console.log('🔍 calculateTotal:', { totalPrice, shipping, discount, total })\n    return total\n  }, [totalPrice, calculateShippingCost, calculateDiscount])\n\n  // Actualizar datos del formulario\n  const updateFormData = useCallback((updates: Partial<CheckoutFormData>) => {\n    setCheckoutState(prev => ({\n      ...prev,\n      formData: { ...prev.formData, ...updates },\n      errors: {}, // Limpiar errores al actualizar\n    }))\n  }, [])\n\n  // Actualizar datos de facturación\n  const updateBillingData = useCallback((billingData: Partial<CheckoutFormData['billing']>) => {\n    setCheckoutState(prev => ({\n      ...prev,\n      formData: {\n        ...prev.formData,\n        billing: { ...prev.formData.billing, ...billingData },\n      },\n      errors: {}, // Limpiar errores al actualizar\n    }))\n  }, [])\n\n  // Actualizar datos de envío\n  const updateShippingData = useCallback((shippingData: Partial<CheckoutFormData['shipping']>) => {\n    setCheckoutState(prev => ({\n      ...prev,\n      formData: {\n        ...prev.formData,\n        shipping: { ...prev.formData.shipping, ...shippingData },\n      },\n      errors: {}, // Limpiar errores al actualizar\n    }))\n  }, [])\n\n  // Aplicar cupón de descuento\n  const applyCoupon = useCallback(async (couponCode: string) => {\n    if (!couponCode.trim()) {\n      setCheckoutState(prev => ({\n        ...prev,\n        errors: { ...prev.errors, coupon: 'Ingresa un código de cupón' },\n      }))\n      return\n    }\n\n    try {\n      // Simular validación de cupón (aquí iría la llamada a la API)\n      const validCoupons = {\n        DESCUENTO10: { discount: 10, type: 'percentage' as const },\n        ENVIOGRATIS: { discount: 5000, type: 'fixed' as const },\n        BIENVENIDO: { discount: 15, type: 'percentage' as const },\n      }\n\n      const coupon = validCoupons[couponCode.toUpperCase() as keyof typeof validCoupons]\n\n      if (coupon) {\n        setAppliedCoupon({\n          code: couponCode.toUpperCase(),\n          ...coupon,\n        })\n        setCheckoutState(prev => ({\n          ...prev,\n          formData: { ...prev.formData, couponCode: couponCode.toUpperCase() },\n          errors: { ...prev.errors, coupon: undefined },\n        }))\n      } else {\n        setCheckoutState(prev => ({\n          ...prev,\n          errors: { ...prev.errors, coupon: 'Código de cupón inválido' },\n        }))\n      }\n    } catch (error) {\n      setCheckoutState(prev => ({\n        ...prev,\n        errors: { ...prev.errors, coupon: 'Error validando el cupón' },\n      }))\n    }\n  }, [])\n\n  // ===================================\n  // FUNCIONES DE VALIDACIÓN\n  // ===================================\n\n  // Validar formulario completo\n  const validateForm = useCallback(() => {\n    const { billing, shipping } = checkoutState.formData\n    const errors: Record<string, string> = {}\n\n    // Validaciones básicas\n    if (!billing.firstName?.trim()) {\n      errors.firstName = 'Nombre es requerido'\n    }\n    if (!billing.lastName?.trim()) {\n      errors.lastName = 'Apellido es requerido'\n    }\n    if (!billing.email?.trim()) {\n      errors.email = 'Email es requerido'\n    }\n    if (!billing.phone?.trim()) {\n      errors.phone = 'Teléfono es requerido'\n    }\n    if (!billing.streetAddress?.trim()) {\n      errors.streetAddress = 'Dirección es requerida'\n    }\n    if (!billing.city?.trim()) {\n      errors.city = 'Ciudad es requerida'\n    }\n    if (!billing.state?.trim()) {\n      errors.state = 'Provincia es requerida'\n    }\n    if (!billing.zipCode?.trim()) {\n      errors.zipCode = 'Código postal es requerido'\n    }\n\n    // Validaciones avanzadas\n    if (billing.email && !validateEmail(billing.email)) {\n      errors.email = 'Email inválido'\n    }\n\n    if (billing.phone && !validatePhoneNumber(billing.phone)) {\n      errors.phone = 'Teléfono inválido. Formato: +54 351 XXX XXXX'\n    }\n\n    if (billing.streetAddress && billing.streetAddress.length < 10) {\n      errors.streetAddress = 'La dirección debe tener al menos 10 caracteres'\n    }\n\n    // Validar código postal argentino (formato XXXX o AXXXX)\n    if (billing.zipCode && !/^[A-Z]?\\d{4}$/.test(billing.zipCode.toUpperCase())) {\n      errors.zipCode = 'Código postal inválido'\n    }\n\n    // Validar envío si es dirección diferente\n    if (shipping.differentAddress) {\n      if (!shipping.streetAddress?.trim()) {\n        errors.shippingStreetAddress = 'Dirección de envío es requerida'\n      }\n      if (!shipping.city?.trim()) {\n        errors.shippingCity = 'Ciudad de envío es requerida'\n      }\n      if (!shipping.state?.trim()) {\n        errors.shippingState = 'Provincia de envío es requerida'\n      }\n      if (!shipping.zipCode?.trim()) {\n        errors.shippingZipCode = 'Código postal de envío es requerido'\n      }\n\n      if (shipping.zipCode && !/^[A-Z]?\\d{4}$/.test(shipping.zipCode.toUpperCase())) {\n        errors.shippingZipCode = 'Código postal de envío inválido'\n      }\n    }\n\n    // Validar que hay items en el carrito\n    if (cartItems.length === 0) {\n      errors.cart = 'El carrito está vacío'\n    }\n\n    setCheckoutState(prev => ({ ...prev, errors }))\n    return Object.keys(errors).length === 0\n  }, [cartItems.length])\n\n  // Validar formulario express (solo campos esenciales)\n  const validateExpressForm = useCallback(() => {\n    const { billing } = checkoutState.formData\n    const errors: Record<string, string> = {}\n\n    console.log('🔍 validateExpressForm - Datos del formulario:', {\n      firstName: billing.firstName,\n      lastName: billing.lastName,\n      dni: billing.dni,\n      email: billing.email,\n      phone: billing.phone,\n      streetAddress: billing.streetAddress,\n      paymentMethod: checkoutState.formData.paymentMethod,\n      cartItemsLength: cartItems.length,\n      currentStep: checkoutState.step, // ✅ NUEVO: Agregar step actual\n    })\n\n    // Validaciones esenciales para checkout express\n    if (!billing.firstName?.trim()) {\n      errors.firstName = 'Nombre es requerido'\n    }\n    if (!billing.lastName?.trim()) {\n      errors.lastName = 'Apellido es requerido'\n    }\n    if (!billing.dni?.trim()) {\n      errors.dni = 'DNI/CUIT es requerido'\n    }\n    if (!billing.email?.trim()) {\n      errors.email = 'Email es requerido'\n    }\n    if (!billing.phone?.trim()) {\n      errors.phone = 'Teléfono es requerido'\n    }\n    if (!billing.streetAddress?.trim()) {\n      errors.streetAddress = 'Dirección es requerida'\n    }\n\n    // Validaciones avanzadas\n    if (billing.email && !validateEmail(billing.email)) {\n      errors.email = 'Email inválido'\n    }\n\n    if (billing.phone && !validatePhoneNumber(billing.phone)) {\n      errors.phone = 'Teléfono inválido. Formato: +54 351 XXX XXXX'\n    }\n\n    // Validación de DNI/CUIT argentino\n    if (billing.dni && !validateDNI(billing.dni)) {\n      errors.dni = 'DNI/CUIT inválido. Formato: 12345678 o 20-12345678-9'\n    }\n\n    // Validar método de pago\n    if (!checkoutState.formData.paymentMethod) {\n      errors.paymentMethod = 'Método de pago es requerido'\n    }\n\n    // ✅ NUEVO: Solo validar carrito si NO estamos en el step de pago\n    // Durante el step 'payment', el carrito ya se vació pero es normal\n    if (checkoutState.step !== 'payment' && cartItems.length === 0) {\n      errors.cart = 'El carrito está vacío'\n    }\n\n    console.log('🔍 validateExpressForm - Errores encontrados:', errors)\n    console.log('🔍 validateExpressForm - Formulario válido:', Object.keys(errors).length === 0)\n\n    setCheckoutState(prev => ({ ...prev, errors }))\n    return Object.keys(errors).length === 0\n  }, [checkoutState.formData, checkoutState.step, cartItems.length]) // ✅ NUEVO: Agregar step a dependencias\n\n  // ===================================\n  // FUNCIONES DE PROCESAMIENTO\n  // ===================================\n\n  // Procesar checkout express\n  const processExpressCheckout = useCallback(async (): Promise<void> => {\n    if (!validateExpressForm()) {\n      return\n    }\n\n    // Marcar que el checkout está en progreso\n    sessionStorage.setItem('checkout-in-progress', 'true')\n\n    setCheckoutState(prev => ({ ...prev, isLoading: true, step: 'processing' }))\n\n    try {\n      const { billing } = checkoutState.formData\n      const shippingCost = calculateShippingCost()\n\n      // Sanitizar teléfono para el backend (solo números, formato argentino 10-11 dígitos)\n      let sanitizedPhone = billing.phone?.replace(/\\D/g, '') || ''\n\n      // Si empieza con 54 (código de Argentina), remover el código de país\n      if (sanitizedPhone.startsWith('54') && sanitizedPhone.length > 11) {\n        sanitizedPhone = sanitizedPhone.substring(2) // Remover \"54\"\n      }\n\n      // Si empieza con 9 (código de celular), mantenerlo para que sea 11 dígitos\n      // Si no empieza con 9, debería ser 10 dígitos (teléfono fijo)\n\n      console.log('🔍 processExpressCheckout - Teléfono original:', billing.phone)\n      console.log('🔍 processExpressCheckout - Teléfono sanitizado:', sanitizedPhone)\n      console.log('🔍 processExpressCheckout - Longitud del teléfono:', sanitizedPhone.length)\n\n      // Preparar datos para la API (Express Checkout - campos simplificados)\n      const payload: CreatePreferencePayload = {\n        items: cartItems.map((item: any) => ({\n          id: item.id.toString(),\n          name: item.title,\n          price: item.discountedPrice,\n          quantity: item.quantity,\n          image: item.imgs?.previews?.[0] || '',\n        })),\n        payer: {\n          name: billing.firstName || 'Cliente', // Valor por defecto para express checkout\n          surname: billing.lastName || 'Express', // Valor por defecto para express checkout\n          email: billing.email,\n          phone: sanitizedPhone, // Teléfono sanitizado (solo números)\n        },\n        shipping:\n          shippingCost > 0\n            ? {\n                cost: shippingCost,\n                address: {\n                  street_name: billing.streetAddress,\n                  street_number: '123', // Número por defecto\n                  zip_code: billing.zipCode || '5000', // Código postal por defecto para Córdoba\n                  city_name: billing.city || 'Córdoba',\n                  state_name: billing.state || 'Córdoba',\n                },\n              }\n            : undefined,\n        external_reference: `express_checkout_${Date.now()}`,\n      }\n\n      console.log('🔍 processExpressCheckout - Payload enviado:', payload)\n\n      // Llamar a la API\n      const response = await fetch('/api/payments/create-preference', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(payload),\n      })\n\n      const result: ApiResponse<PaymentPreferenceResponse> = await response.json()\n\n      if (!result.success) {\n        throw new Error(result.error || 'Error procesando el pago')\n      }\n\n      // ✅ SOLUCIÓN FINAL: Redirección directa a MercadoPago\n      // Esto evita el problema de hooks con el Wallet Brick embebido\n      console.log('🔄 Redirigiendo directamente a MercadoPago:', result.data.init_point)\n\n      // Cambiar a estado de redirección inmediatamente\n      setCheckoutState(prev => ({\n        ...prev,\n        step: 'redirect',\n        preferenceId: result.data.preference_id,\n        initPoint: result.data.init_point,\n        isLoading: false,\n      }))\n    } catch (error: unknown) {\n      const errorMessage = error instanceof Error ? error.message : 'Error procesando el pago'\n      console.error('Error en express checkout:', error)\n      setCheckoutState(prev => ({\n        ...prev,\n        isLoading: false,\n        step: 'form',\n        errors: { general: errorMessage },\n      }))\n    }\n  }, [checkoutState.formData, cartItems, validateExpressForm, calculateShippingCost, dispatch])\n\n  // Procesar checkout completo\n  const processCheckout = useCallback(async (): Promise<void> => {\n    if (!validateForm()) {\n      return\n    }\n\n    // Marcar que el checkout está en progreso\n    sessionStorage.setItem('checkout-in-progress', 'true')\n\n    setCheckoutState(prev => ({ ...prev, isLoading: true, step: 'processing' }))\n\n    try {\n      const { billing, shipping } = checkoutState.formData\n      const shippingCost = calculateShippingCost()\n\n      // Preparar datos para la API\n      const payload: CreatePreferencePayload = {\n        items: cartItems.map((item: any) => ({\n          id: item.id.toString(),\n          name: item.title,\n          price: item.discountedPrice,\n          quantity: item.quantity,\n          image: item.imgs?.previews?.[0] || '',\n        })),\n        payer: {\n          name: billing.firstName,\n          surname: billing.lastName,\n          email: billing.email,\n          phone: billing.phone,\n        },\n        shipping:\n          shippingCost > 0\n            ? {\n                cost: shippingCost,\n                address: {\n                  street_name: shipping.differentAddress\n                    ? shipping.streetAddress!\n                    : billing.streetAddress,\n                  street_number: '123', // Número por defecto como string\n                  zip_code: shipping.differentAddress ? shipping.zipCode! : billing.zipCode,\n                  city_name: shipping.differentAddress ? shipping.city! : billing.city,\n                  state_name: shipping.differentAddress ? shipping.state! : billing.state,\n                },\n              }\n            : undefined,\n        external_reference: `checkout_${Date.now()}`,\n      }\n\n      // Llamar a la API\n      const response = await fetch('/api/payments/create-preference', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(payload),\n      })\n\n      const result: ApiResponse<PaymentPreferenceResponse> = await response.json()\n\n      if (!result.success) {\n        throw new Error(result.error || 'Error procesando el pago')\n      }\n\n      // Procesar resultado exitoso - mostrar paso de pago manual\n      // NOTA: No limpiar el carrito aquí, se limpiará cuando el pago se complete exitosamente\n\n      // ✅ CORREGIDO: Ir directamente a redirect para evitar error de hooks con MercadoPagoWallet\n      console.log('🔄 Redirigiendo directamente a MercadoPago:', result.data.init_point)\n\n      setCheckoutState(prev => ({\n        ...prev,\n        step: 'redirect',\n        preferenceId: result.data.preference_id,\n        initPoint: result.data.init_point,\n        isLoading: false,\n      }))\n    } catch (error: unknown) {\n      const errorMessage = error instanceof Error ? error.message : 'Error procesando el pago'\n      console.error('Error en checkout:', error)\n      setCheckoutState(prev => ({\n        ...prev,\n        isLoading: false,\n        step: 'form',\n        errors: { general: errorMessage },\n      }))\n    }\n  }, [checkoutState.formData, cartItems, validateForm, calculateShippingCost, dispatch])\n\n  // ===================================\n  // CALLBACKS PARA WALLET BRICK\n  // ===================================\n  const handleWalletReady = useCallback(() => {\n    console.log('Wallet Brick está listo')\n  }, [])\n\n  const handleWalletError = useCallback((error: any) => {\n    console.error('Error en Wallet Brick:', error)\n    setCheckoutState(prev => ({\n      ...prev,\n      errors: { payment: error.message || 'Error en el sistema de pagos' },\n      isLoading: false,\n    }))\n  }, [])\n\n  const handleWalletSubmit = useCallback((data: any) => {\n    console.log('💳 Wallet Submit - Pago enviado desde Wallet Brick:', data)\n    console.log('💳 Wallet Submit - Cambiando a step redirect')\n\n    // IMPORTANTE: NO limpiar el carrito aquí\n    // El carrito se limpiará solo cuando el pago sea confirmado como exitoso\n    setCheckoutState(prev => ({\n      ...prev,\n      step: 'redirect',\n      isLoading: false,\n    }))\n  }, [])\n\n  // Memorizar valores calculados para evitar recursión infinita\n  const memoizedShippingCost = useMemo(() => {\n    try {\n      const cost = calculateShippingCost()\n      return typeof cost === 'number' && !isNaN(cost) ? cost : 0\n    } catch (error) {\n      console.error('❌ Error calculating shippingCost:', error)\n      return 0\n    }\n  }, [calculateShippingCost])\n\n  const memoizedDiscount = useMemo(() => {\n    try {\n      const disc = calculateDiscount()\n      return typeof disc === 'number' && !isNaN(disc) ? disc : 0\n    } catch (error) {\n      console.error('❌ Error calculating discount:', error)\n      return 0\n    }\n  }, [calculateDiscount])\n\n  const memoizedFinalTotal = useMemo(() => {\n    try {\n      const total = calculateTotal()\n      return typeof total === 'number' && !isNaN(total) ? total : 0\n    } catch (error) {\n      console.error('❌ Error calculating finalTotal:', error)\n      return 0\n    }\n  }, [calculateTotal])\n\n  return {\n    // Estado\n    formData: checkoutState.formData,\n    isLoading: checkoutState.isLoading,\n    errors: checkoutState.errors,\n    step: checkoutState.step,\n\n    // Datos para Wallet Brick\n    preferenceId: checkoutState.preferenceId,\n    initPoint: checkoutState.initPoint,\n\n    // Datos calculados\n    cartItems,\n    totalPrice,\n    shippingCost: memoizedShippingCost,\n    discount: memoizedDiscount,\n    finalTotal: memoizedFinalTotal,\n\n    // Cupones\n    appliedCoupon,\n    applyCoupon,\n\n    // Acciones\n    updateFormData,\n    updateBillingData,\n    updateShippingData,\n    validateForm,\n    validateExpressForm,\n    processCheckout,\n    processExpressCheckout,\n\n    // Callbacks para Wallet Brick\n    handleWalletReady,\n    handleWalletError,\n    handleWalletSubmit,\n  }\n}\n"],"names":["useCheckout","initialFormData","billing","firstName","lastName","dni","companyName","country","streetAddress","apartment","city","state","zipCode","phone","email","orderNotes","observations","shipping","differentAddress","paymentMethod","shippingMethod","couponCode","dispatch","useAppDispatch","cartItems","useAppSelector","selectCartItems","totalPrice","selectTotalPrice","user","isLoaded","useAuth","checkoutState","setCheckoutState","useState","formData","isLoading","errors","step","preferenceId","undefined","initPoint","appliedCoupon","setAppliedCoupon","useEffect","userEmail","fullName","name","lastNameParts","split","join","prev","currentBilling","shouldUpdateFirstName","shouldUpdateLastName","shouldUpdateEmail","calculateShippingCost","useCallback","calculateDiscount","type","Math","round","discount","calculateTotal","total","max","console","log","updateFormData","updates","updateBillingData","billingData","updateShippingData","shippingData","applyCoupon","trim","coupon","validCoupons","DESCUENTO10","ENVIOGRATIS","BIENVENIDO","toUpperCase","code","error","validateForm","validateEmail","validatePhoneNumber","length","test","shippingStreetAddress","shippingCity","shippingState","shippingZipCode","cart","Object","keys","validateExpressForm","cartItemsLength","currentStep","validateDNI","processExpressCheckout","sessionStorage","setItem","shippingCost","sanitizedPhone","replace","startsWith","substring","payload","items","map","item","id","toString","title","price","discountedPrice","quantity","image","imgs","previews","payer","surname","cost","address","street_name","street_number","zip_code","city_name","state_name","external_reference","Date","now","response","fetch","method","headers","body","JSON","stringify","result","json","success","Error","data","init_point","preference_id","errorMessage","message","general","processCheckout","handleWalletReady","handleWalletError","payment","handleWalletSubmit","memoizedShippingCost","useMemo","isNaN","memoizedDiscount","disc","memoizedFinalTotal","finalTotal"],"mappings":"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"}