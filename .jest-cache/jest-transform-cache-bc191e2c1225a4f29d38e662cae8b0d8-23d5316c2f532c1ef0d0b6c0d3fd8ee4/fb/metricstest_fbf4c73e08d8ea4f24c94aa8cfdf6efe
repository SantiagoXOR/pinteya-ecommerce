df5b1391f640e6df85f31c7b6dcc51ff
// ===================================
// PINTEYA E-COMMERCE - METRICS TESTS
// ===================================
"use strict";
// Mock Redis
jest.mock('@/lib/redis', ()=>({
        redisCache: {
            incr: jest.fn(),
            expire: jest.fn(),
            get: jest.fn(),
            client: {
                lpush: jest.fn(),
                ltrim: jest.fn(),
                expire: jest.fn(),
                lrange: jest.fn()
            }
        }
    }));
// Mock logger
jest.mock('@/lib/enterprise/logger', ()=>({
        logger: {
            debug: jest.fn(),
            info: jest.fn(),
            warn: jest.fn(),
            error: jest.fn()
        },
        LogLevel: {
            DEBUG: 'debug',
            INFO: 'info',
            WARN: 'warn',
            ERROR: 'error'
        },
        LogCategory: {
            SYSTEM: 'system'
        }
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _metrics = require("../../lib/enterprise/metrics");
describe('MetricsCollector', ()=>{
    beforeEach(()=>{
        jest.clearAllMocks();
    });
    describe('Singleton Pattern', ()=>{
        it('should return the same instance', ()=>{
            const instance1 = _metrics.MetricsCollector.getInstance();
            const instance2 = _metrics.MetricsCollector.getInstance();
            expect(instance1).toBe(instance2);
            expect(instance1).toBe(_metrics.metricsCollector);
        });
    });
    describe('recordRequest', ()=>{
        it('should record successful request metrics', async ()=>{
            const { redisCache } = require('@/lib/redis');
            await _metrics.metricsCollector.recordRequest('create-preference', 'POST', 200, 1500, {
                clientIP: '192.168.1.1'
            });
            // Verificar que se registraron las métricas correctas
            expect(redisCache.incr).toHaveBeenCalledWith(expect.stringContaining('metrics:create-preference:POST:requests:total'));
            expect(redisCache.incr).toHaveBeenCalledWith(expect.stringContaining('metrics:create-preference:POST:requests:success'));
            expect(redisCache.client.lpush).toHaveBeenCalledWith(expect.stringContaining('metrics:create-preference:POST:response_time'), '1500');
        });
        it('should record error request metrics', async ()=>{
            const { redisCache } = require('@/lib/redis');
            await _metrics.metricsCollector.recordRequest('create-preference', 'POST', 500, 2000);
            expect(redisCache.incr).toHaveBeenCalledWith(expect.stringContaining('metrics:create-preference:POST:requests:total'));
            expect(redisCache.incr).toHaveBeenCalledWith(expect.stringContaining('metrics:create-preference:POST:requests:error'));
            expect(redisCache.incr).toHaveBeenCalledWith(expect.stringContaining('metrics:create-preference:POST:errors:5xx'));
        });
        it('should record rate limited request metrics', async ()=>{
            const { redisCache } = require('@/lib/redis');
            await _metrics.metricsCollector.recordRequest('webhook', 'POST', 429, 500);
            expect(redisCache.incr).toHaveBeenCalledWith(expect.stringContaining('metrics:webhook:POST:requests:total'));
            expect(redisCache.incr).toHaveBeenCalledWith(expect.stringContaining('metrics:webhook:POST:requests:rate_limited'));
        });
        it('should categorize 4xx errors correctly', async ()=>{
            const { redisCache } = require('@/lib/redis');
            await _metrics.metricsCollector.recordRequest('create-preference', 'POST', 400, 300);
            expect(redisCache.incr).toHaveBeenCalledWith(expect.stringContaining('metrics:create-preference:POST:errors:4xx'));
        });
        it('should handle errors gracefully', async ()=>{
            const { redisCache } = require('@/lib/redis');
            const { logger } = require('@/lib/enterprise/logger');
            redisCache.incr.mockRejectedValue(new Error('Redis error'));
            // No debería lanzar error
            await expect(_metrics.metricsCollector.recordRequest('test-endpoint', 'GET', 200, 1000)).resolves.not.toThrow();
            expect(logger.error).toHaveBeenCalled();
        });
    });
    describe('recordRetry', ()=>{
        it('should record successful retry metrics without errors', async ()=>{
            await expect(_metrics.metricsCollector.recordRetry('createPaymentPreference', 3, true, 5000)).resolves.not.toThrow();
        });
        it('should record failed retry metrics without errors', async ()=>{
            await expect(_metrics.metricsCollector.recordRetry('getPaymentInfo', 2, false, 3000)).resolves.not.toThrow();
        });
    });
    describe('recordRateLimit', ()=>{
        it('should record rate limit metrics without errors', async ()=>{
            await expect(_metrics.metricsCollector.recordRateLimit('create-preference', false, 8, 10)).resolves.not.toThrow();
        });
        it('should record blocked rate limit metrics without errors', async ()=>{
            await expect(_metrics.metricsCollector.recordRateLimit('webhook', true, 0, 100)).resolves.not.toThrow();
        });
    });
    describe('getApiMetrics', ()=>{
        it('should return empty metrics when no data available', async ()=>{
            const { redisCache } = require('@/lib/redis');
            // Mock empty responses
            redisCache.get.mockResolvedValue(null);
            redisCache.client.lrange.mockResolvedValue([]);
            const metrics = await _metrics.metricsCollector.getApiMetrics('test-endpoint', 'GET', 1);
            expect(metrics).toEqual({
                requests: {
                    total: 0,
                    success: 0,
                    error: 0,
                    rate_limited: 0
                },
                response_times: {
                    count: 0,
                    sum: 0,
                    avg: 0,
                    min: 0,
                    max: 0,
                    p95: 0,
                    p99: 0
                },
                error_rates: {
                    '4xx': 0,
                    '5xx': 0,
                    network: 0,
                    timeout: 0
                },
                retry_stats: {
                    total_retries: 0,
                    successful_retries: 0,
                    failed_retries: 0,
                    avg_attempts: 0
                }
            });
        });
        it('should aggregate metrics correctly', async ()=>{
            const { redisCache } = require('@/lib/redis');
            // Mock counter data
            redisCache.get.mockImplementation((key)=>{
                if (key.includes('total')) {
                    return '100';
                }
                if (key.includes('success')) {
                    return '95';
                }
                if (key.includes('error')) {
                    return '5';
                }
                return '0';
            });
            // Mock response time data
            redisCache.client.lrange.mockResolvedValue([
                '1000',
                '1500',
                '2000',
                '800',
                '1200'
            ]);
            const metrics = await _metrics.metricsCollector.getApiMetrics('test-endpoint', 'GET', 1);
            expect(metrics.requests.total).toBeGreaterThan(0);
            expect(metrics.requests.success).toBeGreaterThan(0);
            expect(metrics.response_times.count).toBeGreaterThan(0);
            expect(metrics.response_times.avg).toBeGreaterThan(0);
        });
        it('should handle errors gracefully and return empty metrics', async ()=>{
            const { redisCache } = require('@/lib/redis');
            const { logger } = require('@/lib/enterprise/logger');
            redisCache.get.mockRejectedValue(new Error('Redis error'));
            const metrics = await _metrics.metricsCollector.getApiMetrics('test-endpoint', 'GET', 1);
            expect(logger.error).toHaveBeenCalled();
            expect(metrics.requests.total).toBe(0);
        });
    });
    describe('Window Key Generation', ()=>{
        it('should generate consistent window keys', ()=>{
            const collector = new _metrics.MetricsCollector();
            const timestamp1 = 1640995200000; // 2022-01-01 00:00:00
            const timestamp2 = 1640995260000; // 2022-01-01 00:01:00 (same window)
            const timestamp3 = 1640995500000; // 2022-01-01 00:05:00 (next window)
            const key1 = collector.getWindowKey('test:metric', timestamp1);
            const key2 = collector.getWindowKey('test:metric', timestamp2);
            const key3 = collector.getWindowKey('test:metric', timestamp3);
            expect(key1).toBe(key2); // Same 5-minute window
            expect(key1).not.toBe(key3); // Different window
        });
    });
    describe('Value Statistics', ()=>{
        it('should calculate percentiles correctly', async ()=>{
            const collector = _metrics.metricsCollector;
            const { redisCache } = require('@/lib/redis');
            // Mock response times: [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000]
            const values = Array.from({
                length: 10
            }, (_, i)=>((i + 1) * 100).toString());
            // Mock para que solo devuelva valores una vez
            redisCache.client.lrange.mockResolvedValueOnce(values).mockResolvedValue([]);
            const stats = await collector.getValueStats('test:response_time', 0, Date.now());
            expect(stats.count).toBe(10);
            expect(stats.min).toBe(100);
            expect(stats.max).toBe(1000);
            expect(stats.avg).toBe(550);
            expect(stats.p95).toBeGreaterThan(900); // 95th percentile
            expect(stats.p99).toBeGreaterThan(950); // 99th percentile
        });
        it('should handle empty value arrays', async ()=>{
            const collector = _metrics.metricsCollector;
            const { redisCache } = require('@/lib/redis');
            redisCache.client.lrange.mockResolvedValue([]);
            const stats = await collector.getValueStats('test:response_time', 0, Date.now());
            expect(stats).toEqual({
                count: 0,
                sum: 0,
                avg: 0,
                min: 0,
                max: 0,
                p95: 0,
                p99: 0
            });
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcX190ZXN0c19fXFxsaWJcXG1ldHJpY3MudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQSU5URVlBIEUtQ09NTUVSQ0UgLSBNRVRSSUNTIFRFU1RTXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5pbXBvcnQgeyBNZXRyaWNzQ29sbGVjdG9yLCBtZXRyaWNzQ29sbGVjdG9yIH0gZnJvbSAnQC9saWIvZW50ZXJwcmlzZS9tZXRyaWNzJztcclxuXHJcbi8vIE1vY2sgUmVkaXNcclxuamVzdC5tb2NrKCdAL2xpYi9yZWRpcycsICgpID0+ICh7XHJcbiAgcmVkaXNDYWNoZToge1xyXG4gICAgaW5jcjogamVzdC5mbigpLFxyXG4gICAgZXhwaXJlOiBqZXN0LmZuKCksXHJcbiAgICBnZXQ6IGplc3QuZm4oKSxcclxuICAgIGNsaWVudDoge1xyXG4gICAgICBscHVzaDogamVzdC5mbigpLFxyXG4gICAgICBsdHJpbTogamVzdC5mbigpLFxyXG4gICAgICBleHBpcmU6IGplc3QuZm4oKSxcclxuICAgICAgbHJhbmdlOiBqZXN0LmZuKCksXHJcbiAgICB9LFxyXG4gIH0sXHJcbn0pKTtcclxuXHJcbi8vIE1vY2sgbG9nZ2VyXHJcbmplc3QubW9jaygnQC9saWIvZW50ZXJwcmlzZS9sb2dnZXInLCAoKSA9PiAoe1xyXG4gIGxvZ2dlcjoge1xyXG4gICAgZGVidWc6IGplc3QuZm4oKSxcclxuICAgIGluZm86IGplc3QuZm4oKSxcclxuICAgIHdhcm46IGplc3QuZm4oKSxcclxuICAgIGVycm9yOiBqZXN0LmZuKCksXHJcbiAgfSxcclxuICBMb2dMZXZlbDoge1xyXG4gICAgREVCVUc6ICdkZWJ1ZycsXHJcbiAgICBJTkZPOiAnaW5mbycsXHJcbiAgICBXQVJOOiAnd2FybicsXHJcbiAgICBFUlJPUjogJ2Vycm9yJyxcclxuICB9LFxyXG4gIExvZ0NhdGVnb3J5OiB7XHJcbiAgICBTWVNURU06ICdzeXN0ZW0nLFxyXG4gIH0sXHJcbn0pKTtcclxuXHJcbmRlc2NyaWJlKCdNZXRyaWNzQ29sbGVjdG9yJywgKCkgPT4ge1xyXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdTaW5nbGV0b24gUGF0dGVybicsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgcmV0dXJuIHRoZSBzYW1lIGluc3RhbmNlJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBpbnN0YW5jZTEgPSBNZXRyaWNzQ29sbGVjdG9yLmdldEluc3RhbmNlKCk7XHJcbiAgICAgIGNvbnN0IGluc3RhbmNlMiA9IE1ldHJpY3NDb2xsZWN0b3IuZ2V0SW5zdGFuY2UoKTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChpbnN0YW5jZTEpLnRvQmUoaW5zdGFuY2UyKTtcclxuICAgICAgZXhwZWN0KGluc3RhbmNlMSkudG9CZShtZXRyaWNzQ29sbGVjdG9yKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgncmVjb3JkUmVxdWVzdCcsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgcmVjb3JkIHN1Y2Nlc3NmdWwgcmVxdWVzdCBtZXRyaWNzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCB7IHJlZGlzQ2FjaGUgfSA9IHJlcXVpcmUoJ0AvbGliL3JlZGlzJyk7XHJcbiAgICAgIFxyXG4gICAgICBhd2FpdCBtZXRyaWNzQ29sbGVjdG9yLnJlY29yZFJlcXVlc3QoXHJcbiAgICAgICAgJ2NyZWF0ZS1wcmVmZXJlbmNlJyxcclxuICAgICAgICAnUE9TVCcsXHJcbiAgICAgICAgMjAwLFxyXG4gICAgICAgIDE1MDAsXHJcbiAgICAgICAgeyBjbGllbnRJUDogJzE5Mi4xNjguMS4xJyB9XHJcbiAgICAgICk7XHJcblxyXG4gICAgICAvLyBWZXJpZmljYXIgcXVlIHNlIHJlZ2lzdHJhcm9uIGxhcyBtw6l0cmljYXMgY29ycmVjdGFzXHJcbiAgICAgIGV4cGVjdChyZWRpc0NhY2hlLmluY3IpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxyXG4gICAgICAgIGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdtZXRyaWNzOmNyZWF0ZS1wcmVmZXJlbmNlOlBPU1Q6cmVxdWVzdHM6dG90YWwnKVxyXG4gICAgICApO1xyXG4gICAgICBleHBlY3QocmVkaXNDYWNoZS5pbmNyKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcclxuICAgICAgICBleHBlY3Quc3RyaW5nQ29udGFpbmluZygnbWV0cmljczpjcmVhdGUtcHJlZmVyZW5jZTpQT1NUOnJlcXVlc3RzOnN1Y2Nlc3MnKVxyXG4gICAgICApO1xyXG4gICAgICBleHBlY3QocmVkaXNDYWNoZS5jbGllbnQubHB1c2gpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxyXG4gICAgICAgIGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdtZXRyaWNzOmNyZWF0ZS1wcmVmZXJlbmNlOlBPU1Q6cmVzcG9uc2VfdGltZScpLFxyXG4gICAgICAgICcxNTAwJ1xyXG4gICAgICApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCByZWNvcmQgZXJyb3IgcmVxdWVzdCBtZXRyaWNzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCB7IHJlZGlzQ2FjaGUgfSA9IHJlcXVpcmUoJ0AvbGliL3JlZGlzJyk7XHJcbiAgICAgIFxyXG4gICAgICBhd2FpdCBtZXRyaWNzQ29sbGVjdG9yLnJlY29yZFJlcXVlc3QoXHJcbiAgICAgICAgJ2NyZWF0ZS1wcmVmZXJlbmNlJyxcclxuICAgICAgICAnUE9TVCcsXHJcbiAgICAgICAgNTAwLFxyXG4gICAgICAgIDIwMDBcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGV4cGVjdChyZWRpc0NhY2hlLmluY3IpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxyXG4gICAgICAgIGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdtZXRyaWNzOmNyZWF0ZS1wcmVmZXJlbmNlOlBPU1Q6cmVxdWVzdHM6dG90YWwnKVxyXG4gICAgICApO1xyXG4gICAgICBleHBlY3QocmVkaXNDYWNoZS5pbmNyKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcclxuICAgICAgICBleHBlY3Quc3RyaW5nQ29udGFpbmluZygnbWV0cmljczpjcmVhdGUtcHJlZmVyZW5jZTpQT1NUOnJlcXVlc3RzOmVycm9yJylcclxuICAgICAgKTtcclxuICAgICAgZXhwZWN0KHJlZGlzQ2FjaGUuaW5jcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoXHJcbiAgICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ21ldHJpY3M6Y3JlYXRlLXByZWZlcmVuY2U6UE9TVDplcnJvcnM6NXh4JylcclxuICAgICAgKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmVjb3JkIHJhdGUgbGltaXRlZCByZXF1ZXN0IG1ldHJpY3MnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHsgcmVkaXNDYWNoZSB9ID0gcmVxdWlyZSgnQC9saWIvcmVkaXMnKTtcclxuICAgICAgXHJcbiAgICAgIGF3YWl0IG1ldHJpY3NDb2xsZWN0b3IucmVjb3JkUmVxdWVzdChcclxuICAgICAgICAnd2ViaG9vaycsXHJcbiAgICAgICAgJ1BPU1QnLFxyXG4gICAgICAgIDQyOSxcclxuICAgICAgICA1MDBcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGV4cGVjdChyZWRpc0NhY2hlLmluY3IpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxyXG4gICAgICAgIGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdtZXRyaWNzOndlYmhvb2s6UE9TVDpyZXF1ZXN0czp0b3RhbCcpXHJcbiAgICAgICk7XHJcbiAgICAgIGV4cGVjdChyZWRpc0NhY2hlLmluY3IpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxyXG4gICAgICAgIGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdtZXRyaWNzOndlYmhvb2s6UE9TVDpyZXF1ZXN0czpyYXRlX2xpbWl0ZWQnKVxyXG4gICAgICApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBjYXRlZ29yaXplIDR4eCBlcnJvcnMgY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCB7IHJlZGlzQ2FjaGUgfSA9IHJlcXVpcmUoJ0AvbGliL3JlZGlzJyk7XHJcbiAgICAgIFxyXG4gICAgICBhd2FpdCBtZXRyaWNzQ29sbGVjdG9yLnJlY29yZFJlcXVlc3QoXHJcbiAgICAgICAgJ2NyZWF0ZS1wcmVmZXJlbmNlJyxcclxuICAgICAgICAnUE9TVCcsXHJcbiAgICAgICAgNDAwLFxyXG4gICAgICAgIDMwMFxyXG4gICAgICApO1xyXG5cclxuICAgICAgZXhwZWN0KHJlZGlzQ2FjaGUuaW5jcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoXHJcbiAgICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ21ldHJpY3M6Y3JlYXRlLXByZWZlcmVuY2U6UE9TVDplcnJvcnM6NHh4JylcclxuICAgICAgKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVycm9ycyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCB7IHJlZGlzQ2FjaGUgfSA9IHJlcXVpcmUoJ0AvbGliL3JlZGlzJyk7XHJcbiAgICAgIGNvbnN0IHsgbG9nZ2VyIH0gPSByZXF1aXJlKCdAL2xpYi9lbnRlcnByaXNlL2xvZ2dlcicpO1xyXG4gICAgICBcclxuICAgICAgcmVkaXNDYWNoZS5pbmNyLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignUmVkaXMgZXJyb3InKSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBObyBkZWJlcsOtYSBsYW56YXIgZXJyb3JcclxuICAgICAgYXdhaXQgZXhwZWN0KG1ldHJpY3NDb2xsZWN0b3IucmVjb3JkUmVxdWVzdChcclxuICAgICAgICAndGVzdC1lbmRwb2ludCcsXHJcbiAgICAgICAgJ0dFVCcsXHJcbiAgICAgICAgMjAwLFxyXG4gICAgICAgIDEwMDBcclxuICAgICAgKSkucmVzb2x2ZXMubm90LnRvVGhyb3coKTtcclxuXHJcbiAgICAgIGV4cGVjdChsb2dnZXIuZXJyb3IpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgncmVjb3JkUmV0cnknLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIHJlY29yZCBzdWNjZXNzZnVsIHJldHJ5IG1ldHJpY3Mgd2l0aG91dCBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGF3YWl0IGV4cGVjdChtZXRyaWNzQ29sbGVjdG9yLnJlY29yZFJldHJ5KFxyXG4gICAgICAgICdjcmVhdGVQYXltZW50UHJlZmVyZW5jZScsXHJcbiAgICAgICAgMyxcclxuICAgICAgICB0cnVlLFxyXG4gICAgICAgIDUwMDBcclxuICAgICAgKSkucmVzb2x2ZXMubm90LnRvVGhyb3coKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmVjb3JkIGZhaWxlZCByZXRyeSBtZXRyaWNzIHdpdGhvdXQgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBhd2FpdCBleHBlY3QobWV0cmljc0NvbGxlY3Rvci5yZWNvcmRSZXRyeShcclxuICAgICAgICAnZ2V0UGF5bWVudEluZm8nLFxyXG4gICAgICAgIDIsXHJcbiAgICAgICAgZmFsc2UsXHJcbiAgICAgICAgMzAwMFxyXG4gICAgICApKS5yZXNvbHZlcy5ub3QudG9UaHJvdygpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdyZWNvcmRSYXRlTGltaXQnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIHJlY29yZCByYXRlIGxpbWl0IG1ldHJpY3Mgd2l0aG91dCBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGF3YWl0IGV4cGVjdChtZXRyaWNzQ29sbGVjdG9yLnJlY29yZFJhdGVMaW1pdChcclxuICAgICAgICAnY3JlYXRlLXByZWZlcmVuY2UnLFxyXG4gICAgICAgIGZhbHNlLFxyXG4gICAgICAgIDgsXHJcbiAgICAgICAgMTBcclxuICAgICAgKSkucmVzb2x2ZXMubm90LnRvVGhyb3coKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmVjb3JkIGJsb2NrZWQgcmF0ZSBsaW1pdCBtZXRyaWNzIHdpdGhvdXQgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBhd2FpdCBleHBlY3QobWV0cmljc0NvbGxlY3Rvci5yZWNvcmRSYXRlTGltaXQoXHJcbiAgICAgICAgJ3dlYmhvb2snLFxyXG4gICAgICAgIHRydWUsXHJcbiAgICAgICAgMCxcclxuICAgICAgICAxMDBcclxuICAgICAgKSkucmVzb2x2ZXMubm90LnRvVGhyb3coKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnZ2V0QXBpTWV0cmljcycsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGVtcHR5IG1ldHJpY3Mgd2hlbiBubyBkYXRhIGF2YWlsYWJsZScsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgeyByZWRpc0NhY2hlIH0gPSByZXF1aXJlKCdAL2xpYi9yZWRpcycpO1xyXG4gICAgICBcclxuICAgICAgLy8gTW9jayBlbXB0eSByZXNwb25zZXNcclxuICAgICAgcmVkaXNDYWNoZS5nZXQubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XHJcbiAgICAgIHJlZGlzQ2FjaGUuY2xpZW50LmxyYW5nZS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBtZXRyaWNzID0gYXdhaXQgbWV0cmljc0NvbGxlY3Rvci5nZXRBcGlNZXRyaWNzKCd0ZXN0LWVuZHBvaW50JywgJ0dFVCcsIDEpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KG1ldHJpY3MpLnRvRXF1YWwoe1xyXG4gICAgICAgIHJlcXVlc3RzOiB7IHRvdGFsOiAwLCBzdWNjZXNzOiAwLCBlcnJvcjogMCwgcmF0ZV9saW1pdGVkOiAwIH0sXHJcbiAgICAgICAgcmVzcG9uc2VfdGltZXM6IHsgY291bnQ6IDAsIHN1bTogMCwgYXZnOiAwLCBtaW46IDAsIG1heDogMCwgcDk1OiAwLCBwOTk6IDAgfSxcclxuICAgICAgICBlcnJvcl9yYXRlczogeyAnNHh4JzogMCwgJzV4eCc6IDAsIG5ldHdvcms6IDAsIHRpbWVvdXQ6IDAgfSxcclxuICAgICAgICByZXRyeV9zdGF0czogeyB0b3RhbF9yZXRyaWVzOiAwLCBzdWNjZXNzZnVsX3JldHJpZXM6IDAsIGZhaWxlZF9yZXRyaWVzOiAwLCBhdmdfYXR0ZW1wdHM6IDAgfSxcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGFnZ3JlZ2F0ZSBtZXRyaWNzIGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgeyByZWRpc0NhY2hlIH0gPSByZXF1aXJlKCdAL2xpYi9yZWRpcycpO1xyXG4gICAgICBcclxuICAgICAgLy8gTW9jayBjb3VudGVyIGRhdGFcclxuICAgICAgcmVkaXNDYWNoZS5nZXQubW9ja0ltcGxlbWVudGF0aW9uKChrZXkpID0+IHtcclxuICAgICAgICBpZiAoa2V5LmluY2x1ZGVzKCd0b3RhbCcpKSB7cmV0dXJuICcxMDAnO31cclxuICAgICAgICBpZiAoa2V5LmluY2x1ZGVzKCdzdWNjZXNzJykpIHtyZXR1cm4gJzk1Jzt9XHJcbiAgICAgICAgaWYgKGtleS5pbmNsdWRlcygnZXJyb3InKSkge3JldHVybiAnNSc7fVxyXG4gICAgICAgIHJldHVybiAnMCc7XHJcbiAgICAgIH0pO1xyXG4gICAgICBcclxuICAgICAgLy8gTW9jayByZXNwb25zZSB0aW1lIGRhdGFcclxuICAgICAgcmVkaXNDYWNoZS5jbGllbnQubHJhbmdlLm1vY2tSZXNvbHZlZFZhbHVlKFsnMTAwMCcsICcxNTAwJywgJzIwMDAnLCAnODAwJywgJzEyMDAnXSk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBtZXRyaWNzID0gYXdhaXQgbWV0cmljc0NvbGxlY3Rvci5nZXRBcGlNZXRyaWNzKCd0ZXN0LWVuZHBvaW50JywgJ0dFVCcsIDEpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KG1ldHJpY3MucmVxdWVzdHMudG90YWwpLnRvQmVHcmVhdGVyVGhhbigwKTtcclxuICAgICAgZXhwZWN0KG1ldHJpY3MucmVxdWVzdHMuc3VjY2VzcykudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG4gICAgICBleHBlY3QobWV0cmljcy5yZXNwb25zZV90aW1lcy5jb3VudCkudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG4gICAgICBleHBlY3QobWV0cmljcy5yZXNwb25zZV90aW1lcy5hdmcpLnRvQmVHcmVhdGVyVGhhbigwKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVycm9ycyBncmFjZWZ1bGx5IGFuZCByZXR1cm4gZW1wdHkgbWV0cmljcycsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgeyByZWRpc0NhY2hlIH0gPSByZXF1aXJlKCdAL2xpYi9yZWRpcycpO1xyXG4gICAgICBjb25zdCB7IGxvZ2dlciB9ID0gcmVxdWlyZSgnQC9saWIvZW50ZXJwcmlzZS9sb2dnZXInKTtcclxuICAgICAgXHJcbiAgICAgIHJlZGlzQ2FjaGUuZ2V0Lm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignUmVkaXMgZXJyb3InKSk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBtZXRyaWNzID0gYXdhaXQgbWV0cmljc0NvbGxlY3Rvci5nZXRBcGlNZXRyaWNzKCd0ZXN0LWVuZHBvaW50JywgJ0dFVCcsIDEpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KGxvZ2dlci5lcnJvcikudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICBleHBlY3QobWV0cmljcy5yZXF1ZXN0cy50b3RhbCkudG9CZSgwKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnV2luZG93IEtleSBHZW5lcmF0aW9uJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSBjb25zaXN0ZW50IHdpbmRvdyBrZXlzJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBjb2xsZWN0b3IgPSBuZXcgKE1ldHJpY3NDb2xsZWN0b3IgYXMgYW55KSgpO1xyXG4gICAgICBjb25zdCB0aW1lc3RhbXAxID0gMTY0MDk5NTIwMDAwMDsgLy8gMjAyMi0wMS0wMSAwMDowMDowMFxyXG4gICAgICBjb25zdCB0aW1lc3RhbXAyID0gMTY0MDk5NTI2MDAwMDsgLy8gMjAyMi0wMS0wMSAwMDowMTowMCAoc2FtZSB3aW5kb3cpXHJcbiAgICAgIGNvbnN0IHRpbWVzdGFtcDMgPSAxNjQwOTk1NTAwMDAwOyAvLyAyMDIyLTAxLTAxIDAwOjA1OjAwIChuZXh0IHdpbmRvdylcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IGtleTEgPSBjb2xsZWN0b3IuZ2V0V2luZG93S2V5KCd0ZXN0Om1ldHJpYycsIHRpbWVzdGFtcDEpO1xyXG4gICAgICBjb25zdCBrZXkyID0gY29sbGVjdG9yLmdldFdpbmRvd0tleSgndGVzdDptZXRyaWMnLCB0aW1lc3RhbXAyKTtcclxuICAgICAgY29uc3Qga2V5MyA9IGNvbGxlY3Rvci5nZXRXaW5kb3dLZXkoJ3Rlc3Q6bWV0cmljJywgdGltZXN0YW1wMyk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3Qoa2V5MSkudG9CZShrZXkyKTsgLy8gU2FtZSA1LW1pbnV0ZSB3aW5kb3dcclxuICAgICAgZXhwZWN0KGtleTEpLm5vdC50b0JlKGtleTMpOyAvLyBEaWZmZXJlbnQgd2luZG93XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ1ZhbHVlIFN0YXRpc3RpY3MnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIGNhbGN1bGF0ZSBwZXJjZW50aWxlcyBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNvbGxlY3RvciA9IG1ldHJpY3NDb2xsZWN0b3IgYXMgYW55O1xyXG4gICAgICBjb25zdCB7IHJlZGlzQ2FjaGUgfSA9IHJlcXVpcmUoJ0AvbGliL3JlZGlzJyk7XHJcblxyXG4gICAgICAvLyBNb2NrIHJlc3BvbnNlIHRpbWVzOiBbMTAwLCAyMDAsIDMwMCwgNDAwLCA1MDAsIDYwMCwgNzAwLCA4MDAsIDkwMCwgMTAwMF1cclxuICAgICAgY29uc3QgdmFsdWVzID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogMTAgfSwgKF8sIGkpID0+ICgoaSArIDEpICogMTAwKS50b1N0cmluZygpKTtcclxuXHJcbiAgICAgIC8vIE1vY2sgcGFyYSBxdWUgc29sbyBkZXZ1ZWx2YSB2YWxvcmVzIHVuYSB2ZXpcclxuICAgICAgcmVkaXNDYWNoZS5jbGllbnQubHJhbmdlLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh2YWx1ZXMpLm1vY2tSZXNvbHZlZFZhbHVlKFtdKTtcclxuXHJcbiAgICAgIGNvbnN0IHN0YXRzID0gYXdhaXQgY29sbGVjdG9yLmdldFZhbHVlU3RhdHMoJ3Rlc3Q6cmVzcG9uc2VfdGltZScsIDAsIERhdGUubm93KCkpO1xyXG5cclxuICAgICAgZXhwZWN0KHN0YXRzLmNvdW50KS50b0JlKDEwKTtcclxuICAgICAgZXhwZWN0KHN0YXRzLm1pbikudG9CZSgxMDApO1xyXG4gICAgICBleHBlY3Qoc3RhdHMubWF4KS50b0JlKDEwMDApO1xyXG4gICAgICBleHBlY3Qoc3RhdHMuYXZnKS50b0JlKDU1MCk7XHJcbiAgICAgIGV4cGVjdChzdGF0cy5wOTUpLnRvQmVHcmVhdGVyVGhhbig5MDApOyAvLyA5NXRoIHBlcmNlbnRpbGVcclxuICAgICAgZXhwZWN0KHN0YXRzLnA5OSkudG9CZUdyZWF0ZXJUaGFuKDk1MCk7IC8vIDk5dGggcGVyY2VudGlsZVxyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgdmFsdWUgYXJyYXlzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBjb2xsZWN0b3IgPSBtZXRyaWNzQ29sbGVjdG9yIGFzIGFueTtcclxuICAgICAgY29uc3QgeyByZWRpc0NhY2hlIH0gPSByZXF1aXJlKCdAL2xpYi9yZWRpcycpO1xyXG4gICAgICBcclxuICAgICAgcmVkaXNDYWNoZS5jbGllbnQubHJhbmdlLm1vY2tSZXNvbHZlZFZhbHVlKFtdKTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHN0YXRzID0gYXdhaXQgY29sbGVjdG9yLmdldFZhbHVlU3RhdHMoJ3Rlc3Q6cmVzcG9uc2VfdGltZScsIDAsIERhdGUubm93KCkpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHN0YXRzKS50b0VxdWFsKHtcclxuICAgICAgICBjb3VudDogMCxcclxuICAgICAgICBzdW06IDAsXHJcbiAgICAgICAgYXZnOiAwLFxyXG4gICAgICAgIG1pbjogMCxcclxuICAgICAgICBtYXg6IDAsXHJcbiAgICAgICAgcDk1OiAwLFxyXG4gICAgICAgIHA5OTogMCxcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufSk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiJdLCJuYW1lcyI6WyJqZXN0IiwibW9jayIsInJlZGlzQ2FjaGUiLCJpbmNyIiwiZm4iLCJleHBpcmUiLCJnZXQiLCJjbGllbnQiLCJscHVzaCIsImx0cmltIiwibHJhbmdlIiwibG9nZ2VyIiwiZGVidWciLCJpbmZvIiwid2FybiIsImVycm9yIiwiTG9nTGV2ZWwiLCJERUJVRyIsIklORk8iLCJXQVJOIiwiRVJST1IiLCJMb2dDYXRlZ29yeSIsIlNZU1RFTSIsImRlc2NyaWJlIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJpdCIsImluc3RhbmNlMSIsIk1ldHJpY3NDb2xsZWN0b3IiLCJnZXRJbnN0YW5jZSIsImluc3RhbmNlMiIsImV4cGVjdCIsInRvQmUiLCJtZXRyaWNzQ29sbGVjdG9yIiwicmVxdWlyZSIsInJlY29yZFJlcXVlc3QiLCJjbGllbnRJUCIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIiwic3RyaW5nQ29udGFpbmluZyIsIm1vY2tSZWplY3RlZFZhbHVlIiwiRXJyb3IiLCJyZXNvbHZlcyIsIm5vdCIsInRvVGhyb3ciLCJ0b0hhdmVCZWVuQ2FsbGVkIiwicmVjb3JkUmV0cnkiLCJyZWNvcmRSYXRlTGltaXQiLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsIm1ldHJpY3MiLCJnZXRBcGlNZXRyaWNzIiwidG9FcXVhbCIsInJlcXVlc3RzIiwidG90YWwiLCJzdWNjZXNzIiwicmF0ZV9saW1pdGVkIiwicmVzcG9uc2VfdGltZXMiLCJjb3VudCIsInN1bSIsImF2ZyIsIm1pbiIsIm1heCIsInA5NSIsInA5OSIsImVycm9yX3JhdGVzIiwibmV0d29yayIsInRpbWVvdXQiLCJyZXRyeV9zdGF0cyIsInRvdGFsX3JldHJpZXMiLCJzdWNjZXNzZnVsX3JldHJpZXMiLCJmYWlsZWRfcmV0cmllcyIsImF2Z19hdHRlbXB0cyIsIm1vY2tJbXBsZW1lbnRhdGlvbiIsImtleSIsImluY2x1ZGVzIiwidG9CZUdyZWF0ZXJUaGFuIiwiY29sbGVjdG9yIiwidGltZXN0YW1wMSIsInRpbWVzdGFtcDIiLCJ0aW1lc3RhbXAzIiwia2V5MSIsImdldFdpbmRvd0tleSIsImtleTIiLCJrZXkzIiwidmFsdWVzIiwiQXJyYXkiLCJmcm9tIiwibGVuZ3RoIiwiXyIsImkiLCJ0b1N0cmluZyIsIm1vY2tSZXNvbHZlZFZhbHVlT25jZSIsInN0YXRzIiwiZ2V0VmFsdWVTdGF0cyIsIkRhdGUiLCJub3ciXSwibWFwcGluZ3MiOiJBQUFBLHNDQUFzQztBQUN0QyxxQ0FBcUM7QUFDckMsc0NBQXNDOztBQUl0QyxhQUFhO0FBQ2JBLEtBQUtDLElBQUksQ0FBQyxlQUFlLElBQU8sQ0FBQTtRQUM5QkMsWUFBWTtZQUNWQyxNQUFNSCxLQUFLSSxFQUFFO1lBQ2JDLFFBQVFMLEtBQUtJLEVBQUU7WUFDZkUsS0FBS04sS0FBS0ksRUFBRTtZQUNaRyxRQUFRO2dCQUNOQyxPQUFPUixLQUFL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