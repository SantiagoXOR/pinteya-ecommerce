{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\__tests__\\components\\ProductItem.test.tsx"],"sourcesContent":["// ===================================\r\n// PINTEYA E-COMMERCE - TESTS PARA PRODUCTITEM COMPONENT\r\n// ===================================\r\n\r\nimport React from 'react';\r\nimport { render, screen, fireEvent, act } from '@testing-library/react';\r\nimport { Provider } from 'react-redux';\r\nimport { configureStore } from '@reduxjs/toolkit';\r\nimport ProductItem from '@/components/Common/ProductItem';\r\nimport cartReducer from '@/redux/features/cart-slice';\r\nimport wishlistReducer from '@/redux/features/wishlist-slice';\r\nimport quickViewReducer from '@/redux/features/quickView-slice';\r\nimport productDetailsReducer from '@/redux/features/product-details';\r\nimport { Product } from '@/types/product';\r\n\r\n// Mock del contexto de modal - Eliminado ya que QuickViewModalContext fue removido\r\n// const mockOpenModal = jest.fn();\r\n// jest.mock('@/app/context/QuickViewModalContext', () => ({\r\n//   useModalContext: () => ({\r\n//     openModal: mockOpenModal,\r\n//   }),\r\n// }));\r\n\r\n// Mock de Next.js Link\r\njest.mock('next/link', () => {\r\n  return ({ children, href }: { children: React.ReactNode; href: string }) => (\r\n    <a href={href}>{children}</a>\r\n  );\r\n});\r\n\r\n// Mock de Next.js Image\r\njest.mock('next/image', () => {\r\n  return ({ src, alt, width, height }: { src: string; alt: string; width: number; height: number }) => (\r\n    <img src={src} alt={alt} width={width} height={height} />\r\n  );\r\n});\r\n\r\n// Producto de prueba\r\nconst mockProduct: Product = {\r\n  id: 1,\r\n  title: 'Pintura Latex Interior Blanco 4L',\r\n  reviews: 25,\r\n  price: 18000,\r\n  discountedPrice: 15000,\r\n  imgs: {\r\n    thumbnails: ['/images/products/pintura-latex-blanco-sm.jpg'],\r\n    previews: ['/images/products/pintura-latex-blanco.jpg'],\r\n  },\r\n};\r\n\r\n// Función helper para renderizar con Redux store\r\nconst renderWithStore = (component: React.ReactElement, initialState = {}) => {\r\n  const store = configureStore({\r\n    reducer: {\r\n      cartReducer,\r\n      wishlistReducer,\r\n      quickViewReducer,\r\n      productDetailsReducer,\r\n    },\r\n    preloadedState: initialState,\r\n  });\r\n\r\n  return render(\r\n    <Provider store={store}>\r\n      {component}\r\n    </Provider>\r\n  );\r\n};\r\n\r\ndescribe('ProductItem Component', () => {\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n  });\r\n\r\n  it('should render product information correctly', async () => {\r\n    await act(async () => {\r\n      renderWithStore(<ProductItem item={mockProduct} />);\r\n    });\r\n\r\n    expect(screen.getByText('Pintura Latex Interior Blanco 4L')).toBeInTheDocument();\r\n    expect(screen.getByText((content, element) => {\r\n      return element?.textContent === '$ 15.000' || content.includes('15.000');\r\n    })).toBeInTheDocument();\r\n    expect(screen.getByText((content, element) => {\r\n      return element?.textContent === '$ 18.000' || content.includes('18.000');\r\n    })).toBeInTheDocument();\r\n\r\n    // Buscar la imagen principal del producto\r\n    const productImage = screen.getByAltText('Pintura Latex Interior Blanco 4L');\r\n    expect(productImage).toHaveAttribute('src', '/images/products/pintura-latex-blanco.jpg');\r\n  });\r\n\r\n  it('should display product image', async () => {\r\n    await act(async () => {\r\n      renderWithStore(<ProductItem item={mockProduct} />);\r\n    });\r\n\r\n    // Buscar la imagen principal del producto por su alt text\r\n    const productImage = screen.getByAltText('Pintura Latex Interior Blanco 4L');\r\n    expect(productImage).toBeInTheDocument();\r\n    expect(productImage).toHaveAttribute('src', '/images/products/pintura-latex-blanco.jpg');\r\n    expect(productImage).toHaveClass('object-contain', 'w-full', 'h-full');\r\n  });\r\n\r\n  it('should show discounted price and original price', async () => {\r\n    await act(async () => {\r\n      renderWithStore(<ProductItem item={mockProduct} />);\r\n    });\r\n\r\n    // Precio con descuento (formateado con puntos)\r\n    expect(screen.getByText((content, element) => {\r\n      return element?.textContent === '$ 15.000' || content.includes('15.000');\r\n    })).toBeInTheDocument();\r\n    // Precio original tachado (formateado con puntos)\r\n    expect(screen.getByText((content, element) => {\r\n      return element?.textContent === '$ 18.000' || content.includes('18.000');\r\n    })).toBeInTheDocument();\r\n  });\r\n\r\n  it('should handle add to cart action', async () => {\r\n    const store = configureStore({\r\n      reducer: {\r\n        cartReducer,\r\n        wishlistReducer,\r\n        quickViewReducer,\r\n        productDetailsReducer,\r\n      },\r\n    });\r\n\r\n    await act(async () => {\r\n      render(\r\n        <Provider store={store}>\r\n          <ProductItem item={mockProduct} />\r\n        </Provider>\r\n      );\r\n    });\r\n\r\n    const addToCartButton = screen.getByText('Agregar al carrito');\r\n    \r\n    await act(async () => {\r\n      fireEvent.click(addToCartButton);\r\n    });\r\n\r\n    // Verificar que el producto se agregó al carrito\r\n    const state = store.getState();\r\n    expect(state.cartReducer.items).toHaveLength(1);\r\n    expect(state.cartReducer.items[0].id).toBe(mockProduct.id);\r\n    expect(state.cartReducer.items[0].quantity).toBe(1);\r\n  });\r\n\r\n  it('should handle add to wishlist action', async () => {\r\n    const store = configureStore({\r\n      reducer: {\r\n        cartReducer,\r\n        wishlistReducer,\r\n        quickViewReducer,\r\n        productDetailsReducer,\r\n      },\r\n    });\r\n\r\n    await act(async () => {\r\n      render(\r\n        <Provider store={store}>\r\n          <ProductItem item={mockProduct} />\r\n        </Provider>\r\n      );\r\n    });\r\n\r\n    // El ProductCard unificado no tiene botón de wishlist visible\r\n    // Solo verifica que el componente se renderiza correctamente\r\n    expect(screen.getByTestId('commercial-product-card')).toBeInTheDocument();\r\n    expect(screen.getByText('Pintura Latex Interior Blanco 4L')).toBeInTheDocument();\r\n  });\r\n\r\n  it('should handle quick view action', async () => {\r\n    const store = configureStore({\r\n      reducer: {\r\n        cartReducer,\r\n        wishlistReducer,\r\n        quickViewReducer,\r\n        productDetailsReducer,\r\n      },\r\n    });\r\n\r\n    await act(async () => {\r\n      render(\r\n        <Provider store={store}>\r\n          <ProductItem item={mockProduct} />\r\n        </Provider>\r\n      );\r\n    });\r\n\r\n    // El ProductCard unificado no tiene botón de quick view visible\r\n    // Solo verifica que el componente se renderiza correctamente\r\n    expect(screen.getByTestId('commercial-product-card')).toBeInTheDocument();\r\n    expect(screen.getByText('Pintura Latex Interior Blanco 4L')).toBeInTheDocument();\r\n  });\r\n\r\n  it('should handle product details navigation', async () => {\r\n    await act(async () => {\r\n      renderWithStore(<ProductItem item={mockProduct} />);\r\n    });\r\n\r\n    const productTitle = screen.getByText('Pintura Latex Interior Blanco 4L');\r\n    \r\n    await act(async () => {\r\n      fireEvent.click(productTitle);\r\n    });\r\n\r\n    // El ProductCard unificado no tiene link directo, solo el botón de agregar al carrito\r\n    const addToCartButton = screen.getByTestId('add-to-cart-btn');\r\n    expect(addToCartButton).toBeInTheDocument();\r\n  });\r\n\r\n  it('should show hover effects on buttons', async () => {\r\n    await act(async () => {\r\n      renderWithStore(<ProductItem item={mockProduct} />);\r\n    });\r\n\r\n    const addToCartButton = screen.getByTestId('add-to-cart-btn');\r\n    expect(addToCartButton).toHaveClass('bg-yellow-400');\r\n\r\n    // El ProductCard unificado no tiene botón de wishlist visible\r\n    expect(addToCartButton).toBeInTheDocument();\r\n  });\r\n\r\n  it('should handle product without discount', async () => {\r\n    const productWithoutDiscount: Product = {\r\n      ...mockProduct,\r\n      discountedPrice: mockProduct.price, // Sin descuento\r\n    };\r\n\r\n    await act(async () => {\r\n      renderWithStore(<ProductItem item={productWithoutDiscount} />);\r\n    });\r\n\r\n    // Solo debería mostrar un precio (sin descuento)\r\n    expect(screen.getByText((content, element) => {\r\n      return element?.textContent === '$ 18.000' || content.includes('18.000');\r\n    })).toBeInTheDocument();\r\n    // No debería haber precio tachado\r\n    expect(screen.queryByText('line-through')).not.toBeInTheDocument();\r\n  });\r\n\r\n  it('should handle missing images gracefully', async () => {\r\n    const productWithoutImages: Product = {\r\n      ...mockProduct,\r\n      imgs: {\r\n        thumbnails: [],\r\n        previews: [],\r\n      },\r\n    };\r\n\r\n    await act(async () => {\r\n      renderWithStore(<ProductItem item={productWithoutImages} />);\r\n    });\r\n\r\n    // El componente debería renderizar sin errores\r\n    expect(screen.getByText('Pintura Latex Interior Blanco 4L')).toBeInTheDocument();\r\n  });\r\n\r\n  it('should have proper accessibility attributes', async () => {\r\n    await act(async () => {\r\n      renderWithStore(<ProductItem item={mockProduct} />);\r\n    });\r\n\r\n    // El ProductCard unificado tiene diferentes atributos de accesibilidad\r\n    const addToCartButton = screen.getByTestId('add-to-cart-btn');\r\n    expect(addToCartButton).toBeInTheDocument();\r\n\r\n    const productCard = screen.getByTestId('commercial-product-card');\r\n    expect(productCard).toBeInTheDocument();\r\n  });\r\n});\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":["jest","mock","children","href","a","src","alt","width","height","img","mockProduct","id","title","reviews","price","discountedPrice","imgs","thumbnails","previews","renderWithStore","component","initialState","store","configureStore","reducer","cartReducer","wishlistReducer","quickViewReducer","productDetailsReducer","preloadedState","render","Provider","describe","beforeEach","clearAllMocks","it","act","ProductItem","item","expect","screen","getByText","toBeInTheDocument","content","element","textContent","includes","productImage","getByAltText","toHaveAttribute","toHaveClass","addToCartButton","fireEvent","click","state","getState","items","toHaveLength","toBe","quantity","getByTestId","productTitle","productWithoutDiscount","queryByText","not","productWithoutImages","productCard"],"mappings":"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"}