{"version":3,"names":["cov_2ofg602dqh","actualCoverage","s","GET","f","runtime","supabaseUrl","process","env","NEXT_PUBLIC_SUPABASE_URL","supabaseServiceKey","SUPABASE_SERVICE_ROLE_KEY","request","console","log","supabase","_supabasejs","createClient","url","URL","page","parseInt","b","searchParams","get","limit","offset","data","products","error","count","from","select","range","order","ascending","message","productsLength","length","_server","NextResponse","json","details","status","transformedProducts","map","product","id","name","price","stock","category_name","categories","total","returned","success","pagination","totalPages","Math","ceil","meta","timestamp","Date","toISOString","api","version","errorDetails","Error","stack","undefined","debug","errorName"],"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\app\\api\\admin\\products-test\\route.ts"],"sourcesContent":["// Configuraci√≥n para Node.js Runtime\r\nexport const runtime = 'nodejs';\r\n\r\nimport { NextRequest, NextResponse } from 'next/server';\r\nimport { createClient } from '@supabase/supabase-js';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY!;\r\n\r\n/**\r\n * GET /api/admin/products-test\r\n * Minimal test API to isolate the authResult issue\r\n */\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    console.log('üß™ Products Test API: Starting...');\r\n\r\n    // Create Supabase client\r\n    const supabase = createClient(supabaseUrl, supabaseServiceKey);\r\n\r\n    // Get query parameters\r\n    const url = new URL(request.url);\r\n    const page = parseInt(url.searchParams.get('page') || '1');\r\n    const limit = parseInt(url.searchParams.get('limit') || '5');\r\n    const offset = (page - 1) * limit;\r\n\r\n    console.log('üß™ Products Test API: Query params', { page, limit, offset });\r\n\r\n    // Simple query\r\n    const { data: products, error, count } = await supabase\r\n      .from('products')\r\n      .select(`\r\n        id,\r\n        name,\r\n        price,\r\n        stock,\r\n        categories (\r\n          name\r\n        )\r\n      `, { count: 'exact' })\r\n      .range(offset, offset + limit - 1)\r\n      .order('created_at', { ascending: false });\r\n\r\n    console.log('üß™ Products Test API: Query result', {\r\n      error: error?.message,\r\n      count,\r\n      productsLength: products?.length\r\n    });\r\n\r\n    if (error) {\r\n      console.error('‚ùå Supabase error:', error);\r\n      return NextResponse.json(\r\n        { \r\n          error: 'Database query failed',\r\n          details: error.message\r\n        },\r\n        { status: 500 }\r\n      );\r\n    }\r\n\r\n    // Transform products\r\n    const transformedProducts = products?.map(product => ({\r\n      id: product.id,\r\n      name: product.name,\r\n      price: product.price,\r\n      stock: product.stock,\r\n      category_name: product.categories?.name || null\r\n    })) || [];\r\n\r\n    console.log('‚úÖ Products Test API: Success', {\r\n      total: count,\r\n      returned: transformedProducts.length\r\n    });\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      message: 'Test API working correctly',\r\n      data: {\r\n        products: transformedProducts,\r\n        total: count || 0,\r\n        pagination: {\r\n          page,\r\n          limit,\r\n          totalPages: Math.ceil((count || 0) / limit)\r\n        }\r\n      },\r\n      meta: {\r\n        timestamp: new Date().toISOString(),\r\n        api: 'products-test',\r\n        version: '1.0.0'\r\n      }\r\n    });\r\n\r\n  } catch (error) {\r\n    console.error('‚ùå Fatal error in products test API:', error);\r\n    \r\n    // Detailed error logging\r\n    const errorDetails = {\r\n      message: error instanceof Error ? error.message : 'Unknown error',\r\n      stack: error instanceof Error ? error.stack : undefined,\r\n      name: error instanceof Error ? error.name : 'UnknownError'\r\n    };\r\n\r\n    console.error('‚ùå Error details:', errorDetails);\r\n\r\n    return NextResponse.json(\r\n      {\r\n        error: 'Internal server error',\r\n        details: errorDetails.message,\r\n        debug: {\r\n          errorName: errorDetails.name,\r\n          timestamp: new Date().toISOString()\r\n        }\r\n      },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]}