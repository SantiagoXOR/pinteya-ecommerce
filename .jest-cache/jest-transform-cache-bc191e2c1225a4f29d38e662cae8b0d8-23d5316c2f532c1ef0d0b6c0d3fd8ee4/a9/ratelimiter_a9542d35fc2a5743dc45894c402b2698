a98a352d5d0a80bf42ac84f1baacce4e
// ===================================
// PINTEYA E-COMMERCE - RATE LIMITING MIDDLEWARE
// ===================================
// Sistema de rate limiting enterprise con configuración flexible
// y logging estructurado para APIs críticas
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get RATE_LIMIT_CONFIGS () {
        return RATE_LIMIT_CONFIGS;
    },
    get checkRateLimit () {
        return checkRateLimit;
    },
    get createRateLimitMiddleware () {
        return createRateLimitMiddleware;
    },
    get createRateLimiter () {
        return createRateLimiter;
    },
    get keyGenerators () {
        return keyGenerators;
    },
    get withRateLimit () {
        return withRateLimit;
    }
});
const _server = require("next/server");
// ===================================
// CONFIGURACIONES PREDEFINIDAS
// ===================================
// Configuraciones base para producción
const PRODUCTION_CONFIGS = {
    public: {
        windowMs: 15 * 60 * 1000,
        maxRequests: 1000,
        message: 'Demasiadas solicitudes. Intente nuevamente en 15 minutos.'
    },
    products: {
        windowMs: 5 * 60 * 1000,
        maxRequests: 200,
        message: 'Límite de consultas de productos excedido. Intente en 5 minutos.'
    },
    search: {
        windowMs: 5 * 60 * 1000,
        maxRequests: 150,
        message: 'Límite de búsquedas excedido. Intente en 5 minutos.'
    }
};
// Configuraciones relajadas para desarrollo
const DEVELOPMENT_CONFIGS = {
    public: {
        windowMs: 15 * 60 * 1000,
        maxRequests: 10000,
        message: 'Demasiadas solicitudes. Intente nuevamente en 15 minutos.'
    },
    products: {
        windowMs: 1 * 60 * 1000,
        maxRequests: 1000,
        message: 'Límite de consultas de productos excedido. Intente en 1 minuto.'
    },
    search: {
        windowMs: 1 * 60 * 1000,
        maxRequests: 500,
        message: 'Límite de búsquedas excedido. Intente en 1 minuto.'
    }
};
// ===================================
// HELPER PARA VERIFICAR SI RATE LIMITING ESTÁ HABILITADO
// ===================================
function isRateLimitingEnabled() {
    // Permitir deshabilitar rate limiting en desarrollo con variable de entorno
    if (process.env.DISABLE_RATE_LIMITING === 'true') {
        return false;
    }
    // En desarrollo, usar rate limiting relajado pero habilitado por defecto
    return true;
}
// Seleccionar configuración según el entorno
const isDevelopment = process.env.NODE_ENV === 'development';
const baseConfigs = isDevelopment ? DEVELOPMENT_CONFIGS : PRODUCTION_CONFIGS;
const RATE_LIMIT_CONFIGS = {
    // APIs públicas - límites generosos
    public: baseConfigs.public,
    // APIs de productos - límites moderados
    products: baseConfigs.products,
    // APIs de búsqueda - límites moderados
    search: baseConfigs.search,
    // APIs de autenticación - límites estrictos
    auth: {
        windowMs: 15 * 60 * 1000,
        maxRequests: isDevelopment ? 100 : 10,
        message: 'Demasiados intentos de autenticación. Intente en 15 minutos.'
    },
    // APIs de admin - límites moderados pero monitoreados
    admin: {
        windowMs: 10 * 60 * 1000,
        maxRequests: isDevelopment ? 1000 : 100,
        message: 'Límite de operaciones administrativas excedido.'
    },
    // APIs de pagos - límites muy estrictos
    payment: {
        windowMs: 15 * 60 * 1000,
        maxRequests: isDevelopment ? 100 : 30,
        message: 'Límite de operaciones de pago excedido. Intente en 15 minutos.'
    },
    // APIs de creación - límites estrictos
    creation: {
        windowMs: 10 * 60 * 1000,
        maxRequests: isDevelopment ? 200 : 20,
        message: 'Límite de creación de recursos excedido.'
    },
    // Webhooks - límites rápidos pero altos
    webhook: {
        windowMs: 1 * 60 * 1000,
        maxRequests: isDevelopment ? 1000 : 100,
        message: 'Límite de webhooks excedido. Intente en 1 minuto.'
    }
};
// ===================================
// LOGGING DE CONFIGURACIÓN
// ===================================
// Log de configuración al cargar el módulo
if (process.env.NODE_ENV === 'development') {
    console.log('[RATE_LIMITER] Configuración cargada:', {
        environment: process.env.NODE_ENV,
        rateLimitingEnabled: isRateLimitingEnabled(),
        disableRateLimiting: process.env.DISABLE_RATE_LIMITING,
        productLimits: {
            windowMs: RATE_LIMIT_CONFIGS.products.windowMs / 1000 / 60 + ' minutos',
            maxRequests: RATE_LIMIT_CONFIGS.products.maxRequests
        },
        searchLimits: {
            windowMs: RATE_LIMIT_CONFIGS.search.windowMs / 1000 / 60 + ' minutos',
            maxRequests: RATE_LIMIT_CONFIGS.search.maxRequests
        }
    });
}
// ===================================
// STORE EN MEMORIA (PARA DESARROLLO)
// ===================================
class MemoryStore {
    async get(key) {
        const data = this.store.get(key);
        if (!data) {
            return null;
        }
        // Limpiar datos expirados
        if (Date.now() > data.resetTime) {
            this.store.delete(key);
            return null;
        }
        return data;
    }
    async set(key, value, ttl) {
        this.store.set(key, value);
        // Limpiar automáticamente después del TTL
        setTimeout(()=>{
            this.store.delete(key);
        }, ttl);
    }
    async increment(key, ttl) {
        const now = Date.now();
        const existing = await this.get(key);
        if (!existing) {
            const newData = {
                count: 1,
                resetTime: now + ttl
            };
            await this.set(key, newData, ttl);
            return newData;
        }
        const updatedData = {
            ...existing,
            count: existing.count + 1
        };
        await this.set(key, updatedData, existing.resetTime - now);
        return updatedData;
    }
    constructor(){
        this.store = new Map();
    }
}
// ===================================
// INSTANCIA GLOBAL DEL STORE
// ===================================
const defaultStore = new MemoryStore();
const keyGenerators = {
    // Por IP
    ip: (req)=>{
        const forwarded = req.headers.get('x-forwarded-for');
        const ip = forwarded ? forwarded.split(',')[0] : req.headers.get('x-real-ip') || 'unknown';
        return `ip:${ip}`;
    },
    // Por usuario autenticado (requiere implementación específica)
    user: (req)=>{
        // TODO: Implementar extracción de user ID desde token/session
        const userId = req.headers.get('x-user-id') || 'anonymous';
        return `user:${userId}`;
    },
    // Por endpoint específico
    endpoint: (req)=>{
        const url = new URL(req.url);
        return `endpoint:${url.pathname}`;
    },
    // Combinado IP + endpoint
    combined: (req)=>{
        const ip = keyGenerators.ip(req);
        const endpoint = keyGenerators.endpoint(req);
        return `${ip}:${endpoint}`;
    }
};
function createRateLimiter(config = {}, store = defaultStore) {
    const finalConfig = {
        windowMs: 15 * 60 * 1000,
        maxRequests: 100,
        message: 'Rate limit exceeded',
        headers: true,
        standardHeaders: true,
        legacyHeaders: true,
        ...config
    };
    return async (req)=>{
        return await checkRateLimit(req, finalConfig, store);
    };
}
async function checkRateLimit(req, config, store = defaultStore) {
    const keyGenerator = config.keyGenerator || keyGenerators.combined;
    const key = keyGenerator(req);
    try {
        const data = await store.increment(key, config.windowMs);
        const result = {
            allowed: data.count <= config.maxRequests,
            limit: config.maxRequests,
            remaining: Math.max(0, config.maxRequests - data.count),
            resetTime: data.resetTime
        };
        if (!result.allowed) {
            result.retryAfter = Math.ceil((data.resetTime - Date.now()) / 1000);
        }
        return result;
    } catch (error) {
        console.error('[RATE_LIMITER] Error checking rate limit:', error);
        // En caso de error, permitir la request (fail-open)
        return {
            allowed: true,
            limit: config.maxRequests,
            remaining: config.maxRequests,
            resetTime: Date.now() + config.windowMs
        };
    }
}
function createRateLimitMiddleware(config) {
    return async (req)=>{
        const result = await checkRateLimit(req, config);
        // Crear headers de rate limit
        const headers = new Headers();
        if (config.headers !== false) {
            if (config.standardHeaders !== false) {
                // Headers estándar RFC 6585
                headers.set('RateLimit-Limit', result.limit.toString());
                headers.set('RateLimit-Remaining', result.remaining.toString());
                headers.set('RateLimit-Reset', new Date(result.resetTime).toISOString());
            }
            if (config.legacyHeaders !== false) {
                // Headers legacy para compatibilidad
                headers.set('X-RateLimit-Limit', result.limit.toString());
                headers.set('X-RateLimit-Remaining', result.remaining.toString());
                headers.set('X-RateLimit-Reset', Math.ceil(result.resetTime / 1000).toString());
            }
        }
        if (!result.allowed) {
            if (result.retryAfter) {
                headers.set('Retry-After', result.retryAfter.toString());
            }
            // Log del rate limit excedido
            console.warn('[RATE_LIMITER] Rate limit exceeded:', {
                key: config.keyGenerator ? config.keyGenerator(req) : 'combined',
                limit: result.limit,
                resetTime: new Date(result.resetTime).toISOString(),
                userAgent: req.headers.get('user-agent'),
                ip: req.headers.get('x-forwarded-for') || req.headers.get('x-real-ip')
            });
            return new _server.NextResponse(JSON.stringify({
                error: 'Rate limit exceeded',
                message: config.message || 'Too many requests',
                retryAfter: result.retryAfter
            }), {
                status: 429,
                headers
            });
        }
        // Request permitida, agregar headers informativos
        return _server.NextResponse.next({
            headers
        });
    };
}
async function withRateLimit(req, config, handler) {
    // Si rate limiting está deshabilitado, ejecutar directamente el handler
    if (!isRateLimitingEnabled()) {
        return await handler();
    }
    const result = await checkRateLimit(req, config);
    if (!result.allowed) {
        // Crear headers de rate limit
        const headers = new Headers();
        if (config.headers !== false) {
            if (config.standardHeaders !== false) {
                // Headers estándar RFC 6585
                headers.set('RateLimit-Limit', result.limit.toString());
                headers.set('RateLimit-Remaining', result.remaining.toString());
                headers.set('RateLimit-Reset', new Date(result.resetTime).toISOString());
            }
            if (config.legacyHeaders !== false) {
                // Headers legacy para compatibilidad
                headers.set('X-RateLimit-Limit', result.limit.toString());
                headers.set('X-RateLimit-Remaining', result.remaining.toString());
                headers.set('X-RateLimit-Reset', Math.ceil(result.resetTime / 1000).toString());
            }
        }
        if (result.retryAfter) {
            headers.set('Retry-After', result.retryAfter.toString());
        }
        // Log del rate limit excedido
        console.warn('[RATE_LIMITER] Rate limit exceeded:', {
            key: config.keyGenerator ? config.keyGenerator(req) : 'combined',
            limit: result.limit,
            resetTime: new Date(result.resetTime).toISOString(),
            userAgent: req.headers.get('user-agent'),
            ip: req.headers.get('x-forwarded-for') || req.headers.get('x-real-ip')
        });
        return new _server.NextResponse(JSON.stringify({
            error: 'Rate limit exceeded',
            message: config.message || 'Too many requests',
            retryAfter: result.retryAfter
        }), {
            status: 429,
            headers
        });
    }
    return handler();
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcbGliXFxyYXRlLWxpbWl0aW5nXFxyYXRlLWxpbWl0ZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUElOVEVZQSBFLUNPTU1FUkNFIC0gUkFURSBMSU1JVElORyBNSURETEVXQVJFXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFNpc3RlbWEgZGUgcmF0ZSBsaW1pdGluZyBlbnRlcnByaXNlIGNvbiBjb25maWd1cmFjacOzbiBmbGV4aWJsZVxyXG4vLyB5IGxvZ2dpbmcgZXN0cnVjdHVyYWRvIHBhcmEgQVBJcyBjcsOtdGljYXNcclxuXHJcbmltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XHJcbmltcG9ydCB7IGhlYWRlcnMgfSBmcm9tICduZXh0L2hlYWRlcnMnO1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gVElQT1MgWSBJTlRFUkZBQ0VTXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFJhdGVMaW1pdENvbmZpZyB7XHJcbiAgd2luZG93TXM6IG51bWJlcjsgICAgICAgICAgIC8vIFZlbnRhbmEgZGUgdGllbXBvIGVuIG1pbGlzZWd1bmRvc1xyXG4gIG1heFJlcXVlc3RzOiBudW1iZXI7ICAgICAgICAvLyBNw6F4aW1vIGRlIHJlcXVlc3RzIHBvciB2ZW50YW5hXHJcbiAga2V5R2VuZXJhdG9yPzogKHJlcTogTmV4dFJlcXVlc3QpID0+IHN0cmluZzsgIC8vIEdlbmVyYWRvciBkZSBjbGF2ZSBwZXJzb25hbGl6YWRvXHJcbiAgc2tpcFN1Y2Nlc3NmdWxSZXF1ZXN0cz86IGJvb2xlYW47ICAgICAgICAgICAgIC8vIE9taXRpciByZXF1ZXN0cyBleGl0b3Nvc1xyXG4gIHNraXBGYWlsZWRSZXF1ZXN0cz86IGJvb2xlYW47ICAgICAgICAgICAgICAgICAvLyBPbWl0aXIgcmVxdWVzdHMgZmFsbGlkb3NcclxuICBtZXNzYWdlPzogc3RyaW5nOyAgICAgICAgICAgLy8gTWVuc2FqZSBkZSBlcnJvciBwZXJzb25hbGl6YWRvXHJcbiAgaGVhZGVycz86IGJvb2xlYW47ICAgICAgICAgIC8vIEluY2x1aXIgaGVhZGVycyBkZSByYXRlIGxpbWl0XHJcbiAgc3RhbmRhcmRIZWFkZXJzPzogYm9vbGVhbjsgIC8vIFVzYXIgaGVhZGVycyBlc3TDoW5kYXIgUkZDXHJcbiAgbGVnYWN5SGVhZGVycz86IGJvb2xlYW47ICAgIC8vIEluY2x1aXIgaGVhZGVycyBsZWdhY3lcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBSYXRlTGltaXRSZXN1bHQge1xyXG4gIGFsbG93ZWQ6IGJvb2xlYW47XHJcbiAgbGltaXQ6IG51bWJlcjtcclxuICByZW1haW5pbmc6IG51bWJlcjtcclxuICByZXNldFRpbWU6IG51bWJlcjtcclxuICByZXRyeUFmdGVyPzogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFJhdGVMaW1pdFN0b3JlIHtcclxuICBnZXQoa2V5OiBzdHJpbmcpOiBQcm9taXNlPHsgY291bnQ6IG51bWJlcjsgcmVzZXRUaW1lOiBudW1iZXIgfSB8IG51bGw+O1xyXG4gIHNldChrZXk6IHN0cmluZywgdmFsdWU6IHsgY291bnQ6IG51bWJlcjsgcmVzZXRUaW1lOiBudW1iZXIgfSwgdHRsOiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+O1xyXG4gIGluY3JlbWVudChrZXk6IHN0cmluZywgdHRsOiBudW1iZXIpOiBQcm9taXNlPHsgY291bnQ6IG51bWJlcjsgcmVzZXRUaW1lOiBudW1iZXIgfT47XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTkZJR1VSQUNJT05FUyBQUkVERUZJTklEQVNcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8vIENvbmZpZ3VyYWNpb25lcyBiYXNlIHBhcmEgcHJvZHVjY2nDs25cclxuY29uc3QgUFJPRFVDVElPTl9DT05GSUdTID0ge1xyXG4gIHB1YmxpYzoge1xyXG4gICAgd2luZG93TXM6IDE1ICogNjAgKiAxMDAwLCAgLy8gMTUgbWludXRvc1xyXG4gICAgbWF4UmVxdWVzdHM6IDEwMDAsICAgICAgICAgLy8gMTAwMCByZXF1ZXN0cyBwb3IgdmVudGFuYVxyXG4gICAgbWVzc2FnZTogJ0RlbWFzaWFkYXMgc29saWNpdHVkZXMuIEludGVudGUgbnVldmFtZW50ZSBlbiAxNSBtaW51dG9zLicsXHJcbiAgfSxcclxuICBwcm9kdWN0czoge1xyXG4gICAgd2luZG93TXM6IDUgKiA2MCAqIDEwMDAsICAgLy8gNSBtaW51dG9zXHJcbiAgICBtYXhSZXF1ZXN0czogMjAwLCAgICAgICAgICAvLyAyMDAgcmVxdWVzdHMgcG9yIHZlbnRhbmFcclxuICAgIG1lc3NhZ2U6ICdMw61taXRlIGRlIGNvbnN1bHRhcyBkZSBwcm9kdWN0b3MgZXhjZWRpZG8uIEludGVudGUgZW4gNSBtaW51dG9zLicsXHJcbiAgfSxcclxuICBzZWFyY2g6IHtcclxuICAgIHdpbmRvd01zOiA1ICogNjAgKiAxMDAwLCAgIC8vIDUgbWludXRvc1xyXG4gICAgbWF4UmVxdWVzdHM6IDE1MCwgICAgICAgICAgLy8gMTUwIHJlcXVlc3RzIHBvciB2ZW50YW5hXHJcbiAgICBtZXNzYWdlOiAnTMOtbWl0ZSBkZSBiw7pzcXVlZGFzIGV4Y2VkaWRvLiBJbnRlbnRlIGVuIDUgbWludXRvcy4nLFxyXG4gIH0sXHJcbn07XHJcblxyXG4vLyBDb25maWd1cmFjaW9uZXMgcmVsYWphZGFzIHBhcmEgZGVzYXJyb2xsb1xyXG5jb25zdCBERVZFTE9QTUVOVF9DT05GSUdTID0ge1xyXG4gIHB1YmxpYzoge1xyXG4gICAgd2luZG93TXM6IDE1ICogNjAgKiAxMDAwLCAgLy8gMTUgbWludXRvc1xyXG4gICAgbWF4UmVxdWVzdHM6IDEwMDAwLCAgICAgICAgLy8gMTAwMDAgcmVxdWVzdHMgcG9yIHZlbnRhbmEgKG11eSBnZW5lcm9zbylcclxuICAgIG1lc3NhZ2U6ICdEZW1hc2lhZGFzIHNvbGljaXR1ZGVzLiBJbnRlbnRlIG51ZXZhbWVudGUgZW4gMTUgbWludXRvcy4nLFxyXG4gIH0sXHJcbiAgcHJvZHVjdHM6IHtcclxuICAgIHdpbmRvd01zOiAxICogNjAgKiAxMDAwLCAgIC8vIDEgbWludXRvXHJcbiAgICBtYXhSZXF1ZXN0czogMTAwMCwgICAgICAgICAvLyAxMDAwIHJlcXVlc3RzIHBvciBtaW51dG8gKG11eSBnZW5lcm9zbylcclxuICAgIG1lc3NhZ2U6ICdMw61taXRlIGRlIGNvbnN1bHRhcyBkZSBwcm9kdWN0b3MgZXhjZWRpZG8uIEludGVudGUgZW4gMSBtaW51dG8uJyxcclxuICB9LFxyXG4gIHNlYXJjaDoge1xyXG4gICAgd2luZG93TXM6IDEgKiA2MCAqIDEwMDAsICAgLy8gMSBtaW51dG9cclxuICAgIG1heFJlcXVlc3RzOiA1MDAsICAgICAgICAgIC8vIDUwMCByZXF1ZXN0cyBwb3IgbWludXRvIChtdXkgZ2VuZXJvc28pXHJcbiAgICBtZXNzYWdlOiAnTMOtbWl0ZSBkZSBiw7pzcXVlZGFzIGV4Y2VkaWRvLiBJbnRlbnRlIGVuIDEgbWludXRvLicsXHJcbiAgfSxcclxufTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEhFTFBFUiBQQVJBIFZFUklGSUNBUiBTSSBSQVRFIExJTUlUSU5HIEVTVMOBIEhBQklMSVRBRE9cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmZ1bmN0aW9uIGlzUmF0ZUxpbWl0aW5nRW5hYmxlZCgpOiBib29sZWFuIHtcclxuICAvLyBQZXJtaXRpciBkZXNoYWJpbGl0YXIgcmF0ZSBsaW1pdGluZyBlbiBkZXNhcnJvbGxvIGNvbiB2YXJpYWJsZSBkZSBlbnRvcm5vXHJcbiAgaWYgKHByb2Nlc3MuZW52LkRJU0FCTEVfUkFURV9MSU1JVElORyA9PT0gJ3RydWUnKSB7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvLyBFbiBkZXNhcnJvbGxvLCB1c2FyIHJhdGUgbGltaXRpbmcgcmVsYWphZG8gcGVybyBoYWJpbGl0YWRvIHBvciBkZWZlY3RvXHJcbiAgcmV0dXJuIHRydWU7XHJcbn1cclxuXHJcbi8vIFNlbGVjY2lvbmFyIGNvbmZpZ3VyYWNpw7NuIHNlZ8O6biBlbCBlbnRvcm5vXHJcbmNvbnN0IGlzRGV2ZWxvcG1lbnQgPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JztcclxuY29uc3QgYmFzZUNvbmZpZ3MgPSBpc0RldmVsb3BtZW50ID8gREVWRUxPUE1FTlRfQ09ORklHUyA6IFBST0RVQ1RJT05fQ09ORklHUztcclxuXHJcbmV4cG9ydCBjb25zdCBSQVRFX0xJTUlUX0NPTkZJR1MgPSB7XHJcbiAgLy8gQVBJcyBww7pibGljYXMgLSBsw61taXRlcyBnZW5lcm9zb3NcclxuICBwdWJsaWM6IGJhc2VDb25maWdzLnB1YmxpYyxcclxuXHJcbiAgLy8gQVBJcyBkZSBwcm9kdWN0b3MgLSBsw61taXRlcyBtb2RlcmFkb3NcclxuICBwcm9kdWN0czogYmFzZUNvbmZpZ3MucHJvZHVjdHMsXHJcblxyXG4gIC8vIEFQSXMgZGUgYsO6c3F1ZWRhIC0gbMOtbWl0ZXMgbW9kZXJhZG9zXHJcbiAgc2VhcmNoOiBiYXNlQ29uZmlncy5zZWFyY2gsXHJcbiAgXHJcbiAgLy8gQVBJcyBkZSBhdXRlbnRpY2FjacOzbiAtIGzDrW1pdGVzIGVzdHJpY3Rvc1xyXG4gIGF1dGg6IHtcclxuICAgIHdpbmRvd01zOiAxNSAqIDYwICogMTAwMCwgIC8vIDE1IG1pbnV0b3NcclxuICAgIG1heFJlcXVlc3RzOiBpc0RldmVsb3BtZW50ID8gMTAwIDogMTAsICAvLyAxMDAgZW4gZGV2LCAxMCBlbiBwcm9kXHJcbiAgICBtZXNzYWdlOiAnRGVtYXNpYWRvcyBpbnRlbnRvcyBkZSBhdXRlbnRpY2FjacOzbi4gSW50ZW50ZSBlbiAxNSBtaW51dG9zLicsXHJcbiAgfSxcclxuXHJcbiAgLy8gQVBJcyBkZSBhZG1pbiAtIGzDrW1pdGVzIG1vZGVyYWRvcyBwZXJvIG1vbml0b3JlYWRvc1xyXG4gIGFkbWluOiB7XHJcbiAgICB3aW5kb3dNczogMTAgKiA2MCAqIDEwMDAsICAvLyAxMCBtaW51dG9zXHJcbiAgICBtYXhSZXF1ZXN0czogaXNEZXZlbG9wbWVudCA/IDEwMDAgOiAxMDAsICAvLyAxMDAwIGVuIGRldiwgMTAwIGVuIHByb2RcclxuICAgIG1lc3NhZ2U6ICdMw61taXRlIGRlIG9wZXJhY2lvbmVzIGFkbWluaXN0cmF0aXZhcyBleGNlZGlkby4nLFxyXG4gIH0sXHJcblxyXG4gIC8vIEFQSXMgZGUgcGFnb3MgLSBsw61taXRlcyBtdXkgZXN0cmljdG9zXHJcbiAgcGF5bWVudDoge1xyXG4gICAgd2luZG93TXM6IDE1ICogNjAgKiAxMDAwLCAgLy8gMTUgbWludXRvc1xyXG4gICAgbWF4UmVxdWVzdHM6IGlzRGV2ZWxvcG1lbnQgPyAxMDAgOiAzMCwgIC8vIDEwMCBlbiBkZXYsIDMwIGVuIHByb2RcclxuICAgIG1lc3NhZ2U6ICdMw61taXRlIGRlIG9wZXJhY2lvbmVzIGRlIHBhZ28gZXhjZWRpZG8uIEludGVudGUgZW4gMTUgbWludXRvcy4nLFxyXG4gIH0sXHJcblxyXG4gIC8vIEFQSXMgZGUgY3JlYWNpw7NuIC0gbMOtbWl0ZXMgZXN0cmljdG9zXHJcbiAgY3JlYXRpb246IHtcclxuICAgIHdpbmRvd01zOiAxMCAqIDYwICogMTAwMCwgIC8vIDEwIG1pbnV0b3NcclxuICAgIG1heFJlcXVlc3RzOiBpc0RldmVsb3BtZW50ID8gMjAwIDogMjAsICAvLyAyMDAgZW4gZGV2LCAyMCBlbiBwcm9kXHJcbiAgICBtZXNzYWdlOiAnTMOtbWl0ZSBkZSBjcmVhY2nDs24gZGUgcmVjdXJzb3MgZXhjZWRpZG8uJyxcclxuICB9LFxyXG5cclxuICAvLyBXZWJob29rcyAtIGzDrW1pdGVzIHLDoXBpZG9zIHBlcm8gYWx0b3NcclxuICB3ZWJob29rOiB7XHJcbiAgICB3aW5kb3dNczogMSAqIDYwICogMTAwMCwgICAvLyAxIG1pbnV0b1xyXG4gICAgbWF4UmVxdWVzdHM6IGlzRGV2ZWxvcG1lbnQgPyAxMDAwIDogMTAwLCAgLy8gMTAwMCBlbiBkZXYsIDEwMCBlbiBwcm9kXHJcbiAgICBtZXNzYWdlOiAnTMOtbWl0ZSBkZSB3ZWJob29rcyBleGNlZGlkby4gSW50ZW50ZSBlbiAxIG1pbnV0by4nLFxyXG4gIH1cclxufSBhcyBjb25zdDtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIExPR0dJTkcgREUgQ09ORklHVVJBQ0nDk05cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8vIExvZyBkZSBjb25maWd1cmFjacOzbiBhbCBjYXJnYXIgZWwgbcOzZHVsb1xyXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcclxuICBjb25zb2xlLmxvZygnW1JBVEVfTElNSVRFUl0gQ29uZmlndXJhY2nDs24gY2FyZ2FkYTonLCB7XHJcbiAgICBlbnZpcm9ubWVudDogcHJvY2Vzcy5lbnYuTk9ERV9FTlYsXHJcbiAgICByYXRlTGltaXRpbmdFbmFibGVkOiBpc1JhdGVMaW1pdGluZ0VuYWJsZWQoKSxcclxuICAgIGRpc2FibGVSYXRlTGltaXRpbmc6IHByb2Nlc3MuZW52LkRJU0FCTEVfUkFURV9MSU1JVElORyxcclxuICAgIHByb2R1Y3RMaW1pdHM6IHtcclxuICAgICAgd2luZG93TXM6IFJBVEVfTElNSVRfQ09ORklHUy5wcm9kdWN0cy53aW5kb3dNcyAvIDEwMDAgLyA2MCArICcgbWludXRvcycsXHJcbiAgICAgIG1heFJlcXVlc3RzOiBSQVRFX0xJTUlUX0NPTkZJR1MucHJvZHVjdHMubWF4UmVxdWVzdHNcclxuICAgIH0sXHJcbiAgICBzZWFyY2hMaW1pdHM6IHtcclxuICAgICAgd2luZG93TXM6IFJBVEVfTElNSVRfQ09ORklHUy5zZWFyY2gud2luZG93TXMgLyAxMDAwIC8gNjAgKyAnIG1pbnV0b3MnLFxyXG4gICAgICBtYXhSZXF1ZXN0czogUkFURV9MSU1JVF9DT05GSUdTLnNlYXJjaC5tYXhSZXF1ZXN0c1xyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBTVE9SRSBFTiBNRU1PUklBIChQQVJBIERFU0FSUk9MTE8pXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5jbGFzcyBNZW1vcnlTdG9yZSBpbXBsZW1lbnRzIFJhdGVMaW1pdFN0b3JlIHtcclxuICBwcml2YXRlIHN0b3JlID0gbmV3IE1hcDxzdHJpbmcsIHsgY291bnQ6IG51bWJlcjsgcmVzZXRUaW1lOiBudW1iZXIgfT4oKTtcclxuXHJcbiAgYXN5bmMgZ2V0KGtleTogc3RyaW5nKTogUHJvbWlzZTx7IGNvdW50OiBudW1iZXI7IHJlc2V0VGltZTogbnVtYmVyIH0gfCBudWxsPiB7XHJcbiAgICBjb25zdCBkYXRhID0gdGhpcy5zdG9yZS5nZXQoa2V5KTtcclxuICAgIGlmICghZGF0YSkge3JldHVybiBudWxsO31cclxuICAgIFxyXG4gICAgLy8gTGltcGlhciBkYXRvcyBleHBpcmFkb3NcclxuICAgIGlmIChEYXRlLm5vdygpID4gZGF0YS5yZXNldFRpbWUpIHtcclxuICAgICAgdGhpcy5zdG9yZS5kZWxldGUoa2V5KTtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBkYXRhO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgc2V0KGtleTogc3RyaW5nLCB2YWx1ZTogeyBjb3VudDogbnVtYmVyOyByZXNldFRpbWU6IG51bWJlciB9LCB0dGw6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgdGhpcy5zdG9yZS5zZXQoa2V5LCB2YWx1ZSk7XHJcbiAgICBcclxuICAgIC8vIExpbXBpYXIgYXV0b23DoXRpY2FtZW50ZSBkZXNwdcOpcyBkZWwgVFRMXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgdGhpcy5zdG9yZS5kZWxldGUoa2V5KTtcclxuICAgIH0sIHR0bCk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBpbmNyZW1lbnQoa2V5OiBzdHJpbmcsIHR0bDogbnVtYmVyKTogUHJvbWlzZTx7IGNvdW50OiBudW1iZXI7IHJlc2V0VGltZTogbnVtYmVyIH0+IHtcclxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgICBjb25zdCBleGlzdGluZyA9IGF3YWl0IHRoaXMuZ2V0KGtleSk7XHJcbiAgICBcclxuICAgIGlmICghZXhpc3RpbmcpIHtcclxuICAgICAgY29uc3QgbmV3RGF0YSA9IHsgY291bnQ6IDEsIHJlc2V0VGltZTogbm93ICsgdHRsIH07XHJcbiAgICAgIGF3YWl0IHRoaXMuc2V0KGtleSwgbmV3RGF0YSwgdHRsKTtcclxuICAgICAgcmV0dXJuIG5ld0RhdGE7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IHVwZGF0ZWREYXRhID0geyAuLi5leGlzdGluZywgY291bnQ6IGV4aXN0aW5nLmNvdW50ICsgMSB9O1xyXG4gICAgYXdhaXQgdGhpcy5zZXQoa2V5LCB1cGRhdGVkRGF0YSwgZXhpc3RpbmcucmVzZXRUaW1lIC0gbm93KTtcclxuICAgIHJldHVybiB1cGRhdGVkRGF0YTtcclxuICB9XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIElOU1RBTkNJQSBHTE9CQUwgREVMIFNUT1JFXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5jb25zdCBkZWZhdWx0U3RvcmUgPSBuZXcgTWVtb3J5U3RvcmUoKTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEdFTkVSQURPUkVTIERFIENMQVZFXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5leHBvcnQgY29uc3Qga2V5R2VuZXJhdG9ycyA9IHtcclxuICAvLyBQb3IgSVBcclxuICBpcDogKHJlcTogTmV4dFJlcXVlc3QpOiBzdHJpbmcgPT4ge1xyXG4gICAgY29uc3QgZm9yd2FyZGVkID0gcmVxLmhlYWRlcnMuZ2V0KCd4LWZvcndhcmRlZC1mb3InKTtcclxuICAgIGNvbnN0IGlwID0gZm9yd2FyZGVkID8gZm9yd2FyZGVkLnNwbGl0KCcsJylbMF0gOiByZXEuaGVhZGVycy5nZXQoJ3gtcmVhbC1pcCcpIHx8ICd1bmtub3duJztcclxuICAgIHJldHVybiBgaXA6JHtpcH1gO1xyXG4gIH0sXHJcbiAgXHJcbiAgLy8gUG9yIHVzdWFyaW8gYXV0ZW50aWNhZG8gKHJlcXVpZXJlIGltcGxlbWVudGFjacOzbiBlc3BlY8OtZmljYSlcclxuICB1c2VyOiAocmVxOiBOZXh0UmVxdWVzdCk6IHN0cmluZyA9PiB7XHJcbiAgICAvLyBUT0RPOiBJbXBsZW1lbnRhciBleHRyYWNjacOzbiBkZSB1c2VyIElEIGRlc2RlIHRva2VuL3Nlc3Npb25cclxuICAgIGNvbnN0IHVzZXJJZCA9IHJlcS5oZWFkZXJzLmdldCgneC11c2VyLWlkJykgfHwgJ2Fub255bW91cyc7XHJcbiAgICByZXR1cm4gYHVzZXI6JHt1c2VySWR9YDtcclxuICB9LFxyXG4gIFxyXG4gIC8vIFBvciBlbmRwb2ludCBlc3BlY8OtZmljb1xyXG4gIGVuZHBvaW50OiAocmVxOiBOZXh0UmVxdWVzdCk6IHN0cmluZyA9PiB7XHJcbiAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcS51cmwpO1xyXG4gICAgcmV0dXJuIGBlbmRwb2ludDoke3VybC5wYXRobmFtZX1gO1xyXG4gIH0sXHJcbiAgXHJcbiAgLy8gQ29tYmluYWRvIElQICsgZW5kcG9pbnRcclxuICBjb21iaW5lZDogKHJlcTogTmV4dFJlcXVlc3QpOiBzdHJpbmcgPT4ge1xyXG4gICAgY29uc3QgaXAgPSBrZXlHZW5lcmF0b3JzLmlwKHJlcSk7XHJcbiAgICBjb25zdCBlbmRwb2ludCA9IGtleUdlbmVyYXRvcnMuZW5kcG9pbnQocmVxKTtcclxuICAgIHJldHVybiBgJHtpcH06JHtlbmRwb2ludH1gO1xyXG4gIH1cclxufTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEZBQ1RPUlkgUEFSQSBDUkVBUiBSQVRFIExJTUlURVJTXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQ3JlYSB1biByYXRlIGxpbWl0ZXIgY29uIGNvbmZpZ3VyYWNpw7NuIGVzcGVjw61maWNhXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUmF0ZUxpbWl0ZXIoXHJcbiAgY29uZmlnOiBQYXJ0aWFsPFJhdGVMaW1pdENvbmZpZz4gPSB7fSxcclxuICBzdG9yZTogUmF0ZUxpbWl0U3RvcmUgPSBkZWZhdWx0U3RvcmVcclxuKSB7XHJcbiAgY29uc3QgZmluYWxDb25maWc6IFJhdGVMaW1pdENvbmZpZyA9IHtcclxuICAgIHdpbmRvd01zOiAxNSAqIDYwICogMTAwMCwgIC8vIDE1IG1pbnV0b3MgcG9yIGRlZmVjdG9cclxuICAgIG1heFJlcXVlc3RzOiAxMDAsICAgICAgICAgIC8vIDEwMCByZXF1ZXN0cyBwb3IgZGVmZWN0b1xyXG4gICAgbWVzc2FnZTogJ1JhdGUgbGltaXQgZXhjZWVkZWQnLFxyXG4gICAgaGVhZGVyczogdHJ1ZSxcclxuICAgIHN0YW5kYXJkSGVhZGVyczogdHJ1ZSxcclxuICAgIGxlZ2FjeUhlYWRlcnM6IHRydWUsXHJcbiAgICAuLi5jb25maWdcclxuICB9O1xyXG5cclxuICByZXR1cm4gYXN5bmMgKHJlcTogTmV4dFJlcXVlc3QpOiBQcm9taXNlPFJhdGVMaW1pdFJlc3VsdD4gPT4ge1xyXG4gICAgcmV0dXJuIGF3YWl0IGNoZWNrUmF0ZUxpbWl0KHJlcSwgZmluYWxDb25maWcsIHN0b3JlKTtcclxuICB9O1xyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBGVU5DScOTTiBQUklOQ0lQQUwgREUgUkFURSBMSU1JVElOR1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNoZWNrUmF0ZUxpbWl0KFxyXG4gIHJlcTogTmV4dFJlcXVlc3QsXHJcbiAgY29uZmlnOiBSYXRlTGltaXRDb25maWcsXHJcbiAgc3RvcmU6IFJhdGVMaW1pdFN0b3JlID0gZGVmYXVsdFN0b3JlXHJcbik6IFByb21pc2U8UmF0ZUxpbWl0UmVzdWx0PiB7XHJcbiAgY29uc3Qga2V5R2VuZXJhdG9yID0gY29uZmlnLmtleUdlbmVyYXRvciB8fCBrZXlHZW5lcmF0b3JzLmNvbWJpbmVkO1xyXG4gIGNvbnN0IGtleSA9IGtleUdlbmVyYXRvcihyZXEpO1xyXG4gIFxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgc3RvcmUuaW5jcmVtZW50KGtleSwgY29uZmlnLndpbmRvd01zKTtcclxuICAgIFxyXG4gICAgY29uc3QgcmVzdWx0OiBSYXRlTGltaXRSZXN1bHQgPSB7XHJcbiAgICAgIGFsbG93ZWQ6IGRhdGEuY291bnQgPD0gY29uZmlnLm1heFJlcXVlc3RzLFxyXG4gICAgICBsaW1pdDogY29uZmlnLm1heFJlcXVlc3RzLFxyXG4gICAgICByZW1haW5pbmc6IE1hdGgubWF4KDAsIGNvbmZpZy5tYXhSZXF1ZXN0cyAtIGRhdGEuY291bnQpLFxyXG4gICAgICByZXNldFRpbWU6IGRhdGEucmVzZXRUaW1lLFxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgaWYgKCFyZXN1bHQuYWxsb3dlZCkge1xyXG4gICAgICByZXN1bHQucmV0cnlBZnRlciA9IE1hdGguY2VpbCgoZGF0YS5yZXNldFRpbWUgLSBEYXRlLm5vdygpKSAvIDEwMDApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbUkFURV9MSU1JVEVSXSBFcnJvciBjaGVja2luZyByYXRlIGxpbWl0OicsIGVycm9yKTtcclxuICAgIFxyXG4gICAgLy8gRW4gY2FzbyBkZSBlcnJvciwgcGVybWl0aXIgbGEgcmVxdWVzdCAoZmFpbC1vcGVuKVxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgYWxsb3dlZDogdHJ1ZSxcclxuICAgICAgbGltaXQ6IGNvbmZpZy5tYXhSZXF1ZXN0cyxcclxuICAgICAgcmVtYWluaW5nOiBjb25maWcubWF4UmVxdWVzdHMsXHJcbiAgICAgIHJlc2V0VGltZTogRGF0ZS5ub3coKSArIGNvbmZpZy53aW5kb3dNcyxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBNSURETEVXQVJFIERFIFJBVEUgTElNSVRJTkdcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVSYXRlTGltaXRNaWRkbGV3YXJlKGNvbmZpZzogUmF0ZUxpbWl0Q29uZmlnKSB7XHJcbiAgcmV0dXJuIGFzeW5jIChyZXE6IE5leHRSZXF1ZXN0KTogUHJvbWlzZTxOZXh0UmVzcG9uc2UgfCBudWxsPiA9PiB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjaGVja1JhdGVMaW1pdChyZXEsIGNvbmZpZyk7XHJcbiAgICBcclxuICAgIC8vIENyZWFyIGhlYWRlcnMgZGUgcmF0ZSBsaW1pdFxyXG4gICAgY29uc3QgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XHJcbiAgICBcclxuICAgIGlmIChjb25maWcuaGVhZGVycyAhPT0gZmFsc2UpIHtcclxuICAgICAgaWYgKGNvbmZpZy5zdGFuZGFyZEhlYWRlcnMgIT09IGZhbHNlKSB7XHJcbiAgICAgICAgLy8gSGVhZGVycyBlc3TDoW5kYXIgUkZDIDY1ODVcclxuICAgICAgICBoZWFkZXJzLnNldCgnUmF0ZUxpbWl0LUxpbWl0JywgcmVzdWx0LmxpbWl0LnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIGhlYWRlcnMuc2V0KCdSYXRlTGltaXQtUmVtYWluaW5nJywgcmVzdWx0LnJlbWFpbmluZy50b1N0cmluZygpKTtcclxuICAgICAgICBoZWFkZXJzLnNldCgnUmF0ZUxpbWl0LVJlc2V0JywgbmV3IERhdGUocmVzdWx0LnJlc2V0VGltZSkudG9JU09TdHJpbmcoKSk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIGlmIChjb25maWcubGVnYWN5SGVhZGVycyAhPT0gZmFsc2UpIHtcclxuICAgICAgICAvLyBIZWFkZXJzIGxlZ2FjeSBwYXJhIGNvbXBhdGliaWxpZGFkXHJcbiAgICAgICAgaGVhZGVycy5zZXQoJ1gtUmF0ZUxpbWl0LUxpbWl0JywgcmVzdWx0LmxpbWl0LnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIGhlYWRlcnMuc2V0KCdYLVJhdGVMaW1pdC1SZW1haW5pbmcnLCByZXN1bHQucmVtYWluaW5nLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIGhlYWRlcnMuc2V0KCdYLVJhdGVMaW1pdC1SZXNldCcsIE1hdGguY2VpbChyZXN1bHQucmVzZXRUaW1lIC8gMTAwMCkudG9TdHJpbmcoKSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKCFyZXN1bHQuYWxsb3dlZCkge1xyXG4gICAgICBpZiAocmVzdWx0LnJldHJ5QWZ0ZXIpIHtcclxuICAgICAgICBoZWFkZXJzLnNldCgnUmV0cnktQWZ0ZXInLCByZXN1bHQucmV0cnlBZnRlci50b1N0cmluZygpKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gTG9nIGRlbCByYXRlIGxpbWl0IGV4Y2VkaWRvXHJcbiAgICAgIGNvbnNvbGUud2FybignW1JBVEVfTElNSVRFUl0gUmF0ZSBsaW1pdCBleGNlZWRlZDonLCB7XHJcbiAgICAgICAga2V5OiBjb25maWcua2V5R2VuZXJhdG9yID8gY29uZmlnLmtleUdlbmVyYXRvcihyZXEpIDogJ2NvbWJpbmVkJyxcclxuICAgICAgICBsaW1pdDogcmVzdWx0LmxpbWl0LFxyXG4gICAgICAgIHJlc2V0VGltZTogbmV3IERhdGUocmVzdWx0LnJlc2V0VGltZSkudG9JU09TdHJpbmcoKSxcclxuICAgICAgICB1c2VyQWdlbnQ6IHJlcS5oZWFkZXJzLmdldCgndXNlci1hZ2VudCcpLFxyXG4gICAgICAgIGlwOiByZXEuaGVhZGVycy5nZXQoJ3gtZm9yd2FyZGVkLWZvcicpIHx8IHJlcS5oZWFkZXJzLmdldCgneC1yZWFsLWlwJyksXHJcbiAgICAgIH0pO1xyXG4gICAgICBcclxuICAgICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UoXHJcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgZXJyb3I6ICdSYXRlIGxpbWl0IGV4Y2VlZGVkJyxcclxuICAgICAgICAgIG1lc3NhZ2U6IGNvbmZpZy5tZXNzYWdlIHx8ICdUb28gbWFueSByZXF1ZXN0cycsXHJcbiAgICAgICAgICByZXRyeUFmdGVyOiByZXN1bHQucmV0cnlBZnRlcixcclxuICAgICAgICB9KSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBzdGF0dXM6IDQyOSxcclxuICAgICAgICAgIGhlYWRlcnMsXHJcbiAgICAgICAgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBSZXF1ZXN0IHBlcm1pdGlkYSwgYWdyZWdhciBoZWFkZXJzIGluZm9ybWF0aXZvc1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KHtcclxuICAgICAgaGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH07XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEhFTFBFUiBQQVJBIEFQTElDQVIgUkFURSBMSU1JVElOR1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHdpdGhSYXRlTGltaXQ8VD4oXHJcbiAgcmVxOiBOZXh0UmVxdWVzdCxcclxuICBjb25maWc6IFJhdGVMaW1pdENvbmZpZyxcclxuICBoYW5kbGVyOiAoKSA9PiBQcm9taXNlPFQ+XHJcbik6IFByb21pc2U8VCB8IE5leHRSZXNwb25zZT4ge1xyXG4gIC8vIFNpIHJhdGUgbGltaXRpbmcgZXN0w6EgZGVzaGFiaWxpdGFkbywgZWplY3V0YXIgZGlyZWN0YW1lbnRlIGVsIGhhbmRsZXJcclxuICBpZiAoIWlzUmF0ZUxpbWl0aW5nRW5hYmxlZCgpKSB7XHJcbiAgICByZXR1cm4gYXdhaXQgaGFuZGxlcigpO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2hlY2tSYXRlTGltaXQocmVxLCBjb25maWcpO1xyXG5cclxuICBpZiAoIXJlc3VsdC5hbGxvd2VkKSB7XHJcbiAgICAvLyBDcmVhciBoZWFkZXJzIGRlIHJhdGUgbGltaXRcclxuICAgIGNvbnN0IGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xyXG5cclxuICAgIGlmIChjb25maWcuaGVhZGVycyAhPT0gZmFsc2UpIHtcclxuICAgICAgaWYgKGNvbmZpZy5zdGFuZGFyZEhlYWRlcnMgIT09IGZhbHNlKSB7XHJcbiAgICAgICAgLy8gSGVhZGVycyBlc3TDoW5kYXIgUkZDIDY1ODVcclxuICAgICAgICBoZWFkZXJzLnNldCgnUmF0ZUxpbWl0LUxpbWl0JywgcmVzdWx0LmxpbWl0LnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIGhlYWRlcnMuc2V0KCdSYXRlTGltaXQtUmVtYWluaW5nJywgcmVzdWx0LnJlbWFpbmluZy50b1N0cmluZygpKTtcclxuICAgICAgICBoZWFkZXJzLnNldCgnUmF0ZUxpbWl0LVJlc2V0JywgbmV3IERhdGUocmVzdWx0LnJlc2V0VGltZSkudG9JU09TdHJpbmcoKSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChjb25maWcubGVnYWN5SGVhZGVycyAhPT0gZmFsc2UpIHtcclxuICAgICAgICAvLyBIZWFkZXJzIGxlZ2FjeSBwYXJhIGNvbXBhdGliaWxpZGFkXHJcbiAgICAgICAgaGVhZGVycy5zZXQoJ1gtUmF0ZUxpbWl0LUxpbWl0JywgcmVzdWx0LmxpbWl0LnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIGhlYWRlcnMuc2V0KCdYLVJhdGVMaW1pdC1SZW1haW5pbmcnLCByZXN1bHQucmVtYWluaW5nLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIGhlYWRlcnMuc2V0KCdYLVJhdGVMaW1pdC1SZXNldCcsIE1hdGguY2VpbChyZXN1bHQucmVzZXRUaW1lIC8gMTAwMCkudG9TdHJpbmcoKSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAocmVzdWx0LnJldHJ5QWZ0ZXIpIHtcclxuICAgICAgaGVhZGVycy5zZXQoJ1JldHJ5LUFmdGVyJywgcmVzdWx0LnJldHJ5QWZ0ZXIudG9TdHJpbmcoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gTG9nIGRlbCByYXRlIGxpbWl0IGV4Y2VkaWRvXHJcbiAgICBjb25zb2xlLndhcm4oJ1tSQVRFX0xJTUlURVJdIFJhdGUgbGltaXQgZXhjZWVkZWQ6Jywge1xyXG4gICAgICBrZXk6IGNvbmZpZy5rZXlHZW5lcmF0b3IgPyBjb25maWcua2V5R2VuZXJhdG9yKHJlcSkgOiAnY29tYmluZWQnLFxyXG4gICAgICBsaW1pdDogcmVzdWx0LmxpbWl0LFxyXG4gICAgICByZXNldFRpbWU6IG5ldyBEYXRlKHJlc3VsdC5yZXNldFRpbWUpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIHVzZXJBZ2VudDogcmVxLmhlYWRlcnMuZ2V0KCd1c2VyLWFnZW50JyksXHJcbiAgICAgIGlwOiByZXEuaGVhZGVycy5nZXQoJ3gtZm9yd2FyZGVkLWZvcicpIHx8IHJlcS5oZWFkZXJzLmdldCgneC1yZWFsLWlwJyksXHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gbmV3IE5leHRSZXNwb25zZShcclxuICAgICAgSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGVycm9yOiAnUmF0ZSBsaW1pdCBleGNlZWRlZCcsXHJcbiAgICAgICAgbWVzc2FnZTogY29uZmlnLm1lc3NhZ2UgfHwgJ1RvbyBtYW55IHJlcXVlc3RzJyxcclxuICAgICAgICByZXRyeUFmdGVyOiByZXN1bHQucmV0cnlBZnRlcixcclxuICAgICAgfSksXHJcbiAgICAgIHtcclxuICAgICAgICBzdGF0dXM6IDQyOSxcclxuICAgICAgICBoZWFkZXJzLFxyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIGhhbmRsZXIoKTtcclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4iXSwibmFtZXMiOlsiUkFURV9MSU1JVF9DT05GSUdTIiwiY2hlY2tSYXRlTGltaXQiLCJjcmVhdGVSYXRlTGltaXRNaWRkbGV3YXJlIiwiY3JlYXRlUmF0ZUxpbWl0ZXIiLCJrZXlHZW5lcmF0b3JzIiwid2l0aFJhdGVMaW1pdCIsIlBST0RVQ1RJT05fQ09ORklHUyIsInB1YmxpYyIsIndpbmRvd01zIiwibWF4UmVxdWVzdHMiLCJtZXNzYWdlIiwicHJvZHVjdHMiLCJzZWFyY2giLCJERVZFTE9QTUVOVF9DT05GSUdTIiwiaXNSYXRlTGltaXRpbmdFbmFibGVkIiwicHJvY2VzcyIsImVudiIsIkRJU0FCTEVfUkFURV9MSU1JVElORyIsImlzRGV2ZWxvcG1lbnQiLCJOT0RFX0VOViIsImJhc2VDb25maWdzIiwiYXV0aCIsImFkbWluIiwicGF5bWVudCIsImNyZWF0aW9uIiwid2ViaG9vayIsImNvbnNvbGUiLCJsb2ciLCJlbnZpcm9ubWVudCIsInJhdGVMaW1pdGluZ0VuYWJsZWQiLCJkaXNhYmxlUmF0ZUxpbWl0aW5nIiwicHJvZHVjdExpbWl0cyIsInNlYXJjaExpbWl0cyIsIk1lbW9yeVN0b3JlIiwiZ2V0Iiwia2V5IiwiZGF0YSIsInN0b3JlIiwiRGF0ZSIsIm5vdyIsInJlc2V0VGltZSIsImRlbGV0ZSIsInNldCIsInZhbHVlIiwidHRsIiwic2V0VGltZW91dCIsImluY3JlbWVudCIsImV4aXN0aW5nIiwibmV3RGF0YSIsImNvdW50IiwidXBkYXRlZERhdGEiLCJNYXAiLCJkZWZhdWx0U3RvcmUiLCJpcCIsInJlcSIsImZvcndhcmRlZCIsImhlYWRlcnMiLCJzcGxpdCIsInVzZXIiLCJ1c2VySWQiLCJlbmRwb2ludCIsInVybCIsIlVSTCIsInBhdGhuYW1lIiwiY29tYmluZWQiLCJjb25maWciLCJmaW5hbENvbmZpZyIsInN0YW5kYXJkSGVhZGVycyIsImxlZ2FjeUhlYWRlcnMiLCJrZXlHZW5lcmF0b3IiLCJyZXN1bHQiLCJhbGxvd2VkIiwibGltaXQiLCJyZW1haW5pbmciLCJNYXRoIiwibWF4IiwicmV0cnlBZnRlciIsImNlaWwiLCJlcnJvciIsIkhlYWRlcnMiLCJ0b1N0cmluZyIsInRvSVNPU3RyaW5nIiwid2FybiIsInVzZXJBZ2VudCIsIk5leHRSZXNwb25zZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJzdGF0dXMiLCJuZXh0IiwiaGFuZGxlciJdLCJtYXBwaW5ncyI6IkFBQUEsc0NBQXNDO0FBQ3RDLGdEQUFnRDtBQUNoRCxzQ0FBc0M7QUFDdEMsaUVBQWlFO0FBQ2pFLDRDQUE0Qzs7Ozs7Ozs7Ozs7O1FBK0YvQkE7ZUFBQUE7O1FBcUxTQztlQUFBQTs7UUF3Q05DO2VBQUFBOztRQS9EQUM7ZUFBQUE7O1FBcENIQztlQUFBQTs7UUFnS1NDO2VBQUFBOzs7d0JBdlhvQjtBQWlDMUMsc0NBQXNDO0FBQ3RDLCtCQUErQjtBQUMvQixzQ0FBc0M7QUFFdEMsdUNBQXVDO0FBQ3ZDLE1BQU1DLHFCQUFxQjtJQUN6QkMsUUFBUTtRQUNOQyxVQUFVLEtBQUssS0FBSztRQUNwQkMsYUFBYTtRQUNiQyxTQUFTO0lBQ1g7SUFDQUMs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