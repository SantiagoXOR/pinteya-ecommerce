{"version":3,"names":["cov_26pq7385s6","actualCoverage","s","GET","f","runtime","userId","sessionClaims","_config","auth","console","log","b","JSON","stringify","publicMetadata","metadata","role_from_publicMetadata","role","role_from_metadata","possibleRoles","public_metadata","user_metadata","_server","NextResponse","json","success","debug","hasSessionClaims","sessionClaimsKeys","Object","keys","possibleRoleLocations","detectedRole","values","find","fullSessionClaimsStructure","error","message","errorType","constructor","name","status"],"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\app\\api\\debug-clerk-session\\route.ts"],"sourcesContent":["// Configuración para Node.js Runtime\r\nexport const runtime = 'nodejs';\r\n\r\nimport { auth } from '@/lib/auth/config';\r\nimport { NextResponse } from 'next/server';\r\n\r\nexport async function GET() {\r\n  try {\r\n    const { userId, sessionClaims } = auth();\r\n\r\n    // Log detallado para debugging\r\n    console.log('🔍 CLERK DEBUG INFO:', {\r\n      userId,\r\n      sessionClaims: sessionClaims ? JSON.stringify(sessionClaims, null, 2) : 'null',\r\n      publicMetadata: sessionClaims?.publicMetadata,\r\n      metadata: sessionClaims?.metadata,\r\n      role_from_publicMetadata: sessionClaims?.publicMetadata?.role,\r\n      role_from_metadata: sessionClaims?.metadata?.role\r\n    });\r\n\r\n    // Verificar todas las posibles ubicaciones del rol\r\n    const possibleRoles = {\r\n      'sessionClaims.publicMetadata.role': sessionClaims?.publicMetadata?.role,\r\n      'sessionClaims.metadata.role': sessionClaims?.metadata?.role,\r\n      'sessionClaims.role': sessionClaims?.role,\r\n      'sessionClaims.public_metadata.role': sessionClaims?.public_metadata?.role,\r\n      'sessionClaims.user_metadata.role': sessionClaims?.user_metadata?.role\r\n    };\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      debug: {\r\n        userId,\r\n        hasSessionClaims: !!sessionClaims,\r\n        sessionClaimsKeys: sessionClaims ? Object.keys(sessionClaims) : [],\r\n        publicMetadata: sessionClaims?.publicMetadata,\r\n        metadata: sessionClaims?.metadata,\r\n        possibleRoleLocations: possibleRoles,\r\n        detectedRole: Object.values(possibleRoles).find(role => role === 'admin') || 'none',\r\n        fullSessionClaimsStructure: sessionClaims\r\n      }\r\n    });\r\n  } catch (error) {\r\n    console.error('Debug error:', error);\r\n    return NextResponse.json({\r\n      success: false,\r\n      error: error.message,\r\n      errorType: error.constructor.name\r\n    }, { status: 500 });\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]}