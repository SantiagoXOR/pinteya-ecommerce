c1717ba2e6e386da73fd32ed8c385dda
// ===================================
// PINTEYA E-COMMERCE - HOOK DE CARRITO CON BACKEND
// ===================================
// Hook optimizado que conecta el carrito frontend con las APIs del backend
'use client';
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get default () {
        return _default;
    },
    get useCartWithBackend () {
        return useCartWithBackend;
    }
});
const _react = require("react");
const _react1 = require("next-auth/react");
const _sonner = require("sonner");
const useCartWithBackend = ()=>{
    const { data: session, status } = (0, _react1.useSession)();
    const [cartState, setCartState] = (0, _react.useState)({
        items: [],
        totalItems: 0,
        totalAmount: 0,
        itemCount: 0,
        loading: false,
        error: null
    });
    // Función para hacer requests a la API
    const apiRequest = (0, _react.useCallback)(async (url, options = {})=>{
        try {
            const response = await fetch(url, {
                headers: {
                    'Content-Type': 'application/json',
                    ...options.headers
                },
                ...options
            });
            // Verificar si la respuesta tiene contenido antes de parsear JSON
            const text = await response.text();
            let data = null;
            if (text.trim()) {
                try {
                    data = JSON.parse(text);
                } catch (parseError) {
                    console.error(`JSON Parse Error (${url}):`, parseError);
                    console.error('Raw response:', text);
                    throw new Error(`Invalid JSON response: ${parseError.message}`);
                }
            }
            if (!response.ok) {
                // Si es 401 (Unauthorized), es un caso esperado, no un error
                if (response.status === 401) {
                    return data; // Devolver la respuesta tal como está
                }
                throw new Error(data?.error || `HTTP ${response.status}: ${response.statusText}`);
            }
            return data;
        } catch (error) {
            console.error(`API Error (${url}):`, error);
            throw error;
        }
    }, []);
    // Cargar carrito desde el backend
    const loadCart = (0, _react.useCallback)(async ()=>{
        if (status === 'loading') {
            return;
        }
        if (!session?.user) {
            // Usuario no autenticado - carrito vacío
            setCartState((prev)=>({
                    ...prev,
                    items: [],
                    totalItems: 0,
                    totalAmount: 0,
                    itemCount: 0,
                    loading: false,
                    error: null
                }));
            return;
        }
        setCartState((prev)=>({
                ...prev,
                loading: true,
                error: null
            }));
        try {
            const data = await apiRequest('/api/cart');
            // Si la respuesta indica que no hay autenticación, manejar como carrito vacío
            if (!data.success && data.error === 'Usuario no autenticado') {
                setCartState((prev)=>({
                        ...prev,
                        items: [],
                        totalItems: 0,
                        totalAmount: 0,
                        itemCount: 0,
                        loading: false,
                        error: null
                    }));
                return;
            }
            setCartState((prev)=>({
                    ...prev,
                    items: data.items || [],
                    totalItems: data.totalItems || 0,
                    totalAmount: data.totalAmount || 0,
                    itemCount: data.itemCount || 0,
                    loading: false,
                    error: null
                }));
            console.log('✅ Carrito cargado:', data.itemCount, 'productos únicos');
        } catch (error) {
            console.error('❌ Error cargando carrito:', error);
            setCartState((prev)=>({
                    ...prev,
                    loading: false,
                    error: error.message || 'Error cargando carrito'
                }));
        }
    }, [
        session,
        status,
        apiRequest
    ]);
    // Agregar item al carrito
    const addItem = (0, _react.useCallback)(async (productId, quantity = 1)=>{
        if (!session?.user) {
            _sonner.toast.error('Debes iniciar sesión para agregar productos al carrito');
            return false;
        }
        setCartState((prev)=>({
                ...prev,
                loading: true,
                error: null
            }));
        try {
            const data = await apiRequest('/api/cart/add', {
                method: 'POST',
                body: JSON.stringify({
                    productId,
                    quantity
                })
            });
            if (data.success) {
                // Recargar carrito para obtener estado actualizado
                await loadCart();
                _sonner.toast.success(data.message || 'Producto agregado al carrito');
                console.log('✅ Producto agregado:', data.item?.productName);
                return true;
            } else {
                throw new Error(data.error || 'Error agregando producto');
            }
        } catch (error) {
            console.error('❌ Error agregando al carrito:', error);
            setCartState((prev)=>({
                    ...prev,
                    loading: false,
                    error: error.message
                }));
            if (error.message.includes('Stock insuficiente')) {
                _sonner.toast.error(error.message);
            } else if (error.message.includes('autenticado')) {
                _sonner.toast.error('Debes iniciar sesión para agregar productos');
            } else {
                _sonner.toast.error('Error agregando producto al carrito');
            }
            return false;
        }
    }, [
        session,
        apiRequest,
        loadCart
    ]);
    // Remover item del carrito
    const removeItem = (0, _react.useCallback)(async (productId, quantity)=>{
        if (!session?.user) {
            _sonner.toast.error('Debes iniciar sesión');
            return false;
        }
        setCartState((prev)=>({
                ...prev,
                loading: true,
                error: null
            }));
        try {
            const data = await apiRequest('/api/cart/remove', {
                method: 'DELETE',
                body: JSON.stringify({
                    productId,
                    quantity
                })
            });
            if (data.success) {
                await loadCart();
                _sonner.toast.success(data.message || 'Producto removido del carrito');
                console.log('✅ Producto removido:', data.item?.productName);
                return true;
            } else {
                throw new Error(data.error || 'Error removiendo producto');
            }
        } catch (error) {
            console.error('❌ Error removiendo del carrito:', error);
            setCartState((prev)=>({
                    ...prev,
                    loading: false,
                    error: error.message
                }));
            _sonner.toast.error('Error removiendo producto del carrito');
            return false;
        }
    }, [
        session,
        apiRequest,
        loadCart
    ]);
    // Actualizar cantidad de un item
    const updateQuantity = (0, _react.useCallback)(async (productId, quantity)=>{
        if (!session?.user) {
            _sonner.toast.error('Debes iniciar sesión');
            return false;
        }
        setCartState((prev)=>({
                ...prev,
                loading: true,
                error: null
            }));
        try {
            const data = await apiRequest('/api/cart/update', {
                method: 'PUT',
                body: JSON.stringify({
                    productId,
                    quantity
                })
            });
            if (data.success) {
                await loadCart();
                _sonner.toast.success(data.message || 'Cantidad actualizada');
                console.log('✅ Cantidad actualizada:', data.item?.productName);
                return true;
            } else {
                throw new Error(data.error || 'Error actualizando cantidad');
            }
        } catch (error) {
            console.error('❌ Error actualizando cantidad:', error);
            setCartState((prev)=>({
                    ...prev,
                    loading: false,
                    error: error.message
                }));
            _sonner.toast.error('Error actualizando cantidad');
            return false;
        }
    }, [
        session,
        apiRequest,
        loadCart
    ]);
    // Limpiar carrito completo
    const clearCart = (0, _react.useCallback)(async ()=>{
        if (!session?.user) {
            _sonner.toast.error('Debes iniciar sesión');
            return false;
        }
        setCartState((prev)=>({
                ...prev,
                loading: true,
                error: null
            }));
        try {
            const data = await apiRequest('/api/cart', {
                method: 'DELETE'
            });
            if (data.success) {
                await loadCart();
                _sonner.toast.success('Carrito limpiado');
                console.log('✅ Carrito limpiado');
                return true;
            } else {
                throw new Error(data.error || 'Error limpiando carrito');
            }
        } catch (error) {
            console.error('❌ Error limpiando carrito:', error);
            setCartState((prev)=>({
                    ...prev,
                    loading: false,
                    error: error.message
                }));
            _sonner.toast.error('Error limpiando carrito');
            return false;
        }
    }, [
        session,
        apiRequest,
        loadCart
    ]);
    // Obtener cantidad de un producto específico en el carrito
    const getItemQuantity = (0, _react.useCallback)((productId)=>{
        const item = cartState.items.find((item)=>item.product_id === productId);
        return item?.quantity || 0;
    }, [
        cartState.items
    ]);
    // Verificar si un producto está en el carrito
    const isInCart = (0, _react.useCallback)((productId)=>{
        return cartState.items.some((item)=>item.product_id === productId);
    }, [
        cartState.items
    ]);
    // Refrescar carrito (alias para loadCart)
    const refreshCart = (0, _react.useCallback)(async ()=>{
        await loadCart();
    }, [
        loadCart
    ]);
    // Cargar carrito al montar el componente o cuando cambie la sesión
    (0, _react.useEffect)(()=>{
        loadCart();
    }, [
        loadCart
    ]);
    return {
        ...cartState,
        addItem,
        removeItem,
        updateQuantity,
        clearCart,
        loadCart,
        getItemQuantity,
        isInCart,
        refreshCart
    };
};
const _default = useCartWithBackend;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcaG9va3NcXHVzZUNhcnRXaXRoQmFja2VuZC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQSU5URVlBIEUtQ09NTUVSQ0UgLSBIT09LIERFIENBUlJJVE8gQ09OIEJBQ0tFTkRcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gSG9vayBvcHRpbWl6YWRvIHF1ZSBjb25lY3RhIGVsIGNhcnJpdG8gZnJvbnRlbmQgY29uIGxhcyBBUElzIGRlbCBiYWNrZW5kXHJcblxyXG4ndXNlIGNsaWVudCc7XHJcblxyXG5pbXBvcnQgeyB1c2VDYWxsYmFjaywgdXNlRWZmZWN0LCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgdXNlU2Vzc2lvbiB9IGZyb20gJ25leHQtYXV0aC9yZWFjdCc7XHJcbmltcG9ydCB7IHRvYXN0IH0gZnJvbSAnc29ubmVyJztcclxuXHJcbi8vIFRpcG9zIHBhcmEgZWwgY2Fycml0b1xyXG5pbnRlcmZhY2UgQ2FydFByb2R1Y3Qge1xyXG4gIGlkOiBudW1iZXI7XHJcbiAgbmFtZTogc3RyaW5nO1xyXG4gIHByaWNlOiBudW1iZXI7XHJcbiAgZGlzY291bnRlZF9wcmljZT86IG51bWJlcjtcclxuICBpbWFnZXM/OiBhbnk7XHJcbiAgc3RvY2s6IG51bWJlcjtcclxuICBicmFuZD86IHN0cmluZztcclxuICBjYXRlZ29yeT86IHtcclxuICAgIGlkOiBudW1iZXI7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgfTtcclxufVxyXG5cclxuaW50ZXJmYWNlIENhcnRJdGVtIHtcclxuICBpZDogc3RyaW5nO1xyXG4gIHVzZXJfaWQ6IHN0cmluZztcclxuICBwcm9kdWN0X2lkOiBudW1iZXI7XHJcbiAgcXVhbnRpdHk6IG51bWJlcjtcclxuICBjcmVhdGVkX2F0OiBzdHJpbmc7XHJcbiAgdXBkYXRlZF9hdDogc3RyaW5nO1xyXG4gIHByb2R1Y3RzOiBDYXJ0UHJvZHVjdDtcclxufVxyXG5cclxuaW50ZXJmYWNlIENhcnRTdGF0ZSB7XHJcbiAgaXRlbXM6IENhcnRJdGVtW107XHJcbiAgdG90YWxJdGVtczogbnVtYmVyO1xyXG4gIHRvdGFsQW1vdW50OiBudW1iZXI7XHJcbiAgaXRlbUNvdW50OiBudW1iZXI7XHJcbiAgbG9hZGluZzogYm9vbGVhbjtcclxuICBlcnJvcjogc3RyaW5nIHwgbnVsbDtcclxufVxyXG5cclxuaW50ZXJmYWNlIFVzZUNhcnRXaXRoQmFja2VuZFJldHVybiBleHRlbmRzIENhcnRTdGF0ZSB7XHJcbiAgYWRkSXRlbTogKHByb2R1Y3RJZDogbnVtYmVyLCBxdWFudGl0eT86IG51bWJlcikgPT4gUHJvbWlzZTxib29sZWFuPjtcclxuICByZW1vdmVJdGVtOiAocHJvZHVjdElkOiBudW1iZXIsIHF1YW50aXR5PzogbnVtYmVyKSA9PiBQcm9taXNlPGJvb2xlYW4+O1xyXG4gIHVwZGF0ZVF1YW50aXR5OiAocHJvZHVjdElkOiBudW1iZXIsIHF1YW50aXR5OiBudW1iZXIpID0+IFByb21pc2U8Ym9vbGVhbj47XHJcbiAgY2xlYXJDYXJ0OiAoKSA9PiBQcm9taXNlPGJvb2xlYW4+O1xyXG4gIGxvYWRDYXJ0OiAoKSA9PiBQcm9taXNlPHZvaWQ+O1xyXG4gIGdldEl0ZW1RdWFudGl0eTogKHByb2R1Y3RJZDogbnVtYmVyKSA9PiBudW1iZXI7XHJcbiAgaXNJbkNhcnQ6IChwcm9kdWN0SWQ6IG51bWJlcikgPT4gYm9vbGVhbjtcclxuICByZWZyZXNoQ2FydDogKCkgPT4gUHJvbWlzZTx2b2lkPjtcclxufVxyXG5cclxuLyoqXHJcbiAqIEhvb2sgcGFyYSBtYW5lamFyIGVsIGNhcnJpdG8gY29uIGludGVncmFjacOzbiBjb21wbGV0YSBhbCBiYWNrZW5kXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgdXNlQ2FydFdpdGhCYWNrZW5kID0gKCk6IFVzZUNhcnRXaXRoQmFja2VuZFJldHVybiA9PiB7XHJcbiAgY29uc3QgeyBkYXRhOiBzZXNzaW9uLCBzdGF0dXMgfSA9IHVzZVNlc3Npb24oKTtcclxuICBjb25zdCBbY2FydFN0YXRlLCBzZXRDYXJ0U3RhdGVdID0gdXNlU3RhdGU8Q2FydFN0YXRlPih7XHJcbiAgICBpdGVtczogW10sXHJcbiAgICB0b3RhbEl0ZW1zOiAwLFxyXG4gICAgdG90YWxBbW91bnQ6IDAsXHJcbiAgICBpdGVtQ291bnQ6IDAsXHJcbiAgICBsb2FkaW5nOiBmYWxzZSxcclxuICAgIGVycm9yOiBudWxsXHJcbiAgfSk7XHJcblxyXG4gIC8vIEZ1bmNpw7NuIHBhcmEgaGFjZXIgcmVxdWVzdHMgYSBsYSBBUElcclxuICBjb25zdCBhcGlSZXF1ZXN0ID0gdXNlQ2FsbGJhY2soYXN5bmMgKHVybDogc3RyaW5nLCBvcHRpb25zOiBSZXF1ZXN0SW5pdCA9IHt9KSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xyXG4gICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgICAuLi5vcHRpb25zLmhlYWRlcnNcclxuICAgICAgICB9LFxyXG4gICAgICAgIC4uLm9wdGlvbnNcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBWZXJpZmljYXIgc2kgbGEgcmVzcHVlc3RhIHRpZW5lIGNvbnRlbmlkbyBhbnRlcyBkZSBwYXJzZWFyIEpTT05cclxuICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcclxuICAgICAgbGV0IGRhdGEgPSBudWxsO1xyXG4gICAgICBcclxuICAgICAgaWYgKHRleHQudHJpbSgpKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKHRleHQpO1xyXG4gICAgICAgIH0gY2F0Y2ggKHBhcnNlRXJyb3IpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEpTT04gUGFyc2UgRXJyb3IgKCR7dXJsfSk6YCwgcGFyc2VFcnJvcik7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdSYXcgcmVzcG9uc2U6JywgdGV4dCk7XHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgSlNPTiByZXNwb25zZTogJHtwYXJzZUVycm9yLm1lc3NhZ2V9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgLy8gU2kgZXMgNDAxIChVbmF1dGhvcml6ZWQpLCBlcyB1biBjYXNvIGVzcGVyYWRvLCBubyB1biBlcnJvclxyXG4gICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xyXG4gICAgICAgICAgcmV0dXJuIGRhdGE7IC8vIERldm9sdmVyIGxhIHJlc3B1ZXN0YSB0YWwgY29tbyBlc3TDoVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZGF0YT8uZXJyb3IgfHwgYEhUVFAgJHtyZXNwb25zZS5zdGF0dXN9OiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBBUEkgRXJyb3IgKCR7dXJsfSk6YCwgZXJyb3IpO1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICB9LCBbXSk7XHJcblxyXG4gIC8vIENhcmdhciBjYXJyaXRvIGRlc2RlIGVsIGJhY2tlbmRcclxuICBjb25zdCBsb2FkQ2FydCA9IHVzZUNhbGxiYWNrKGFzeW5jICgpID0+IHtcclxuICAgIGlmIChzdGF0dXMgPT09ICdsb2FkaW5nJykge3JldHVybjt9XHJcbiAgICBcclxuICAgIGlmICghc2Vzc2lvbj8udXNlcikge1xyXG4gICAgICAvLyBVc3VhcmlvIG5vIGF1dGVudGljYWRvIC0gY2Fycml0byB2YWPDrW9cclxuICAgICAgc2V0Q2FydFN0YXRlKHByZXYgPT4gKHtcclxuICAgICAgICAuLi5wcmV2LFxyXG4gICAgICAgIGl0ZW1zOiBbXSxcclxuICAgICAgICB0b3RhbEl0ZW1zOiAwLFxyXG4gICAgICAgIHRvdGFsQW1vdW50OiAwLFxyXG4gICAgICAgIGl0ZW1Db3VudDogMCxcclxuICAgICAgICBsb2FkaW5nOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogbnVsbFxyXG4gICAgICB9KSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBzZXRDYXJ0U3RhdGUocHJldiA9PiAoeyAuLi5wcmV2LCBsb2FkaW5nOiB0cnVlLCBlcnJvcjogbnVsbCB9KSk7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IGFwaVJlcXVlc3QoJy9hcGkvY2FydCcpO1xyXG4gICAgICBcclxuICAgICAgLy8gU2kgbGEgcmVzcHVlc3RhIGluZGljYSBxdWUgbm8gaGF5IGF1dGVudGljYWNpw7NuLCBtYW5lamFyIGNvbW8gY2Fycml0byB2YWPDrW9cclxuICAgICAgaWYgKCFkYXRhLnN1Y2Nlc3MgJiYgZGF0YS5lcnJvciA9PT0gJ1VzdWFyaW8gbm8gYXV0ZW50aWNhZG8nKSB7XHJcbiAgICAgICAgc2V0Q2FydFN0YXRlKHByZXYgPT4gKHtcclxuICAgICAgICAgIC4uLnByZXYsXHJcbiAgICAgICAgICBpdGVtczogW10sXHJcbiAgICAgICAgICB0b3RhbEl0ZW1zOiAwLFxyXG4gICAgICAgICAgdG90YWxBbW91bnQ6IDAsXHJcbiAgICAgICAgICBpdGVtQ291bnQ6IDAsXHJcbiAgICAgICAgICBsb2FkaW5nOiBmYWxzZSxcclxuICAgICAgICAgIGVycm9yOiBudWxsXHJcbiAgICAgICAgfSkpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgc2V0Q2FydFN0YXRlKHByZXYgPT4gKHtcclxuICAgICAgICAuLi5wcmV2LFxyXG4gICAgICAgIGl0ZW1zOiBkYXRhLml0ZW1zIHx8IFtdLFxyXG4gICAgICAgIHRvdGFsSXRlbXM6IGRhdGEudG90YWxJdGVtcyB8fCAwLFxyXG4gICAgICAgIHRvdGFsQW1vdW50OiBkYXRhLnRvdGFsQW1vdW50IHx8IDAsXHJcbiAgICAgICAgaXRlbUNvdW50OiBkYXRhLml0ZW1Db3VudCB8fCAwLFxyXG4gICAgICAgIGxvYWRpbmc6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiBudWxsXHJcbiAgICAgIH0pKTtcclxuXHJcbiAgICAgIGNvbnNvbGUubG9nKCfinIUgQ2Fycml0byBjYXJnYWRvOicsIGRhdGEuaXRlbUNvdW50LCAncHJvZHVjdG9zIMO6bmljb3MnKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIGNhcmdhbmRvIGNhcnJpdG86JywgZXJyb3IpO1xyXG4gICAgICBzZXRDYXJ0U3RhdGUocHJldiA9PiAoe1xyXG4gICAgICAgIC4uLnByZXYsXHJcbiAgICAgICAgbG9hZGluZzogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfHwgJ0Vycm9yIGNhcmdhbmRvIGNhcnJpdG8nXHJcbiAgICAgIH0pKTtcclxuICAgIH1cclxuICB9LCBbc2Vzc2lvbiwgc3RhdHVzLCBhcGlSZXF1ZXN0XSk7XHJcblxyXG4gIC8vIEFncmVnYXIgaXRlbSBhbCBjYXJyaXRvXHJcbiAgY29uc3QgYWRkSXRlbSA9IHVzZUNhbGxiYWNrKGFzeW5jIChwcm9kdWN0SWQ6IG51bWJlciwgcXVhbnRpdHk6IG51bWJlciA9IDEpOiBQcm9taXNlPGJvb2xlYW4+ID0+IHtcclxuICAgIGlmICghc2Vzc2lvbj8udXNlcikge1xyXG4gICAgICB0b2FzdC5lcnJvcignRGViZXMgaW5pY2lhciBzZXNpw7NuIHBhcmEgYWdyZWdhciBwcm9kdWN0b3MgYWwgY2Fycml0bycpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0Q2FydFN0YXRlKHByZXYgPT4gKHsgLi4ucHJldiwgbG9hZGluZzogdHJ1ZSwgZXJyb3I6IG51bGwgfSkpO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBhcGlSZXF1ZXN0KCcvYXBpL2NhcnQvYWRkJywge1xyXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgcHJvZHVjdElkLCBxdWFudGl0eSB9KVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGlmIChkYXRhLnN1Y2Nlc3MpIHtcclxuICAgICAgICAvLyBSZWNhcmdhciBjYXJyaXRvIHBhcmEgb2J0ZW5lciBlc3RhZG8gYWN0dWFsaXphZG9cclxuICAgICAgICBhd2FpdCBsb2FkQ2FydCgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRvYXN0LnN1Y2Nlc3MoZGF0YS5tZXNzYWdlIHx8ICdQcm9kdWN0byBhZ3JlZ2FkbyBhbCBjYXJyaXRvJyk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ+KchSBQcm9kdWN0byBhZ3JlZ2FkbzonLCBkYXRhLml0ZW0/LnByb2R1Y3ROYW1lKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZGF0YS5lcnJvciB8fCAnRXJyb3IgYWdyZWdhbmRvIHByb2R1Y3RvJyk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIGFncmVnYW5kbyBhbCBjYXJyaXRvOicsIGVycm9yKTtcclxuICAgICAgc2V0Q2FydFN0YXRlKHByZXYgPT4gKHsgLi4ucHJldiwgbG9hZGluZzogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH0pKTtcclxuICAgICAgXHJcbiAgICAgIGlmIChlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdTdG9jayBpbnN1ZmljaWVudGUnKSkge1xyXG4gICAgICAgIHRvYXN0LmVycm9yKGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICB9IGVsc2UgaWYgKGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ2F1dGVudGljYWRvJykpIHtcclxuICAgICAgICB0b2FzdC5lcnJvcignRGViZXMgaW5pY2lhciBzZXNpw7NuIHBhcmEgYWdyZWdhciBwcm9kdWN0b3MnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0b2FzdC5lcnJvcignRXJyb3IgYWdyZWdhbmRvIHByb2R1Y3RvIGFsIGNhcnJpdG8nKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH0sIFtzZXNzaW9uLCBhcGlSZXF1ZXN0LCBsb2FkQ2FydF0pO1xyXG5cclxuICAvLyBSZW1vdmVyIGl0ZW0gZGVsIGNhcnJpdG9cclxuICBjb25zdCByZW1vdmVJdGVtID0gdXNlQ2FsbGJhY2soYXN5bmMgKHByb2R1Y3RJZDogbnVtYmVyLCBxdWFudGl0eT86IG51bWJlcik6IFByb21pc2U8Ym9vbGVhbj4gPT4ge1xyXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyKSB7XHJcbiAgICAgIHRvYXN0LmVycm9yKCdEZWJlcyBpbmljaWFyIHNlc2nDs24nKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHNldENhcnRTdGF0ZShwcmV2ID0+ICh7IC4uLnByZXYsIGxvYWRpbmc6IHRydWUsIGVycm9yOiBudWxsIH0pKTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgYXBpUmVxdWVzdCgnL2FwaS9jYXJ0L3JlbW92ZScsIHtcclxuICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgcHJvZHVjdElkLCBxdWFudGl0eSB9KVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGlmIChkYXRhLnN1Y2Nlc3MpIHtcclxuICAgICAgICBhd2FpdCBsb2FkQ2FydCgpO1xyXG4gICAgICAgIHRvYXN0LnN1Y2Nlc3MoZGF0YS5tZXNzYWdlIHx8ICdQcm9kdWN0byByZW1vdmlkbyBkZWwgY2Fycml0bycpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCfinIUgUHJvZHVjdG8gcmVtb3ZpZG86JywgZGF0YS5pdGVtPy5wcm9kdWN0TmFtZSk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGRhdGEuZXJyb3IgfHwgJ0Vycm9yIHJlbW92aWVuZG8gcHJvZHVjdG8nKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyb3IgcmVtb3ZpZW5kbyBkZWwgY2Fycml0bzonLCBlcnJvcik7XHJcbiAgICAgIHNldENhcnRTdGF0ZShwcmV2ID0+ICh7IC4uLnByZXYsIGxvYWRpbmc6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9KSk7XHJcbiAgICAgIHRvYXN0LmVycm9yKCdFcnJvciByZW1vdmllbmRvIHByb2R1Y3RvIGRlbCBjYXJyaXRvJyk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICB9LCBbc2Vzc2lvbiwgYXBpUmVxdWVzdCwgbG9hZENhcnRdKTtcclxuXHJcbiAgLy8gQWN0dWFsaXphciBjYW50aWRhZCBkZSB1biBpdGVtXHJcbiAgY29uc3QgdXBkYXRlUXVhbnRpdHkgPSB1c2VDYWxsYmFjayhhc3luYyAocHJvZHVjdElkOiBudW1iZXIsIHF1YW50aXR5OiBudW1iZXIpOiBQcm9taXNlPGJvb2xlYW4+ID0+IHtcclxuICAgIGlmICghc2Vzc2lvbj8udXNlcikge1xyXG4gICAgICB0b2FzdC5lcnJvcignRGViZXMgaW5pY2lhciBzZXNpw7NuJyk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRDYXJ0U3RhdGUocHJldiA9PiAoeyAuLi5wcmV2LCBsb2FkaW5nOiB0cnVlLCBlcnJvcjogbnVsbCB9KSk7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IGFwaVJlcXVlc3QoJy9hcGkvY2FydC91cGRhdGUnLCB7XHJcbiAgICAgICAgbWV0aG9kOiAnUFVUJyxcclxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IHByb2R1Y3RJZCwgcXVhbnRpdHkgfSlcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAoZGF0YS5zdWNjZXNzKSB7XHJcbiAgICAgICAgYXdhaXQgbG9hZENhcnQoKTtcclxuICAgICAgICB0b2FzdC5zdWNjZXNzKGRhdGEubWVzc2FnZSB8fCAnQ2FudGlkYWQgYWN0dWFsaXphZGEnKTtcclxuICAgICAgICBjb25zb2xlLmxvZygn4pyFIENhbnRpZGFkIGFjdHVhbGl6YWRhOicsIGRhdGEuaXRlbT8ucHJvZHVjdE5hbWUpO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihkYXRhLmVycm9yIHx8ICdFcnJvciBhY3R1YWxpemFuZG8gY2FudGlkYWQnKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyb3IgYWN0dWFsaXphbmRvIGNhbnRpZGFkOicsIGVycm9yKTtcclxuICAgICAgc2V0Q2FydFN0YXRlKHByZXYgPT4gKHsgLi4ucHJldiwgbG9hZGluZzogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH0pKTtcclxuICAgICAgdG9hc3QuZXJyb3IoJ0Vycm9yIGFjdHVhbGl6YW5kbyBjYW50aWRhZCcpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfSwgW3Nlc3Npb24sIGFwaVJlcXVlc3QsIGxvYWRDYXJ0XSk7XHJcblxyXG4gIC8vIExpbXBpYXIgY2Fycml0byBjb21wbGV0b1xyXG4gIGNvbnN0IGNsZWFyQ2FydCA9IHVzZUNhbGxiYWNrKGFzeW5jICgpOiBQcm9taXNlPGJvb2xlYW4+ID0+IHtcclxuICAgIGlmICghc2Vzc2lvbj8udXNlcikge1xyXG4gICAgICB0b2FzdC5lcnJvcignRGViZXMgaW5pY2lhciBzZXNpw7NuJyk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRDYXJ0U3RhdGUocHJldiA9PiAoeyAuLi5wcmV2LCBsb2FkaW5nOiB0cnVlLCBlcnJvcjogbnVsbCB9KSk7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IGFwaVJlcXVlc3QoJy9hcGkvY2FydCcsIHtcclxuICAgICAgICBtZXRob2Q6ICdERUxFVEUnXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKGRhdGEuc3VjY2Vzcykge1xyXG4gICAgICAgIGF3YWl0IGxvYWRDYXJ0KCk7XHJcbiAgICAgICAgdG9hc3Quc3VjY2VzcygnQ2Fycml0byBsaW1waWFkbycpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCfinIUgQ2Fycml0byBsaW1waWFkbycpO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihkYXRhLmVycm9yIHx8ICdFcnJvciBsaW1waWFuZG8gY2Fycml0bycpO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBsaW1waWFuZG8gY2Fycml0bzonLCBlcnJvcik7XHJcbiAgICAgIHNldENhcnRTdGF0ZShwcmV2ID0+ICh7IC4uLnByZXYsIGxvYWRpbmc6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9KSk7XHJcbiAgICAgIHRvYXN0LmVycm9yKCdFcnJvciBsaW1waWFuZG8gY2Fycml0bycpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfSwgW3Nlc3Npb24sIGFwaVJlcXVlc3QsIGxvYWRDYXJ0XSk7XHJcblxyXG4gIC8vIE9idGVuZXIgY2FudGlkYWQgZGUgdW4gcHJvZHVjdG8gZXNwZWPDrWZpY28gZW4gZWwgY2Fycml0b1xyXG4gIGNvbnN0IGdldEl0ZW1RdWFudGl0eSA9IHVzZUNhbGxiYWNrKChwcm9kdWN0SWQ6IG51bWJlcik6IG51bWJlciA9PiB7XHJcbiAgICBjb25zdCBpdGVtID0gY2FydFN0YXRlLml0ZW1zLmZpbmQoaXRlbSA9PiBpdGVtLnByb2R1Y3RfaWQgPT09IHByb2R1Y3RJZCk7XHJcbiAgICByZXR1cm4gaXRlbT8ucXVhbnRpdHkgfHwgMDtcclxuICB9LCBbY2FydFN0YXRlLml0ZW1zXSk7XHJcblxyXG4gIC8vIFZlcmlmaWNhciBzaSB1biBwcm9kdWN0byBlc3TDoSBlbiBlbCBjYXJyaXRvXHJcbiAgY29uc3QgaXNJbkNhcnQgPSB1c2VDYWxsYmFjaygocHJvZHVjdElkOiBudW1iZXIpOiBib29sZWFuID0+IHtcclxuICAgIHJldHVybiBjYXJ0U3RhdGUuaXRlbXMuc29tZShpdGVtID0+IGl0ZW0ucHJvZHVjdF9pZCA9PT0gcHJvZHVjdElkKTtcclxuICB9LCBbY2FydFN0YXRlLml0ZW1zXSk7XHJcblxyXG4gIC8vIFJlZnJlc2NhciBjYXJyaXRvIChhbGlhcyBwYXJhIGxvYWRDYXJ0KVxyXG4gIGNvbnN0IHJlZnJlc2hDYXJ0ID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgYXdhaXQgbG9hZENhcnQoKTtcclxuICB9LCBbbG9hZENhcnRdKTtcclxuXHJcbiAgLy8gQ2FyZ2FyIGNhcnJpdG8gYWwgbW9udGFyIGVsIGNvbXBvbmVudGUgbyBjdWFuZG8gY2FtYmllIGxhIHNlc2nDs25cclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgbG9hZENhcnQoKTtcclxuICB9LCBbbG9hZENhcnRdKTtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIC4uLmNhcnRTdGF0ZSxcclxuICAgIGFkZEl0ZW0sXHJcbiAgICByZW1vdmVJdGVtLFxyXG4gICAgdXBkYXRlUXVhbnRpdHksXHJcbiAgICBjbGVhckNhcnQsXHJcbiAgICBsb2FkQ2FydCxcclxuICAgIGdldEl0ZW1RdWFudGl0eSxcclxuICAgIGlzSW5DYXJ0LFxyXG4gICAgcmVmcmVzaENhcnRcclxuICB9O1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgdXNlQ2FydFdpdGhCYWNrZW5kO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4iXSwibmFtZXMiOlsidXNlQ2FydFdpdGhCYWNrZW5kIiwiZGF0YSIsInNlc3Npb24iLCJzdGF0dXMiLCJ1c2VTZXNzaW9uIiwiY2FydFN0YXRlIiwic2V0Q2FydFN0YXRlIiwidXNlU3RhdGUiLCJpdGVtcyIsInRvdGFsSXRlbXMiLCJ0b3RhbEFtb3VudCIsIml0ZW1Db3VudCIsImxvYWRpbmciLCJlcnJvciIsImFwaVJlcXVlc3QiLCJ1c2VDYWxsYmFjayIsInVybCIsIm9wdGlvbnMiLCJyZXNwb25zZSIsImZldGNoIiwiaGVhZGVycyIsInRleHQiLCJ0cmltIiwiSlNPTiIsInBhcnNlIiwicGFyc2VFcnJvciIsImNvbnNvbGUiLCJFcnJvciIsIm1lc3NhZ2UiLCJvayIsInN0YXR1c1RleHQiLCJsb2FkQ2FydCIsInVzZXIiLCJwcmV2Iiwic3VjY2VzcyIsImxvZyIsImFkZEl0ZW0iLCJwcm9kdWN0SWQiLCJxdWFudGl0eSIsInRvYXN0IiwibWV0aG9kIiwiYm9keSIsInN0cmluZ2lmeSIsIml0ZW0iLCJwcm9kdWN0TmFtZSIsImluY2x1ZGVzIiwicmVtb3ZlSXRlbSIsInVwZGF0ZVF1YW50aXR5IiwiY2xlYXJDYXJ0IiwiZ2V0SXRlbVF1YW50aXR5IiwiZmluZCIsInByb2R1Y3RfaWQiLCJpc0luQ2FydCIsInNvbWUiLCJyZWZyZXNoQ2FydCIsInVzZUVmZmVjdCJdLCJt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