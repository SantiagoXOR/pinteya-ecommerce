{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\hooks\\admin\\useShipments.ts"],"sourcesContent":["// =====================================================\r\n// HOOK: SHIPMENTS MANAGEMENT ENTERPRISE\r\n// Descripción: Hook para gestión completa de envíos\r\n// Basado en: Patrones TanStack Query + React Hook Form\r\n// =====================================================\r\n\r\n'use client';\r\n\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { useState, useCallback } from 'react';\r\nimport { toast } from 'sonner';\r\nimport { \r\n  Shipment,\r\n  CreateShipmentRequest,\r\n  UpdateShipmentRequest,\r\n  GetShipmentsRequest,\r\n  PaginatedResponse,\r\n  UseShipmentsReturn,\r\n  ShipmentStatus \r\n} from '@/types/logistics';\r\n\r\n// =====================================================\r\n// CONFIGURACIÓN DE QUERIES\r\n// =====================================================\r\n\r\nconst SHIPMENTS_QUERY_KEY = ['admin', 'logistics', 'shipments'];\r\nconst STALE_TIME = 30000; // 30 segundos\r\n\r\n// =====================================================\r\n// FUNCIONES DE API\r\n// =====================================================\r\n\r\nasync function fetchShipments(params: GetShipmentsRequest): Promise<PaginatedResponse<Shipment>> {\r\n  const searchParams = new URLSearchParams();\r\n  \r\n  Object.entries(params).forEach(([key, value]) => {\r\n    if (value !== undefined && value !== null) {\r\n      searchParams.append(key, value.toString());\r\n    }\r\n  });\r\n  \r\n  const response = await fetch(`/api/admin/logistics/shipments?${searchParams}`, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    }\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const errorData = await response.json().catch(() => ({}));\r\n    throw new Error(errorData.error || `HTTP ${response.status}: ${response.statusText}`);\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nasync function createShipment(data: CreateShipmentRequest): Promise<Shipment> {\r\n  const response = await fetch('/api/admin/logistics/shipments', {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n    body: JSON.stringify(data)\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const errorData = await response.json().catch(() => ({}));\r\n    throw new Error(errorData.error || `HTTP ${response.status}: ${response.statusText}`);\r\n  }\r\n  \r\n  const result = await response.json();\r\n  return result.data;\r\n}\r\n\r\nasync function updateShipment(id: number, data: UpdateShipmentRequest): Promise<Shipment> {\r\n  const response = await fetch(`/api/admin/logistics/shipments/${id}`, {\r\n    method: 'PUT',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n    body: JSON.stringify(data)\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const errorData = await response.json().catch(() => ({}));\r\n    throw new Error(errorData.error || `HTTP ${response.status}: ${response.statusText}`);\r\n  }\r\n  \r\n  const result = await response.json();\r\n  return result.data;\r\n}\r\n\r\nasync function deleteShipment(id: number): Promise<void> {\r\n  const response = await fetch(`/api/admin/logistics/shipments/${id}`, {\r\n    method: 'DELETE',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    }\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const errorData = await response.json().catch(() => ({}));\r\n    throw new Error(errorData.error || `HTTP ${response.status}: ${response.statusText}`);\r\n  }\r\n}\r\n\r\n// =====================================================\r\n// HOOK PRINCIPAL: useShipments\r\n// =====================================================\r\n\r\nexport function useShipments(params: GetShipmentsRequest = {}): UseShipmentsReturn {\r\n  const queryClient = useQueryClient();\r\n  \r\n  const queryKey = [...SHIPMENTS_QUERY_KEY, params];\r\n  \r\n  const {\r\n    data,\r\n    isLoading,\r\n    error,\r\n    refetch\r\n  } = useQuery({\r\n    queryKey,\r\n    queryFn: () => fetchShipments(params),\r\n    staleTime: STALE_TIME,\r\n    retry: 3,\r\n    retryDelay: (attemptIndex) => Math.min(1000 * 2 ** attemptIndex, 30000)\r\n  });\r\n  \r\n  return {\r\n    data,\r\n    isLoading,\r\n    error: error as Error | null,\r\n    refetch\r\n  };\r\n}\r\n\r\n// =====================================================\r\n// HOOK: useCreateShipment\r\n// =====================================================\r\n\r\nexport function useCreateShipment() {\r\n  const queryClient = useQueryClient();\r\n  \r\n  return useMutation({\r\n    mutationFn: createShipment,\r\n    onSuccess: (newShipment) => {\r\n      // Invalidar cache de shipments\r\n      queryClient.invalidateQueries({ queryKey: SHIPMENTS_QUERY_KEY });\r\n      \r\n      // Invalidar dashboard de logística\r\n      queryClient.invalidateQueries({ queryKey: ['admin', 'logistics', 'dashboard'] });\r\n      \r\n      toast.success('Envío creado exitosamente', {\r\n        description: `Número de envío: ${newShipment.shipment_number}`\r\n      });\r\n    },\r\n    onError: (error: Error) => {\r\n      toast.error('Error al crear envío', {\r\n        description: error.message\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\n// =====================================================\r\n// HOOK: useUpdateShipment\r\n// =====================================================\r\n\r\nexport function useUpdateShipment() {\r\n  const queryClient = useQueryClient();\r\n  \r\n  return useMutation({\r\n    mutationFn: ({ id, data }: { id: number; data: UpdateShipmentRequest }) => \r\n      updateShipment(id, data),\r\n    onSuccess: (updatedShipment) => {\r\n      // Actualizar cache específico del shipment\r\n      queryClient.setQueryData(\r\n        ['admin', 'logistics', 'shipment', updatedShipment.id],\r\n        updatedShipment\r\n      );\r\n      \r\n      // Invalidar listas de shipments\r\n      queryClient.invalidateQueries({ queryKey: SHIPMENTS_QUERY_KEY });\r\n      \r\n      // Invalidar dashboard si cambió el estado\r\n      queryClient.invalidateQueries({ queryKey: ['admin', 'logistics', 'dashboard'] });\r\n      \r\n      toast.success('Envío actualizado exitosamente');\r\n    },\r\n    onError: (error: Error) => {\r\n      toast.error('Error al actualizar envío', {\r\n        description: error.message\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\n// =====================================================\r\n// HOOK: useDeleteShipment\r\n// =====================================================\r\n\r\nexport function useDeleteShipment() {\r\n  const queryClient = useQueryClient();\r\n  \r\n  return useMutation({\r\n    mutationFn: deleteShipment,\r\n    onSuccess: (_, deletedId) => {\r\n      // Remover del cache\r\n      queryClient.removeQueries({ queryKey: ['admin', 'logistics', 'shipment', deletedId] });\r\n      \r\n      // Invalidar listas\r\n      queryClient.invalidateQueries({ queryKey: SHIPMENTS_QUERY_KEY });\r\n      queryClient.invalidateQueries({ queryKey: ['admin', 'logistics', 'dashboard'] });\r\n      \r\n      toast.success('Envío eliminado exitosamente');\r\n    },\r\n    onError: (error: Error) => {\r\n      toast.error('Error al eliminar envío', {\r\n        description: error.message\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\n// =====================================================\r\n// HOOK: useShipmentFilters\r\n// =====================================================\r\n\r\nexport function useShipmentFilters() {\r\n  const [filters, setFilters] = useState<GetShipmentsRequest>({\r\n    page: 1,\r\n    limit: 20,\r\n    order_by: 'created_at',\r\n    order_direction: 'desc'\r\n  });\r\n  \r\n  const updateFilter = useCallback((key: keyof GetShipmentsRequest, value: any) => {\r\n    setFilters(prev => ({\r\n      ...prev,\r\n      [key]: value,\r\n      page: key !== 'page' ? 1 : value // Reset page when other filters change\r\n    }));\r\n  }, []);\r\n  \r\n  const resetFilters = useCallback(() => {\r\n    setFilters({\r\n      page: 1,\r\n      limit: 20,\r\n      order_by: 'created_at',\r\n      order_direction: 'desc'\r\n    });\r\n  }, []);\r\n  \r\n  const setPage = useCallback((page: number) => {\r\n    updateFilter('page', page);\r\n  }, [updateFilter]);\r\n  \r\n  const setStatus = useCallback((status: ShipmentStatus | undefined) => {\r\n    updateFilter('status', status);\r\n  }, [updateFilter]);\r\n  \r\n  const setSearch = useCallback((search: string) => {\r\n    updateFilter('search', search || undefined);\r\n  }, [updateFilter]);\r\n  \r\n  const setDateRange = useCallback((dateFrom?: string, dateTo?: string) => {\r\n    setFilters(prev => ({\r\n      ...prev,\r\n      date_from: dateFrom,\r\n      date_to: dateTo,\r\n      page: 1\r\n    }));\r\n  }, []);\r\n  \r\n  return {\r\n    filters,\r\n    updateFilter,\r\n    resetFilters,\r\n    setPage,\r\n    setStatus,\r\n    setSearch,\r\n    setDateRange\r\n  };\r\n}\r\n\r\n// =====================================================\r\n// HOOK: useShipmentStats\r\n// =====================================================\r\n\r\nexport function useShipmentStats(shipments?: Shipment[]) {\r\n  return {\r\n    total: shipments?.length || 0,\r\n    byStatus: shipments?.reduce((acc, shipment) => {\r\n      acc[shipment.status] = (acc[shipment.status] || 0) + 1;\r\n      return acc;\r\n    }, {} as Record<ShipmentStatus, number>) || {},\r\n    totalCost: shipments?.reduce((acc, shipment) => acc + shipment.total_cost, 0) || 0,\r\n    averageCost: shipments?.length \r\n      ? (shipments.reduce((acc, shipment) => acc + shipment.total_cost, 0) / shipments.length)\r\n      : 0\r\n  };\r\n}\r\n\r\n// =====================================================\r\n// HOOK: useBulkShipmentOperations\r\n// =====================================================\r\n\r\nexport function useBulkShipmentOperations() {\r\n  const queryClient = useQueryClient();\r\n  const [selectedShipments, setSelectedShipments] = useState<number[]>([]);\r\n  \r\n  const bulkUpdateStatus = useMutation({\r\n    mutationFn: async ({ shipmentIds, status }: { shipmentIds: number[]; status: ShipmentStatus }) => {\r\n      const promises = shipmentIds.map(id => updateShipment(id, { status }));\r\n      return Promise.all(promises);\r\n    },\r\n    onSuccess: (_, { shipmentIds, status }) => {\r\n      queryClient.invalidateQueries({ queryKey: SHIPMENTS_QUERY_KEY });\r\n      queryClient.invalidateQueries({ queryKey: ['admin', 'logistics', 'dashboard'] });\r\n      \r\n      toast.success(`${shipmentIds.length} envíos actualizados a ${status}`);\r\n      setSelectedShipments([]);\r\n    },\r\n    onError: (error: Error) => {\r\n      toast.error('Error en operación masiva', {\r\n        description: error.message\r\n      });\r\n    }\r\n  });\r\n  \r\n  const bulkDelete = useMutation({\r\n    mutationFn: async (shipmentIds: number[]) => {\r\n      const promises = shipmentIds.map(id => deleteShipment(id));\r\n      return Promise.all(promises);\r\n    },\r\n    onSuccess: (_, shipmentIds) => {\r\n      queryClient.invalidateQueries({ queryKey: SHIPMENTS_QUERY_KEY });\r\n      queryClient.invalidateQueries({ queryKey: ['admin', 'logistics', 'dashboard'] });\r\n      \r\n      toast.success(`${shipmentIds.length} envíos eliminados`);\r\n      setSelectedShipments([]);\r\n    },\r\n    onError: (error: Error) => {\r\n      toast.error('Error al eliminar envíos', {\r\n        description: error.message\r\n      });\r\n    }\r\n  });\r\n  \r\n  const toggleSelection = useCallback((shipmentId: number) => {\r\n    setSelectedShipments(prev => \r\n      prev.includes(shipmentId)\r\n        ? prev.filter(id => id !== shipmentId)\r\n        : [...prev, shipmentId]\r\n    );\r\n  }, []);\r\n  \r\n  const selectAll = useCallback((shipmentIds: number[]) => {\r\n    setSelectedShipments(shipmentIds);\r\n  }, []);\r\n  \r\n  const clearSelection = useCallback(() => {\r\n    setSelectedShipments([]);\r\n  }, []);\r\n  \r\n  return {\r\n    selectedShipments,\r\n    toggleSelection,\r\n    selectAll,\r\n    clearSelection,\r\n    bulkUpdateStatus,\r\n    bulkDelete,\r\n    isLoading: bulkUpdateStatus.isPending || bulkDelete.isPending\r\n  };\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":["useBulkShipmentOperations","useCreateShipment","useDeleteShipment","useShipmentFilters","useShipmentStats","useShipments","useUpdateShipment","SHIPMENTS_QUERY_KEY","STALE_TIME","fetchShipments","params","searchParams","URLSearchParams","Object","entries","forEach","key","value","undefined","append","toString","response","fetch","method","headers","ok","errorData","json","catch","Error","error","status","statusText","createShipment","data","body","JSON","stringify","result","updateShipment","id","deleteShipment","queryClient","useQueryClient","queryKey","isLoading","refetch","useQuery","queryFn","staleTime","retry","retryDelay","attemptIndex","Math","min","useMutation","mutationFn","onSuccess","newShipment","invalidateQueries","toast","success","description","shipment_number","onError","message","updatedShipment","setQueryData","_","deletedId","removeQueries","filters","setFilters","useState","page","limit","order_by","order_direction","updateFilter","useCallback","prev","resetFilters","setPage","setStatus","setSearch","search","setDateRange","dateFrom","dateTo","date_from","date_to","shipments","total","length","byStatus","reduce","acc","shipment","totalCost","total_cost","averageCost","selectedShipments","setSelectedShipments","bulkUpdateStatus","shipmentIds","promises","map","Promise","all","bulkDelete","toggleSelection","shipmentId","includes","filter","selectAll","clearSelection","isPending"],"mappings":"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"}