{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\hooks\\__tests__\\useFilterAnalytics.test.ts"],"sourcesContent":["// ===================================\r\n// TESTS: useFilterAnalytics - Hook de Analytics para Filtros\r\n// ===================================\r\n\r\nimport { renderHook, act } from '@testing-library/react';\r\nimport { useFilterAnalytics } from '../useFilterAnalytics';\r\n\r\n// ===================================\r\n// MOCKS\r\n// ===================================\r\n\r\n// Mock fetch global\r\nglobal.fetch = jest.fn();\r\n\r\n// Mock window.gtag\r\nObject.defineProperty(window, 'gtag', {\r\n  value: jest.fn(),\r\n  writable: true,\r\n});\r\n\r\n// Mock sessionStorage\r\nconst mockSessionStorage = {\r\n  getItem: jest.fn(),\r\n  setItem: jest.fn(),\r\n  removeItem: jest.fn(),\r\n  clear: jest.fn(),\r\n};\r\n\r\nObject.defineProperty(window, 'sessionStorage', {\r\n  value: mockSessionStorage,\r\n  writable: true,\r\n});\r\n\r\n// Mock window.location\r\nObject.defineProperty(window, 'location', {\r\n  value: {\r\n    href: 'http://localhost:3000/test',\r\n    pathname: '/test',\r\n    search: '?categories=Exterior',\r\n  },\r\n  writable: true,\r\n});\r\n\r\n// Mock document.title\r\nObject.defineProperty(document, 'title', {\r\n  value: 'Test Page - Pinteya',\r\n  writable: true,\r\n});\r\n\r\n// ===================================\r\n// SETUP Y HELPERS\r\n// ===================================\r\n\r\nconst mockFetchResponse = (success = true, data = {}) => {\r\n  (global.fetch as jest.Mock).mockResolvedValueOnce({\r\n    ok: success,\r\n    json: async () => data,\r\n  });\r\n};\r\n\r\n// ===================================\r\n// TESTS PRINCIPALES\r\n// ===================================\r\n\r\ndescribe('useFilterAnalytics', () => {\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n    mockSessionStorage.getItem.mockReturnValue(null);\r\n    console.log = jest.fn();\r\n    console.warn = jest.fn();\r\n  });\r\n\r\n  // ===================================\r\n  // TESTS DE INICIALIZACIÓN\r\n  // ===================================\r\n\r\n  describe('Inicialización', () => {\r\n    it('inicializa con configuración por defecto', () => {\r\n      const { result } = renderHook(() => useFilterAnalytics());\r\n      \r\n      expect(result.current.enabled).toBe(true);\r\n      expect(result.current.sessionId).toMatch(/^session_\\d+_[a-z0-9]+$/);\r\n      expect(result.current.userId).toBeUndefined();\r\n    });\r\n\r\n    it('acepta configuración personalizada', () => {\r\n      const { result } = renderHook(() => \r\n        useFilterAnalytics({\r\n          enabled: false,\r\n          debug: true,\r\n          sessionId: 'custom-session-123',\r\n          userId: 'user-456',\r\n        })\r\n      );\r\n      \r\n      expect(result.current.enabled).toBe(false);\r\n      expect(result.current.sessionId).toBe('custom-session-123');\r\n      expect(result.current.userId).toBe('user-456');\r\n    });\r\n\r\n    it('genera sessionId único cuando no se proporciona', () => {\r\n      const { result: result1 } = renderHook(() => useFilterAnalytics());\r\n      const { result: result2 } = renderHook(() => useFilterAnalytics());\r\n      \r\n      expect(result1.current.sessionId).not.toBe(result2.current.sessionId);\r\n    });\r\n\r\n    it('usa sessionId del sessionStorage si existe', () => {\r\n      mockSessionStorage.getItem.mockReturnValue('existing-session-789');\r\n      \r\n      const { result } = renderHook(() => useFilterAnalytics());\r\n      \r\n      expect(result.current.sessionId).toBe('existing-session-789');\r\n    });\r\n  });\r\n\r\n  // ===================================\r\n  // TESTS DE TRACKING DE FILTROS\r\n  // ===================================\r\n\r\n  describe('Tracking de Filtros', () => {\r\n    it('trackea aplicación de filtro correctamente', async () => {\r\n      mockFetchResponse(true);\r\n      \r\n      const { result } = renderHook(() => useFilterAnalytics());\r\n      \r\n      await act(async () => {\r\n        result.current.trackFilterApplied('category', 'Exterior', 12);\r\n      });\r\n      \r\n      expect(global.fetch).toHaveBeenCalledWith('/api/analytics/events', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: expect.stringContaining('\"event\":\"filter_applied\"'),\r\n      });\r\n      \r\n      expect(window.gtag).toHaveBeenCalledWith('event', 'applied', expect.any(Object));\r\n    });\r\n\r\n    it('trackea remoción de filtro correctamente', async () => {\r\n      mockFetchResponse(true);\r\n      \r\n      const { result } = renderHook(() => useFilterAnalytics());\r\n      \r\n      await act(async () => {\r\n        result.current.trackFilterRemoved('brand', 'Sherwin Williams', 2);\r\n      });\r\n      \r\n      expect(global.fetch).toHaveBeenCalledWith('/api/analytics/events', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: expect.stringContaining('\"event\":\"filter_removed\"'),\r\n      });\r\n    });\r\n\r\n    it('trackea limpieza de filtros correctamente', async () => {\r\n      mockFetchResponse(true);\r\n      \r\n      const { result } = renderHook(() => useFilterAnalytics());\r\n      \r\n      await act(async () => {\r\n        result.current.trackFiltersCleared(3, ['category', 'brand', 'price_range']);\r\n      });\r\n      \r\n      expect(global.fetch).toHaveBeenCalledWith('/api/analytics/events', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: expect.stringContaining('\"event\":\"filter_cleared\"'),\r\n      });\r\n    });\r\n\r\n    it('trackea búsqueda correctamente', async () => {\r\n      mockFetchResponse(true);\r\n      \r\n      const { result } = renderHook(() => useFilterAnalytics());\r\n      \r\n      await act(async () => {\r\n        result.current.trackSearchPerformed('pintura exterior', 15, true, 2);\r\n      });\r\n      \r\n      expect(global.fetch).toHaveBeenCalledWith('/api/analytics/events', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: expect.stringContaining('\"event\":\"filter_search\"'),\r\n      });\r\n    });\r\n\r\n    it('trackea paginación correctamente', async () => {\r\n      mockFetchResponse(true);\r\n      \r\n      const { result } = renderHook(() => useFilterAnalytics());\r\n      \r\n      await act(async () => {\r\n        result.current.trackPaginationUsed(1, 2, 5, 12);\r\n      });\r\n      \r\n      expect(global.fetch).toHaveBeenCalledWith('/api/analytics/events', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: expect.stringContaining('\"event\":\"filter_pagination\"'),\r\n      });\r\n    });\r\n\r\n    it('trackea cambio de ordenamiento correctamente', async () => {\r\n      mockFetchResponse(true);\r\n      \r\n      const { result } = renderHook(() => useFilterAnalytics());\r\n      \r\n      await act(async () => {\r\n        result.current.trackSortChanged('created_at', 'price_asc', 20);\r\n      });\r\n      \r\n      expect(global.fetch).toHaveBeenCalledWith('/api/analytics/events', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: expect.stringContaining('\"event\":\"filter_sort_changed\"'),\r\n      });\r\n    });\r\n  });\r\n\r\n  // ===================================\r\n  // TESTS DE TRACKING AUTOMÁTICO\r\n  // ===================================\r\n\r\n  describe('Tracking Automático de Cambios', () => {\r\n    it('detecta y trackea filtros añadidos', async () => {\r\n      mockFetchResponse(true);\r\n      \r\n      const { result } = renderHook(() => useFilterAnalytics());\r\n      \r\n      const previousFilters = {\r\n        categories: [],\r\n        brands: [],\r\n        priceMin: undefined,\r\n        priceMax: undefined,\r\n        search: '',\r\n        sortBy: 'created_at',\r\n        page: 1,\r\n        limit: 12,\r\n      };\r\n      \r\n      const currentFilters = {\r\n        categories: ['Exterior'],\r\n        brands: [],\r\n        priceMin: undefined,\r\n        priceMax: undefined,\r\n        search: '',\r\n        sortBy: 'created_at',\r\n        page: 1,\r\n        limit: 12,\r\n      };\r\n      \r\n      await act(async () => {\r\n        result.current.trackFilterChanges(previousFilters, currentFilters, 12);\r\n      });\r\n      \r\n      expect(global.fetch).toHaveBeenCalledWith('/api/analytics/events', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: expect.stringContaining('\"event\":\"filter_applied\"'),\r\n      });\r\n    });\r\n\r\n    it('detecta y trackea filtros removidos', async () => {\r\n      mockFetchResponse(true);\r\n      \r\n      const { result } = renderHook(() => useFilterAnalytics());\r\n      \r\n      const previousFilters = {\r\n        categories: ['Exterior', 'Interior'],\r\n        brands: ['Sherwin Williams'],\r\n        priceMin: undefined,\r\n        priceMax: undefined,\r\n        search: '',\r\n        sortBy: 'created_at',\r\n        page: 1,\r\n        limit: 12,\r\n      };\r\n      \r\n      const currentFilters = {\r\n        categories: ['Exterior'],\r\n        brands: [],\r\n        priceMin: undefined,\r\n        priceMax: undefined,\r\n        search: '',\r\n        sortBy: 'created_at',\r\n        page: 1,\r\n        limit: 12,\r\n      };\r\n      \r\n      await act(async () => {\r\n        result.current.trackFilterChanges(previousFilters, currentFilters, 8);\r\n      });\r\n      \r\n      // Debe trackear remoción de 'Interior' y 'Sherwin Williams'\r\n      // Verificar que se llamó a fetch para cada remoción específica\r\n      expect(global.fetch).toHaveBeenCalledWith('/api/analytics/events',\r\n        expect.objectContaining({\r\n          method: 'POST',\r\n          body: expect.stringContaining('\"filter_value\":\"Interior\"')\r\n        })\r\n      );\r\n      expect(global.fetch).toHaveBeenCalledWith('/api/analytics/events',\r\n        expect.objectContaining({\r\n          method: 'POST',\r\n          body: expect.stringContaining('\"filter_value\":\"Sherwin Williams\"')\r\n        })\r\n      );\r\n      // El hook hace 3 llamadas: 2 remociones + 1 adicional (posiblemente por otros cambios detectados)\r\n      expect(global.fetch).toHaveBeenCalledTimes(3);\r\n    });\r\n\r\n    it('detecta cambios de precio', async () => {\r\n      mockFetchResponse(true);\r\n      \r\n      const { result } = renderHook(() => useFilterAnalytics());\r\n      \r\n      const previousFilters = {\r\n        categories: [],\r\n        brands: [],\r\n        priceMin: undefined,\r\n        priceMax: undefined,\r\n        search: '',\r\n        sortBy: 'created_at',\r\n        page: 1,\r\n        limit: 12,\r\n      };\r\n      \r\n      const currentFilters = {\r\n        categories: [],\r\n        brands: [],\r\n        priceMin: 1000,\r\n        priceMax: 5000,\r\n        search: '',\r\n        sortBy: 'created_at',\r\n        page: 1,\r\n        limit: 12,\r\n      };\r\n      \r\n      await act(async () => {\r\n        result.current.trackFilterChanges(previousFilters, currentFilters, 5);\r\n      });\r\n      \r\n      expect(global.fetch).toHaveBeenCalledWith('/api/analytics/events', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: expect.stringContaining('\"filter_value\":\"1000-5000\"'),\r\n      });\r\n    });\r\n  });\r\n\r\n  // ===================================\r\n  // TESTS DE MANEJO DE ERRORES\r\n  // ===================================\r\n\r\n  describe('Manejo de Errores', () => {\r\n    it('maneja errores de fetch gracefully', async () => {\r\n      (global.fetch as jest.Mock).mockRejectedValueOnce(new Error('Network error'));\r\n      \r\n      const { result } = renderHook(() => useFilterAnalytics());\r\n      \r\n      await act(async () => {\r\n        result.current.trackFilterApplied('category', 'Exterior', 12);\r\n      });\r\n      \r\n      expect(console.warn).toHaveBeenCalledWith(\r\n        'Failed to send analytics event to Supabase:',\r\n        expect.any(Error)\r\n      );\r\n    });\r\n\r\n    it('continúa funcionando cuando gtag no está disponible', async () => {\r\n      delete (window as any).gtag;\r\n      mockFetchResponse(true);\r\n      \r\n      const { result } = renderHook(() => useFilterAnalytics());\r\n      \r\n      await act(async () => {\r\n        result.current.trackFilterApplied('category', 'Exterior', 12);\r\n      });\r\n      \r\n      // Debe seguir enviando a Supabase\r\n      expect(global.fetch).toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  // ===================================\r\n  // TESTS DE CONFIGURACIÓN\r\n  // ===================================\r\n\r\n  describe('Configuración', () => {\r\n    it('no trackea cuando está deshabilitado', async () => {\r\n      const { result } = renderHook(() => \r\n        useFilterAnalytics({ enabled: false })\r\n      );\r\n      \r\n      await act(async () => {\r\n        result.current.trackFilterApplied('category', 'Exterior', 12);\r\n      });\r\n      \r\n      expect(global.fetch).not.toHaveBeenCalled();\r\n      expect(window.gtag).not.toHaveBeenCalled();\r\n    });\r\n\r\n    it('funciona correctamente en modo debug', async () => {\r\n      mockFetchResponse(true);\r\n\r\n      const { result } = renderHook(() =>\r\n        useFilterAnalytics({ debug: true })\r\n      );\r\n\r\n      await act(async () => {\r\n        result.current.trackFilterApplied('category', 'Exterior', 12);\r\n      });\r\n\r\n      // Verificar que el tracking funciona normalmente en modo debug\r\n      expect(global.fetch).toHaveBeenCalledWith('/api/analytics/events',\r\n        expect.objectContaining({\r\n          method: 'POST',\r\n          body: expect.stringContaining('\"filter_value\":\"Exterior\"')\r\n        })\r\n      );\r\n    });\r\n  });\r\n\r\n  // ===================================\r\n  // TESTS DE EVENTOS DE SESIÓN\r\n  // ===================================\r\n\r\n  describe('Eventos de Sesión', () => {\r\n    it('trackea inicio de sesión al montar', () => {\r\n      mockFetchResponse(true);\r\n      \r\n      renderHook(() => useFilterAnalytics());\r\n      \r\n      expect(global.fetch).toHaveBeenCalledWith('/api/analytics/events', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: expect.stringContaining('\"event\":\"filter_session_started\"'),\r\n      });\r\n    });\r\n\r\n    it('trackea fin de sesión al desmontar', () => {\r\n      mockFetchResponse(true);\r\n      \r\n      const { unmount } = renderHook(() => useFilterAnalytics());\r\n      \r\n      jest.clearAllMocks();\r\n      \r\n      unmount();\r\n      \r\n      expect(global.fetch).toHaveBeenCalledWith('/api/analytics/events', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: expect.stringContaining('\"event\":\"filter_session_ended\"'),\r\n      });\r\n    });\r\n  });\r\n});\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":["global","fetch","jest","fn","Object","defineProperty","window","value","writable","mockSessionStorage","getItem","setItem","removeItem","clear","href","pathname","search","document","mockFetchResponse","success","data","mockResolvedValueOnce","ok","json","describe","beforeEach","clearAllMocks","mockReturnValue","console","log","warn","it","result","renderHook","useFilterAnalytics","expect","current","enabled","toBe","sessionId","toMatch","userId","toBeUndefined","debug","result1","result2","not","act","trackFilterApplied","toHaveBeenCalledWith","method","headers","body","stringContaining","gtag","any","trackFilterRemoved","trackFiltersCleared","trackSearchPerformed","trackPaginationUsed","trackSortChanged","previousFilters","categories","brands","priceMin","undefined","priceMax","sortBy","page","limit","currentFilters","trackFilterChanges","objectContaining","toHaveBeenCalledTimes","mockRejectedValueOnce","Error","toHaveBeenCalled","unmount"],"mappings":"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"}