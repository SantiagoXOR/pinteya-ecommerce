{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\app\\api\\admin\\create-admin-user-enterprise\\route.ts"],"sourcesContent":["// Configuración para Node.js Runtime\r\nexport const runtime = 'nodejs';\r\n\r\n/**\r\n * API Enterprise para crear usuario administrador\r\n * Refactorizada con utilidades enterprise + RLS + validaciones robustas\r\n */\r\n\r\nimport { NextRequest, NextResponse } from 'next/server';\r\nimport { supabaseAdmin } from '@/lib/integrations/supabase';\r\nimport { \r\n  requireCriticalAuth \r\n} from '@/lib/auth/enterprise-auth-utils';\r\nimport {\r\n  executeWithRLS,\r\n  checkRLSPermission\r\n} from '@/lib/auth/enterprise-rls-utils';\r\nimport {\r\n  invalidateUserCache\r\n} from '@/lib/auth/enterprise-cache';\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    // ENTERPRISE: Autenticación crítica para operaciones de creación de admin\r\n    const authResult = await requireCriticalAuth(request);\r\n\r\n    if (!authResult.success) {\r\n      return NextResponse.json(\r\n        { \r\n          error: authResult.error,\r\n          code: authResult.code,\r\n          enterprise: true,\r\n          operation: 'CREATE_ADMIN_USER'\r\n        },\r\n        { status: authResult.status || 401 }\r\n      );\r\n    }\r\n\r\n    const context = authResult.context!;\r\n\r\n    // ENTERPRISE: Verificar permisos específicos para crear admins\r\n    if (!context.permissions.includes('admin_create') && context.role !== 'admin') {\r\n      return NextResponse.json(\r\n        { \r\n          error: 'Permisos insuficientes para crear usuarios administradores',\r\n          code: 'INSUFFICIENT_PERMISSIONS',\r\n          enterprise: true,\r\n          required_permissions: ['admin_create']\r\n        },\r\n        { status: 403 }\r\n      );\r\n    }\r\n\r\n    const { \r\n      securityKey, \r\n      email, \r\n      password, \r\n      firstName = 'Admin', \r\n      lastName = 'User',\r\n      permissions = ['admin_access', 'user_management', 'products_create', 'products_update', 'products_delete']\r\n    } = await request.json();\r\n\r\n    // ENTERPRISE: Validación de clave de seguridad\r\n    if (securityKey !== 'CREATE_ADMIN_PINTEYA_ENTERPRISE_2025') {\r\n      return NextResponse.json(\r\n        { \r\n          error: 'Clave de seguridad enterprise incorrecta',\r\n          code: 'INVALID_SECURITY_KEY',\r\n          enterprise: true\r\n        },\r\n        { status: 403 }\r\n      );\r\n    }\r\n\r\n    // ENTERPRISE: Validaciones robustas\r\n    if (!email || !password) {\r\n      return NextResponse.json(\r\n        { \r\n          error: 'Email y contraseña son requeridos',\r\n          code: 'MISSING_REQUIRED_FIELDS',\r\n          enterprise: true\r\n        },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // ENTERPRISE: Validación de email\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    if (!emailRegex.test(email)) {\r\n      return NextResponse.json(\r\n        { \r\n          error: 'Formato de email inválido',\r\n          code: 'INVALID_EMAIL_FORMAT',\r\n          enterprise: true\r\n        },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // ENTERPRISE: Validación de contraseña robusta\r\n    if (password.length < 12) {\r\n      return NextResponse.json(\r\n        { \r\n          error: 'La contraseña debe tener al menos 12 caracteres para admin',\r\n          code: 'WEAK_PASSWORD',\r\n          enterprise: true\r\n        },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // ENTERPRISE: Validación de complejidad de contraseña\r\n    const hasUpperCase = /[A-Z]/.test(password);\r\n    const hasLowerCase = /[a-z]/.test(password);\r\n    const hasNumbers = /\\d/.test(password);\r\n    const hasSpecialChar = /[!@#$%^&*(),.?\":{}|<>]/.test(password);\r\n\r\n    if (!hasUpperCase || !hasLowerCase || !hasNumbers || !hasSpecialChar) {\r\n      return NextResponse.json(\r\n        { \r\n          error: 'La contraseña debe contener mayúsculas, minúsculas, números y caracteres especiales',\r\n          code: 'PASSWORD_COMPLEXITY_FAILED',\r\n          enterprise: true\r\n        },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // ENTERPRISE: Ejecutar creación con RLS y auditoría\r\n    const result = await executeWithRLS(\r\n      context,\r\n      async (client, rlsContext) => {\r\n        // Verificar permisos RLS específicos\r\n        if (!checkRLSPermission(rlsContext, 'admin_create')) {\r\n          throw new Error('Permisos RLS insuficientes para crear administradores');\r\n        }\r\n\r\n        // 1. Verificar si el usuario ya existe en auth.users\r\n        const { data: existingAuthUser } = await supabaseAdmin.auth.admin.listUsers();\r\n        const userExists = existingAuthUser.users.find(u => u.email === email);\r\n\r\n        let authUser;\r\n\r\n        if (userExists) {\r\n          authUser = userExists;\r\n        } else {\r\n          // 2. Crear usuario en Supabase Auth con metadata enterprise\r\n          const { data: newAuthUser, error: authError } = await supabaseAdmin.auth.admin.createUser({\r\n            email,\r\n            password,\r\n            email_confirm: true,\r\n            user_metadata: {\r\n              first_name: firstName,\r\n              last_name: lastName,\r\n              role: 'admin',\r\n              created_by: context.userId,\r\n              enterprise_admin: true,\r\n              security_level: 'critical'\r\n            }\r\n          });\r\n\r\n          if (authError) {\r\n            throw new Error(`Error creando usuario en Auth: ${authError.message}`);\r\n          }\r\n\r\n          authUser = newAuthUser.user;\r\n        }\r\n\r\n        // 3. Verificar si el perfil ya existe\r\n        const { data: existingProfile } = await client\r\n          .from('user_profiles')\r\n          .select('*')\r\n          .eq('email', email)\r\n          .single();\r\n\r\n        if (existingProfile) {\r\n          // 4. Actualizar perfil existente con datos enterprise\r\n          const { data: updatedProfile, error: updateError } = await client\r\n            .from('user_profiles')\r\n            .update({\r\n              supabase_user_id: authUser.id,\r\n              first_name: firstName,\r\n              last_name: lastName,\r\n              permissions: permissions,\r\n              metadata: {\r\n                ...existingProfile.metadata,\r\n                updated_by: context.userId,\r\n                enterprise_admin: true,\r\n                last_admin_update: new Date().toISOString()\r\n              },\r\n              updated_at: new Date().toISOString()\r\n            })\r\n            .eq('email', email)\r\n            .select(`\r\n              *,\r\n              user_roles (\r\n                role_name,\r\n                permissions\r\n              )\r\n            `)\r\n            .single();\r\n\r\n          if (updateError) {\r\n            throw new Error(`Error actualizando perfil: ${updateError.message}`);\r\n          }\r\n\r\n          return {\r\n            action: 'updated',\r\n            authUser,\r\n            profile: updatedProfile\r\n          };\r\n        } else {\r\n          // 5. Obtener rol de admin\r\n          const { data: adminRole } = await client\r\n            .from('user_roles')\r\n            .select('id')\r\n            .eq('role_name', 'admin')\r\n            .single();\r\n\r\n          if (!adminRole) {\r\n            throw new Error('Rol de admin no encontrado en la base de datos');\r\n          }\r\n\r\n          // 6. Crear nuevo perfil enterprise\r\n          const { data: newProfile, error: profileError } = await client\r\n            .from('user_profiles')\r\n            .insert({\r\n              supabase_user_id: authUser.id,\r\n              email,\r\n              first_name: firstName,\r\n              last_name: lastName,\r\n              role_id: adminRole.id,\r\n              permissions: permissions,\r\n              is_active: true,\r\n              is_verified: true,\r\n              metadata: {\r\n                created_by: context.userId,\r\n                enterprise_admin: true,\r\n                security_level: 'critical',\r\n                created_via: 'enterprise_api'\r\n              },\r\n              created_at: new Date().toISOString(),\r\n              updated_at: new Date().toISOString()\r\n            })\r\n            .select(`\r\n              *,\r\n              user_roles (\r\n                role_name,\r\n                permissions\r\n              )\r\n            `)\r\n            .single();\r\n\r\n          if (profileError) {\r\n            throw new Error(`Error creando perfil: ${profileError.message}`);\r\n          }\r\n\r\n          return {\r\n            action: 'created',\r\n            authUser,\r\n            profile: newProfile\r\n          };\r\n        }\r\n      },\r\n      {\r\n        enforceRLS: true,\r\n        auditLog: true,\r\n        adminOverride: true // Permitir bypass RLS para esta operación crítica\r\n      }\r\n    );\r\n\r\n    if (!result.success) {\r\n      return NextResponse.json(\r\n        { \r\n          error: result.error,\r\n          code: result.code,\r\n          enterprise: true,\r\n          rls: true\r\n        },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const { action, authUser, profile } = result.data!;\r\n\r\n    // ENTERPRISE: Invalidar cache relacionado\r\n    invalidateUserCache(authUser.id);\r\n\r\n    // ENTERPRISE: Respuesta enterprise con información completa\r\n    return NextResponse.json({\r\n      success: true,\r\n      message: `Usuario administrador ${action === 'created' ? 'creado' : 'actualizado'} correctamente`,\r\n      data: {\r\n        action,\r\n        user: {\r\n          auth_id: authUser.id,\r\n          email: authUser.email,\r\n          profile: {\r\n            id: profile.id,\r\n            name: `${profile.first_name} ${profile.last_name}`,\r\n            role: profile.user_roles?.role_name,\r\n            permissions: profile.permissions,\r\n            is_active: profile.is_active,\r\n            created_at: profile.created_at\r\n          }\r\n        }\r\n      },\r\n      enterprise: {\r\n        security_level: 'critical',\r\n        rls_enabled: true,\r\n        created_by: context.userId,\r\n        permissions_granted: permissions\r\n      },\r\n      timestamp: new Date().toISOString()\r\n    }, { status: action === 'created' ? 201 : 200 });\r\n\r\n  } catch (error) {\r\n    console.error('[ENTERPRISE] Error en create-admin-user-enterprise:', error);\r\n    return NextResponse.json(\r\n      { \r\n        error: 'Error interno del servidor enterprise',\r\n        code: 'INTERNAL_SERVER_ERROR',\r\n        enterprise: true\r\n      },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\nexport async function GET() {\r\n  return NextResponse.json({\r\n    message: 'API Enterprise para crear usuario administrador',\r\n    enterprise: true,\r\n    instructions: {\r\n      method: 'POST',\r\n      required_fields: ['securityKey', 'email', 'password'],\r\n      optional_fields: ['firstName', 'lastName', 'permissions'],\r\n      security_key: 'CREATE_ADMIN_PINTEYA_ENTERPRISE_2025',\r\n      password_requirements: {\r\n        min_length: 12,\r\n        must_contain: ['uppercase', 'lowercase', 'numbers', 'special_chars']\r\n      }\r\n    },\r\n    features: [\r\n      'Enterprise authentication with critical security level',\r\n      'Row Level Security (RLS) enforcement',\r\n      'Robust password validation',\r\n      'Audit logging',\r\n      'Cache invalidation',\r\n      'Comprehensive error handling'\r\n    ]\r\n  });\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":["GET","POST","runtime","request","authResult","requireCriticalAuth","success","NextResponse","json","error","code","enterprise","operation","status","context","permissions","includes","role","required_permissions","securityKey","email","password","firstName","lastName","emailRegex","test","length","hasUpperCase","hasLowerCase","hasNumbers","hasSpecialChar","result","executeWithRLS","client","rlsContext","checkRLSPermission","Error","data","existingAuthUser","supabaseAdmin","auth","admin","listUsers","userExists","users","find","u","authUser","newAuthUser","authError","createUser","email_confirm","user_metadata","first_name","last_name","created_by","userId","enterprise_admin","security_level","message","user","existingProfile","from","select","eq","single","updatedProfile","updateError","update","supabase_user_id","id","metadata","updated_by","last_admin_update","Date","toISOString","updated_at","action","profile","adminRole","newProfile","profileError","insert","role_id","is_active","is_verified","created_via","created_at","enforceRLS","auditLog","adminOverride","rls","invalidateUserCache","auth_id","name","user_roles","role_name","rls_enabled","permissions_granted","timestamp","console","instructions","method","required_fields","optional_fields","security_key","password_requirements","min_length","must_contain","features"],"mappings":"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"}