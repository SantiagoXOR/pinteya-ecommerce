{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\lib\\logging\\security-logger.ts"],"sourcesContent":["// ===================================\r\n// PINTEYA E-COMMERCE - LOGGING ESTRUCTURADO DE SEGURIDAD\r\n// ===================================\r\n// Sistema de logging estructurado para eventos de seguridad\r\n// con contexto enriquecido y formato consistente\r\n\r\nimport { NextRequest } from 'next/server';\r\n\r\n// ===================================\r\n// TIPOS Y INTERFACES\r\n// ===================================\r\n\r\nexport interface SecurityLogContext {\r\n  userId?: string;\r\n  sessionId?: string;\r\n  ip?: string;\r\n  userAgent?: string;\r\n  endpoint: string;\r\n  method: string;\r\n  timestamp: string;\r\n  requestId?: string;\r\n}\r\n\r\nexport interface SecurityEvent {\r\n  type: SecurityEventType;\r\n  severity: SecuritySeverity;\r\n  message: string;\r\n  context: SecurityLogContext;\r\n  metadata?: Record<string, any>;\r\n  error?: Error;\r\n}\r\n\r\nexport type SecurityEventType = \r\n  | 'auth_attempt'\r\n  | 'auth_success'\r\n  | 'auth_failure'\r\n  | 'rate_limit_exceeded'\r\n  | 'permission_denied'\r\n  | 'suspicious_activity'\r\n  | 'data_access'\r\n  | 'admin_action'\r\n  | 'api_error'\r\n  | 'validation_error'\r\n  | 'security_scan'\r\n  | 'unauthorized_access';\r\n\r\nexport type SecuritySeverity = 'low' | 'medium' | 'high' | 'critical';\r\n\r\nexport interface SecurityLogger {\r\n  log(event: SecurityEvent): void;\r\n  logAuthAttempt(context: SecurityLogContext, success: boolean, metadata?: Record<string, any>): void;\r\n  logRateLimitExceeded(context: SecurityLogContext, metadata?: Record<string, any>): void;\r\n  logPermissionDenied(context: SecurityLogContext, resource: string, action: string): void;\r\n  logSuspiciousActivity(context: SecurityLogContext, reason: string, metadata?: Record<string, any>): void;\r\n  logAdminAction(context: SecurityLogContext, action: string, metadata?: Record<string, any>): void;\r\n  logApiError(context: SecurityLogContext, error: Error, metadata?: Record<string, any>): void;\r\n}\r\n\r\n// ===================================\r\n// EXTRACTOR DE CONTEXTO DE REQUEST\r\n// ===================================\r\n\r\nexport function extractSecurityContext(\r\n  request: NextRequest,\r\n  additionalContext: Partial<SecurityLogContext> = {}\r\n): SecurityLogContext {\r\n  const url = new URL(request.url);\r\n  \r\n  // Extraer IP de headers\r\n  const forwarded = request.headers.get('x-forwarded-for');\r\n  const ip = forwarded \r\n    ? forwarded.split(',')[0].trim() \r\n    : request.headers.get('x-real-ip') || 'unknown';\r\n  \r\n  // Generar request ID único\r\n  const requestId = request.headers.get('x-request-id') || \r\n    `req_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n  \r\n  return {\r\n    ip,\r\n    userAgent: request.headers.get('user-agent') || 'unknown',\r\n    endpoint: url.pathname,\r\n    method: request.method,\r\n    timestamp: new Date().toISOString(),\r\n    requestId,\r\n    ...additionalContext,\r\n  };\r\n}\r\n\r\n// ===================================\r\n// IMPLEMENTACIÓN DEL LOGGER\r\n// ===================================\r\n\r\nclass SecurityLoggerImpl implements SecurityLogger {\r\n  private formatLogEntry(event: SecurityEvent): string {\r\n    const logEntry = {\r\n      timestamp: event.context.timestamp,\r\n      level: this.mapSeverityToLevel(event.severity),\r\n      type: 'SECURITY',\r\n      event_type: event.type,\r\n      severity: event.severity,\r\n      message: event.message,\r\n      context: event.context,\r\n      metadata: event.metadata,\r\n      error: event.error ? {\r\n        name: event.error.name,\r\n        message: event.error.message,\r\n        stack: event.error.stack,\r\n      } : undefined,\r\n    };\r\n    \r\n    return JSON.stringify(logEntry, null, process.env.NODE_ENV === 'development' ? 2 : 0);\r\n  }\r\n  \r\n  private mapSeverityToLevel(severity: SecuritySeverity): string {\r\n    switch (severity) {\r\n      case 'low': return 'info';\r\n      case 'medium': return 'warn';\r\n      case 'high': return 'error';\r\n      case 'critical': return 'error';\r\n      default: return 'info';\r\n    }\r\n  }\r\n  \r\n  private shouldLog(severity: SecuritySeverity): boolean {\r\n    const logLevel = process.env.SECURITY_LOG_LEVEL || 'medium';\r\n    \r\n    const levels = { low: 1, medium: 2, high: 3, critical: 4 };\r\n    const currentLevel = levels[logLevel as SecuritySeverity] || 2;\r\n    const eventLevel = levels[severity];\r\n    \r\n    return eventLevel >= currentLevel;\r\n  }\r\n  \r\n  log(event: SecurityEvent): void {\r\n    if (!this.shouldLog(event.severity)) {\r\n      return;\r\n    }\r\n    \r\n    const logEntry = this.formatLogEntry(event);\r\n    \r\n    // En desarrollo, usar console con colores\r\n    if (process.env.NODE_ENV === 'development') {\r\n      const colors = {\r\n        low: '\\x1b[36m',      // cyan\r\n        medium: '\\x1b[33m',   // yellow\r\n        high: '\\x1b[31m',     // red\r\n        critical: '\\x1b[35m', // magenta\r\n      };\r\n      \r\n      const reset = '\\x1b[0m';\r\n      const color = colors[event.severity];\r\n      \r\n      console.log(`${color}[SECURITY:${event.type.toUpperCase()}]${reset}`, logEntry);\r\n    } else {\r\n      // En producción, usar console.log estándar para integración con sistemas de logging\r\n      console.log(logEntry);\r\n    }\r\n    \r\n    // TODO: Integrar con servicio de logging externo (DataDog, LogRocket, etc.)\r\n    // await this.sendToExternalLogger(logEntry);\r\n  }\r\n  \r\n  logAuthAttempt(\r\n    context: SecurityLogContext, \r\n    success: boolean, \r\n    metadata?: Record<string, any>\r\n  ): void {\r\n    this.log({\r\n      type: success ? 'auth_success' : 'auth_failure',\r\n      severity: success ? 'low' : 'medium',\r\n      message: success \r\n        ? `Authentication successful for ${context.userId || 'unknown user'}` \r\n        : `Authentication failed for ${context.userId || 'unknown user'}`,\r\n      context,\r\n      metadata: {\r\n        success,\r\n        ...metadata,\r\n      },\r\n    });\r\n  }\r\n  \r\n  logRateLimitExceeded(\r\n    context: SecurityLogContext, \r\n    metadata?: Record<string, any>\r\n  ): void {\r\n    this.log({\r\n      type: 'rate_limit_exceeded',\r\n      severity: 'medium',\r\n      message: `Rate limit exceeded for ${context.endpoint}`,\r\n      context,\r\n      metadata: {\r\n        endpoint: context.endpoint,\r\n        ip: context.ip,\r\n        ...metadata,\r\n      },\r\n    });\r\n  }\r\n  \r\n  logPermissionDenied(\r\n    context: SecurityLogContext, \r\n    resource: string, \r\n    action: string\r\n  ): void {\r\n    this.log({\r\n      type: 'permission_denied',\r\n      severity: 'high',\r\n      message: `Permission denied: ${action} on ${resource}`,\r\n      context,\r\n      metadata: {\r\n        resource,\r\n        action,\r\n        userId: context.userId,\r\n      },\r\n    });\r\n  }\r\n  \r\n  logSuspiciousActivity(\r\n    context: SecurityLogContext, \r\n    reason: string, \r\n    metadata?: Record<string, any>\r\n  ): void {\r\n    this.log({\r\n      type: 'suspicious_activity',\r\n      severity: 'high',\r\n      message: `Suspicious activity detected: ${reason}`,\r\n      context,\r\n      metadata: {\r\n        reason,\r\n        ...metadata,\r\n      },\r\n    });\r\n  }\r\n  \r\n  logAdminAction(\r\n    context: SecurityLogContext, \r\n    action: string, \r\n    metadata?: Record<string, any>\r\n  ): void {\r\n    this.log({\r\n      type: 'admin_action',\r\n      severity: 'medium',\r\n      message: `Admin action performed: ${action}`,\r\n      context,\r\n      metadata: {\r\n        action,\r\n        adminUserId: context.userId,\r\n        ...metadata,\r\n      },\r\n    });\r\n  }\r\n  \r\n  logApiError(\r\n    context: SecurityLogContext, \r\n    error: Error, \r\n    metadata?: Record<string, any>\r\n  ): void {\r\n    this.log({\r\n      type: 'api_error',\r\n      severity: 'medium',\r\n      message: `API error in ${context.endpoint}: ${error.message}`,\r\n      context,\r\n      error,\r\n      metadata,\r\n    });\r\n  }\r\n}\r\n\r\n// ===================================\r\n// INSTANCIA GLOBAL Y FACTORY\r\n// ===================================\r\n\r\nconst globalSecurityLogger = new SecurityLoggerImpl();\r\n\r\n/**\r\n * Crea un logger de seguridad con contexto pre-configurado\r\n */\r\nexport function createSecurityLogger(\r\n  request?: NextRequest,\r\n  additionalContext?: Partial<SecurityLogContext>\r\n): SecurityLogger & { context: SecurityLogContext } {\r\n  const context = request \r\n    ? extractSecurityContext(request, additionalContext)\r\n    : {\r\n        endpoint: 'unknown',\r\n        method: 'unknown',\r\n        timestamp: new Date().toISOString(),\r\n        ...additionalContext,\r\n      } as SecurityLogContext;\r\n  \r\n  return {\r\n    context,\r\n    log: globalSecurityLogger.log.bind(globalSecurityLogger),\r\n    logAuthAttempt: (ctx, success, metadata) => \r\n      globalSecurityLogger.logAuthAttempt({ ...context, ...ctx }, success, metadata),\r\n    logRateLimitExceeded: (ctx, metadata) => \r\n      globalSecurityLogger.logRateLimitExceeded({ ...context, ...ctx }, metadata),\r\n    logPermissionDenied: (ctx, resource, action) => \r\n      globalSecurityLogger.logPermissionDenied({ ...context, ...ctx }, resource, action),\r\n    logSuspiciousActivity: (ctx, reason, metadata) => \r\n      globalSecurityLogger.logSuspiciousActivity({ ...context, ...ctx }, reason, metadata),\r\n    logAdminAction: (ctx, action, metadata) => \r\n      globalSecurityLogger.logAdminAction({ ...context, ...ctx }, action, metadata),\r\n    logApiError: (ctx, error, metadata) => \r\n      globalSecurityLogger.logApiError({ ...context, ...ctx }, error, metadata),\r\n  };\r\n}\r\n\r\n// ===================================\r\n// HELPERS Y UTILIDADES\r\n// ===================================\r\n\r\n/**\r\n * Helper para logging rápido de eventos de seguridad\r\n */\r\nexport const securityLog = {\r\n  info: (message: string, context: Partial<SecurityLogContext> = {}) => {\r\n    globalSecurityLogger.log({\r\n      type: 'security_scan',\r\n      severity: 'low',\r\n      message,\r\n      context: {\r\n        endpoint: 'system',\r\n        method: 'SYSTEM',\r\n        timestamp: new Date().toISOString(),\r\n        ...context,\r\n      },\r\n    });\r\n  },\r\n  \r\n  warn: (message: string, context: Partial<SecurityLogContext> = {}) => {\r\n    globalSecurityLogger.log({\r\n      type: 'suspicious_activity',\r\n      severity: 'medium',\r\n      message,\r\n      context: {\r\n        endpoint: 'system',\r\n        method: 'SYSTEM',\r\n        timestamp: new Date().toISOString(),\r\n        ...context,\r\n      },\r\n    });\r\n  },\r\n  \r\n  error: (message: string, error?: Error, context: Partial<SecurityLogContext> = {}) => {\r\n    globalSecurityLogger.log({\r\n      type: 'api_error',\r\n      severity: 'high',\r\n      message,\r\n      error,\r\n      context: {\r\n        endpoint: 'system',\r\n        method: 'SYSTEM',\r\n        timestamp: new Date().toISOString(),\r\n        ...context,\r\n      },\r\n    });\r\n  },\r\n};\r\n\r\nexport default globalSecurityLogger;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":["createSecurityLogger","extractSecurityContext","securityLog","request","additionalContext","url","URL","forwarded","headers","get","ip","split","trim","requestId","Date","now","Math","random","toString","substr","userAgent","endpoint","pathname","method","timestamp","toISOString","SecurityLoggerImpl","formatLogEntry","event","logEntry","context","level","mapSeverityToLevel","severity","type","event_type","message","metadata","error","name","stack","undefined","JSON","stringify","process","env","NODE_ENV","shouldLog","logLevel","SECURITY_LOG_LEVEL","levels","low","medium","high","critical","currentLevel","eventLevel","log","colors","reset","color","console","toUpperCase","logAuthAttempt","success","userId","logRateLimitExceeded","logPermissionDenied","resource","action","logSuspiciousActivity","reason","logAdminAction","adminUserId","logApiError","globalSecurityLogger","bind","ctx","info","warn"],"mappings":"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"}