41462cbd22db2d606e9117f01e9ab814
// Configuración para Node.js Runtime
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get GET () {
        return GET;
    },
    get POST () {
        return POST;
    },
    get runtime () {
        return runtime;
    }
});
const _server = require("next/server");
const _supabase = require("../../../../lib/integrations/supabase");
const _ratelimiter = require("../../../../lib/rate-limiting/rate-limiter");
const _apitimeouts = require("../../../../lib/config/api-timeouts");
const _securitylogger = require("../../../../lib/logging/security-logger");
const runtime = 'nodejs';
// Búsquedas trending generadas dinámicamente basadas en productos reales
async function generateDynamicTrendingSearches(supabase, limit = 6) {
    try {
        // Obtener productos más populares y marcas para generar búsquedas trending realistas
        const { data: products, error: productsError } = await supabase.from('products').select('name, brand, category_id, categories(name)').eq('is_active', true).limit(20);
        if (productsError || !products) {
            console.warn('Error obteniendo productos para trending:', productsError);
            return getFallbackTrendingSearches(limit);
        }
        // Generar búsquedas trending basadas en productos reales
        const trendingSearches = [];
        const usedQueries = new Set();
        // Agregar búsquedas por marca
        const brands = [
            ...new Set(products.map((p)=>p.brand).filter(Boolean))
        ];
        brands.slice(0, 2).forEach((brand, index)=>{
            if (brand && !usedQueries.has(brand.toLowerCase())) {
                trendingSearches.push({
                    id: `trending-brand-${index + 1}`,
                    query: brand,
                    count: Math.floor(Math.random() * 50) + 20,
                    category: 'marcas',
                    href: `/search?q=${encodeURIComponent(brand)}`,
                    type: 'trending'
                });
                usedQueries.add(brand.toLowerCase());
            }
        });
        // Agregar búsquedas por categoría
        const categories = [
            ...new Set(products.map((p)=>p.categories?.name).filter(Boolean))
        ];
        categories.slice(0, 2).forEach((category, index)=>{
            if (category && !usedQueries.has(category.toLowerCase())) {
                trendingSearches.push({
                    id: `trending-category-${index + 1}`,
                    query: category,
                    count: Math.floor(Math.random() * 40) + 15,
                    category: 'pinturas',
                    href: `/search?q=${encodeURIComponent(category)}`,
                    type: 'trending'
                });
                usedQueries.add(category.toLowerCase());
            }
        });
        // Agregar búsquedas por productos específicos
        const popularProducts = products.slice(0, 2);
        popularProducts.forEach((product, index)=>{
            const productName = product.name;
            if (productName && !usedQueries.has(productName.toLowerCase())) {
                trendingSearches.push({
                    id: `trending-product-${index + 1}`,
                    query: productName,
                    count: Math.floor(Math.random() * 30) + 10,
                    category: 'productos',
                    href: `/search?q=${encodeURIComponent(productName)}`,
                    type: 'trending'
                });
                usedQueries.add(productName.toLowerCase());
            }
        });
        // Ordenar por count descendente y limitar
        return trendingSearches.sort((a, b)=>b.count - a.count).slice(0, limit);
    } catch (error) {
        console.error('Error generando trending searches dinámicas:', error);
        return getFallbackTrendingSearches(limit);
    }
}
// Fallback con datos mínimos (solo si falla todo lo demás)
function getFallbackTrendingSearches(limit = 6) {
    const fallbackSearches = [
        {
            query: 'Pintura',
            category: 'pinturas'
        },
        {
            query: 'Esmalte',
            category: 'pinturas'
        },
        {
            query: 'Látex',
            category: 'pinturas'
        },
        {
            query: 'Barniz',
            category: 'pinturas'
        },
        {
            query: 'Imprimación',
            category: 'pinturas'
        },
        {
            query: 'Rodillos',
            category: 'herramientas'
        }
    ];
    return fallbackSearches.slice(0, limit).map((search, index)=>({
            id: `fallback-${index + 1}`,
            query: search.query,
            count: Math.floor(Math.random() * 20) + 5,
            category: search.category,
            href: `/search?q=${encodeURIComponent(search.query.toLowerCase())}`,
            type: 'trending'
        }));
}
async function GET(request) {
    // Crear logger de seguridad con contexto
    const securityLogger = (0, _securitylogger.createSecurityLogger)(request);
    // Aplicar rate limiting para APIs de búsqueda
    const rateLimitResult = await (0, _ratelimiter.withRateLimit)(request, _ratelimiter.RATE_LIMIT_CONFIGS.search, async ()=>{
        // Log de acceso a la API
        securityLogger.log({
            type: 'data_access',
            severity: 'low',
            message: 'Trending search API accessed',
            context: securityLogger.context,
            metadata: {
                endpoint: '/api/search/trending',
                method: 'GET',
                userAgent: request.headers.get('user-agent')
            }
        });
        try {
            const { searchParams } = new URL(request.url);
            const limit = parseInt(searchParams.get('limit') || '6');
            const days = parseInt(searchParams.get('days') || '7');
            const category = searchParams.get('category');
            console.log('🔥 API /api/search/trending: Obteniendo búsquedas trending', {
                limit,
                days,
                category
            });
            const supabase = (0, _supabase.getSupabaseClient)();
            let trendingSearches = [];
            // Intentar obtener búsquedas trending reales del sistema de analytics
            if (supabase) {
                try {
                    const startDate = new Date();
                    startDate.setDate(startDate.getDate() - days);
                    // Query para obtener búsquedas más populares de analytics_events
                    let query = supabase.from('analytics_events').select('label, metadata').eq('category', 'search').eq('action', 'search_query').gte('created_at', startDate.toISOString()).not('label', 'is', null);
                    if (category) {
                        query = query.eq('metadata->>category', category);
                    }
                    const { data: analyticsData, error } = await (0, _apitimeouts.withDatabaseTimeout)(async (signal)=>await query, _apitimeouts.API_TIMEOUTS.database);
                    if (!error && analyticsData && analyticsData.length > 0) {
                        // Procesar datos de analytics para obtener trending
                        const searchCounts = new Map();
                        const searchCategories = new Map();
                        analyticsData.forEach((event)=>{
                            if (event.label) {
                                const query = event.label.toLowerCase().trim();
                                if (query.length > 2) {
                                    // Solo queries de más de 2 caracteres
                                    searchCounts.set(query, (searchCounts.get(query) || 0) + 1);
                                    // Extraer categoría del metadata si existe
                                    if (event.metadata && event.metadata.category) {
                                        searchCategories.set(query, event.metadata.category);
                                    }
                                }
                            }
                        });
                        // Convertir a array y ordenar por popularidad
                        const sortedSearches = Array.from(searchCounts.entries()).sort((a, b)=>b[1] - a[1]).slice(0, limit);
                        trendingSearches = sortedSearches.map(([query, count], index)=>({
                                id: `trending-real-${index + 1}`,
                                query: query.charAt(0).toUpperCase() + query.slice(1),
                                count,
                                category: searchCategories.get(query),
                                href: `/search?q=${encodeURIComponent(query)}`,
                                type: 'trending'
                            }));
                    }
                } catch (analyticsError) {
                    console.warn('⚠️ Error obteniendo trending de analytics, usando fallback:', analyticsError);
                }
            }
            // Si no hay datos reales o hay pocos, generar dinámicamente
            if (trendingSearches.length < 3) {
                console.log('🔄 Generando búsquedas trending dinámicas desde productos');
                try {
                    const dynamicSearches = await generateDynamicTrendingSearches(supabase, limit);
                    // Filtrar por categoría si se especifica
                    let filteredSearches = dynamicSearches;
                    if (category) {
                        filteredSearches = dynamicSearches.filter((search)=>search.category === category);
                    }
                    // Combinar datos reales con dinámicos si es necesario
                    const needed = limit - trendingSearches.length;
                    const additionalSearches = filteredSearches.slice(0, needed);
                    trendingSearches = [
                        ...trendingSearches,
                        ...additionalSearches
                    ];
                } catch (error) {
                    console.error('Error generando trending dinámicas, usando fallback:', error);
                    const fallbackSearches = getFallbackTrendingSearches(limit - trendingSearches.length);
                    trendingSearches = [
                        ...trendingSearches,
                        ...fallbackSearches
                    ];
                }
            }
            // Limitar al número solicitado
            trendingSearches = trendingSearches.slice(0, limit);
            const response = {
                data: {
                    trending: trendingSearches,
                    lastUpdated: new Date().toISOString()
                },
                success: true
            };
            console.log('🔥 Trending searches response:', {
                count: trendingSearches.length,
                hasRealData: trendingSearches.some((s)=>s.id.includes('real')),
                categories: [
                    ...new Set(trendingSearches.map((s)=>s.category).filter(Boolean))
                ]
            });
            // Log de operación exitosa
            securityLogger.log({
                type: 'data_access',
                severity: 'low',
                message: 'Trending searches retrieved successfully',
                context: securityLogger.context,
                metadata: {
                    searchesCount: trendingSearches.length,
                    limit: limit,
                    days: days,
                    category: category
                }
            });
            return _server.NextResponse.json(response);
        } catch (error) {
            console.error('❌ Error en /api/search/trending:', error);
            // Log de error de seguridad
            securityLogger.logApiError(securityLogger.context, error instanceof Error ? error : new Error('Unknown error'), {
                endpoint: '/api/search/trending'
            });
            // En caso de error, devolver búsquedas por defecto
            const fallbackResponse = {
                data: {
                    trending: defaultTrendingSearches.slice(0, parseInt(request.nextUrl.searchParams.get('limit') || '6')),
                    lastUpdated: new Date().toISOString()
                },
                success: true
            };
            return _server.NextResponse.json(fallbackResponse);
        }
    });
    // Manejar rate limit excedido
    if (rateLimitResult instanceof _server.NextResponse) {
        securityLogger.logRateLimitExceeded(securityLogger.context, {
            endpoint: '/api/search/trending',
            method: 'GET'
        });
        return rateLimitResult;
    }
    return rateLimitResult;
}
async function POST(request) {
    try {
        // Validar que el request tenga contenido
        const contentType = request.headers.get('content-type');
        if (!contentType || !contentType.includes('application/json')) {
            return _server.NextResponse.json({
                error: 'Content-Type debe ser application/json'
            }, {
                status: 400
            });
        }
        // Obtener el texto del body primero para validar
        const bodyText = await request.text();
        if (!bodyText || bodyText.trim() === '' || bodyText === '""' || bodyText === "''") {
            return _server.NextResponse.json({
                error: 'Body de la request no puede estar vacío'
            }, {
                status: 400
            });
        }
        // Parsear JSON de forma segura
        let requestData;
        try {
            requestData = JSON.parse(bodyText);
        } catch (parseError) {
            console.error('Error parsing JSON in POST /api/search/trending:', parseError);
            return _server.NextResponse.json({
                error: 'JSON inválido en el body de la request'
            }, {
                status: 400
            });
        }
        const { query, category, userId, sessionId } = requestData;
        if (!query || typeof query !== 'string') {
            return _server.NextResponse.json({
                error: 'Query de búsqueda requerida'
            }, {
                status: 400
            });
        }
        const supabase = (0, _supabase.getSupabaseClient)();
        if (supabase) {
            // Registrar la búsqueda en analytics usando función optimizada
            const { error } = await supabase.rpc('insert_analytics_event_optimized', {
                p_event_name: 'search',
                p_category: 'search',
                p_action: 'search',
                p_label: query.toLowerCase().trim().substring(0, 50),
                p_user_id: userId,
                p_session_id: sessionId || 'anonymous',
                p_page: '/search',
                p_user_agent: null
            });
            if (error) {
                console.error('Error registrando búsqueda en analytics:', error);
            } else {}
        }
        return _server.NextResponse.json({
            success: true
        });
    } catch (error) {
        console.error('❌ Error registrando búsqueda:', error);
        return _server.NextResponse.json({
            error: 'Error interno del servidor'
        }, {
            status: 500
        });
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcYXBwXFxhcGlcXHNlYXJjaFxcdHJlbmRpbmdcXHJvdXRlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvbmZpZ3VyYWNpw7NuIHBhcmEgTm9kZS5qcyBSdW50aW1lXG5leHBvcnQgY29uc3QgcnVudGltZSA9ICdub2RlanMnXG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBBUEk6IC9hcGkvc2VhcmNoL3RyZW5kaW5nIC0gQsO6c3F1ZWRhcyBwb3B1bGFyZXMvdHJlbmRpbmdcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IGdldFN1cGFiYXNlQ2xpZW50IH0gZnJvbSAnQC9saWIvaW50ZWdyYXRpb25zL3N1cGFiYXNlJ1xuaW1wb3J0IHsgQXBpUmVzcG9uc2UgfSBmcm9tICdAL3R5cGVzL2FwaSdcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIE1FSk9SQVMgREUgU0VHVVJJREFEIC0gQUxUQSBQUklPUklEQURcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5pbXBvcnQgeyB3aXRoUmF0ZUxpbWl0LCBSQVRFX0xJTUlUX0NPTkZJR1MgfSBmcm9tICdAL2xpYi9yYXRlLWxpbWl0aW5nL3JhdGUtbGltaXRlcidcbmltcG9ydCB7IEFQSV9USU1FT1VUUywgd2l0aERhdGFiYXNlVGltZW91dCwgZ2V0RW5kcG9pbnRUaW1lb3V0cyB9IGZyb20gJ0AvbGliL2NvbmZpZy9hcGktdGltZW91dHMnXG5pbXBvcnQgeyBjcmVhdGVTZWN1cml0eUxvZ2dlciB9IGZyb20gJ0AvbGliL2xvZ2dpbmcvc2VjdXJpdHktbG9nZ2VyJ1xuXG5leHBvcnQgaW50ZXJmYWNlIFRyZW5kaW5nU2VhcmNoIHtcbiAgaWQ6IHN0cmluZ1xuICBxdWVyeTogc3RyaW5nXG4gIGNvdW50OiBudW1iZXJcbiAgY2F0ZWdvcnk/OiBzdHJpbmdcbiAgaHJlZjogc3RyaW5nXG4gIHR5cGU6ICd0cmVuZGluZydcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUcmVuZGluZ1NlYXJjaGVzUmVzcG9uc2Uge1xuICB0cmVuZGluZzogVHJlbmRpbmdTZWFyY2hbXVxuICBsYXN0VXBkYXRlZDogc3RyaW5nXG59XG5cbi8vIELDunNxdWVkYXMgdHJlbmRpbmcgZ2VuZXJhZGFzIGRpbsOhbWljYW1lbnRlIGJhc2FkYXMgZW4gcHJvZHVjdG9zIHJlYWxlc1xuYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVEeW5hbWljVHJlbmRpbmdTZWFyY2hlcyhcbiAgc3VwYWJhc2U6IGFueSxcbiAgbGltaXQ6IG51bWJlciA9IDZcbik6IFByb21pc2U8VHJlbmRpbmdTZWFyY2hbXT4ge1xuICB0cnkge1xuICAgIC8vIE9idGVuZXIgcHJvZHVjdG9zIG3DoXMgcG9wdWxhcmVzIHkgbWFyY2FzIHBhcmEgZ2VuZXJhciBiw7pzcXVlZGFzIHRyZW5kaW5nIHJlYWxpc3Rhc1xuICAgIGNvbnN0IHsgZGF0YTogcHJvZHVjdHMsIGVycm9yOiBwcm9kdWN0c0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3Byb2R1Y3RzJylcbiAgICAgIC5zZWxlY3QoJ25hbWUsIGJyYW5kLCBjYXRlZ29yeV9pZCwgY2F0ZWdvcmllcyhuYW1lKScpXG4gICAgICAuZXEoJ2lzX2FjdGl2ZScsIHRydWUpXG4gICAgICAubGltaXQoMjApXG5cbiAgICBpZiAocHJvZHVjdHNFcnJvciB8fCAhcHJvZHVjdHMpIHtcbiAgICAgIGNvbnNvbGUud2FybignRXJyb3Igb2J0ZW5pZW5kbyBwcm9kdWN0b3MgcGFyYSB0cmVuZGluZzonLCBwcm9kdWN0c0Vycm9yKVxuICAgICAgcmV0dXJuIGdldEZhbGxiYWNrVHJlbmRpbmdTZWFyY2hlcyhsaW1pdClcbiAgICB9XG5cbiAgICAvLyBHZW5lcmFyIGLDunNxdWVkYXMgdHJlbmRpbmcgYmFzYWRhcyBlbiBwcm9kdWN0b3MgcmVhbGVzXG4gICAgY29uc3QgdHJlbmRpbmdTZWFyY2hlczogVHJlbmRpbmdTZWFyY2hbXSA9IFtdXG4gICAgY29uc3QgdXNlZFF1ZXJpZXMgPSBuZXcgU2V0PHN0cmluZz4oKVxuXG4gICAgLy8gQWdyZWdhciBiw7pzcXVlZGFzIHBvciBtYXJjYVxuICAgIGNvbnN0IGJyYW5kcyA9IFsuLi5uZXcgU2V0KHByb2R1Y3RzLm1hcChwID0+IHAuYnJhbmQpLmZpbHRlcihCb29sZWFuKSldXG4gICAgYnJhbmRzLnNsaWNlKDAsIDIpLmZvckVhY2goKGJyYW5kLCBpbmRleCkgPT4ge1xuICAgICAgaWYgKGJyYW5kICYmICF1c2VkUXVlcmllcy5oYXMoYnJhbmQudG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgICAgdHJlbmRpbmdTZWFyY2hlcy5wdXNoKHtcbiAgICAgICAgICBpZDogYHRyZW5kaW5nLWJyYW5kLSR7aW5kZXggKyAxfWAsXG4gICAgICAgICAgcXVlcnk6IGJyYW5kLFxuICAgICAgICAgIGNvdW50OiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA1MCkgKyAyMCwgLy8gUmFuZ28gcmVhbGlzdGEgMjAtNzBcbiAgICAgICAgICBjYXRlZ29yeTogJ21hcmNhcycsXG4gICAgICAgICAgaHJlZjogYC9zZWFyY2g/cT0ke2VuY29kZVVSSUNvbXBvbmVudChicmFuZCl9YCxcbiAgICAgICAgICB0eXBlOiAndHJlbmRpbmcnLFxuICAgICAgICB9KVxuICAgICAgICB1c2VkUXVlcmllcy5hZGQoYnJhbmQudG9Mb3dlckNhc2UoKSlcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgLy8gQWdyZWdhciBiw7pzcXVlZGFzIHBvciBjYXRlZ29yw61hXG4gICAgY29uc3QgY2F0ZWdvcmllcyA9IFsuLi5uZXcgU2V0KHByb2R1Y3RzLm1hcChwID0+IHAuY2F0ZWdvcmllcz8ubmFtZSkuZmlsdGVyKEJvb2xlYW4pKV1cbiAgICBjYXRlZ29yaWVzLnNsaWNlKDAsIDIpLmZvckVhY2goKGNhdGVnb3J5LCBpbmRleCkgPT4ge1xuICAgICAgaWYgKGNhdGVnb3J5ICYmICF1c2VkUXVlcmllcy5oYXMoY2F0ZWdvcnkudG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgICAgdHJlbmRpbmdTZWFyY2hlcy5wdXNoKHtcbiAgICAgICAgICBpZDogYHRyZW5kaW5nLWNhdGVnb3J5LSR7aW5kZXggKyAxfWAsXG4gICAgICAgICAgcXVlcnk6IGNhdGVnb3J5LFxuICAgICAgICAgIGNvdW50OiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA0MCkgKyAxNSwgLy8gUmFuZ28gcmVhbGlzdGEgMTUtNTVcbiAgICAgICAgICBjYXRlZ29yeTogJ3BpbnR1cmFzJyxcbiAgICAgICAgICBocmVmOiBgL3NlYXJjaD9xPSR7ZW5jb2RlVVJJQ29tcG9uZW50KGNhdGVnb3J5KX1gLFxuICAgICAgICAgIHR5cGU6ICd0cmVuZGluZycsXG4gICAgICAgIH0pXG4gICAgICAgIHVzZWRRdWVyaWVzLmFkZChjYXRlZ29yeS50b0xvd2VyQ2FzZSgpKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICAvLyBBZ3JlZ2FyIGLDunNxdWVkYXMgcG9yIHByb2R1Y3RvcyBlc3BlY8OtZmljb3NcbiAgICBjb25zdCBwb3B1bGFyUHJvZHVjdHMgPSBwcm9kdWN0cy5zbGljZSgwLCAyKVxuICAgIHBvcHVsYXJQcm9kdWN0cy5mb3JFYWNoKChwcm9kdWN0LCBpbmRleCkgPT4ge1xuICAgICAgY29uc3QgcHJvZHVjdE5hbWUgPSBwcm9kdWN0Lm5hbWVcbiAgICAgIGlmIChwcm9kdWN0TmFtZSAmJiAhdXNlZFF1ZXJpZXMuaGFzKHByb2R1Y3ROYW1lLnRvTG93ZXJDYXNlKCkpKSB7XG4gICAgICAgIHRyZW5kaW5nU2VhcmNoZXMucHVzaCh7XG4gICAgICAgICAgaWQ6IGB0cmVuZGluZy1wcm9kdWN0LSR7aW5kZXggKyAxfWAsXG4gICAgICAgICAgcXVlcnk6IHByb2R1Y3ROYW1lLFxuICAgICAgICAgIGNvdW50OiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzMCkgKyAxMCwgLy8gUmFuZ28gcmVhbGlzdGEgMTAtNDBcbiAgICAgICAgICBjYXRlZ29yeTogJ3Byb2R1Y3RvcycsXG4gICAgICAgICAgaHJlZjogYC9zZWFyY2g/cT0ke2VuY29kZVVSSUNvbXBvbmVudChwcm9kdWN0TmFtZSl9YCxcbiAgICAgICAgICB0eXBlOiAndHJlbmRpbmcnLFxuICAgICAgICB9KVxuICAgICAgICB1c2VkUXVlcmllcy5hZGQocHJvZHVjdE5hbWUudG9Mb3dlckNhc2UoKSlcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgLy8gT3JkZW5hciBwb3IgY291bnQgZGVzY2VuZGVudGUgeSBsaW1pdGFyXG4gICAgcmV0dXJuIHRyZW5kaW5nU2VhcmNoZXMuc29ydCgoYSwgYikgPT4gYi5jb3VudCAtIGEuY291bnQpLnNsaWNlKDAsIGxpbWl0KVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYW5kbyB0cmVuZGluZyBzZWFyY2hlcyBkaW7DoW1pY2FzOicsIGVycm9yKVxuICAgIHJldHVybiBnZXRGYWxsYmFja1RyZW5kaW5nU2VhcmNoZXMobGltaXQpXG4gIH1cbn1cblxuLy8gRmFsbGJhY2sgY29uIGRhdG9zIG3DrW5pbW9zIChzb2xvIHNpIGZhbGxhIHRvZG8gbG8gZGVtw6FzKVxuZnVuY3Rpb24gZ2V0RmFsbGJhY2tUcmVuZGluZ1NlYXJjaGVzKGxpbWl0OiBudW1iZXIgPSA2KTogVHJlbmRpbmdTZWFyY2hbXSB7XG4gIGNvbnN0IGZhbGxiYWNrU2VhcmNoZXMgPSBbXG4gICAgeyBxdWVyeTogJ1BpbnR1cmEnLCBjYXRlZ29yeTogJ3BpbnR1cmFzJyB9LFxuICAgIHsgcXVlcnk6ICdFc21hbHRlJywgY2F0ZWdvcnk6ICdwaW50dXJhcycgfSxcbiAgICB7IHF1ZXJ5OiAnTMOhdGV4JywgY2F0ZWdvcnk6ICdwaW50dXJhcycgfSxcbiAgICB7IHF1ZXJ5OiAnQmFybml6JywgY2F0ZWdvcnk6ICdwaW50dXJhcycgfSxcbiAgICB7IHF1ZXJ5OiAnSW1wcmltYWNpw7NuJywgY2F0ZWdvcnk6ICdwaW50dXJhcycgfSxcbiAgICB7IHF1ZXJ5OiAnUm9kaWxsb3MnLCBjYXRlZ29yeTogJ2hlcnJhbWllbnRhcycgfSxcbiAgXVxuXG4gIHJldHVybiBmYWxsYmFja1NlYXJjaGVzLnNsaWNlKDAsIGxpbWl0KS5tYXAoKHNlYXJjaCwgaW5kZXgpID0+ICh7XG4gICAgaWQ6IGBmYWxsYmFjay0ke2luZGV4ICsgMX1gLFxuICAgIHF1ZXJ5OiBzZWFyY2gucXVlcnksXG4gICAgY291bnQ6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIwKSArIDUsIC8vIFJhbmdvIG3DrW5pbW8gNS0yNVxuICAgIGNhdGVnb3J5OiBzZWFyY2guY2F0ZWdvcnksXG4gICAgaHJlZjogYC9zZWFyY2g/cT0ke2VuY29kZVVSSUNvbXBvbmVudChzZWFyY2gucXVlcnkudG9Mb3dlckNhc2UoKSl9YCxcbiAgICB0eXBlOiAndHJlbmRpbmcnIGFzIGNvbnN0LFxuICB9KSlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICAvLyBDcmVhciBsb2dnZXIgZGUgc2VndXJpZGFkIGNvbiBjb250ZXh0b1xuICBjb25zdCBzZWN1cml0eUxvZ2dlciA9IGNyZWF0ZVNlY3VyaXR5TG9nZ2VyKHJlcXVlc3QpXG5cbiAgLy8gQXBsaWNhciByYXRlIGxpbWl0aW5nIHBhcmEgQVBJcyBkZSBiw7pzcXVlZGFcbiAgY29uc3QgcmF0ZUxpbWl0UmVzdWx0ID0gYXdhaXQgd2l0aFJhdGVMaW1pdChyZXF1ZXN0LCBSQVRFX0xJTUlUX0NPTkZJR1Muc2VhcmNoLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gTG9nIGRlIGFjY2VzbyBhIGxhIEFQSVxuICAgIHNlY3VyaXR5TG9nZ2VyLmxvZyh7XG4gICAgICB0eXBlOiAnZGF0YV9hY2Nlc3MnLFxuICAgICAgc2V2ZXJpdHk6ICdsb3cnLFxuICAgICAgbWVzc2FnZTogJ1RyZW5kaW5nIHNlYXJjaCBBUEkgYWNjZXNzZWQnLFxuICAgICAgY29udGV4dDogc2VjdXJpdHlMb2dnZXIuY29udGV4dCxcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIGVuZHBvaW50OiAnL2FwaS9zZWFyY2gvdHJlbmRpbmcnLFxuICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICB1c2VyQWdlbnQ6IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3VzZXItYWdlbnQnKSxcbiAgICAgIH0sXG4gICAgfSlcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybClcbiAgICAgIGNvbnN0IGxpbWl0ID0gcGFyc2VJbnQoc2VhcmNoUGFyYW1zLmdldCgnbGltaXQnKSB8fCAnNicpXG4gICAgICBjb25zdCBkYXlzID0gcGFyc2VJbnQoc2VhcmNoUGFyYW1zLmdldCgnZGF5cycpIHx8ICc3JylcbiAgICAgIGNvbnN0IGNhdGVnb3J5ID0gc2VhcmNoUGFyYW1zLmdldCgnY2F0ZWdvcnknKVxuXG4gICAgICBjb25zb2xlLmxvZygn8J+UpSBBUEkgL2FwaS9zZWFyY2gvdHJlbmRpbmc6IE9idGVuaWVuZG8gYsO6c3F1ZWRhcyB0cmVuZGluZycsIHtcbiAgICAgICAgbGltaXQsXG4gICAgICAgIGRheXMsXG4gICAgICAgIGNhdGVnb3J5LFxuICAgICAgfSlcblxuICAgICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZUNsaWVudCgpXG5cbiAgICAgIGxldCB0cmVuZGluZ1NlYXJjaGVzOiBUcmVuZGluZ1NlYXJjaFtdID0gW11cblxuICAgICAgLy8gSW50ZW50YXIgb2J0ZW5lciBiw7pzcXVlZGFzIHRyZW5kaW5nIHJlYWxlcyBkZWwgc2lzdGVtYSBkZSBhbmFseXRpY3NcbiAgICAgIGlmIChzdXBhYmFzZSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKClcbiAgICAgICAgICBzdGFydERhdGUuc2V0RGF0ZShzdGFydERhdGUuZ2V0RGF0ZSgpIC0gZGF5cylcblxuICAgICAgICAgIC8vIFF1ZXJ5IHBhcmEgb2J0ZW5lciBiw7pzcXVlZGFzIG3DoXMgcG9wdWxhcmVzIGRlIGFuYWx5dGljc19ldmVudHNcbiAgICAgICAgICBsZXQgcXVlcnkgPSBzdXBhYmFzZVxuICAgICAgICAgICAgLmZyb20oJ2FuYWx5dGljc19ldmVudHMnKVxuICAgICAgICAgICAgLnNlbGVjdCgnbGFiZWwsIG1ldGFkYXRhJylcbiAgICAgICAgICAgIC5lcSgnY2F0ZWdvcnknLCAnc2VhcmNoJylcbiAgICAgICAgICAgIC5lcSgnYWN0aW9uJywgJ3NlYXJjaF9xdWVyeScpXG4gICAgICAgICAgICAuZ3RlKCdjcmVhdGVkX2F0Jywgc3RhcnREYXRlLnRvSVNPU3RyaW5nKCkpXG4gICAgICAgICAgICAubm90KCdsYWJlbCcsICdpcycsIG51bGwpXG5cbiAgICAgICAgICBpZiAoY2F0ZWdvcnkpIHtcbiAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ21ldGFkYXRhLT4+Y2F0ZWdvcnknLCBjYXRlZ29yeSlcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCB7IGRhdGE6IGFuYWx5dGljc0RhdGEsIGVycm9yIH0gPSBhd2FpdCB3aXRoRGF0YWJhc2VUaW1lb3V0KFxuICAgICAgICAgICAgYXN5bmMgc2lnbmFsID0+IGF3YWl0IHF1ZXJ5LFxuICAgICAgICAgICAgQVBJX1RJTUVPVVRTLmRhdGFiYXNlXG4gICAgICAgICAgKVxuXG4gICAgICAgICAgaWYgKCFlcnJvciAmJiBhbmFseXRpY3NEYXRhICYmIGFuYWx5dGljc0RhdGEubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgLy8gUHJvY2VzYXIgZGF0b3MgZGUgYW5hbHl0aWNzIHBhcmEgb2J0ZW5lciB0cmVuZGluZ1xuICAgICAgICAgICAgY29uc3Qgc2VhcmNoQ291bnRzID0gbmV3IE1hcDxzdHJpbmcsIG51bWJlcj4oKVxuICAgICAgICAgICAgY29uc3Qgc2VhcmNoQ2F0ZWdvcmllcyA9IG5ldyBNYXA8c3RyaW5nLCBzdHJpbmc+KClcblxuICAgICAgICAgICAgYW5hbHl0aWNzRGF0YS5mb3JFYWNoKGV2ZW50ID0+IHtcbiAgICAgICAgICAgICAgaWYgKGV2ZW50LmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcXVlcnkgPSBldmVudC5sYWJlbC50b0xvd2VyQ2FzZSgpLnRyaW0oKVxuICAgICAgICAgICAgICAgIGlmIChxdWVyeS5sZW5ndGggPiAyKSB7XG4gICAgICAgICAgICAgICAgICAvLyBTb2xvIHF1ZXJpZXMgZGUgbcOhcyBkZSAyIGNhcmFjdGVyZXNcbiAgICAgICAgICAgICAgICAgIHNlYXJjaENvdW50cy5zZXQocXVlcnksIChzZWFyY2hDb3VudHMuZ2V0KHF1ZXJ5KSB8fCAwKSArIDEpXG5cbiAgICAgICAgICAgICAgICAgIC8vIEV4dHJhZXIgY2F0ZWdvcsOtYSBkZWwgbWV0YWRhdGEgc2kgZXhpc3RlXG4gICAgICAgICAgICAgICAgICBpZiAoZXZlbnQubWV0YWRhdGEgJiYgZXZlbnQubWV0YWRhdGEuY2F0ZWdvcnkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoQ2F0ZWdvcmllcy5zZXQocXVlcnksIGV2ZW50Lm1ldGFkYXRhLmNhdGVnb3J5KVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgLy8gQ29udmVydGlyIGEgYXJyYXkgeSBvcmRlbmFyIHBvciBwb3B1bGFyaWRhZFxuICAgICAgICAgICAgY29uc3Qgc29ydGVkU2VhcmNoZXMgPSBBcnJheS5mcm9tKHNlYXJjaENvdW50cy5lbnRyaWVzKCkpXG4gICAgICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiBiWzFdIC0gYVsxXSlcbiAgICAgICAgICAgICAgLnNsaWNlKDAsIGxpbWl0KVxuXG4gICAgICAgICAgICB0cmVuZGluZ1NlYXJjaGVzID0gc29ydGVkU2VhcmNoZXMubWFwKChbcXVlcnksIGNvdW50XSwgaW5kZXgpID0+ICh7XG4gICAgICAgICAgICAgIGlkOiBgdHJlbmRpbmctcmVhbC0ke2luZGV4ICsgMX1gLFxuICAgICAgICAgICAgICBxdWVyeTogcXVlcnkuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBxdWVyeS5zbGljZSgxKSxcbiAgICAgICAgICAgICAgY291bnQsXG4gICAgICAgICAgICAgIGNhdGVnb3J5OiBzZWFyY2hDYXRlZ29yaWVzLmdldChxdWVyeSksXG4gICAgICAgICAgICAgIGhyZWY6IGAvc2VhcmNoP3E9JHtlbmNvZGVVUklDb21wb25lbnQocXVlcnkpfWAsXG4gICAgICAgICAgICAgIHR5cGU6ICd0cmVuZGluZycgYXMgY29uc3QsXG4gICAgICAgICAgICB9KSlcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGFuYWx5dGljc0Vycm9yKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICAgJ+KaoO+4jyBFcnJvciBvYnRlbmllbmRvIHRyZW5kaW5nIGRlIGFuYWx5dGljcywgdXNhbmRvIGZhbGxiYWNrOicsXG4gICAgICAgICAgICBhbmFseXRpY3NFcnJvclxuICAgICAgICAgIClcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBTaSBubyBoYXkgZGF0b3MgcmVhbGVzIG8gaGF5IHBvY29zLCBnZW5lcmFyIGRpbsOhbWljYW1lbnRlXG4gICAgICBpZiAodHJlbmRpbmdTZWFyY2hlcy5sZW5ndGggPCAzKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5SEIEdlbmVyYW5kbyBiw7pzcXVlZGFzIHRyZW5kaW5nIGRpbsOhbWljYXMgZGVzZGUgcHJvZHVjdG9zJylcblxuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IGR5bmFtaWNTZWFyY2hlcyA9IGF3YWl0IGdlbmVyYXRlRHluYW1pY1RyZW5kaW5nU2VhcmNoZXMoc3VwYWJhc2UsIGxpbWl0KVxuXG4gICAgICAgICAgLy8gRmlsdHJhciBwb3IgY2F0ZWdvcsOtYSBzaSBzZSBlc3BlY2lmaWNhXG4gICAgICAgICAgbGV0IGZpbHRlcmVkU2VhcmNoZXMgPSBkeW5hbWljU2VhcmNoZXNcbiAgICAgICAgICBpZiAoY2F0ZWdvcnkpIHtcbiAgICAgICAgICAgIGZpbHRlcmVkU2VhcmNoZXMgPSBkeW5hbWljU2VhcmNoZXMuZmlsdGVyKHNlYXJjaCA9PiBzZWFyY2guY2F0ZWdvcnkgPT09IGNhdGVnb3J5KVxuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIENvbWJpbmFyIGRhdG9zIHJlYWxlcyBjb24gZGluw6FtaWNvcyBzaSBlcyBuZWNlc2FyaW9cbiAgICAgICAgICBjb25zdCBuZWVkZWQgPSBsaW1pdCAtIHRyZW5kaW5nU2VhcmNoZXMubGVuZ3RoXG4gICAgICAgICAgY29uc3QgYWRkaXRpb25hbFNlYXJjaGVzID0gZmlsdGVyZWRTZWFyY2hlcy5zbGljZSgwLCBuZWVkZWQpXG5cbiAgICAgICAgICB0cmVuZGluZ1NlYXJjaGVzID0gWy4uLnRyZW5kaW5nU2VhcmNoZXMsIC4uLmFkZGl0aW9uYWxTZWFyY2hlc11cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZW5lcmFuZG8gdHJlbmRpbmcgZGluw6FtaWNhcywgdXNhbmRvIGZhbGxiYWNrOicsIGVycm9yKVxuICAgICAgICAgIGNvbnN0IGZhbGxiYWNrU2VhcmNoZXMgPSBnZXRGYWxsYmFja1RyZW5kaW5nU2VhcmNoZXMobGltaXQgLSB0cmVuZGluZ1NlYXJjaGVzLmxlbmd0aClcbiAgICAgICAgICB0cmVuZGluZ1NlYXJjaGVzID0gWy4uLnRyZW5kaW5nU2VhcmNoZXMsIC4uLmZhbGxiYWNrU2VhcmNoZXNdXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gTGltaXRhciBhbCBuw7ptZXJvIHNvbGljaXRhZG9cbiAgICAgIHRyZW5kaW5nU2VhcmNoZXMgPSB0cmVuZGluZ1NlYXJjaGVzLnNsaWNlKDAsIGxpbWl0KVxuXG4gICAgICBjb25zdCByZXNwb25zZTogQXBpUmVzcG9uc2U8VHJlbmRpbmdTZWFyY2hlc1Jlc3BvbnNlPiA9IHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHRyZW5kaW5nOiB0cmVuZGluZ1NlYXJjaGVzLFxuICAgICAgICAgIGxhc3RVcGRhdGVkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIH0sXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCfwn5SlIFRyZW5kaW5nIHNlYXJjaGVzIHJlc3BvbnNlOicsIHtcbiAgICAgICAgY291bnQ6IHRyZW5kaW5nU2VhcmNoZXMubGVuZ3RoLFxuICAgICAgICBoYXNSZWFsRGF0YTogdHJlbmRpbmdTZWFyY2hlcy5zb21lKHMgPT4gcy5pZC5pbmNsdWRlcygncmVhbCcpKSxcbiAgICAgICAgY2F0ZWdvcmllczogWy4uLm5ldyBTZXQodHJlbmRpbmdTZWFyY2hlcy5tYXAocyA9PiBzLmNhdGVnb3J5KS5maWx0ZXIoQm9vbGVhbikpXSxcbiAgICAgIH0pXG5cbiAgICAgIC8vIExvZyBkZSBvcGVyYWNpw7NuIGV4aXRvc2FcbiAgICAgIHNlY3VyaXR5TG9nZ2VyLmxvZyh7XG4gICAgICAgIHR5cGU6ICdkYXRhX2FjY2VzcycsXG4gICAgICAgIHNldmVyaXR5OiAnbG93JyxcbiAgICAgICAgbWVzc2FnZTogJ1RyZW5kaW5nIHNlYXJjaGVzIHJldHJpZXZlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgICBjb250ZXh0OiBzZWN1cml0eUxvZ2dlci5jb250ZXh0LFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIHNlYXJjaGVzQ291bnQ6IHRyZW5kaW5nU2VhcmNoZXMubGVuZ3RoLFxuICAgICAgICAgIGxpbWl0OiBsaW1pdCxcbiAgICAgICAgICBkYXlzOiBkYXlzLFxuICAgICAgICAgIGNhdGVnb3J5OiBjYXRlZ29yeSxcbiAgICAgICAgfSxcbiAgICAgIH0pXG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihyZXNwb25zZSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIGVuIC9hcGkvc2VhcmNoL3RyZW5kaW5nOicsIGVycm9yKVxuXG4gICAgICAvLyBMb2cgZGUgZXJyb3IgZGUgc2VndXJpZGFkXG4gICAgICBzZWN1cml0eUxvZ2dlci5sb2dBcGlFcnJvcihcbiAgICAgICAgc2VjdXJpdHlMb2dnZXIuY29udGV4dCxcbiAgICAgICAgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKCdVbmtub3duIGVycm9yJyksXG4gICAgICAgIHtcbiAgICAgICAgICBlbmRwb2ludDogJy9hcGkvc2VhcmNoL3RyZW5kaW5nJyxcbiAgICAgICAgfVxuICAgICAgKVxuXG4gICAgICAvLyBFbiBjYXNvIGRlIGVycm9yLCBkZXZvbHZlciBiw7pzcXVlZGFzIHBvciBkZWZlY3RvXG4gICAgICBjb25zdCBmYWxsYmFja1Jlc3BvbnNlOiBBcGlSZXNwb25zZTxUcmVuZGluZ1NlYXJjaGVzUmVzcG9uc2U+ID0ge1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgdHJlbmRpbmc6IGRlZmF1bHRUcmVuZGluZ1NlYXJjaGVzLnNsaWNlKFxuICAgICAgICAgICAgMCxcbiAgICAgICAgICAgIHBhcnNlSW50KHJlcXVlc3QubmV4dFVybC5zZWFyY2hQYXJhbXMuZ2V0KCdsaW1pdCcpIHx8ICc2JylcbiAgICAgICAgICApLFxuICAgICAgICAgIGxhc3RVcGRhdGVkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIH0sXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihmYWxsYmFja1Jlc3BvbnNlKVxuICAgIH1cbiAgfSlcblxuICAvLyBNYW5lamFyIHJhdGUgbGltaXQgZXhjZWRpZG9cbiAgaWYgKHJhdGVMaW1pdFJlc3VsdCBpbnN0YW5jZW9mIE5leHRSZXNwb25zZSkge1xuICAgIHNlY3VyaXR5TG9nZ2VyLmxvZ1JhdGVMaW1pdEV4Y2VlZGVkKHNlY3VyaXR5TG9nZ2VyLmNvbnRleHQsIHtcbiAgICAgIGVuZHBvaW50OiAnL2FwaS9zZWFyY2gvdHJlbmRpbmcnLFxuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICB9KVxuICAgIHJldHVybiByYXRlTGltaXRSZXN1bHRcbiAgfVxuXG4gIHJldHVybiByYXRlTGltaXRSZXN1bHRcbn1cblxuLy8gTcOpdG9kbyBQT1NUIHBhcmEgcmVnaXN0cmFyIHVuYSBiw7pzcXVlZGEgKHBhcmEgYW5hbHl0aWNzKVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICAvLyBWYWxpZGFyIHF1ZSBlbCByZXF1ZXN0IHRlbmdhIGNvbnRlbmlkb1xuICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gcmVxdWVzdC5oZWFkZXJzLmdldCgnY29udGVudC10eXBlJylcbiAgICBpZiAoIWNvbnRlbnRUeXBlIHx8ICFjb250ZW50VHlwZS5pbmNsdWRlcygnYXBwbGljYXRpb24vanNvbicpKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0NvbnRlbnQtVHlwZSBkZWJlIHNlciBhcHBsaWNhdGlvbi9qc29uJyB9LCB7IHN0YXR1czogNDAwIH0pXG4gICAgfVxuXG4gICAgLy8gT2J0ZW5lciBlbCB0ZXh0byBkZWwgYm9keSBwcmltZXJvIHBhcmEgdmFsaWRhclxuICAgIGNvbnN0IGJvZHlUZXh0ID0gYXdhaXQgcmVxdWVzdC50ZXh0KClcbiAgICBpZiAoIWJvZHlUZXh0IHx8IGJvZHlUZXh0LnRyaW0oKSA9PT0gJycgfHwgYm9keVRleHQgPT09ICdcIlwiJyB8fCBib2R5VGV4dCA9PT0gXCInJ1wiKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdCb2R5IGRlIGxhIHJlcXVlc3Qgbm8gcHVlZGUgZXN0YXIgdmFjw61vJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgIClcbiAgICB9XG5cbiAgICAvLyBQYXJzZWFyIEpTT04gZGUgZm9ybWEgc2VndXJhXG4gICAgbGV0IHJlcXVlc3REYXRhXG4gICAgdHJ5IHtcbiAgICAgIHJlcXVlc3REYXRhID0gSlNPTi5wYXJzZShib2R5VGV4dClcbiAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwYXJzaW5nIEpTT04gaW4gUE9TVCAvYXBpL3NlYXJjaC90cmVuZGluZzonLCBwYXJzZUVycm9yKVxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdKU09OIGludsOhbGlkbyBlbiBlbCBib2R5IGRlIGxhIHJlcXVlc3QnIH0sIHsgc3RhdHVzOiA0MDAgfSlcbiAgICB9XG5cbiAgICBjb25zdCB7IHF1ZXJ5LCBjYXRlZ29yeSwgdXNlcklkLCBzZXNzaW9uSWQgfSA9IHJlcXVlc3REYXRhXG5cbiAgICBpZiAoIXF1ZXJ5IHx8IHR5cGVvZiBxdWVyeSAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnUXVlcnkgZGUgYsO6c3F1ZWRhIHJlcXVlcmlkYScgfSwgeyBzdGF0dXM6IDQwMCB9KVxuICAgIH1cblxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VDbGllbnQoKVxuXG4gICAgaWYgKHN1cGFiYXNlKSB7XG4gICAgICAvLyBSZWdpc3RyYXIgbGEgYsO6c3F1ZWRhIGVuIGFuYWx5dGljcyB1c2FuZG8gZnVuY2nDs24gb3B0aW1pemFkYVxuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UucnBjKCdpbnNlcnRfYW5hbHl0aWNzX2V2ZW50X29wdGltaXplZCcsIHtcbiAgICAgICAgcF9ldmVudF9uYW1lOiAnc2VhcmNoJyxcbiAgICAgICAgcF9jYXRlZ29yeTogJ3NlYXJjaCcsXG4gICAgICAgIHBfYWN0aW9uOiAnc2VhcmNoJyxcbiAgICAgICAgcF9sYWJlbDogcXVlcnkudG9Mb3dlckNhc2UoKS50cmltKCkuc3Vic3RyaW5nKDAsIDUwKSxcbiAgICAgICAgcF91c2VyX2lkOiB1c2VySWQsXG4gICAgICAgIHBfc2Vzc2lvbl9pZDogc2Vzc2lvbklkIHx8ICdhbm9ueW1vdXMnLFxuICAgICAgICBwX3BhZ2U6ICcvc2VhcmNoJyxcbiAgICAgICAgcF91c2VyX2FnZW50OiBudWxsLFxuICAgICAgfSlcblxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlZ2lzdHJhbmRvIGLDunNxdWVkYSBlbiBhbmFseXRpY3M6JywgZXJyb3IpXG4gICAgICB9IGVsc2Uge1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSlcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyb3IgcmVnaXN0cmFuZG8gYsO6c3F1ZWRhOicsIGVycm9yKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnRXJyb3IgaW50ZXJubyBkZWwgc2Vydmlkb3InIH0sIHsgc3RhdHVzOiA1MDAgfSlcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkdFVCIsIlBPU1QiLCJydW50aW1lIiwiZ2VuZXJhdGVEeW5hbWljVHJlbmRpbmdTZWFyY2hlcyIsInN1cGFiYXNlIiwibGltaXQiLCJkYXRhIiwicHJvZHVjdHMiLCJlcnJvciIsInByb2R1Y3RzRXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJjb25zb2xlIiwid2FybiIsImdldEZhbGxiYWNrVHJlbmRpbmdTZWFyY2hlcyIsInRyZW5kaW5nU2VhcmNoZXMiLCJ1c2VkUXVlcmllcyIsIlNldCIsImJyYW5kcyIsIm1hcCIsInAiLCJicmFuZCIsImZpbHRlciIsIkJvb2xlYW4iLCJzbGljZSIsImZvckVhY2giLCJpbmRleCIsImhhcyIsInRvTG93ZXJDYXNlIiwicHVzaCIsImlkIiwicXVlcnkiLCJjb3VudCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImNhdGVnb3J5IiwiaHJlZiIsImVuY29kZVVSSUNvbXBvbmVudCIsInR5cGUiLCJhZGQiLCJjYXRlZ29yaWVzIiwibmFtZSIsInBvcHVsYXJQcm9kdWN0cyIsInByb2R1Y3QiLCJwcm9kdWN0TmFtZSIsInNvcnQiLCJhIiwiYiIsImZhbGxiYWNrU2VhcmNoZXMiLCJzZWFyY2giLCJyZXF1ZXN0Iiwic2VjdXJpdHlMb2dnZXIiLCJjcmVhdGVTZWN1cml0eUxvZ2dlciIsInJhdGVMaW1pdFJlc3VsdCIsIndpdGhSYXRlTGltaXQiLCJSQVRFX0xJTUlUX0NPTkZJR1MiLCJsb2ciLCJzZXZlcml0eSIsIm1lc3NhZ2UiLCJjb250ZXh0IiwibWV0YWRhdGEiLCJlbmRwb2ludCIsIm1ldGhvZCIsInVzZXJBZ2VudCIsImhlYWRlcnMiLCJnZXQiLCJzZWFyY2hQYXJhbXMiLCJVUkwiLCJ1cmwiLCJwYXJzZUludCIsImRheXMiLCJnZXRTdXBhYmFzZUNsaWVudCIsInN0YXJ0RGF0ZSIsIkRhdGUiLCJzZXREYXRlIiwiZ2V0RGF0ZSIsImd0ZSIsInRvSVNPU3RyaW5nIiwibm90IiwiYW5hbHl0aWNzRGF0YSIsIndpdGhEYXRhYmFzZVRpbWVvdXQiLCJzaWduYWwiLCJBUElfVElNRU9VVFMiLCJkYXRhYmFzZSIsImxlbmd0aCIsInNlYXJjaENvdW50cyIsIk1hcCIsInNlYXJjaENhdGVnb3JpZXMiLCJldmVudCIsImxhYmVsIiwidHJpbSIsInNldCIsInNvcnRlZFNlYXJjaGVzIiwiQXJyYXkiLCJlbnRyaWVzIiwiY2hhckF0IiwidG9VcHBlckNhc2UiLCJhbmFseXRpY3NFcnJvciIsImR5bmFtaWNTZWFyY2hlcyIsImZpbHRlcmVkU2VhcmNoZXMiLCJuZWVkZWQiLCJhZGRpdGlvbmFsU2VhcmNoZXMiLCJyZXNwb25zZSIsInRyZW5kaW5nIiwibGFzdFVwZGF0ZWQiLCJzdWNjZXNzIiwiaGFzUmVhbERhdGEiLCJzb21lIiwicyIsImluY2x1ZGVzIiwic2VhcmNoZXNDb3VudCIsIk5leHRSZXNwb25zZSIsImpzb24iLCJsb2dBcGlFcnJvciIsIkVycm9yIiwiZmFsbGJhY2tSZXNwb25zZSIsImRlZmF1bHRUcmVuZGluZ1NlYXJjaGVzIiwibmV4dFVybCIsImxvZ1JhdGVMaW1pdEV4Y2VlZGVkIiwiY29udGVudFR5cGUiLCJzdGF0dXMiLCJib2R5VGV4dCIsInRleHQiLCJyZXF1ZXN0RGF0YSIsIkpTT04iLCJwYXJzZSIsInBhcnNlRXJyb3IiLCJ1c2VySWQiLCJzZXNzaW9uSWQiLCJycGMiLCJwX2V2ZW50X25hbWUiLCJwX2NhdGVnb3J5IiwicF9hY3Rpb24iLCJwX2xhYmVsIiwic3Vic3RyaW5nIiwicF91c2VyX2lkIiwicF9zZXNzaW9uX2lkIiwicF9wYWdlIiwicF91c2VyX2FnZW50Il0sIm1hcHBpbmdzIjoiQUFBQSxxQ0FBcUM7Ozs7Ozs7Ozs7OztRQW9JZkE7ZUFBQUE7O1FBdU1BQztlQUFBQTs7UUExVVRDO2VBQUFBOzs7d0JBTTZCOzBCQUNSOzZCQU1nQjs2QkFDcUI7Z0NBQ2xDO0FBZjlCLE1BQU1BLFVBQVU7QUErQnZCLHlFQUF5RTtBQUN6RSxlQUFlQyxnQ0FDYkMsUUFBYSxFQUNiQyxRQUFnQixDQUFDO0lBRWpCLElBQUk7UUFDRixxRkFBcUY7UUFDckYsTUFBTSxFQUFFQyxNQUFNQyxRQUFRLEVBQUVDLE9BQU9DLGFBQWEsRUFBRSxHQUFHLE1BQU1MLFNBQ3BETSxJQUFJLENBQUMsWUFDTEMsTUFBTSxDQUFDLDhDQUNQQyxFQUFFLENBQUMsYUFBYSxNQUNoQlAsS0FBSyxDQUFDO1FBRVQsSUFBSUksaUJBQWlCLENBQUNGLFVBQVU7WUFDOUJNLFFBQVFDLElBQUksQ0FBQyw2Q0FBNkNMO1lBQzFELE9BQU9N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