{"version":3,"names":["auth","cov_h4tnu49bh","f","s","handlers","signIn","signOut","supabaseUrl","process","env","NEXT_PUBLIC_SUPABASE_URL","supabaseServiceRoleKey","SUPABASE_SERVICE_ROLE_KEY","b","Error","nextAuth","_nextauth","default","adapter","_supabaseadapter","SupabaseAdapter","url","secret","providers","_google","clientId","AUTH_GOOGLE_ID","clientSecret","AUTH_GOOGLE_SECRET","authorization","params","prompt","pages","error","callbacks","jwt","token","user","account","accessToken","access_token","refreshToken","refresh_token","userId","id","session","profile","provider","events","console","log","email","strategy","maxAge"],"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\auth.ts"],"sourcesContent":["import NextAuth from \"next-auth\"\r\nimport Google from \"next-auth/providers/google\"\r\nimport { SupabaseAdapter } from \"./lib/integrations/supabase/supabase-adapter\"\r\n\r\n// Validación de variables de entorno requeridas\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\r\nconst supabaseServiceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY\r\n\r\nif (!supabaseUrl) {\r\n  throw new Error(\"NEXT_PUBLIC_SUPABASE_URL is required but not defined\")\r\n}\r\n\r\nif (!supabaseServiceRoleKey) {\r\n  throw new Error(\"SUPABASE_SERVICE_ROLE_KEY is required but not defined\")\r\n}\r\n\r\nconst nextAuth = NextAuth({\r\n  adapter: SupabaseAdapter({\r\n    url: supabaseUrl,\r\n    secret: supabaseServiceRoleKey,\r\n  }),\r\n  providers: [\r\n    Google({\r\n      clientId: process.env.AUTH_GOOGLE_ID!,\r\n      clientSecret: process.env.AUTH_GOOGLE_SECRET!,\r\n      authorization: {\r\n        params: {\r\n          prompt: \"select_account\",\r\n        },\r\n      },\r\n    }),\r\n  ],\r\n  pages: {\r\n    signIn: \"/auth/signin\",\r\n    error: \"/auth/error\",\r\n  },\r\n  callbacks: {\r\n    async jwt({ token, user, account }) {\r\n      if (account && user) {\r\n        token.accessToken = account.access_token\r\n        token.refreshToken = account.refresh_token\r\n        token.userId = user.id\r\n      }\r\n      return token\r\n    },\r\n    async session({ session, token }) {\r\n      if (token) {\r\n        session.accessToken = token.accessToken as string\r\n        session.refreshToken = token.refreshToken as string\r\n        session.user.id = token.userId as string\r\n      }\r\n      return session\r\n    },\r\n    async signIn({ user, account, profile }) {\r\n      // Permitir el sign-in para todos los usuarios de Google\r\n      if (account?.provider === \"google\") {\r\n        return true\r\n      }\r\n      return false\r\n    },\r\n  },\r\n  events: {\r\n    async signIn({ user, account, profile }) {\r\n      console.log(\"Usuario autenticado:\", user.email)\r\n    },\r\n    async signOut({ session, token }) {\r\n      console.log(\"Usuario desconectado\")\r\n    },\r\n  },\r\n  session: {\r\n    strategy: \"jwt\" as const,\r\n    maxAge: 30 * 24 * 60 * 60, // 30 días\r\n  },\r\n  jwt: {\r\n    maxAge: 30 * 24 * 60 * 60, // 30 días\r\n  },\r\n})\r\n\r\nexport const { auth, handlers, signIn, signOut } = nextAuth\r\n\r\n// Tipos TypeScript para extender la sesión\r\ndeclare module \"next-auth\" {\r\n  interface Session {\r\n    supabaseAccessToken?: string\r\n    user: {\r\n      id: string\r\n      name?: string | null\r\n      email?: string | null\r\n      image?: string | null\r\n    }\r\n  }\r\n}\r\n\r\ndeclare module \"next-auth/jwt\" {\r\n  interface JWT {\r\n    sub: string\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]}