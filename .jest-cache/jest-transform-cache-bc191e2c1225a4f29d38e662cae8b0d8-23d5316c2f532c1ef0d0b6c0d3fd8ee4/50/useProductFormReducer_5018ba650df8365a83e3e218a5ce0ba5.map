{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\hooks\\optimization\\useProductFormReducer.ts"],"sourcesContent":["import { useReducer, useCallback, useMemo } from 'react';\r\n\r\n// Tipos para el estado del formulario de productos\r\ninterface ProductFormState {\r\n  // Información básica\r\n  name: string;\r\n  description: string;\r\n  shortDescription: string;\r\n  categoryId: string;\r\n  status: 'active' | 'inactive' | 'draft';\r\n  \r\n  // Detalles del producto\r\n  brand: string;\r\n  model: string;\r\n  sku: string;\r\n  barcode: string;\r\n  \r\n  // Precios\r\n  price: number;\r\n  comparePrice: number;\r\n  costPrice: number;\r\n  taxRate: number;\r\n  \r\n  // Inventario\r\n  trackInventory: boolean;\r\n  stock: number;\r\n  lowStockThreshold: number;\r\n  allowBackorder: boolean;\r\n  \r\n  // Envío\r\n  requiresShipping: boolean;\r\n  weight: number;\r\n  dimensions: {\r\n    length: number;\r\n    width: number;\r\n    height: number;\r\n  };\r\n  \r\n  // SEO\r\n  seoTitle: string;\r\n  seoDescription: string;\r\n  seoKeywords: string[];\r\n  \r\n  // Imágenes y variantes\r\n  images: string[];\r\n  variants: any[];\r\n  \r\n  // Estado del formulario\r\n  isLoading: boolean;\r\n  isSaving: boolean;\r\n  errors: Record<string, string>;\r\n  isDirty: boolean;\r\n  currentStep: number;\r\n  validationErrors: Record<string, string[]>;\r\n}\r\n\r\n// Tipos de acciones\r\ntype ProductFormAction =\r\n  | { type: 'SET_FIELD'; field: keyof ProductFormState; value: any }\r\n  | { type: 'SET_MULTIPLE_FIELDS'; fields: Partial<ProductFormState> }\r\n  | { type: 'SET_LOADING'; payload: boolean }\r\n  | { type: 'SET_SAVING'; payload: boolean }\r\n  | { type: 'SET_ERROR'; field: string; error: string }\r\n  | { type: 'CLEAR_ERROR'; field: string }\r\n  | { type: 'CLEAR_ALL_ERRORS' }\r\n  | { type: 'SET_VALIDATION_ERRORS'; errors: Record<string, string[]> }\r\n  | { type: 'SET_DIRTY'; payload: boolean }\r\n  | { type: 'SET_STEP'; step: number }\r\n  | { type: 'NEXT_STEP' }\r\n  | { type: 'PREV_STEP' }\r\n  | { type: 'ADD_IMAGE'; image: string }\r\n  | { type: 'REMOVE_IMAGE'; index: number }\r\n  | { type: 'ADD_VARIANT'; variant: any }\r\n  | { type: 'REMOVE_VARIANT'; index: number }\r\n  | { type: 'UPDATE_VARIANT'; index: number; variant: any }\r\n  | { type: 'ADD_SEO_KEYWORD'; keyword: string }\r\n  | { type: 'REMOVE_SEO_KEYWORD'; index: number }\r\n  | { type: 'RESET_FORM' }\r\n  | { type: 'LOAD_PRODUCT'; product: Partial<ProductFormState> };\r\n\r\n// Estado inicial\r\nconst initialState: ProductFormState = {\r\n  // Información básica\r\n  name: '',\r\n  description: '',\r\n  shortDescription: '',\r\n  categoryId: '',\r\n  status: 'draft',\r\n  \r\n  // Detalles del producto\r\n  brand: '',\r\n  model: '',\r\n  sku: '',\r\n  barcode: '',\r\n  \r\n  // Precios\r\n  price: 0,\r\n  comparePrice: 0,\r\n  costPrice: 0,\r\n  taxRate: 0,\r\n  \r\n  // Inventario\r\n  trackInventory: true,\r\n  stock: 0,\r\n  lowStockThreshold: 5,\r\n  allowBackorder: false,\r\n  \r\n  // Envío\r\n  requiresShipping: true,\r\n  weight: 0,\r\n  dimensions: {\r\n    length: 0,\r\n    width: 0,\r\n    height: 0,\r\n  },\r\n  \r\n  // SEO\r\n  seoTitle: '',\r\n  seoDescription: '',\r\n  seoKeywords: [],\r\n  \r\n  // Imágenes y variantes\r\n  images: [],\r\n  variants: [],\r\n  \r\n  // Estado del formulario\r\n  isLoading: false,\r\n  isSaving: false,\r\n  errors: {},\r\n  isDirty: false,\r\n  currentStep: 0,\r\n  validationErrors: {},\r\n};\r\n\r\n// Reducer function\r\nfunction productFormReducer(\r\n  state: ProductFormState,\r\n  action: ProductFormAction\r\n): ProductFormState {\r\n  switch (action.type) {\r\n    case 'SET_FIELD':\r\n      return {\r\n        ...state,\r\n        [action.field]: action.value,\r\n        isDirty: true,\r\n        // Limpiar error del campo si existe\r\n        errors: {\r\n          ...state.errors,\r\n          [action.field]: undefined,\r\n        },\r\n      };\r\n    \r\n    case 'SET_MULTIPLE_FIELDS':\r\n      return {\r\n        ...state,\r\n        ...action.fields,\r\n        isDirty: true,\r\n      };\r\n    \r\n    case 'SET_LOADING':\r\n      return { ...state, isLoading: action.payload };\r\n    \r\n    case 'SET_SAVING':\r\n      return { ...state, isSaving: action.payload };\r\n    \r\n    case 'SET_ERROR':\r\n      return {\r\n        ...state,\r\n        errors: {\r\n          ...state.errors,\r\n          [action.field]: action.error,\r\n        },\r\n      };\r\n    \r\n    case 'CLEAR_ERROR':\r\n      const { [action.field]: _, ...restErrors } = state.errors;\r\n      return {\r\n        ...state,\r\n        errors: restErrors,\r\n      };\r\n    \r\n    case 'CLEAR_ALL_ERRORS':\r\n      return {\r\n        ...state,\r\n        errors: {},\r\n        validationErrors: {},\r\n      };\r\n    \r\n    case 'SET_VALIDATION_ERRORS':\r\n      return {\r\n        ...state,\r\n        validationErrors: action.errors,\r\n      };\r\n    \r\n    case 'SET_DIRTY':\r\n      return { ...state, isDirty: action.payload };\r\n    \r\n    case 'SET_STEP':\r\n      return { ...state, currentStep: Math.max(0, Math.min(4, action.step)) };\r\n    \r\n    case 'NEXT_STEP':\r\n      return { ...state, currentStep: Math.min(4, state.currentStep + 1) };\r\n    \r\n    case 'PREV_STEP':\r\n      return { ...state, currentStep: Math.max(0, state.currentStep - 1) };\r\n    \r\n    case 'ADD_IMAGE':\r\n      return {\r\n        ...state,\r\n        images: [...state.images, action.image],\r\n        isDirty: true,\r\n      };\r\n    \r\n    case 'REMOVE_IMAGE':\r\n      return {\r\n        ...state,\r\n        images: state.images.filter((_, index) => index !== action.index),\r\n        isDirty: true,\r\n      };\r\n    \r\n    case 'ADD_VARIANT':\r\n      return {\r\n        ...state,\r\n        variants: [...state.variants, action.variant],\r\n        isDirty: true,\r\n      };\r\n    \r\n    case 'REMOVE_VARIANT':\r\n      return {\r\n        ...state,\r\n        variants: state.variants.filter((_, index) => index !== action.index),\r\n        isDirty: true,\r\n      };\r\n    \r\n    case 'UPDATE_VARIANT':\r\n      return {\r\n        ...state,\r\n        variants: state.variants.map((variant, index) =>\r\n          index === action.index ? action.variant : variant\r\n        ),\r\n        isDirty: true,\r\n      };\r\n    \r\n    case 'ADD_SEO_KEYWORD':\r\n      if (!state.seoKeywords.includes(action.keyword)) {\r\n        return {\r\n          ...state,\r\n          seoKeywords: [...state.seoKeywords, action.keyword],\r\n          isDirty: true,\r\n        };\r\n      }\r\n      return state;\r\n    \r\n    case 'REMOVE_SEO_KEYWORD':\r\n      return {\r\n        ...state,\r\n        seoKeywords: state.seoKeywords.filter((_, index) => index !== action.index),\r\n        isDirty: true,\r\n      };\r\n    \r\n    case 'RESET_FORM':\r\n      return initialState;\r\n    \r\n    case 'LOAD_PRODUCT':\r\n      return {\r\n        ...state,\r\n        ...action.product,\r\n        isDirty: false,\r\n      };\r\n    \r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\n// Hook personalizado\r\nexport function useProductFormReducer() {\r\n  const [state, dispatch] = useReducer(productFormReducer, initialState);\r\n\r\n  // Acciones memoizadas\r\n  const actions = useMemo(() => ({\r\n    setField: (field: keyof ProductFormState, value: any) =>\r\n      dispatch({ type: 'SET_FIELD', field, value }),\r\n    \r\n    setMultipleFields: (fields: Partial<ProductFormState>) =>\r\n      dispatch({ type: 'SET_MULTIPLE_FIELDS', fields }),\r\n    \r\n    setLoading: (loading: boolean) =>\r\n      dispatch({ type: 'SET_LOADING', payload: loading }),\r\n    \r\n    setSaving: (saving: boolean) =>\r\n      dispatch({ type: 'SET_SAVING', payload: saving }),\r\n    \r\n    setError: (field: string, error: string) =>\r\n      dispatch({ type: 'SET_ERROR', field, error }),\r\n    \r\n    clearError: (field: string) =>\r\n      dispatch({ type: 'CLEAR_ERROR', field }),\r\n    \r\n    clearAllErrors: () =>\r\n      dispatch({ type: 'CLEAR_ALL_ERRORS' }),\r\n    \r\n    setValidationErrors: (errors: Record<string, string[]>) =>\r\n      dispatch({ type: 'SET_VALIDATION_ERRORS', errors }),\r\n    \r\n    setDirty: (dirty: boolean) =>\r\n      dispatch({ type: 'SET_DIRTY', payload: dirty }),\r\n    \r\n    setStep: (step: number) =>\r\n      dispatch({ type: 'SET_STEP', step }),\r\n    \r\n    nextStep: () =>\r\n      dispatch({ type: 'NEXT_STEP' }),\r\n    \r\n    prevStep: () =>\r\n      dispatch({ type: 'PREV_STEP' }),\r\n    \r\n    addImage: (image: string) =>\r\n      dispatch({ type: 'ADD_IMAGE', image }),\r\n    \r\n    removeImage: (index: number) =>\r\n      dispatch({ type: 'REMOVE_IMAGE', index }),\r\n    \r\n    addVariant: (variant: any) =>\r\n      dispatch({ type: 'ADD_VARIANT', variant }),\r\n    \r\n    removeVariant: (index: number) =>\r\n      dispatch({ type: 'REMOVE_VARIANT', index }),\r\n    \r\n    updateVariant: (index: number, variant: any) =>\r\n      dispatch({ type: 'UPDATE_VARIANT', index, variant }),\r\n    \r\n    addSeoKeyword: (keyword: string) =>\r\n      dispatch({ type: 'ADD_SEO_KEYWORD', keyword }),\r\n    \r\n    removeSeoKeyword: (index: number) =>\r\n      dispatch({ type: 'REMOVE_SEO_KEYWORD', index }),\r\n    \r\n    resetForm: () =>\r\n      dispatch({ type: 'RESET_FORM' }),\r\n    \r\n    loadProduct: (product: Partial<ProductFormState>) =>\r\n      dispatch({ type: 'LOAD_PRODUCT', product }),\r\n  }), []);\r\n\r\n  // Selectores memoizados\r\n  const selectors = useMemo(() => ({\r\n    // Verificaciones de estado\r\n    hasErrors: Object.keys(state.errors).length > 0,\r\n    hasValidationErrors: Object.keys(state.validationErrors).length > 0,\r\n    isFormValid: Object.keys(state.errors).length === 0 && state.name.trim() !== '',\r\n    \r\n    // Información de pasos\r\n    isFirstStep: state.currentStep === 0,\r\n    isLastStep: state.currentStep === 4,\r\n    stepProgress: ((state.currentStep + 1) / 5) * 100,\r\n    \r\n    // Cálculos de precios\r\n    profitMargin: state.price > 0 && state.costPrice > 0 \r\n      ? ((state.price - state.costPrice) / state.price) * 100 \r\n      : 0,\r\n    \r\n    discountPercentage: state.comparePrice > 0 && state.price > 0\r\n      ? ((state.comparePrice - state.price) / state.comparePrice) * 100\r\n      : 0,\r\n    \r\n    // Estado de inventario\r\n    isLowStock: state.stock <= state.lowStockThreshold,\r\n    isOutOfStock: state.stock === 0,\r\n    \r\n    // Validaciones específicas\r\n    isPriceValid: state.price > 0,\r\n    isSkuValid: state.sku.length > 0,\r\n    areDimensionsValid: state.dimensions.length > 0 && \r\n                       state.dimensions.width > 0 && \r\n                       state.dimensions.height > 0,\r\n    \r\n    // Contadores\r\n    imageCount: state.images.length,\r\n    variantCount: state.variants.length,\r\n    keywordCount: state.seoKeywords.length,\r\n    \r\n    // Obtener errores por paso\r\n    getStepErrors: (step: number) => {\r\n      const stepFields = {\r\n        0: ['name', 'description', 'categoryId'],\r\n        1: ['price', 'comparePrice', 'costPrice'],\r\n        2: ['stock', 'lowStockThreshold'],\r\n        3: ['images'],\r\n        4: ['seoTitle', 'seoDescription'],\r\n      };\r\n      \r\n      const fields = stepFields[step as keyof typeof stepFields] || [];\r\n      return fields.filter(field => state.errors[field]);\r\n    },\r\n  }), [state]);\r\n\r\n  return {\r\n    state,\r\n    actions,\r\n    selectors,\r\n  };\r\n}\r\n\r\n// Hook para validación en tiempo real\r\nexport function useProductFormValidation() {\r\n  const { state, actions, selectors } = useProductFormReducer();\r\n  \r\n  const validateField = useCallback((field: keyof ProductFormState, value: any) => {\r\n    let error = '';\r\n    \r\n    switch (field) {\r\n      case 'name':\r\n        if (!value || value.trim().length === 0) {\r\n          error = 'El nombre es requerido';\r\n        } else if (value.length > 255) {\r\n          error = 'Máximo 255 caracteres';\r\n        }\r\n        break;\r\n      \r\n      case 'price':\r\n        if (value <= 0) {\r\n          error = 'El precio debe ser mayor a 0';\r\n        } else if (value > 999999.99) {\r\n          error = 'Precio máximo excedido';\r\n        }\r\n        break;\r\n      \r\n      case 'comparePrice':\r\n        if (value > 0 && value < state.price) {\r\n          error = 'El precio de comparación debe ser mayor al precio base';\r\n        }\r\n        break;\r\n      \r\n      case 'costPrice':\r\n        if (value > 0 && value > state.price) {\r\n          error = 'El precio de costo debe ser menor al precio de venta';\r\n        }\r\n        break;\r\n      \r\n      case 'stock':\r\n        if (value < 0) {\r\n          error = 'El stock debe ser mayor o igual a 0';\r\n        } else if (value > 999999) {\r\n          error = 'Stock máximo excedido';\r\n        }\r\n        break;\r\n      \r\n      case 'sku':\r\n        if (value && !/^[A-Z0-9\\-_]+$/.test(value)) {\r\n          error = 'SKU debe contener solo letras mayúsculas, números, guiones y guiones bajos';\r\n        }\r\n        break;\r\n    }\r\n    \r\n    if (error) {\r\n      actions.setError(field, error);\r\n    } else {\r\n      actions.clearError(field);\r\n    }\r\n    \r\n    return error === '';\r\n  }, [state.price, actions]);\r\n  \r\n  const validateForm = useCallback(() => {\r\n    const fields: (keyof ProductFormState)[] = [\r\n      'name', 'price', 'stock', 'categoryId'\r\n    ];\r\n    \r\n    let isValid = true;\r\n    fields.forEach(field => {\r\n      const fieldValid = validateField(field, state[field]);\r\n      if (!fieldValid) {isValid = false;}\r\n    });\r\n    \r\n    return isValid;\r\n  }, [state, validateField]);\r\n  \r\n  return {\r\n    state,\r\n    actions,\r\n    selectors,\r\n    validateField,\r\n    validateForm,\r\n  };\r\n}\r\n\r\nexport type { ProductFormState, ProductFormAction };\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":["useProductFormReducer","useProductFormValidation","initialState","name","description","shortDescription","categoryId","status","brand","model","sku","barcode","price","comparePrice","costPrice","taxRate","trackInventory","stock","lowStockThreshold","allowBackorder","requiresShipping","weight","dimensions","length","width","height","seoTitle","seoDescription","seoKeywords","images","variants","isLoading","isSaving","errors","isDirty","currentStep","validationErrors","productFormReducer","state","action","type","field","value","undefined","fields","payload","error","_","restErrors","Math","max","min","step","image","filter","index","variant","map","includes","keyword","product","dispatch","useReducer","actions","useMemo","setField","setMultipleFields","setLoading","loading","setSaving","saving","setError","clearError","clearAllErrors","setValidationErrors","setDirty","dirty","setStep","nextStep","prevStep","addImage","removeImage","addVariant","removeVariant","updateVariant","addSeoKeyword","removeSeoKeyword","resetForm","loadProduct","selectors","hasErrors","Object","keys","hasValidationErrors","isFormValid","trim","isFirstStep","isLastStep","stepProgress","profitMargin","discountPercentage","isLowStock","isOutOfStock","isPriceValid","isSkuValid","areDimensionsValid","imageCount","variantCount","keywordCount","getStepErrors","stepFields","validateField","useCallback","test","validateForm","isValid","forEach","fieldValid"],"mappings":"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"}