979237660c33774923c3f27015d82b63
// Configuración para Node.js Runtime
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get GET () {
        return GET;
    },
    get POST () {
        return POST;
    },
    get runtime () {
        return runtime;
    }
});
const _server = require("next/server");
const _config = require("../../../../lib/auth/config");
const _server1 = require("../../../../lib/integrations/supabase/server");
const runtime = 'nodejs';
async function GET(request) {
    try {
        // Verificar autenticación
        const session = await (0, _config.auth)();
        if (!session?.user?.email) {
            return _server.NextResponse.json({
                error: 'No autorizado'
            }, {
                status: 401
            });
        }
        const { searchParams } = new URL(request.url);
        const status = searchParams.get('status'); // pending, in_transit, delivered, exception
        const date = searchParams.get('date'); // YYYY-MM-DD
        const supabase = await (0, _server1.createClient)();
        // Obtener información del driver
        const { data: driver, error: driverError } = await supabase.from('drivers').select('id').eq('email', session.user.email).single();
        if (driverError || !driver) {
            return _server.NextResponse.json({
                error: 'Driver no encontrado'
            }, {
                status: 404
            });
        }
        // Construir query para obtener rutas con entregas
        let query = supabase.from('optimized_routes').select('*').eq('driver_id', driver.id);
        // Filtrar por fecha si se especifica
        if (date) {
            query = query.gte('created_at', `${date}T00:00:00.000Z`).lte('created_at', `${date}T23:59:59.999Z`);
        }
        const { data: routes, error: routesError } = await query;
        if (routesError) {
            console.error('Error fetching routes:', routesError);
            return _server.NextResponse.json({
                error: 'Error obteniendo rutas'
            }, {
                status: 500
            });
        }
        // Extraer y procesar todas las entregas
        const allDeliveries = [];
        for (const route of routes || []){
            if (route.shipments && Array.isArray(route.shipments)) {
                for(let i = 0; i < route.shipments.length; i++){
                    const shipment = route.shipments[i];
                    // Filtrar por estado si se especifica
                    if (status && shipment.status !== status) {
                        continue;
                    }
                    const delivery = {
                        id: shipment.id || `${route.id}-${i}`,
                        route_id: route.id,
                        route_name: route.name,
                        tracking_number: shipment.tracking_number || `TRK-${route.id.slice(-6)}-${i + 1}`,
                        customer_name: shipment.customer_name || `Cliente ${i + 1}`,
                        customer_phone: shipment.customer_phone,
                        destination: {
                            address: shipment.destination?.address || `Dirección ${i + 1}`,
                            city: shipment.destination?.city || 'Buenos Aires',
                            postal_code: shipment.destination?.postal_code || '1000',
                            coordinates: shipment.destination?.coordinates,
                            notes: shipment.destination?.notes
                        },
                        items: shipment.items || [],
                        status: shipment.status || 'confirmed',
                        estimated_delivery_time: shipment.estimated_delivery_time,
                        special_instructions: shipment.special_instructions,
                        requires_signature: shipment.requires_signature || false,
                        cash_on_delivery: shipment.cash_on_delivery,
                        delivery_notes: shipment.delivery_notes,
                        delivered_at: shipment.delivered_at,
                        delivered_by: shipment.delivered_by,
                        created_at: route.created_at,
                        updated_at: route.updated_at
                    };
                    allDeliveries.push(delivery);
                }
            }
        }
        // Ordenar por fecha de creación (más recientes primero)
        allDeliveries.sort((a, b)=>new Date(b.created_at).getTime() - new Date(a.created_at).getTime());
        // Estadísticas
        const stats = {
            total: allDeliveries.length,
            pending: allDeliveries.filter((d)=>d.status === 'pending').length,
            confirmed: allDeliveries.filter((d)=>d.status === 'confirmed').length,
            in_transit: allDeliveries.filter((d)=>d.status === 'in_transit').length,
            delivered: allDeliveries.filter((d)=>d.status === 'delivered').length,
            exception: allDeliveries.filter((d)=>d.status === 'exception').length
        };
        return _server.NextResponse.json({
            deliveries: allDeliveries,
            stats,
            driver_id: driver.id
        });
    } catch (error) {
        console.error('Error in driver deliveries API:', error);
        return _server.NextResponse.json({
            error: 'Error interno del servidor'
        }, {
            status: 500
        });
    }
}
async function POST(request) {
    try {
        // Verificar autenticación
        const session = await (0, _config.auth)();
        if (!session?.user?.email) {
            return _server.NextResponse.json({
                error: 'No autorizado'
            }, {
                status: 401
            });
        }
        const body = await request.json();
        const { delivery_id, route_id, status, delivery_notes, signature_data, photo_evidence, location } = body;
        // Validar parámetros requeridos
        if (!delivery_id || !route_id || !status) {
            return _server.NextResponse.json({
                error: 'delivery_id, route_id y status son requeridos'
            }, {
                status: 400
            });
        }
        const supabase = await (0, _server1.createClient)();
        // Obtener información del driver
        const { data: driver, error: driverError } = await supabase.from('drivers').select('id, name').eq('email', session.user.email).single();
        if (driverError || !driver) {
            return _server.NextResponse.json({
                error: 'Driver no encontrado'
            }, {
                status: 404
            });
        }
        // Obtener la ruta actual
        const { data: route, error: routeError } = await supabase.from('optimized_routes').select('*').eq('id', route_id).eq('driver_id', driver.id).single();
        if (routeError || !route) {
            return _server.NextResponse.json({
                error: 'Ruta no encontrada'
            }, {
                status: 404
            });
        }
        // Actualizar el shipment específico
        const updatedShipments = route.shipments.map((shipment)=>{
            if (shipment.id === delivery_id || `${route_id}-${route.shipments.indexOf(shipment)}` === delivery_id) {
                const updatedShipment = {
                    ...shipment,
                    status,
                    delivery_notes,
                    updated_at: new Date().toISOString()
                };
                // Si se marca como entregado, agregar información adicional
                if (status === 'delivered') {
                    updatedShipment.delivered_at = new Date().toISOString();
                    updatedShipment.delivered_by = driver.name;
                    updatedShipment.delivery_location = location;
                    if (signature_data) {
                        updatedShipment.signature_data = signature_data;
                    }
                    if (photo_evidence) {
                        updatedShipment.photo_evidence = photo_evidence;
                    }
                }
                return updatedShipment;
            }
            return shipment;
        });
        // Actualizar la ruta en la base de datos
        const { data: updatedRoute, error: updateError } = await supabase.from('optimized_routes').update({
            shipments: updatedShipments,
            updated_at: new Date().toISOString()
        }).eq('id', route_id).eq('driver_id', driver.id).select().single();
        if (updateError) {
            console.error('Error updating delivery:', updateError);
            return _server.NextResponse.json({
                error: 'Error actualizando entrega'
            }, {
                status: 500
            });
        }
        // Verificar si todas las entregas están completadas
        const allDelivered = updatedShipments.every((shipment)=>shipment.status === 'delivered');
        // Si todas las entregas están completadas, marcar la ruta como completada
        if (allDelivered) {
            await supabase.from('optimized_routes').update({
                status: 'completed',
                completed_at: new Date().toISOString()
            }).eq('id', route_id);
        }
        return _server.NextResponse.json({
            success: true,
            delivery_id,
            status,
            route_completed: allDelivered,
            updated_at: new Date().toISOString()
        });
    } catch (error) {
        console.error('Error in driver delivery update API:', error);
        return _server.NextResponse.json({
            error: 'Error interno del servidor'
        }, {
            status: 500
        });
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcYXBwXFxhcGlcXGRyaXZlclxcZGVsaXZlcmllc1xccm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29uZmlndXJhY2nDs24gcGFyYSBOb2RlLmpzIFJ1bnRpbWVcclxuZXhwb3J0IGNvbnN0IHJ1bnRpbWUgPSAnbm9kZWpzJztcclxuXHJcbi8qKlxyXG4gKiBBUEkgcGFyYSBnZXN0acOzbiBkZSBlbnRyZWdhcyBwb3IgcGFydGUgZGUgbG9zIGRyaXZlcnNcclxuICogR0VUIC9hcGkvZHJpdmVyL2RlbGl2ZXJpZXMgLSBPYnRlbmVyIGVudHJlZ2FzIGFzaWduYWRhc1xyXG4gKiBQT1NUIC9hcGkvZHJpdmVyL2RlbGl2ZXJpZXMgLSBBY3R1YWxpemFyIGVzdGFkbyBkZSBlbnRyZWdhXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcclxuaW1wb3J0IHsgYXV0aCB9IGZyb20gJ0AvbGliL2F1dGgvY29uZmlnJztcclxuaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQC9saWIvaW50ZWdyYXRpb25zL3N1cGFiYXNlL3NlcnZlcic7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIFZlcmlmaWNhciBhdXRlbnRpY2FjacOzblxyXG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGF1dGgoKTtcclxuICAgIFxyXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyPy5lbWFpbCkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogJ05vIGF1dG9yaXphZG8nIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMSB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xyXG4gICAgY29uc3Qgc3RhdHVzID0gc2VhcmNoUGFyYW1zLmdldCgnc3RhdHVzJyk7IC8vIHBlbmRpbmcsIGluX3RyYW5zaXQsIGRlbGl2ZXJlZCwgZXhjZXB0aW9uXHJcbiAgICBjb25zdCBkYXRlID0gc2VhcmNoUGFyYW1zLmdldCgnZGF0ZScpOyAvLyBZWVlZLU1NLUREXHJcblxyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVDbGllbnQoKTtcclxuXHJcbiAgICAvLyBPYnRlbmVyIGluZm9ybWFjacOzbiBkZWwgZHJpdmVyXHJcbiAgICBjb25zdCB7IGRhdGE6IGRyaXZlciwgZXJyb3I6IGRyaXZlckVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnZHJpdmVycycpXHJcbiAgICAgIC5zZWxlY3QoJ2lkJylcclxuICAgICAgLmVxKCdlbWFpbCcsIHNlc3Npb24udXNlci5lbWFpbClcclxuICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChkcml2ZXJFcnJvciB8fCAhZHJpdmVyKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiAnRHJpdmVyIG5vIGVuY29udHJhZG8nIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwNCB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ29uc3RydWlyIHF1ZXJ5IHBhcmEgb2J0ZW5lciBydXRhcyBjb24gZW50cmVnYXNcclxuICAgIGxldCBxdWVyeSA9IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdvcHRpbWl6ZWRfcm91dGVzJylcclxuICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgIC5lcSgnZHJpdmVyX2lkJywgZHJpdmVyLmlkKTtcclxuXHJcbiAgICAvLyBGaWx0cmFyIHBvciBmZWNoYSBzaSBzZSBlc3BlY2lmaWNhXHJcbiAgICBpZiAoZGF0ZSkge1xyXG4gICAgICBxdWVyeSA9IHF1ZXJ5XHJcbiAgICAgICAgLmd0ZSgnY3JlYXRlZF9hdCcsIGAke2RhdGV9VDAwOjAwOjAwLjAwMFpgKVxyXG4gICAgICAgIC5sdGUoJ2NyZWF0ZWRfYXQnLCBgJHtkYXRlfVQyMzo1OTo1OS45OTlaYCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyBkYXRhOiByb3V0ZXMsIGVycm9yOiByb3V0ZXNFcnJvciB9ID0gYXdhaXQgcXVlcnk7XHJcblxyXG4gICAgaWYgKHJvdXRlc0Vycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHJvdXRlczonLCByb3V0ZXNFcnJvcik7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiAnRXJyb3Igb2J0ZW5pZW5kbyBydXRhcycgfSxcclxuICAgICAgICB7IHN0YXR1czogNTAwIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBFeHRyYWVyIHkgcHJvY2VzYXIgdG9kYXMgbGFzIGVudHJlZ2FzXHJcbiAgICBjb25zdCBhbGxEZWxpdmVyaWVzID0gW107XHJcbiAgICBcclxuICAgIGZvciAoY29uc3Qgcm91dGUgb2Ygcm91dGVzIHx8IFtdKSB7XHJcbiAgICAgIGlmIChyb3V0ZS5zaGlwbWVudHMgJiYgQXJyYXkuaXNBcnJheShyb3V0ZS5zaGlwbWVudHMpKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByb3V0ZS5zaGlwbWVudHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgIGNvbnN0IHNoaXBtZW50ID0gcm91dGUuc2hpcG1lbnRzW2ldO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBGaWx0cmFyIHBvciBlc3RhZG8gc2kgc2UgZXNwZWNpZmljYVxyXG4gICAgICAgICAgaWYgKHN0YXR1cyAmJiBzaGlwbWVudC5zdGF0dXMgIT09IHN0YXR1cykge1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBjb25zdCBkZWxpdmVyeSA9IHtcclxuICAgICAgICAgICAgaWQ6IHNoaXBtZW50LmlkIHx8IGAke3JvdXRlLmlkfS0ke2l9YCxcclxuICAgICAgICAgICAgcm91dGVfaWQ6IHJvdXRlLmlkLFxyXG4gICAgICAgICAgICByb3V0ZV9uYW1lOiByb3V0ZS5uYW1lLFxyXG4gICAgICAgICAgICB0cmFja2luZ19udW1iZXI6IHNoaXBtZW50LnRyYWNraW5nX251bWJlciB8fCBgVFJLLSR7cm91dGUuaWQuc2xpY2UoLTYpfS0ke2kgKyAxfWAsXHJcbiAgICAgICAgICAgIGN1c3RvbWVyX25hbWU6IHNoaXBtZW50LmN1c3RvbWVyX25hbWUgfHwgYENsaWVudGUgJHtpICsgMX1gLFxyXG4gICAgICAgICAgICBjdXN0b21lcl9waG9uZTogc2hpcG1lbnQuY3VzdG9tZXJfcGhvbmUsXHJcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uOiB7XHJcbiAgICAgICAgICAgICAgYWRkcmVzczogc2hpcG1lbnQuZGVzdGluYXRpb24/LmFkZHJlc3MgfHwgYERpcmVjY2nDs24gJHtpICsgMX1gLFxyXG4gICAgICAgICAgICAgIGNpdHk6IHNoaXBtZW50LmRlc3RpbmF0aW9uPy5jaXR5IHx8ICdCdWVub3MgQWlyZXMnLFxyXG4gICAgICAgICAgICAgIHBvc3RhbF9jb2RlOiBzaGlwbWVudC5kZXN0aW5hdGlvbj8ucG9zdGFsX2NvZGUgfHwgJzEwMDAnLFxyXG4gICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBzaGlwbWVudC5kZXN0aW5hdGlvbj8uY29vcmRpbmF0ZXMsXHJcbiAgICAgICAgICAgICAgbm90ZXM6IHNoaXBtZW50LmRlc3RpbmF0aW9uPy5ub3Rlc1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBpdGVtczogc2hpcG1lbnQuaXRlbXMgfHwgW10sXHJcbiAgICAgICAgICAgIHN0YXR1czogc2hpcG1lbnQuc3RhdHVzIHx8ICdjb25maXJtZWQnLFxyXG4gICAgICAgICAgICBlc3RpbWF0ZWRfZGVsaXZlcnlfdGltZTogc2hpcG1lbnQuZXN0aW1hdGVkX2RlbGl2ZXJ5X3RpbWUsXHJcbiAgICAgICAgICAgIHNwZWNpYWxfaW5zdHJ1Y3Rpb25zOiBzaGlwbWVudC5zcGVjaWFsX2luc3RydWN0aW9ucyxcclxuICAgICAgICAgICAgcmVxdWlyZXNfc2lnbmF0dXJlOiBzaGlwbWVudC5yZXF1aXJlc19zaWduYXR1cmUgfHwgZmFsc2UsXHJcbiAgICAgICAgICAgIGNhc2hfb25fZGVsaXZlcnk6IHNoaXBtZW50LmNhc2hfb25fZGVsaXZlcnksXHJcbiAgICAgICAgICAgIGRlbGl2ZXJ5X25vdGVzOiBzaGlwbWVudC5kZWxpdmVyeV9ub3RlcyxcclxuICAgICAgICAgICAgZGVsaXZlcmVkX2F0OiBzaGlwbWVudC5kZWxpdmVyZWRfYXQsXHJcbiAgICAgICAgICAgIGRlbGl2ZXJlZF9ieTogc2hpcG1lbnQuZGVsaXZlcmVkX2J5LFxyXG4gICAgICAgICAgICBjcmVhdGVkX2F0OiByb3V0ZS5jcmVhdGVkX2F0LFxyXG4gICAgICAgICAgICB1cGRhdGVkX2F0OiByb3V0ZS51cGRhdGVkX2F0XHJcbiAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgIGFsbERlbGl2ZXJpZXMucHVzaChkZWxpdmVyeSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gT3JkZW5hciBwb3IgZmVjaGEgZGUgY3JlYWNpw7NuIChtw6FzIHJlY2llbnRlcyBwcmltZXJvKVxyXG4gICAgYWxsRGVsaXZlcmllcy5zb3J0KChhLCBiKSA9PiBcclxuICAgICAgbmV3IERhdGUoYi5jcmVhdGVkX2F0KS5nZXRUaW1lKCkgLSBuZXcgRGF0ZShhLmNyZWF0ZWRfYXQpLmdldFRpbWUoKVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBFc3RhZMOtc3RpY2FzXHJcbiAgICBjb25zdCBzdGF0cyA9IHtcclxuICAgICAgdG90YWw6IGFsbERlbGl2ZXJpZXMubGVuZ3RoLFxyXG4gICAgICBwZW5kaW5nOiBhbGxEZWxpdmVyaWVzLmZpbHRlcihkID0+IGQuc3RhdHVzID09PSAncGVuZGluZycpLmxlbmd0aCxcclxuICAgICAgY29uZmlybWVkOiBhbGxEZWxpdmVyaWVzLmZpbHRlcihkID0+IGQuc3RhdHVzID09PSAnY29uZmlybWVkJykubGVuZ3RoLFxyXG4gICAgICBpbl90cmFuc2l0OiBhbGxEZWxpdmVyaWVzLmZpbHRlcihkID0+IGQuc3RhdHVzID09PSAnaW5fdHJhbnNpdCcpLmxlbmd0aCxcclxuICAgICAgZGVsaXZlcmVkOiBhbGxEZWxpdmVyaWVzLmZpbHRlcihkID0+IGQuc3RhdHVzID09PSAnZGVsaXZlcmVkJykubGVuZ3RoLFxyXG4gICAgICBleGNlcHRpb246IGFsbERlbGl2ZXJpZXMuZmlsdGVyKGQgPT4gZC5zdGF0dXMgPT09ICdleGNlcHRpb24nKS5sZW5ndGhcclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgZGVsaXZlcmllczogYWxsRGVsaXZlcmllcyxcclxuICAgICAgc3RhdHMsXHJcbiAgICAgIGRyaXZlcl9pZDogZHJpdmVyLmlkXHJcbiAgICB9KTtcclxuXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGRyaXZlciBkZWxpdmVyaWVzIEFQSTonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHsgZXJyb3I6ICdFcnJvciBpbnRlcm5vIGRlbCBzZXJ2aWRvcicgfSxcclxuICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICApO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgLy8gVmVyaWZpY2FyIGF1dGVudGljYWNpw7NuXHJcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgYXV0aCgpO1xyXG4gICAgXHJcbiAgICBpZiAoIXNlc3Npb24/LnVzZXI/LmVtYWlsKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiAnTm8gYXV0b3JpemFkbycgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAxIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XHJcbiAgICBjb25zdCB7IFxyXG4gICAgICBkZWxpdmVyeV9pZCwgXHJcbiAgICAgIHJvdXRlX2lkLCBcclxuICAgICAgc3RhdHVzLCBcclxuICAgICAgZGVsaXZlcnlfbm90ZXMsIFxyXG4gICAgICBzaWduYXR1cmVfZGF0YSxcclxuICAgICAgcGhvdG9fZXZpZGVuY2UsXHJcbiAgICAgIGxvY2F0aW9uIFxyXG4gICAgfSA9IGJvZHk7XHJcblxyXG4gICAgLy8gVmFsaWRhciBwYXLDoW1ldHJvcyByZXF1ZXJpZG9zXHJcbiAgICBpZiAoIWRlbGl2ZXJ5X2lkIHx8ICFyb3V0ZV9pZCB8fCAhc3RhdHVzKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiAnZGVsaXZlcnlfaWQsIHJvdXRlX2lkIHkgc3RhdHVzIHNvbiByZXF1ZXJpZG9zJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XHJcblxyXG4gICAgLy8gT2J0ZW5lciBpbmZvcm1hY2nDs24gZGVsIGRyaXZlclxyXG4gICAgY29uc3QgeyBkYXRhOiBkcml2ZXIsIGVycm9yOiBkcml2ZXJFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2RyaXZlcnMnKVxyXG4gICAgICAuc2VsZWN0KCdpZCwgbmFtZScpXHJcbiAgICAgIC5lcSgnZW1haWwnLCBzZXNzaW9uLnVzZXIuZW1haWwpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoZHJpdmVyRXJyb3IgfHwgIWRyaXZlcikge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogJ0RyaXZlciBubyBlbmNvbnRyYWRvJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDQgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIE9idGVuZXIgbGEgcnV0YSBhY3R1YWxcclxuICAgIGNvbnN0IHsgZGF0YTogcm91dGUsIGVycm9yOiByb3V0ZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnb3B0aW1pemVkX3JvdXRlcycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAuZXEoJ2lkJywgcm91dGVfaWQpXHJcbiAgICAgIC5lcSgnZHJpdmVyX2lkJywgZHJpdmVyLmlkKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKHJvdXRlRXJyb3IgfHwgIXJvdXRlKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiAnUnV0YSBubyBlbmNvbnRyYWRhJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDQgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFjdHVhbGl6YXIgZWwgc2hpcG1lbnQgZXNwZWPDrWZpY29cclxuICAgIGNvbnN0IHVwZGF0ZWRTaGlwbWVudHMgPSByb3V0ZS5zaGlwbWVudHMubWFwKChzaGlwbWVudDogYW55KSA9PiB7XHJcbiAgICAgIGlmIChzaGlwbWVudC5pZCA9PT0gZGVsaXZlcnlfaWQgfHwgXHJcbiAgICAgICAgICBgJHtyb3V0ZV9pZH0tJHtyb3V0ZS5zaGlwbWVudHMuaW5kZXhPZihzaGlwbWVudCl9YCA9PT0gZGVsaXZlcnlfaWQpIHtcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCB1cGRhdGVkU2hpcG1lbnQgPSB7XHJcbiAgICAgICAgICAuLi5zaGlwbWVudCxcclxuICAgICAgICAgIHN0YXR1cyxcclxuICAgICAgICAgIGRlbGl2ZXJ5X25vdGVzLFxyXG4gICAgICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gU2kgc2UgbWFyY2EgY29tbyBlbnRyZWdhZG8sIGFncmVnYXIgaW5mb3JtYWNpw7NuIGFkaWNpb25hbFxyXG4gICAgICAgIGlmIChzdGF0dXMgPT09ICdkZWxpdmVyZWQnKSB7XHJcbiAgICAgICAgICB1cGRhdGVkU2hpcG1lbnQuZGVsaXZlcmVkX2F0ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xyXG4gICAgICAgICAgdXBkYXRlZFNoaXBtZW50LmRlbGl2ZXJlZF9ieSA9IGRyaXZlci5uYW1lO1xyXG4gICAgICAgICAgdXBkYXRlZFNoaXBtZW50LmRlbGl2ZXJ5X2xvY2F0aW9uID0gbG9jYXRpb247XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGlmIChzaWduYXR1cmVfZGF0YSkge1xyXG4gICAgICAgICAgICB1cGRhdGVkU2hpcG1lbnQuc2lnbmF0dXJlX2RhdGEgPSBzaWduYXR1cmVfZGF0YTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIFxyXG4gICAgICAgICAgaWYgKHBob3RvX2V2aWRlbmNlKSB7XHJcbiAgICAgICAgICAgIHVwZGF0ZWRTaGlwbWVudC5waG90b19ldmlkZW5jZSA9IHBob3RvX2V2aWRlbmNlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHVwZGF0ZWRTaGlwbWVudDtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gc2hpcG1lbnQ7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBBY3R1YWxpemFyIGxhIHJ1dGEgZW4gbGEgYmFzZSBkZSBkYXRvc1xyXG4gICAgY29uc3QgeyBkYXRhOiB1cGRhdGVkUm91dGUsIGVycm9yOiB1cGRhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ29wdGltaXplZF9yb3V0ZXMnKVxyXG4gICAgICAudXBkYXRlKHtcclxuICAgICAgICBzaGlwbWVudHM6IHVwZGF0ZWRTaGlwbWVudHMsXHJcbiAgICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgIH0pXHJcbiAgICAgIC5lcSgnaWQnLCByb3V0ZV9pZClcclxuICAgICAgLmVxKCdkcml2ZXJfaWQnLCBkcml2ZXIuaWQpXHJcbiAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKHVwZGF0ZUVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGRlbGl2ZXJ5OicsIHVwZGF0ZUVycm9yKTtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgZXJyb3I6ICdFcnJvciBhY3R1YWxpemFuZG8gZW50cmVnYScgfSxcclxuICAgICAgICB7IHN0YXR1czogNTAwIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBWZXJpZmljYXIgc2kgdG9kYXMgbGFzIGVudHJlZ2FzIGVzdMOhbiBjb21wbGV0YWRhc1xyXG4gICAgY29uc3QgYWxsRGVsaXZlcmVkID0gdXBkYXRlZFNoaXBtZW50cy5ldmVyeShcclxuICAgICAgKHNoaXBtZW50OiBhbnkpID0+IHNoaXBtZW50LnN0YXR1cyA9PT0gJ2RlbGl2ZXJlZCdcclxuICAgICk7XHJcblxyXG4gICAgLy8gU2kgdG9kYXMgbGFzIGVudHJlZ2FzIGVzdMOhbiBjb21wbGV0YWRhcywgbWFyY2FyIGxhIHJ1dGEgY29tbyBjb21wbGV0YWRhXHJcbiAgICBpZiAoYWxsRGVsaXZlcmVkKSB7XHJcbiAgICAgIGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgLmZyb20oJ29wdGltaXplZF9yb3V0ZXMnKVxyXG4gICAgICAgIC51cGRhdGUoe1xyXG4gICAgICAgICAgc3RhdHVzOiAnY29tcGxldGVkJyxcclxuICAgICAgICAgIGNvbXBsZXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgICAgfSlcclxuICAgICAgICAuZXEoJ2lkJywgcm91dGVfaWQpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGRlbGl2ZXJ5X2lkLFxyXG4gICAgICBzdGF0dXMsXHJcbiAgICAgIHJvdXRlX2NvbXBsZXRlZDogYWxsRGVsaXZlcmVkLFxyXG4gICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgIH0pO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZHJpdmVyIGRlbGl2ZXJ5IHVwZGF0ZSBBUEk6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7IGVycm9yOiAnRXJyb3IgaW50ZXJubyBkZWwgc2Vydmlkb3InIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiJdLCJuYW1lcyI6WyJHRVQiLCJQT1NUIiwicnVudGltZSIsInJlcXVlc3QiLCJzZXNzaW9uIiwiYXV0aCIsInVzZXIiLCJlbWFpbCIsIk5leHRSZXNwb25zZSIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsInNlYXJjaFBhcmFtcyIsIlVSTCIsInVybCIsImdldCIsImRhdGUiLCJzdXBhYmFzZSIsImNyZWF0ZUNsaWVudCIsImRhdGEiLCJkcml2ZXIiLCJkcml2ZXJFcnJvciIsImZyb20iLCJzZWxlY3QiLCJlcSIsInNpbmdsZSIsInF1ZXJ5IiwiaWQiLCJndGUiLCJsdGUiLCJyb3V0ZXMiLCJyb3V0ZXNFcnJvciIsImNvbnNvbGUiLCJhbGxEZWxpdmVyaWVzIiwicm91dGUiLCJzaGlwbWVudHMiLCJBcnJheSIsImlzQXJyYXkiLCJpIiwibGVuZ3RoIiwic2hpcG1lbnQiLCJkZWxpdmVyeSIsInJvdXRlX2lkIiwicm91dGVfbmFtZSIsIm5hbWUiLCJ0cmFja2luZ19udW1iZXIiLCJzbGljZSIsImN1c3RvbWVyX25hbWUiLCJjdXN0b21lcl9waG9uZSIsImRlc3RpbmF0aW9uIiwiYWRkcmVzcyIsImNpdHkiLCJwb3N0YWxfY29kZSIsImNvb3JkaW5hdGVzIiwibm90ZXMiLCJpdGVtcyIsImVzdGltYXRlZF9kZWxpdmVyeV90aW1lIiwic3BlY2lhbF9pbnN0cnVjdGlvbnMiLCJyZXF1aXJlc19zaWduYXR1cmUiLCJjYXNoX29uX2RlbGl2ZXJ5IiwiZGVsaXZlcnlfbm90ZXMiLCJkZWxpdmVyZWRfYXQiLCJkZWxpdmVyZWRfYnkiLCJjcmVhdGVkX2F0IiwidXBkYXRlZF9hdCIsInB1c2giLCJzb3J0IiwiYSIsImIiLCJEYXRlIiwiZ2V0VGltZSIsInN0YXRzIiwidG90YWwiLCJwZW5kaW5nIiwiZmlsdGVyIiwiZCIsImNvbmZpcm1lZCIsImluX3RyYW5zaXQiLCJkZWxpdmVyZWQiLCJleGNlcHRpb24iLCJkZWxpdmVyaWVzIiwiZHJpdmVyX2lkIiwiYm9keSIsImRlbGl2ZXJ5X2lkIiwic2lnbmF0dXJlX2RhdGEiLCJwaG90b19ldmlkZW5jZSIsImxvY2F0aW9uIiwicm91dGVFcnJvciIsInVwZGF0ZWRTaGlwbWVudHMiLCJtYXAiLCJpbmRleE9mIiwidXBkYXRlZFNoaXBtZW50IiwidG9JU09TdHJpbmciLCJkZWxpdmVyeV9sb2NhdGlvbiIsInVwZGF0ZWRSb3V0ZSIsInVwZGF0ZUVycm9yIiwidXBkYXRlIiwiYWxsRGVsaXZlcmVkIiwiZXZlcnkiLCJjb21wbGV0ZWRfYXQiLCJzdWNjZXNzIiwicm91dGVfY29tcGxldGVkIl0sIm1hcHBpbmdzIjoi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