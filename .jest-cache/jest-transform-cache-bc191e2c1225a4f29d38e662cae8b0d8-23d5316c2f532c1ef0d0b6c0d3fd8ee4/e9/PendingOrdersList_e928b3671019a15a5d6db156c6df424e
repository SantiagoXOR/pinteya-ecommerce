aa4bda3a82d7d28c6f959e16e0c0de6a
/**
 * Componente para mostrar lista de órdenes pendientes de entrega
 */ 'use client';
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return PendingOrdersList;
    }
});
const _jsxruntime = require("react/jsx-runtime");
const _react = /*#__PURE__*/ _interop_require_wildcard(require("react"));
const _card = require("../ui/card");
const _button = require("../ui/button");
const _badge = require("../ui/badge");
const _lucidereact = require("lucide-react");
const _sonner = require("sonner");
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
function PendingOrdersList({ onStartRoute, onSelectOrder }) {
    const [orders, setOrders] = (0, _react.useState)([]);
    const [stats, setStats] = (0, _react.useState)(null);
    const [loading, setLoading] = (0, _react.useState)(true);
    const [selectedOrders, setSelectedOrders] = (0, _react.useState)(new Set());
    const [optimizing, setOptimizing] = (0, _react.useState)(false);
    (0, _react.useEffect)(()=>{
        fetchPendingOrders();
    }, []);
    const fetchPendingOrders = async ()=>{
        try {
            setLoading(true);
            const response = await fetch('/api/driver/pending-orders');
            if (!response.ok) {
                throw new Error('Error al cargar órdenes pendientes');
            }
            const result = await response.json();
            if (result.success) {
                setOrders(result.data.orders);
                setStats(result.data.stats);
                // Seleccionar todas las órdenes por defecto
                const allOrderIds = new Set(result.data.orders.map((order)=>order.id));
                setSelectedOrders(allOrderIds);
            } else {
                throw new Error(result.error || 'Error desconocido');
            }
        } catch (error) {
            console.error('Error fetching pending orders:', error);
            _sonner.toast.error('Error al cargar órdenes pendientes');
        } finally{
            setLoading(false);
        }
    };
    const toggleOrderSelection = (orderId)=>{
        const newSelection = new Set(selectedOrders);
        if (newSelection.has(orderId)) {
            newSelection.delete(orderId);
        } else {
            newSelection.add(orderId);
        }
        setSelectedOrders(newSelection);
    };
    const handleStartOptimizedRoute = async ()=>{
        const selectedOrdersList = orders.filter((order)=>selectedOrders.has(order.id));
        if (selectedOrdersList.length === 0) {
            _sonner.toast.error('Selecciona al menos una orden para iniciar la ruta');
            return;
        }
        setOptimizing(true);
        try {
            // Preparar datos para optimización
            const stops = selectedOrdersList.map((order)=>({
                    orderId: order.id,
                    address: order.shippingAddress.fullAddress,
                    priority: order.status === 'confirmed' ? 1 : 0
                }));
            const response = await fetch('/api/driver/optimize-route', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    stops
                })
            });
            if (!response.ok) {
                throw new Error('Error al optimizar la ruta');
            }
            const result = await response.json();
            if (result.success) {
                _sonner.toast.success(`Ruta optimizada: ${result.data.summary.totalStops} paradas, ${Math.round(result.data.summary.totalDistance)}km`);
                if (onStartRoute) {
                    onStartRoute(selectedOrdersList);
                }
            } else {
                throw new Error(result.error || 'Error en optimización');
            }
        } catch (error) {
            console.error('Error optimizing route:', error);
            _sonner.toast.error('Error al optimizar la ruta');
        } finally{
            setOptimizing(false);
        }
    };
    const formatCurrency = (amount)=>{
        return new Intl.NumberFormat('es-AR', {
            style: 'currency',
            currency: 'ARS'
        }).format(amount);
    };
    const formatDate = (dateString)=>{
        return new Date(dateString).toLocaleDateString('es-AR', {
            day: '2-digit',
            month: '2-digit',
            year: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
        });
    };
    if (loading) {
        return /*#__PURE__*/ (0, _jsxruntime.jsx)(_card.Card, {
            children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_card.CardContent, {
                className: "p-6",
                children: /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                    className: "flex items-center justify-center",
                    children: [
                        /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                            className: "animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"
                        }),
                        /*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                            className: "ml-2",
                            children: "Cargando \xf3rdenes..."
                        })
                    ]
                })
            })
        });
    }
    return /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
        className: "space-y-4",
        children: [
            stats && /*#__PURE__*/ (0, _jsxruntime.jsxs)(_card.Card, {
                children: [
                    /*#__PURE__*/ (0, _jsxruntime.jsx)(_card.CardHeader, {
                        children: /*#__PURE__*/ (0, _jsxruntime.jsxs)(_card.CardTitle, {
                            className: "flex items-center gap-2",
                            children: [
                                /*#__PURE__*/ (0, _jsxruntime.jsx)(_lucidereact.Package, {
                                    className: "h-5 w-5"
                                }),
                                "Resumen del D\xeda"
                            ]
                        })
                    }),
                    /*#__PURE__*/ (0, _jsxruntime.jsx)(_card.CardContent, {
                        children: /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                            className: "grid grid-cols-2 md:grid-cols-4 gap-4",
                            children: [
                                /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                    className: "text-center",
                                    children: [
                                        /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                            className: "text-2xl font-bold text-blue-600",
                                            children: stats.totalOrders
                                        }),
                                        /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                            className: "text-sm text-gray-600",
                                            children: "\xd3rdenes"
                                        })
                                    ]
                                }),
                                /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                    className: "text-center",
                                    children: [
                                        /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                            className: "text-2xl font-bold text-green-600",
                                            children: formatCurrency(stats.totalValue)
                                        }),
                                        /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                            className: "text-sm text-gray-600",
                                            children: "Valor Total"
                                        })
                                    ]
                                }),
                                /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                    className: "text-center",
                                    children: [
                                        /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                            className: "text-2xl font-bold text-orange-600",
                                            children: stats.totalItems
                                        }),
                                        /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                            className: "text-sm text-gray-600",
                                            children: "Productos"
                                        })
                                    ]
                                }),
                                /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                    className: "text-center",
                                    children: [
                                        /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                            className: "text-2xl font-bold text-purple-600",
                                            children: [
                                                Math.round(stats.totalWeight),
                                                "kg"
                                            ]
                                        }),
                                        /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                            className: "text-sm text-gray-600",
                                            children: "Peso Total"
                                        })
                                    ]
                                })
                            ]
                        })
                    })
                ]
            }),
            /*#__PURE__*/ (0, _jsxruntime.jsx)(_card.Card, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_card.CardContent, {
                    className: "p-4",
                    children: /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                        className: "flex items-center justify-between",
                        children: [
                            /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                className: "flex items-center gap-2",
                                children: [
                                    /*#__PURE__*/ (0, _jsxruntime.jsx)(_lucidereact.Navigation, {
                                        className: "h-5 w-5"
                                    }),
                                    /*#__PURE__*/ (0, _jsxruntime.jsxs)("span", {
                                        className: "font-medium",
                                        children: [
                                            selectedOrders.size,
                                            " de ",
                                            orders.length,
                                            " \xf3rdenes seleccionadas"
                                        ]
                                    })
                                ]
                            }),
                            /*#__PURE__*/ (0, _jsxruntime.jsx)(_button.Button, {
                                onClick: handleStartOptimizedRoute,
                                disabled: selectedOrders.size === 0 || optimizing,
                                className: "flex items-center gap-2",
                                children: optimizing ? /*#__PURE__*/ (0, _jsxruntime.jsxs)(_jsxruntime.Fragment, {
                                    children: [
                                        /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                            className: "animate-spin rounded-full h-4 w-4 border-b-2 border-white"
                                        }),
                                        "Optimizando..."
                                    ]
                                }) : /*#__PURE__*/ (0, _jsxruntime.jsxs)(_jsxruntime.Fragment, {
                                    children: [
                                        /*#__PURE__*/ (0, _jsxruntime.jsx)(_lucidereact.Navigation, {
                                            className: "h-4 w-4"
                                        }),
                                        "Iniciar Recorrido"
                                    ]
                                })
                            })
                        ]
                    })
                })
            }),
            /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                className: "space-y-3",
                children: orders.length === 0 ? /*#__PURE__*/ (0, _jsxruntime.jsx)(_card.Card, {
                    children: /*#__PURE__*/ (0, _jsxruntime.jsxs)(_card.CardContent, {
                        className: "p-6 text-center",
                        children: [
                            /*#__PURE__*/ (0, _jsxruntime.jsx)(_lucidereact.CheckCircle, {
                                className: "h-12 w-12 text-green-500 mx-auto mb-4"
                            }),
                            /*#__PURE__*/ (0, _jsxruntime.jsx)("h3", {
                                className: "text-lg font-semibold mb-2",
                                children: "\xa1No hay entregas pendientes!"
                            }),
                            /*#__PURE__*/ (0, _jsxruntime.jsx)("p", {
                                className: "text-gray-600",
                                children: "Todas las \xf3rdenes del d\xeda han sido completadas."
                            })
                        ]
                    })
                }) : orders.map((order)=>/*#__PURE__*/ (0, _jsxruntime.jsx)(_card.Card, {
                        className: `cursor-pointer transition-all ${selectedOrders.has(order.id) ? 'ring-2 ring-blue-500 bg-blue-50' : 'hover:shadow-md'}`,
                        onClick: ()=>toggleOrderSelection(order.id),
                        children: /*#__PURE__*/ (0, _jsxruntime.jsxs)(_card.CardContent, {
                            className: "p-4",
                            children: [
                                /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                    className: "flex items-start justify-between mb-3",
                                    children: [
                                        /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                            className: "flex items-center gap-2",
                                            children: [
                                                /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                                    className: `w-4 h-4 rounded border-2 flex items-center justify-center ${selectedOrders.has(order.id) ? 'bg-blue-500 border-blue-500' : 'border-gray-300'}`,
                                                    children: selectedOrders.has(order.id) && /*#__PURE__*/ (0, _jsxruntime.jsx)(_lucidereact.CheckCircle, {
                                                        className: "h-3 w-3 text-white"
                                                    })
                                                }),
                                                /*#__PURE__*/ (0, _jsxruntime.jsx)("h3", {
                                                    className: "font-semibold",
                                                    children: order.orderNumber
                                                }),
                                                /*#__PURE__*/ (0, _jsxruntime.jsx)(_badge.Badge, {
                                                    variant: order.status === 'paid' ? 'default' : 'secondary',
                                                    children: order.status === 'paid' ? 'Pagado' : 'Confirmado'
                                                })
                                            ]
                                        }),
                                        /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                            className: "text-right",
                                            children: [
                                                /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                                    className: "font-bold text-green-600",
                                                    children: formatCurrency(order.total)
                                                }),
                                                /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                                    className: "text-sm text-gray-500",
                                                    children: [
                                                        order.totalItems,
                                                        " productos"
                                                    ]
                                                })
                                            ]
                                        })
                                    ]
                                }),
                                /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                    className: "space-y-2",
                                    children: [
                                        /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                            className: "flex items-start gap-2",
                                            children: [
                                                /*#__PURE__*/ (0, _jsxruntime.jsx)(_lucidereact.MapPin, {
                                                    className: "h-4 w-4 text-gray-500 mt-0.5 flex-shrink-0"
                                                }),
                                                /*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                                                    className: "text-sm",
                                                    children: order.shippingAddress.fullAddress
                                                })
                                            ]
                                        }),
                                        /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                            className: "flex items-center gap-2",
                                            children: [
                                                /*#__PURE__*/ (0, _jsxruntime.jsx)(_lucidereact.Clock, {
                                                    className: "h-4 w-4 text-gray-500"
                                                }),
                                                /*#__PURE__*/ (0, _jsxruntime.jsxs)("span", {
                                                    className: "text-sm",
                                                    children: [
                                                        "Creado: ",
                                                        formatDate(order.createdAt)
                                                    ]
                                                })
                                            ]
                                        }),
                                        /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                            className: "flex items-center gap-4 text-sm text-gray-600",
                                            children: [
                                                /*#__PURE__*/ (0, _jsxruntime.jsxs)("span", {
                                                    children: [
                                                        order.totalWeight,
                                                        "kg"
                                                    ]
                                                }),
                                                /*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                                                    children: "•"
                                                }),
                                                /*#__PURE__*/ (0, _jsxruntime.jsxs)("span", {
                                                    children: [
                                                        order.items.length,
                                                        " tipos de productos"
                                                    ]
                                                })
                                            ]
                                        })
                                    ]
                                }),
                                order.notes && /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                    className: "mt-3 p-2 bg-yellow-50 rounded border-l-4 border-yellow-400",
                                    children: /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                        className: "flex items-start gap-2",
                                        children: [
                                            /*#__PURE__*/ (0, _jsxruntime.jsx)(_lucidereact.AlertCircle, {
                                                className: "h-4 w-4 text-yellow-600 mt-0.5"
                                            }),
                                            /*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                                                className: "text-sm text-yellow-800",
                                                children: order.notes
                                            })
                                        ]
                                    })
                                })
                            ]
                        })
                    }, order.id))
            })
        ]
    });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcY29tcG9uZW50c1xcZHJpdmVyXFxQZW5kaW5nT3JkZXJzTGlzdC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb21wb25lbnRlIHBhcmEgbW9zdHJhciBsaXN0YSBkZSDDs3JkZW5lcyBwZW5kaWVudGVzIGRlIGVudHJlZ2FcbiAqL1xuXG4ndXNlIGNsaWVudCdcblxuaW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCdcbmltcG9ydCB7IENhcmQsIENhcmRDb250ZW50LCBDYXJkSGVhZGVyLCBDYXJkVGl0bGUgfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvY2FyZCdcbmltcG9ydCB7IEJ1dHRvbiB9IGZyb20gJ0AvY29tcG9uZW50cy91aS9idXR0b24nXG5pbXBvcnQgeyBCYWRnZSB9IGZyb20gJ0AvY29tcG9uZW50cy91aS9iYWRnZSdcbmltcG9ydCB7XG4gIFBhY2thZ2UsXG4gIE1hcFBpbixcbiAgQ2xvY2ssXG4gIERvbGxhclNpZ24sXG4gIE5hdmlnYXRpb24sXG4gIENoZWNrQ2lyY2xlLFxuICBBbGVydENpcmNsZSxcbiAgVHJ1Y2ssXG4gIFJvdXRlLFxufSBmcm9tICdsdWNpZGUtcmVhY3QnXG5pbXBvcnQgeyB0b2FzdCB9IGZyb20gJ3Nvbm5lcidcblxuaW50ZXJmYWNlIE9yZGVySXRlbSB7XG4gIGlkOiBudW1iZXJcbiAgcHJvZHVjdE5hbWU6IHN0cmluZ1xuICBxdWFudGl0eTogbnVtYmVyXG4gIHByaWNlOiBudW1iZXJcbiAgd2VpZ2h0OiBudW1iZXJcbn1cblxuaW50ZXJmYWNlIFNoaXBwaW5nQWRkcmVzcyB7XG4gIHN0cmVldE5hbWU6IHN0cmluZ1xuICBzdHJlZXROdW1iZXI6IHN0cmluZ1xuICBmbG9vcj86IHN0cmluZ1xuICBhcGFydG1lbnQ/OiBzdHJpbmdcbiAgY2l0eU5hbWU6IHN0cmluZ1xuICBzdGF0ZU5hbWU6IHN0cmluZ1xuICB6aXBDb2RlOiBzdHJpbmdcbiAgZnVsbEFkZHJlc3M6IHN0cmluZ1xufVxuXG5pbnRlcmZhY2UgUGVuZGluZ09yZGVyIHtcbiAgaWQ6IG51bWJlclxuICBvcmRlck51bWJlcjogc3RyaW5nXG4gIHRvdGFsOiBudW1iZXJcbiAgc3RhdHVzOiBzdHJpbmdcbiAgcGF5bWVudFN0YXR1czogc3RyaW5nXG4gIGZ1bGZpbGxtZW50U3RhdHVzOiBzdHJpbmdcbiAgY3JlYXRlZEF0OiBzdHJpbmdcbiAgZXN0aW1hdGVkRGVsaXZlcnk/OiBzdHJpbmdcbiAgc2hpcHBpbmdBZGRyZXNzOiBTaGlwcGluZ0FkZHJlc3NcbiAgaXRlbXM6IE9yZGVySXRlbVtdXG4gIHRvdGFsSXRlbXM6IG51bWJlclxuICB0b3RhbFdlaWdodDogbnVtYmVyXG4gIG5vdGVzPzogc3RyaW5nXG59XG5cbmludGVyZmFjZSBQZW5kaW5nT3JkZXJzRGF0YSB7XG4gIG9yZGVyczogUGVuZGluZ09yZGVyW11cbiAgc3RhdHM6IHtcbiAgICB0b3RhbE9yZGVyczogbnVtYmVyXG4gICAgdG90YWxWYWx1ZTogbnVtYmVyXG4gICAgdG90YWxJdGVtczogbnVtYmVyXG4gICAgdG90YWxXZWlnaHQ6IG51bWJlclxuICAgIGF2ZXJhZ2VPcmRlclZhbHVlOiBudW1iZXJcbiAgfVxuICBkcml2ZXI6IHtcbiAgICBpZDogc3RyaW5nXG4gICAgbmFtZTogc3RyaW5nXG4gICAgc3RhdHVzOiBzdHJpbmdcbiAgfVxufVxuXG5pbnRlcmZhY2UgUGVuZGluZ09yZGVyc0xpc3RQcm9wcyB7XG4gIG9uU3RhcnRSb3V0ZT86IChvcmRlcnM6IFBlbmRpbmdPcmRlcltdKSA9PiB2b2lkXG4gIG9uU2VsZWN0T3JkZXI/OiAob3JkZXI6IFBlbmRpbmdPcmRlcikgPT4gdm9pZFxufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBQZW5kaW5nT3JkZXJzTGlzdCh7IG9uU3RhcnRSb3V0ZSwgb25TZWxlY3RPcmRlciB9OiBQZW5kaW5nT3JkZXJzTGlzdFByb3BzKSB7XG4gIGNvbnN0IFtvcmRlcnMsIHNldE9yZGVyc10gPSB1c2VTdGF0ZTxQZW5kaW5nT3JkZXJbXT4oW10pXG4gIGNvbnN0IFtzdGF0cywgc2V0U3RhdHNdID0gdXNlU3RhdGU8UGVuZGluZ09yZGVyc0RhdGFbJ3N0YXRzJ10gfCBudWxsPihudWxsKVxuICBjb25zdCBbbG9hZGluZywgc2V0TG9hZGluZ10gPSB1c2VTdGF0ZSh0cnVlKVxuICBjb25zdCBbc2VsZWN0ZWRPcmRlcnMsIHNldFNlbGVjdGVkT3JkZXJzXSA9IHVzZVN0YXRlPFNldDxudW1iZXI+PihuZXcgU2V0KCkpXG4gIGNvbnN0IFtvcHRpbWl6aW5nLCBzZXRPcHRpbWl6aW5nXSA9IHVzZVN0YXRlKGZhbHNlKVxuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgZmV0Y2hQZW5kaW5nT3JkZXJzKClcbiAgfSwgW10pXG5cbiAgY29uc3QgZmV0Y2hQZW5kaW5nT3JkZXJzID0gYXN5bmMgKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBzZXRMb2FkaW5nKHRydWUpXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCcvYXBpL2RyaXZlci9wZW5kaW5nLW9yZGVycycpXG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdFcnJvciBhbCBjYXJnYXIgw7NyZGVuZXMgcGVuZGllbnRlcycpXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuXG4gICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgc2V0T3JkZXJzKHJlc3VsdC5kYXRhLm9yZGVycylcbiAgICAgICAgc2V0U3RhdHMocmVzdWx0LmRhdGEuc3RhdHMpXG5cbiAgICAgICAgLy8gU2VsZWNjaW9uYXIgdG9kYXMgbGFzIMOzcmRlbmVzIHBvciBkZWZlY3RvXG4gICAgICAgIGNvbnN0IGFsbE9yZGVySWRzID0gbmV3IFNldChyZXN1bHQuZGF0YS5vcmRlcnMubWFwKChvcmRlcjogUGVuZGluZ09yZGVyKSA9PiBvcmRlci5pZCkpXG4gICAgICAgIHNldFNlbGVjdGVkT3JkZXJzKGFsbE9yZGVySWRzKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKHJlc3VsdC5lcnJvciB8fCAnRXJyb3IgZGVzY29ub2NpZG8nKVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBwZW5kaW5nIG9yZGVyczonLCBlcnJvcilcbiAgICAgIHRvYXN0LmVycm9yKCdFcnJvciBhbCBjYXJnYXIgw7NyZGVuZXMgcGVuZGllbnRlcycpXG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldExvYWRpbmcoZmFsc2UpXG4gICAgfVxuICB9XG5cbiAgY29uc3QgdG9nZ2xlT3JkZXJTZWxlY3Rpb24gPSAob3JkZXJJZDogbnVtYmVyKSA9PiB7XG4gICAgY29uc3QgbmV3U2VsZWN0aW9uID0gbmV3IFNldChzZWxlY3RlZE9yZGVycylcbiAgICBpZiAobmV3U2VsZWN0aW9uLmhhcyhvcmRlcklkKSkge1xuICAgICAgbmV3U2VsZWN0aW9uLmRlbGV0ZShvcmRlcklkKVxuICAgIH0gZWxzZSB7XG4gICAgICBuZXdTZWxlY3Rpb24uYWRkKG9yZGVySWQpXG4gICAgfVxuICAgIHNldFNlbGVjdGVkT3JkZXJzKG5ld1NlbGVjdGlvbilcbiAgfVxuXG4gIGNvbnN0IGhhbmRsZVN0YXJ0T3B0aW1pemVkUm91dGUgPSBhc3luYyAoKSA9PiB7XG4gICAgY29uc3Qgc2VsZWN0ZWRPcmRlcnNMaXN0ID0gb3JkZXJzLmZpbHRlcihvcmRlciA9PiBzZWxlY3RlZE9yZGVycy5oYXMob3JkZXIuaWQpKVxuXG4gICAgaWYgKHNlbGVjdGVkT3JkZXJzTGlzdC5sZW5ndGggPT09IDApIHtcbiAgICAgIHRvYXN0LmVycm9yKCdTZWxlY2Npb25hIGFsIG1lbm9zIHVuYSBvcmRlbiBwYXJhIGluaWNpYXIgbGEgcnV0YScpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBzZXRPcHRpbWl6aW5nKHRydWUpXG5cbiAgICB0cnkge1xuICAgICAgLy8gUHJlcGFyYXIgZGF0b3MgcGFyYSBvcHRpbWl6YWNpw7NuXG4gICAgICBjb25zdCBzdG9wcyA9IHNlbGVjdGVkT3JkZXJzTGlzdC5tYXAob3JkZXIgPT4gKHtcbiAgICAgICAgb3JkZXJJZDogb3JkZXIuaWQsXG4gICAgICAgIGFkZHJlc3M6IG9yZGVyLnNoaXBwaW5nQWRkcmVzcy5mdWxsQWRkcmVzcyxcbiAgICAgICAgcHJpb3JpdHk6IG9yZGVyLnN0YXR1cyA9PT0gJ2NvbmZpcm1lZCcgPyAxIDogMCxcbiAgICAgIH0pKVxuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCcvYXBpL2RyaXZlci9vcHRpbWl6ZS1yb3V0ZScsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IHN0b3BzIH0pLFxuICAgICAgfSlcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Vycm9yIGFsIG9wdGltaXphciBsYSBydXRhJylcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXG5cbiAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICB0b2FzdC5zdWNjZXNzKFxuICAgICAgICAgIGBSdXRhIG9wdGltaXphZGE6ICR7cmVzdWx0LmRhdGEuc3VtbWFyeS50b3RhbFN0b3BzfSBwYXJhZGFzLCAke01hdGgucm91bmQocmVzdWx0LmRhdGEuc3VtbWFyeS50b3RhbERpc3RhbmNlKX1rbWBcbiAgICAgICAgKVxuXG4gICAgICAgIGlmIChvblN0YXJ0Um91dGUpIHtcbiAgICAgICAgICBvblN0YXJ0Um91dGUoc2VsZWN0ZWRPcmRlcnNMaXN0KVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IocmVzdWx0LmVycm9yIHx8ICdFcnJvciBlbiBvcHRpbWl6YWNpw7NuJylcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igb3B0aW1pemluZyByb3V0ZTonLCBlcnJvcilcbiAgICAgIHRvYXN0LmVycm9yKCdFcnJvciBhbCBvcHRpbWl6YXIgbGEgcnV0YScpXG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldE9wdGltaXppbmcoZmFsc2UpXG4gICAgfVxuICB9XG5cbiAgY29uc3QgZm9ybWF0Q3VycmVuY3kgPSAoYW1vdW50OiBudW1iZXIpID0+IHtcbiAgICByZXR1cm4gbmV3IEludGwuTnVtYmVyRm9ybWF0KCdlcy1BUicsIHtcbiAgICAgIHN0eWxlOiAnY3VycmVuY3knLFxuICAgICAgY3VycmVuY3k6ICdBUlMnLFxuICAgIH0pLmZvcm1hdChhbW91bnQpXG4gIH1cblxuICBjb25zdCBmb3JtYXREYXRlID0gKGRhdGVTdHJpbmc6IHN0cmluZykgPT4ge1xuICAgIHJldHVybiBuZXcgRGF0ZShkYXRlU3RyaW5nKS50b0xvY2FsZURhdGVTdHJpbmcoJ2VzLUFSJywge1xuICAgICAgZGF5OiAnMi1kaWdpdCcsXG4gICAgICBtb250aDogJzItZGlnaXQnLFxuICAgICAgeWVhcjogJ251bWVyaWMnLFxuICAgICAgaG91cjogJzItZGlnaXQnLFxuICAgICAgbWludXRlOiAnMi1kaWdpdCcsXG4gICAgfSlcbiAgfVxuXG4gIGlmIChsb2FkaW5nKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxDYXJkPlxuICAgICAgICA8Q2FyZENvbnRlbnQgY2xhc3NOYW1lPSdwLTYnPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlcic+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nYW5pbWF0ZS1zcGluIHJvdW5kZWQtZnVsbCBoLTggdy04IGJvcmRlci1iLTIgYm9yZGVyLWJsdWUtNjAwJz48L2Rpdj5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT0nbWwtMic+Q2FyZ2FuZG8gw7NyZGVuZXMuLi48L3NwYW4+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvQ2FyZENvbnRlbnQ+XG4gICAgICA8L0NhcmQ+XG4gICAgKVxuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT0nc3BhY2UteS00Jz5cbiAgICAgIHsvKiBFc3RhZMOtc3RpY2FzIGRlbCBkw61hICovfVxuICAgICAge3N0YXRzICYmIChcbiAgICAgICAgPENhcmQ+XG4gICAgICAgICAgPENhcmRIZWFkZXI+XG4gICAgICAgICAgICA8Q2FyZFRpdGxlIGNsYXNzTmFtZT0nZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTInPlxuICAgICAgICAgICAgICA8UGFja2FnZSBjbGFzc05hbWU9J2gtNSB3LTUnIC8+XG4gICAgICAgICAgICAgIFJlc3VtZW4gZGVsIETDrWFcbiAgICAgICAgICAgIDwvQ2FyZFRpdGxlPlxuICAgICAgICAgIDwvQ2FyZEhlYWRlcj5cbiAgICAgICAgICA8Q2FyZENvbnRlbnQ+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZ3JpZCBncmlkLWNvbHMtMiBtZDpncmlkLWNvbHMtNCBnYXAtNCc+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSd0ZXh0LWNlbnRlcic+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3RleHQtMnhsIGZvbnQtYm9sZCB0ZXh0LWJsdWUtNjAwJz57c3RhdHMudG90YWxPcmRlcnN9PC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3RleHQtc20gdGV4dC1ncmF5LTYwMCc+w5NyZGVuZXM8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSd0ZXh0LWNlbnRlcic+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3RleHQtMnhsIGZvbnQtYm9sZCB0ZXh0LWdyZWVuLTYwMCc+XG4gICAgICAgICAgICAgICAgICB7Zm9ybWF0Q3VycmVuY3koc3RhdHMudG90YWxWYWx1ZSl9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3RleHQtc20gdGV4dC1ncmF5LTYwMCc+VmFsb3IgVG90YWw8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSd0ZXh0LWNlbnRlcic+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3RleHQtMnhsIGZvbnQtYm9sZCB0ZXh0LW9yYW5nZS02MDAnPntzdGF0cy50b3RhbEl0ZW1zfTwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSd0ZXh0LXNtIHRleHQtZ3JheS02MDAnPlByb2R1Y3RvczwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3RleHQtY2VudGVyJz5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ndGV4dC0yeGwgZm9udC1ib2xkIHRleHQtcHVycGxlLTYwMCc+XG4gICAgICAgICAgICAgICAgICB7TWF0aC5yb3VuZChzdGF0cy50b3RhbFdlaWdodCl9a2dcbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ndGV4dC1zbSB0ZXh0LWdyYXktNjAwJz5QZXNvIFRvdGFsPC9kaXY+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9DYXJkQ29udGVudD5cbiAgICAgICAgPC9DYXJkPlxuICAgICAgKX1cblxuICAgICAgey8qIENvbnRyb2xlcyBkZSBydXRhICovfVxuICAgICAgPENhcmQ+XG4gICAgICAgIDxDYXJkQ29udGVudCBjbGFzc05hbWU9J3AtNCc+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2ZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2Vlbic+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTInPlxuICAgICAgICAgICAgICA8TmF2aWdhdGlvbiBjbGFzc05hbWU9J2gtNSB3LTUnIC8+XG4gICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT0nZm9udC1tZWRpdW0nPlxuICAgICAgICAgICAgICAgIHtzZWxlY3RlZE9yZGVycy5zaXplfSBkZSB7b3JkZXJzLmxlbmd0aH0gw7NyZGVuZXMgc2VsZWNjaW9uYWRhc1xuICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlU3RhcnRPcHRpbWl6ZWRSb3V0ZX1cbiAgICAgICAgICAgICAgZGlzYWJsZWQ9e3NlbGVjdGVkT3JkZXJzLnNpemUgPT09IDAgfHwgb3B0aW1pemluZ31cbiAgICAgICAgICAgICAgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMidcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAge29wdGltaXppbmcgPyAoXG4gICAgICAgICAgICAgICAgPD5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdhbmltYXRlLXNwaW4gcm91bmRlZC1mdWxsIGgtNCB3LTQgYm9yZGVyLWItMiBib3JkZXItd2hpdGUnPjwvZGl2PlxuICAgICAgICAgICAgICAgICAgT3B0aW1pemFuZG8uLi5cbiAgICAgICAgICAgICAgICA8Lz5cbiAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICA8PlxuICAgICAgICAgICAgICAgICAgPE5hdmlnYXRpb24gY2xhc3NOYW1lPSdoLTQgdy00JyAvPlxuICAgICAgICAgICAgICAgICAgSW5pY2lhciBSZWNvcnJpZG9cbiAgICAgICAgICAgICAgICA8Lz5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L0NhcmRDb250ZW50PlxuICAgICAgPC9DYXJkPlxuXG4gICAgICB7LyogTGlzdGEgZGUgw7NyZGVuZXMgKi99XG4gICAgICA8ZGl2IGNsYXNzTmFtZT0nc3BhY2UteS0zJz5cbiAgICAgICAge29yZGVycy5sZW5ndGggPT09IDAgPyAoXG4gICAgICAgICAgPENhcmQ+XG4gICAgICAgICAgICA8Q2FyZENvbnRlbnQgY2xhc3NOYW1lPSdwLTYgdGV4dC1jZW50ZXInPlxuICAgICAgICAgICAgICA8Q2hlY2tDaXJjbGUgY2xhc3NOYW1lPSdoLTEyIHctMTIgdGV4dC1ncmVlbi01MDAgbXgtYXV0byBtYi00JyAvPlxuICAgICAgICAgICAgICA8aDMgY2xhc3NOYW1lPSd0ZXh0LWxnIGZvbnQtc2VtaWJvbGQgbWItMic+wqFObyBoYXkgZW50cmVnYXMgcGVuZGllbnRlcyE8L2gzPlxuICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9J3RleHQtZ3JheS02MDAnPlRvZGFzIGxhcyDDs3JkZW5lcyBkZWwgZMOtYSBoYW4gc2lkbyBjb21wbGV0YWRhcy48L3A+XG4gICAgICAgICAgICA8L0NhcmRDb250ZW50PlxuICAgICAgICAgIDwvQ2FyZD5cbiAgICAgICAgKSA6IChcbiAgICAgICAgICBvcmRlcnMubWFwKG9yZGVyID0+IChcbiAgICAgICAgICAgIDxDYXJkXG4gICAgICAgICAgICAgIGtleT17b3JkZXIuaWR9XG4gICAgICAgICAgICAgIGNsYXNzTmFtZT17YGN1cnNvci1wb2ludGVyIHRyYW5zaXRpb24tYWxsICR7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRPcmRlcnMuaGFzKG9yZGVyLmlkKSA/ICdyaW5nLTIgcmluZy1ibHVlLTUwMCBiZy1ibHVlLTUwJyA6ICdob3ZlcjpzaGFkb3ctbWQnXG4gICAgICAgICAgICAgIH1gfVxuICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB0b2dnbGVPcmRlclNlbGVjdGlvbihvcmRlci5pZCl9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIDxDYXJkQ29udGVudCBjbGFzc05hbWU9J3AtNCc+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2ZsZXggaXRlbXMtc3RhcnQganVzdGlmeS1iZXR3ZWVuIG1iLTMnPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2ZsZXggaXRlbXMtY2VudGVyIGdhcC0yJz5cbiAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17YHctNCBoLTQgcm91bmRlZCBib3JkZXItMiBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciAke1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRPcmRlcnMuaGFzKG9yZGVyLmlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICA/ICdiZy1ibHVlLTUwMCBib3JkZXItYmx1ZS01MDAnXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDogJ2JvcmRlci1ncmF5LTMwMCdcbiAgICAgICAgICAgICAgICAgICAgICB9YH1cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgIHtzZWxlY3RlZE9yZGVycy5oYXMob3JkZXIuaWQpICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxDaGVja0NpcmNsZSBjbGFzc05hbWU9J2gtMyB3LTMgdGV4dC13aGl0ZScgLz5cbiAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPGgzIGNsYXNzTmFtZT0nZm9udC1zZW1pYm9sZCc+e29yZGVyLm9yZGVyTnVtYmVyfTwvaDM+XG4gICAgICAgICAgICAgICAgICAgIDxCYWRnZSB2YXJpYW50PXtvcmRlci5zdGF0dXMgPT09ICdwYWlkJyA/ICdkZWZhdWx0JyA6ICdzZWNvbmRhcnknfT5cbiAgICAgICAgICAgICAgICAgICAgICB7b3JkZXIuc3RhdHVzID09PSAncGFpZCcgPyAnUGFnYWRvJyA6ICdDb25maXJtYWRvJ31cbiAgICAgICAgICAgICAgICAgICAgPC9CYWRnZT5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3RleHQtcmlnaHQnPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZm9udC1ib2xkIHRleHQtZ3JlZW4tNjAwJz57Zm9ybWF0Q3VycmVuY3kob3JkZXIudG90YWwpfTwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ndGV4dC1zbSB0ZXh0LWdyYXktNTAwJz57b3JkZXIudG90YWxJdGVtc30gcHJvZHVjdG9zPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdzcGFjZS15LTInPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2ZsZXggaXRlbXMtc3RhcnQgZ2FwLTInPlxuICAgICAgICAgICAgICAgICAgICA8TWFwUGluIGNsYXNzTmFtZT0naC00IHctNCB0ZXh0LWdyYXktNTAwIG10LTAuNSBmbGV4LXNocmluay0wJyAvPlxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9J3RleHQtc20nPntvcmRlci5zaGlwcGluZ0FkZHJlc3MuZnVsbEFkZHJlc3N9PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMic+XG4gICAgICAgICAgICAgICAgICAgIDxDbG9jayBjbGFzc05hbWU9J2gtNCB3LTQgdGV4dC1ncmF5LTUwMCcgLz5cbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSd0ZXh0LXNtJz5DcmVhZG86IHtmb3JtYXREYXRlKG9yZGVyLmNyZWF0ZWRBdCl9PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBnYXAtNCB0ZXh0LXNtIHRleHQtZ3JheS02MDAnPlxuICAgICAgICAgICAgICAgICAgICA8c3Bhbj57b3JkZXIudG90YWxXZWlnaHR9a2c8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuPuKAojwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgPHNwYW4+e29yZGVyLml0ZW1zLmxlbmd0aH0gdGlwb3MgZGUgcHJvZHVjdG9zPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICB7b3JkZXIubm90ZXMgJiYgKFxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J210LTMgcC0yIGJnLXllbGxvdy01MCByb3VuZGVkIGJvcmRlci1sLTQgYm9yZGVyLXllbGxvdy00MDAnPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZmxleCBpdGVtcy1zdGFydCBnYXAtMic+XG4gICAgICAgICAgICAgICAgICAgICAgPEFsZXJ0Q2lyY2xlIGNsYXNzTmFtZT0naC00IHctNCB0ZXh0LXllbGxvdy02MDAgbXQtMC41JyAvPlxuICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT0ndGV4dC1zbSB0ZXh0LXllbGxvdy04MDAnPntvcmRlci5ub3Rlc308L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgPC9DYXJkQ29udGVudD5cbiAgICAgICAgICAgIDwvQ2FyZD5cbiAgICAgICAgICApKVxuICAgICAgICApfVxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIClcbn1cbiJdLCJuYW1lcyI6WyJQZW5kaW5nT3JkZXJzTGlzdCIsIm9uU3RhcnRSb3V0ZSIsIm9uU2VsZWN0T3JkZXIiLCJvcmRlcnMiLCJzZXRPcmRlcnMiLCJ1c2VTdGF0ZSIsInN0YXRzIiwic2V0U3RhdHMiLCJsb2FkaW5nIiwic2V0TG9hZGluZyIsInNlbGVjdGVkT3JkZXJzIiwic2V0U2VsZWN0ZWRPcmRlcnMiLCJTZXQiLCJvcHRpbWl6aW5nIiwic2V0T3B0aW1pemluZyIsInVzZUVmZmVjdCIsImZldGNoUGVuZGluZ09yZGVycyIsInJlc3BvbnNlIiwiZmV0Y2giLCJvayIsIkVycm9yIiwicmVzdWx0IiwianNvbiIsInN1Y2Nlc3MiLCJkYXRhIiwiYWxsT3JkZXJJZHMiLCJtYXAiLCJvcmRlciIsImlkIiwiZXJyb3IiLCJjb25zb2xlIiwidG9hc3QiLCJ0b2dnbGVPcmRlclNlbGVjdGlvbiIsIm9yZGVySWQiLCJuZXdTZWxlY3Rpb24iLCJoYXMiLCJkZWxldGUiLCJhZGQiLCJoYW5kbGVTdGFydE9wdGltaXplZFJvdXRlIiwic2VsZWN0ZWRPcmRlcnNMaXN0IiwiZmlsdGVyIiwibGVuZ3RoIiwic3RvcHMiLCJhZGRyZXNzIiwic2hpcHBpbmdBZGRyZXNzIiwiZnVsbEFkZHJlc3MiLCJwcmlvcml0eSIsInN0YXR1cyIsIm1ldGhvZCIsImhlYWRlcnMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInN1bW1hcnkiLCJ0b3RhbFN0b3BzIiwiTWF0aCIsInJvdW5kIiwidG90YWxEaXN0YW5jZSIsImZvcm1hdEN1cnJlbmN5IiwiYW1vdW50IiwiSW50bCIsIk51bWJlckZvcm1hdCIsInN0eWxlIiwiY3VycmVuY3kiLCJmb3JtYXQiLCJmb3JtYXREYXRlIiwiZGF0ZVN0cmluZyIsIkRhdGUiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJkYXkiLCJtb250aCIsInllYXIiLCJob3VyIiwibWludXRlIiwiQ2FyZCIsIkNhcmRDb250ZW50IiwiY2xhc3NOYW1lIiwiZGl2Iiwic3BhbiIsIkNhcmRIZWFkZXIiLCJDYXJkVGl0bGUiLCJQYWNrYWdlIiwidG90YWxPcmRlcnMiLCJ0b3RhbFZhbHVlIiwidG90YWxJdGVtcyIsInRvdGFsV2VpZ2h0IiwiTmF2aWdhdGlvbiIsInNpemUiLCJCdXR0b24iLCJvbkNsaWNrIiwiZGlzYWJsZWQiLCJDaGVja0NpcmNsZSIsImgzIiwicCIsIm9yZGVyTnVtYmVyIiwiQmFkZ2UiLCJ2YXJpYW50IiwidG90YWwiLCJNYXBQaW4iLCJDbG9jayIsImNyZWF0ZWRBdCIsIml0ZW1zIiwibm90ZXMiLCJBbGVydENpcmNsZSJdLCJtYXBwaW5ncyI6IkFBQUE7O0NBRUMsR0FFRDs7Ozs7K0JBMkVBOzs7ZUFBd0JBOzs7OytEQXpFbUI7c0JBQ2M7d0JBQ2xDO3VCQUNEOzZCQVdmO3dCQUNlOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUEwRFAsU0FBU0Esa0JBQWtCLEVBQUVDLFlBQVksRUFBRUMsYUFBYSxFQUEwQjtJQUMvRixNQUFNLENBQUNDLFFBQVFDLFVBQVUsR0FBR0MsSUFBQUEsZUFBUSxFQUFpQixFQUFFO0lBQ3ZELE1BQU0sQ0FBQ0MsT0FBT0MsU0FBUyxHQUFHRixJQUFBQSxlQUFRLEVBQW9DO0lBQ3RFLE1BQU0sQ0FBQ0csU0FBU0MsV0FBVyxHQUFHSixJQUFBQSxlQUFRLEVBQUM7SUFDdkMsTUFBTSxDQUFDSyxnQkFBZ0JDLGtCQUFrQixHQUFHTixJQUFBQSxlQUFRLEVBQWMsSUFBSU87SUFDdEUsTUFBTSxDQUFDQyxZQUFZQyxjQUFjLEdBQUdULElBQUFBLGVBQVEsRUFBQztJQUU3Q1UsSUFBQUEsZ0JBQVMsRUFBQztRQUNSQztJQUNGLEdBQUcsRUFBRTtJQUVMLE1BQU1BLHFCQUFxQjtRQUN6QixJQUFJO1lB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