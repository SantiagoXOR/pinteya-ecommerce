84d207ad0eb37de79845e8ac7429b6e2
"use strict";

/* istanbul ignore next */
function cov_b09sl6144() {
  var path = "C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\app\\api\\admin\\orders\\[id]\\history\\route.ts";
  var hash = "f71bb5477160a1331ea69c93e894d4bab22071fb";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\app\\api\\admin\\orders\\[id]\\history\\route.ts",
    statementMap: {
      "0": {
        start: {
          line: 2,
          column: 0
        },
        end: {
          line: 4,
          column: 3
        }
      },
      "1": {
        start: {
          line: 5,
          column: 0
        },
        end: {
          line: 10,
          column: 3
        }
      },
      "2": {
        start: {
          line: 8,
          column: 8
        },
        end: {
          line: 8,
          column: 19
        }
      },
      "3": {
        start: {
          line: 11,
          column: 16
        },
        end: {
          line: 11,
          column: 38
        }
      },
      "4": {
        start: {
          line: 12,
          column: 14
        },
        end: {
          line: 12,
          column: 47
        }
      },
      "5": {
        start: {
          line: 13,
          column: 17
        },
        end: {
          line: 13,
          column: 78
        }
      },
      "6": {
        start: {
          line: 14,
          column: 16
        },
        end: {
          line: 14,
          column: 66
        }
      },
      "7": {
        start: {
          line: 16,
          column: 4
        },
        end: {
          line: 129,
          column: 5
        }
      },
      "8": {
        start: {
          line: 17,
          column: 24
        },
        end: {
          line: 17,
          column: 33
        }
      },
      "9": {
        start: {
          line: 19,
          column: 24
        },
        end: {
          line: 19,
          column: 47
        }
      },
      "10": {
        start: {
          line: 20,
          column: 8
        },
        end: {
          line: 27,
          column: 9
        }
      },
      "11": {
        start: {
          line: 21,
          column: 12
        },
        end: {
          line: 26,
          column: 15
        }
      },
      "12": {
        start: {
          line: 28,
          column: 8
        },
        end: {
          line: 31,
          column: 11
        }
      },
      "13": {
        start: {
          line: 33,
          column: 25
        },
        end: {
          line: 33,
          column: 58
        }
      },
      "14": {
        start: {
          line: 34,
          column: 51
        },
        end: {
          line: 34,
          column: 140
        }
      },
      "15": {
        start: {
          line: 35,
          column: 8
        },
        end: {
          line: 46,
          column: 9
        }
      },
      "16": {
        start: {
          line: 36,
          column: 12
        },
        end: {
          line: 39,
          column: 15
        }
      },
      "17": {
        start: {
          line: 40,
          column: 12
        },
        end: {
          line: 45,
          column: 15
        }
      },
      "18": {
        start: {
          line: 48,
          column: 28
        },
        end: {
          line: 48,
          column: 30
        }
      },
      "19": {
        start: {
          line: 49,
          column: 8
        },
        end: {
          line: 109,
          column: 9
        }
      },
      "20": {
        start: {
          line: 50,
          column: 59
        },
        end: {
          line: 62,
          column: 14
        }
      },
      "21": {
        start: {
          line: 63,
          column: 12
        },
        end: {
          line: 93,
          column: 13
        }
      },
      "22": {
        start: {
          line: 65,
          column: 16
        },
        end: {
          line: 71,
          column: 24
        }
      },
      "23": {
        start: {
          line: 65,
          column: 60
        },
        end: {
          line: 71,
          column: 21
        }
      },
      "24": {
        start: {
          line: 74,
          column: 16
        },
        end: {
          line: 82,
          column: 18
        }
      },
      "25": {
        start: {
          line: 84,
          column: 16
        },
        end: {
          line: 92,
          column: 17
        }
      },
      "26": {
        start: {
          line: 85,
          column: 20
        },
        end: {
          line: 91,
          column: 23
        }
      },
      "27": {
        start: {
          line: 95,
          column: 12
        },
        end: {
          line: 98,
          column: 15
        }
      },
      "28": {
        start: {
          line: 100,
          column: 12
        },
        end: {
          line: 108,
          column: 14
        }
      },
      "29": {
        start: {
          line: 110,
          column: 8
        },
        end: {
          line: 113,
          column: 11
        }
      },
      "30": {
        start: {
          line: 114,
          column: 8
        },
        end: {
          line: 117,
          column: 11
        }
      },
      "31": {
        start: {
          line: 119,
          column: 8
        },
        end: {
          line: 122,
          column: 11
        }
      },
      "32": {
        start: {
          line: 123,
          column: 8
        },
        end: {
          line: 128,
          column: 11
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 7,
            column: 9
          },
          end: {
            line: 7,
            column: 10
          }
        },
        loc: {
          start: {
            line: 7,
            column: 20
          },
          end: {
            line: 9,
            column: 5
          }
        },
        line: 7
      },
      "1": {
        name: "GET",
        decl: {
          start: {
            line: 15,
            column: 15
          },
          end: {
            line: 15,
            column: 18
          }
        },
        loc: {
          start: {
            line: 15,
            column: 40
          },
          end: {
            line: 130,
            column: 1
          }
        },
        line: 15
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 65,
            column: 44
          },
          end: {
            line: 65,
            column: 45
          }
        },
        loc: {
          start: {
            line: 65,
            column: 60
          },
          end: {
            line: 71,
            column: 21
          }
        },
        line: 65
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 20,
            column: 8
          },
          end: {
            line: 27,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 20,
            column: 8
          },
          end: {
            line: 27,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 20
      },
      "1": {
        loc: {
          start: {
            line: 35,
            column: 8
          },
          end: {
            line: 46,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 35,
            column: 8
          },
          end: {
            line: 46,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 35
      },
      "2": {
        loc: {
          start: {
            line: 35,
            column: 12
          },
          end: {
            line: 35,
            column: 32
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 35,
            column: 12
          },
          end: {
            line: 35,
            column: 22
          }
        }, {
          start: {
            line: 35,
            column: 26
          },
          end: {
            line: 35,
            column: 32
          }
        }],
        line: 35
      },
      "3": {
        loc: {
          start: {
            line: 63,
            column: 12
          },
          end: {
            line: 93,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 63,
            column: 12
          },
          end: {
            line: 93,
            column: 13
          }
        }, {
          start: {
            line: 72,
            column: 19
          },
          end: {
            line: 93,
            column: 13
          }
        }],
        line: 63
      },
      "4": {
        loc: {
          start: {
            line: 63,
            column: 16
          },
          end: {
            line: 63,
            column: 62
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 63,
            column: 16
          },
          end: {
            line: 63,
            column: 29
          }
        }, {
          start: {
            line: 63,
            column: 33
          },
          end: {
            line: 63,
            column: 40
          }
        }, {
          start: {
            line: 63,
            column: 44
          },
          end: {
            line: 63,
            column: 62
          }
        }],
        line: 63
      },
      "5": {
        loc: {
          start: {
            line: 69,
            column: 30
          },
          end: {
            line: 69,
            column: 83
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 69,
            column: 30
          },
          end: {
            line: 69,
            column: 41
          }
        }, {
          start: {
            line: 69,
            column: 45
          },
          end: {
            line: 69,
            column: 83
          }
        }],
        line: 69
      },
      "6": {
        loc: {
          start: {
            line: 70,
            column: 30
          },
          end: {
            line: 70,
            column: 67
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 70,
            column: 30
          },
          end: {
            line: 70,
            column: 54
          }
        }, {
          start: {
            line: 70,
            column: 58
          },
          end: {
            line: 70,
            column: 67
          }
        }],
        line: 70
      },
      "7": {
        loc: {
          start: {
            line: 84,
            column: 16
          },
          end: {
            line: 92,
            column: 17
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 84,
            column: 16
          },
          end: {
            line: 92,
            column: 17
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 84
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0]
    },
    inputSourceMap: {
      version: 3,
      sources: ["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\app\\api\\admin\\orders\\[id]\\history\\route.ts"],
      sourcesContent: ["import { NextRequest, NextResponse } from 'next/server';\r\nimport { auth } from '@/auth';\r\nimport { createAdminClient } from '@/lib/integrations/supabase/server';\r\nimport { logger, LogLevel, LogCategory } from '@/lib/enterprise/logger';\r\n\r\n/**\r\n * GET /api/admin/orders/[id]/history\r\n * Obtiene el historial de estados de una orden espec\xEDfica\r\n */\r\nexport async function GET(\r\n  request: NextRequest,\r\n  { params }: { params: { id: string } }\r\n): Promise<NextResponse> {\r\n  try {\r\n    const orderId = params.id;\r\n\r\n    // Verificar autenticaci\xF3n\r\n    const session = await auth();\r\n    if (!session?.user) {\r\n      return NextResponse.json(\r\n        { success: false, error: 'No autorizado' },\r\n        { status: 401 }\r\n      );\r\n    }\r\n\r\n    logger.log(LogLevel.INFO, LogCategory.API, 'Fetching order history', { \r\n      orderId,\r\n      userId: session.user.id \r\n    });\r\n\r\n    // Verificar que la orden existe\r\n    const supabase = createAdminClient();\r\n    const { data: order, error: orderError } = await supabase\r\n      .from('orders')\r\n      .select('id, status, created_at')\r\n      .eq('id', orderId)\r\n      .single();\r\n\r\n    if (orderError || !order) {\r\n      logger.log(LogLevel.WARN, LogCategory.API, 'Order not found', { orderId, orderError });\r\n      return NextResponse.json(\r\n        { success: false, error: 'Orden no encontrada' },\r\n        { status: 404 }\r\n      );\r\n    }\r\n\r\n    // Intentar obtener historial de estados desde order_status_history\r\n    let statusHistory = [];\r\n    try {\r\n      const { data: history, error: historyError } = await supabase\r\n        .from('order_status_history')\r\n        .select(`\r\n          id,\r\n          previous_status,\r\n          new_status,\r\n          reason,\r\n          created_at,\r\n          user_profiles!order_status_history_changed_by_fkey (\r\n            name,\r\n            email\r\n          )\r\n        `)\r\n        .eq('order_id', orderId)\r\n        .order('created_at', { ascending: true });\r\n\r\n      if (!historyError && history && history.length > 0) {\r\n        // Formatear historial real\r\n        statusHistory = history.map((item, index) => ({\r\n          id: item.id,\r\n          status: item.new_status,\r\n          timestamp: item.created_at,\r\n          note: item.reason || `Estado cambiado a ${item.new_status}`,\r\n          user: item.user_profiles?.name || 'Sistema'\r\n        }));\r\n      } else {\r\n        // Si no hay historial en la tabla, crear historial b\xE1sico\r\n        statusHistory = [\r\n          {\r\n            id: '1',\r\n            status: order.status,\r\n            timestamp: order.created_at,\r\n            note: 'Orden creada',\r\n            user: 'Sistema'\r\n          }\r\n        ];\r\n\r\n        // Si el estado actual no es 'pending', agregar una entrada adicional\r\n        if (order.status !== 'pending') {\r\n          statusHistory.push({\r\n            id: '2',\r\n            status: order.status,\r\n            timestamp: order.created_at, // En un caso real, esto ser\xEDa la fecha de cambio\r\n            note: `Estado actualizado a ${order.status}`,\r\n            user: 'Sistema'\r\n          });\r\n        }\r\n      }\r\n    } catch (historyError) {\r\n      logger.log(LogLevel.WARN, LogCategory.DATABASE, 'Error fetching order history, using fallback', { \r\n        orderId, \r\n        historyError \r\n      });\r\n\r\n      // Fallback: crear historial b\xE1sico\r\n      statusHistory = [\r\n        {\r\n          id: '1',\r\n          status: order.status,\r\n          timestamp: order.created_at,\r\n          note: 'Orden creada',\r\n          user: 'Sistema'\r\n        }\r\n      ];\r\n    }\r\n\r\n    logger.log(LogLevel.INFO, LogCategory.API, 'Order history fetched successfully', {\r\n      orderId,\r\n      historyCount: statusHistory.length\r\n    });\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      data: statusHistory\r\n    });\r\n\r\n  } catch (error) {\r\n    logger.log(LogLevel.ERROR, LogCategory.API, 'Unexpected error in order history API', { \r\n      orderId: params.id,\r\n      error \r\n    });\r\n    \r\n    return NextResponse.json(\r\n      { success: false, error: 'Error interno del servidor' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],
      names: ["GET", "request", "params", "orderId", "id", "session", "auth", "user", "NextResponse", "json", "success", "error", "status", "logger", "log", "LogLevel", "INFO", "LogCategory", "API", "userId", "supabase", "createAdminClient", "data", "order", "orderError", "from", "select", "eq", "single", "WARN", "statusHistory", "history", "historyError", "ascending", "length", "map", "item", "index", "new_status", "timestamp", "created_at", "note", "reason", "user_profiles", "name", "push", "DATABASE", "historyCount", "ERROR"],
      mappings: "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"
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "f71bb5477160a1331ea69c93e894d4bab22071fb"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_b09sl6144 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_b09sl6144();
cov_b09sl6144().s[0]++;
Object.defineProperty(exports, "__esModule", {
  value: true
});
/* istanbul ignore next */
cov_b09sl6144().s[1]++;
Object.defineProperty(exports, "GET", {
  enumerable: true,
  get: function () {
    /* istanbul ignore next */
    cov_b09sl6144().f[0]++;
    cov_b09sl6144().s[2]++;
    return GET;
  }
});
const _server =
/* istanbul ignore next */
(cov_b09sl6144().s[3]++, require("next/server"));
const _auth =
/* istanbul ignore next */
(cov_b09sl6144().s[4]++, require("../../../../../../auth"));
const _server1 =
/* istanbul ignore next */
(cov_b09sl6144().s[5]++, require("../../../../../../lib/integrations/supabase/server"));
const _logger =
/* istanbul ignore next */
(cov_b09sl6144().s[6]++, require("../../../../../../lib/enterprise/logger"));
async function GET(request, {
  params
}) {
  /* istanbul ignore next */
  cov_b09sl6144().f[1]++;
  cov_b09sl6144().s[7]++;
  try {
    const orderId =
    /* istanbul ignore next */
    (cov_b09sl6144().s[8]++, params.id);
    // Verificar autenticación
    const session =
    /* istanbul ignore next */
    (cov_b09sl6144().s[9]++, await (0, _auth.auth)());
    /* istanbul ignore next */
    cov_b09sl6144().s[10]++;
    if (!session?.user) {
      /* istanbul ignore next */
      cov_b09sl6144().b[0][0]++;
      cov_b09sl6144().s[11]++;
      return _server.NextResponse.json({
        success: false,
        error: 'No autorizado'
      }, {
        status: 401
      });
    } else
    /* istanbul ignore next */
    {
      cov_b09sl6144().b[0][1]++;
    }
    cov_b09sl6144().s[12]++;
    _logger.logger.log(_logger.LogLevel.INFO, _logger.LogCategory.API, 'Fetching order history', {
      orderId,
      userId: session.user.id
    });
    // Verificar que la orden existe
    const supabase =
    /* istanbul ignore next */
    (cov_b09sl6144().s[13]++, (0, _server1.createAdminClient)());
    const {
      data: order,
      error: orderError
    } =
    /* istanbul ignore next */
    (cov_b09sl6144().s[14]++, await supabase.from('orders').select('id, status, created_at').eq('id', orderId).single());
    /* istanbul ignore next */
    cov_b09sl6144().s[15]++;
    if (
    /* istanbul ignore next */
    (cov_b09sl6144().b[2][0]++, orderError) ||
    /* istanbul ignore next */
    (cov_b09sl6144().b[2][1]++, !order)) {
      /* istanbul ignore next */
      cov_b09sl6144().b[1][0]++;
      cov_b09sl6144().s[16]++;
      _logger.logger.log(_logger.LogLevel.WARN, _logger.LogCategory.API, 'Order not found', {
        orderId,
        orderError
      });
      /* istanbul ignore next */
      cov_b09sl6144().s[17]++;
      return _server.NextResponse.json({
        success: false,
        error: 'Orden no encontrada'
      }, {
        status: 404
      });
    } else
    /* istanbul ignore next */
    {
      cov_b09sl6144().b[1][1]++;
    }
    // Intentar obtener historial de estados desde order_status_history
    let statusHistory =
    /* istanbul ignore next */
    (cov_b09sl6144().s[18]++, []);
    /* istanbul ignore next */
    cov_b09sl6144().s[19]++;
    try {
      const {
        data: history,
        error: historyError
      } =
      /* istanbul ignore next */
      (cov_b09sl6144().s[20]++, await supabase.from('order_status_history').select(`
          id,
          previous_status,
          new_status,
          reason,
          created_at,
          user_profiles!order_status_history_changed_by_fkey (
            name,
            email
          )
        `).eq('order_id', orderId).order('created_at', {
        ascending: true
      }));
      /* istanbul ignore next */
      cov_b09sl6144().s[21]++;
      if (
      /* istanbul ignore next */
      (cov_b09sl6144().b[4][0]++, !historyError) &&
      /* istanbul ignore next */
      (cov_b09sl6144().b[4][1]++, history) &&
      /* istanbul ignore next */
      (cov_b09sl6144().b[4][2]++, history.length > 0)) {
        /* istanbul ignore next */
        cov_b09sl6144().b[3][0]++;
        cov_b09sl6144().s[22]++;
        // Formatear historial real
        statusHistory = history.map((item, index) => {
          /* istanbul ignore next */
          cov_b09sl6144().f[2]++;
          cov_b09sl6144().s[23]++;
          return {
            id: item.id,
            status: item.new_status,
            timestamp: item.created_at,
            note:
            /* istanbul ignore next */
            (cov_b09sl6144().b[5][0]++, item.reason) ||
            /* istanbul ignore next */
            (cov_b09sl6144().b[5][1]++, `Estado cambiado a ${item.new_status}`),
            user:
            /* istanbul ignore next */
            (cov_b09sl6144().b[6][0]++, item.user_profiles?.name) ||
            /* istanbul ignore next */
            (cov_b09sl6144().b[6][1]++, 'Sistema')
          };
        });
      } else {
        /* istanbul ignore next */
        cov_b09sl6144().b[3][1]++;
        cov_b09sl6144().s[24]++;
        // Si no hay historial en la tabla, crear historial básico
        statusHistory = [{
          id: '1',
          status: order.status,
          timestamp: order.created_at,
          note: 'Orden creada',
          user: 'Sistema'
        }];
        // Si el estado actual no es 'pending', agregar una entrada adicional
        /* istanbul ignore next */
        cov_b09sl6144().s[25]++;
        if (order.status !== 'pending') {
          /* istanbul ignore next */
          cov_b09sl6144().b[7][0]++;
          cov_b09sl6144().s[26]++;
          statusHistory.push({
            id: '2',
            status: order.status,
            timestamp: order.created_at,
            note: `Estado actualizado a ${order.status}`,
            user: 'Sistema'
          });
        } else
        /* istanbul ignore next */
        {
          cov_b09sl6144().b[7][1]++;
        }
      }
    } catch (historyError) {
      /* istanbul ignore next */
      cov_b09sl6144().s[27]++;
      _logger.logger.log(_logger.LogLevel.WARN, _logger.LogCategory.DATABASE, 'Error fetching order history, using fallback', {
        orderId,
        historyError
      });
      // Fallback: crear historial básico
      /* istanbul ignore next */
      cov_b09sl6144().s[28]++;
      statusHistory = [{
        id: '1',
        status: order.status,
        timestamp: order.created_at,
        note: 'Orden creada',
        user: 'Sistema'
      }];
    }
    /* istanbul ignore next */
    cov_b09sl6144().s[29]++;
    _logger.logger.log(_logger.LogLevel.INFO, _logger.LogCategory.API, 'Order history fetched successfully', {
      orderId,
      historyCount: statusHistory.length
    });
    /* istanbul ignore next */
    cov_b09sl6144().s[30]++;
    return _server.NextResponse.json({
      success: true,
      data: statusHistory
    });
  } catch (error) {
    /* istanbul ignore next */
    cov_b09sl6144().s[31]++;
    _logger.logger.log(_logger.LogLevel.ERROR, _logger.LogCategory.API, 'Unexpected error in order history API', {
      orderId: params.id,
      error
    });
    /* istanbul ignore next */
    cov_b09sl6144().s[32]++;
    return _server.NextResponse.json({
      success: false,
      error: 'Error interno del servidor'
    }, {
      status: 500
    });
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfYjA5c2w2MTQ0IiwiYWN0dWFsQ292ZXJhZ2UiLCJzIiwiR0VUIiwicmVxdWVzdCIsInBhcmFtcyIsImYiLCJvcmRlcklkIiwiaWQiLCJzZXNzaW9uIiwiX2F1dGgiLCJhdXRoIiwidXNlciIsImIiLCJfc2VydmVyIiwiTmV4dFJlc3BvbnNlIiwianNvbiIsInN1Y2Nlc3MiLCJlcnJvciIsInN0YXR1cyIsIl9sb2dnZXIiLCJsb2dnZXIiLCJsb2ciLCJMb2dMZXZlbCIsIklORk8iLCJMb2dDYXRlZ29yeSIsIkFQSSIsInVzZXJJZCIsInN1cGFiYXNlIiwiX3NlcnZlcjEiLCJjcmVhdGVBZG1pbkNsaWVudCIsImRhdGEiLCJvcmRlciIsIm9yZGVyRXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJzaW5nbGUiLCJXQVJOIiwic3RhdHVzSGlzdG9yeSIsImhpc3RvcnkiLCJoaXN0b3J5RXJyb3IiLCJhc2NlbmRpbmciLCJsZW5ndGgiLCJtYXAiLCJpdGVtIiwiaW5kZXgiLCJuZXdfc3RhdHVzIiwidGltZXN0YW1wIiwiY3JlYXRlZF9hdCIsIm5vdGUiLCJyZWFzb24iLCJ1c2VyX3Byb2ZpbGVzIiwibmFtZSIsInB1c2giLCJEQVRBQkFTRSIsImhpc3RvcnlDb3VudCIsIkVSUk9SIl0sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxtYXJ0aVxcRGVza3RvcFxcREVTQVJST0xMT1NXXFxCT0lMRVJQTEFUVEUgRS1DT01NRVJDRVxcc3JjXFxhcHBcXGFwaVxcYWRtaW5cXG9yZGVyc1xcW2lkXVxcaGlzdG9yeVxccm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcclxuaW1wb3J0IHsgYXV0aCB9IGZyb20gJ0AvYXV0aCc7XHJcbmltcG9ydCB7IGNyZWF0ZUFkbWluQ2xpZW50IH0gZnJvbSAnQC9saWIvaW50ZWdyYXRpb25zL3N1cGFiYXNlL3NlcnZlcic7XHJcbmltcG9ydCB7IGxvZ2dlciwgTG9nTGV2ZWwsIExvZ0NhdGVnb3J5IH0gZnJvbSAnQC9saWIvZW50ZXJwcmlzZS9sb2dnZXInO1xyXG5cclxuLyoqXHJcbiAqIEdFVCAvYXBpL2FkbWluL29yZGVycy9baWRdL2hpc3RvcnlcclxuICogT2J0aWVuZSBlbCBoaXN0b3JpYWwgZGUgZXN0YWRvcyBkZSB1bmEgb3JkZW4gZXNwZWPDrWZpY2FcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQoXHJcbiAgcmVxdWVzdDogTmV4dFJlcXVlc3QsXHJcbiAgeyBwYXJhbXMgfTogeyBwYXJhbXM6IHsgaWQ6IHN0cmluZyB9IH1cclxuKTogUHJvbWlzZTxOZXh0UmVzcG9uc2U+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3Qgb3JkZXJJZCA9IHBhcmFtcy5pZDtcclxuXHJcbiAgICAvLyBWZXJpZmljYXIgYXV0ZW50aWNhY2nDs25cclxuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBhdXRoKCk7XHJcbiAgICBpZiAoIXNlc3Npb24/LnVzZXIpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnTm8gYXV0b3JpemFkbycgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAxIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBsb2dnZXIubG9nKExvZ0xldmVsLklORk8sIExvZ0NhdGVnb3J5LkFQSSwgJ0ZldGNoaW5nIG9yZGVyIGhpc3RvcnknLCB7IFxyXG4gICAgICBvcmRlcklkLFxyXG4gICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCBcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIFZlcmlmaWNhciBxdWUgbGEgb3JkZW4gZXhpc3RlXHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZUFkbWluQ2xpZW50KCk7XHJcbiAgICBjb25zdCB7IGRhdGE6IG9yZGVyLCBlcnJvcjogb3JkZXJFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ29yZGVycycpXHJcbiAgICAgIC5zZWxlY3QoJ2lkLCBzdGF0dXMsIGNyZWF0ZWRfYXQnKVxyXG4gICAgICAuZXEoJ2lkJywgb3JkZXJJZClcclxuICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChvcmRlckVycm9yIHx8ICFvcmRlcikge1xyXG4gICAgICBsb2dnZXIubG9nKExvZ0xldmVsLldBUk4sIExvZ0NhdGVnb3J5LkFQSSwgJ09yZGVyIG5vdCBmb3VuZCcsIHsgb3JkZXJJZCwgb3JkZXJFcnJvciB9KTtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnT3JkZW4gbm8gZW5jb250cmFkYScgfSxcclxuICAgICAgICB7IHN0YXR1czogNDA0IH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBJbnRlbnRhciBvYnRlbmVyIGhpc3RvcmlhbCBkZSBlc3RhZG9zIGRlc2RlIG9yZGVyX3N0YXR1c19oaXN0b3J5XHJcbiAgICBsZXQgc3RhdHVzSGlzdG9yeSA9IFtdO1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgeyBkYXRhOiBoaXN0b3J5LCBlcnJvcjogaGlzdG9yeUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAgIC5mcm9tKCdvcmRlcl9zdGF0dXNfaGlzdG9yeScpXHJcbiAgICAgICAgLnNlbGVjdChgXHJcbiAgICAgICAgICBpZCxcclxuICAgICAgICAgIHByZXZpb3VzX3N0YXR1cyxcclxuICAgICAgICAgIG5ld19zdGF0dXMsXHJcbiAgICAgICAgICByZWFzb24sXHJcbiAgICAgICAgICBjcmVhdGVkX2F0LFxyXG4gICAgICAgICAgdXNlcl9wcm9maWxlcyFvcmRlcl9zdGF0dXNfaGlzdG9yeV9jaGFuZ2VkX2J5X2ZrZXkgKFxyXG4gICAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgICBlbWFpbFxyXG4gICAgICAgICAgKVxyXG4gICAgICAgIGApXHJcbiAgICAgICAgLmVxKCdvcmRlcl9pZCcsIG9yZGVySWQpXHJcbiAgICAgICAgLm9yZGVyKCdjcmVhdGVkX2F0JywgeyBhc2NlbmRpbmc6IHRydWUgfSk7XHJcblxyXG4gICAgICBpZiAoIWhpc3RvcnlFcnJvciAmJiBoaXN0b3J5ICYmIGhpc3RvcnkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIC8vIEZvcm1hdGVhciBoaXN0b3JpYWwgcmVhbFxyXG4gICAgICAgIHN0YXR1c0hpc3RvcnkgPSBoaXN0b3J5Lm1hcCgoaXRlbSwgaW5kZXgpID0+ICh7XHJcbiAgICAgICAgICBpZDogaXRlbS5pZCxcclxuICAgICAgICAgIHN0YXR1czogaXRlbS5uZXdfc3RhdHVzLFxyXG4gICAgICAgICAgdGltZXN0YW1wOiBpdGVtLmNyZWF0ZWRfYXQsXHJcbiAgICAgICAgICBub3RlOiBpdGVtLnJlYXNvbiB8fCBgRXN0YWRvIGNhbWJpYWRvIGEgJHtpdGVtLm5ld19zdGF0dXN9YCxcclxuICAgICAgICAgIHVzZXI6IGl0ZW0udXNlcl9wcm9maWxlcz8ubmFtZSB8fCAnU2lzdGVtYSdcclxuICAgICAgICB9KSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gU2kgbm8gaGF5IGhpc3RvcmlhbCBlbiBsYSB0YWJsYSwgY3JlYXIgaGlzdG9yaWFsIGLDoXNpY29cclxuICAgICAgICBzdGF0dXNIaXN0b3J5ID0gW1xyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBpZDogJzEnLFxyXG4gICAgICAgICAgICBzdGF0dXM6IG9yZGVyLnN0YXR1cyxcclxuICAgICAgICAgICAgdGltZXN0YW1wOiBvcmRlci5jcmVhdGVkX2F0LFxyXG4gICAgICAgICAgICBub3RlOiAnT3JkZW4gY3JlYWRhJyxcclxuICAgICAgICAgICAgdXNlcjogJ1Npc3RlbWEnXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgXTtcclxuXHJcbiAgICAgICAgLy8gU2kgZWwgZXN0YWRvIGFjdHVhbCBubyBlcyAncGVuZGluZycsIGFncmVnYXIgdW5hIGVudHJhZGEgYWRpY2lvbmFsXHJcbiAgICAgICAgaWYgKG9yZGVyLnN0YXR1cyAhPT0gJ3BlbmRpbmcnKSB7XHJcbiAgICAgICAgICBzdGF0dXNIaXN0b3J5LnB1c2goe1xyXG4gICAgICAgICAgICBpZDogJzInLFxyXG4gICAgICAgICAgICBzdGF0dXM6IG9yZGVyLnN0YXR1cyxcclxuICAgICAgICAgICAgdGltZXN0YW1wOiBvcmRlci5jcmVhdGVkX2F0LCAvLyBFbiB1biBjYXNvIHJlYWwsIGVzdG8gc2Vyw61hIGxhIGZlY2hhIGRlIGNhbWJpb1xyXG4gICAgICAgICAgICBub3RlOiBgRXN0YWRvIGFjdHVhbGl6YWRvIGEgJHtvcmRlci5zdGF0dXN9YCxcclxuICAgICAgICAgICAgdXNlcjogJ1Npc3RlbWEnXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGhpc3RvcnlFcnJvcikge1xyXG4gICAgICBsb2dnZXIubG9nKExvZ0xldmVsLldBUk4sIExvZ0NhdGVnb3J5LkRBVEFCQVNFLCAnRXJyb3IgZmV0Y2hpbmcgb3JkZXIgaGlzdG9yeSwgdXNpbmcgZmFsbGJhY2snLCB7IFxyXG4gICAgICAgIG9yZGVySWQsIFxyXG4gICAgICAgIGhpc3RvcnlFcnJvciBcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBGYWxsYmFjazogY3JlYXIgaGlzdG9yaWFsIGLDoXNpY29cclxuICAgICAgc3RhdHVzSGlzdG9yeSA9IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBpZDogJzEnLFxyXG4gICAgICAgICAgc3RhdHVzOiBvcmRlci5zdGF0dXMsXHJcbiAgICAgICAgICB0aW1lc3RhbXA6IG9yZGVyLmNyZWF0ZWRfYXQsXHJcbiAgICAgICAgICBub3RlOiAnT3JkZW4gY3JlYWRhJyxcclxuICAgICAgICAgIHVzZXI6ICdTaXN0ZW1hJ1xyXG4gICAgICAgIH1cclxuICAgICAgXTtcclxuICAgIH1cclxuXHJcbiAgICBsb2dnZXIubG9nKExvZ0xldmVsLklORk8sIExvZ0NhdGVnb3J5LkFQSSwgJ09yZGVyIGhpc3RvcnkgZmV0Y2hlZCBzdWNjZXNzZnVsbHknLCB7XHJcbiAgICAgIG9yZGVySWQsXHJcbiAgICAgIGhpc3RvcnlDb3VudDogc3RhdHVzSGlzdG9yeS5sZW5ndGhcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGRhdGE6IHN0YXR1c0hpc3RvcnlcclxuICAgIH0pO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgbG9nZ2VyLmxvZyhMb2dMZXZlbC5FUlJPUiwgTG9nQ2F0ZWdvcnkuQVBJLCAnVW5leHBlY3RlZCBlcnJvciBpbiBvcmRlciBoaXN0b3J5IEFQSScsIHsgXHJcbiAgICAgIG9yZGVySWQ6IHBhcmFtcy5pZCxcclxuICAgICAgZXJyb3IgXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0Vycm9yIGludGVybm8gZGVsIHNlcnZpZG9yJyB9LFxyXG4gICAgICB7IHN0YXR1czogNTAwIH1cclxuICAgICk7XHJcbiAgfVxyXG59XHJcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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