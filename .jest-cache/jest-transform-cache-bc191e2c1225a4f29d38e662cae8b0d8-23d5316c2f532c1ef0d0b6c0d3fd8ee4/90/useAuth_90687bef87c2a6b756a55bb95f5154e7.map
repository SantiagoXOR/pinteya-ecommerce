{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\hooks\\useAuth.ts"],"sourcesContent":["/**\r\n * Hook de Autenticación para NextAuth.js\r\n * Reemplaza los hooks de Clerk con NextAuth.js\r\n */\r\n\r\n\"use client\"\r\n\r\nimport { useSession, signIn, signOut } from 'next-auth/react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useEffect } from 'react';\r\nimport { UseAuthReturn, AuthUser } from '@/types/hooks';\r\n\r\n// ===================================\r\n// INTERFACES\r\n// ===================================\r\n// Interfaces movidas a @/types/hooks para reutilización\r\n\r\nexport function useAuth(): UseAuthReturn {\r\n  const { data: session, status } = useSession()\r\n  const router = useRouter()\r\n\r\n  const handleSignIn = useCallback(async (provider: string = \"google\", options?: { callbackUrl?: string }) => {\r\n    try {\r\n      await signIn(provider, {\r\n        callbackUrl: options?.callbackUrl || \"/admin\",\r\n        redirect: true,\r\n      })\r\n    } catch (error) {\r\n      console.error(\"Error al iniciar sesión:\", error)\r\n    }\r\n  }, [])\r\n\r\n  const handleSignOut = useCallback(async (options?: { callbackUrl?: string }) => {\r\n    try {\r\n      await signOut({\r\n        callbackUrl: options?.callbackUrl || \"/\",\r\n        redirect: true,\r\n      })\r\n    } catch (error) {\r\n      console.error(\"Error al cerrar sesión:\", error)\r\n    }\r\n  }, [])\r\n\r\n  // Mapear usuario de NextAuth a nuestro formato\r\n  const user: AuthUser | null = session?.user ? {\r\n    id: session.user.id || session.user.email || '',\r\n    name: session.user.name,\r\n    email: session.user.email,\r\n    image: session.user.image,\r\n  } : null\r\n\r\n  return {\r\n    user,\r\n    isLoaded: status !== \"loading\",\r\n    isSignedIn: status === \"authenticated\",\r\n    signIn: handleSignIn,\r\n    signOut: handleSignOut,\r\n    session,\r\n    status,\r\n  }\r\n}\r\n\r\n// Hook para verificar si el usuario es administrador\r\nexport function useIsAdmin(): boolean {\r\n  const { user, isSignedIn } = useAuth()\r\n  \r\n  // Por ahora, todos los usuarios autenticados son admin\r\n  // TODO: Implementar sistema de roles más granular\r\n  return isSignedIn && !!user\r\n}\r\n\r\n// Hook para proteger rutas\r\nexport function useRequireAuth(redirectTo: string = \"/api/auth/signin\") {\r\n  const { isSignedIn, isLoaded } = useAuth()\r\n  const router = useRouter()\r\n\r\n  if (isLoaded && !isSignedIn) {\r\n    router.push(redirectTo)\r\n  }\r\n\r\n  return { isSignedIn, isLoaded }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":["useAuth","useIsAdmin","useRequireAuth","data","session","status","useSession","router","useRouter","handleSignIn","useCallback","provider","options","signIn","callbackUrl","redirect","error","console","handleSignOut","signOut","user","id","email","name","image","isLoaded","isSignedIn","redirectTo","push"],"mappings":"AAAA;;;CAGC,GAED;;;;;;;;;;;;QAYgBA;eAAAA;;QA8CAC;eAAAA;;QASAC;eAAAA;;;uBAjE4B;4BAClB;AASnB,SAASF;IACd,MAAM,EAAEG,MAAMC,OAAO,EAAEC,MAAM,EAAE,GAAGC,IAAAA,iBAAU;IAC5C,MAAMC,SAASC,IAAAA,qBAAS;IAExB,MAAMC,eAAeC,YAAY,OAAOC,WAAmB,QAAQ,EAAEC;QACnE,IAAI;YACF,MAAMC,IAAAA,aAAM,EAACF,UAAU;gBACrBG,aAAaF,SAASE,eAAe;gBACrCC,UAAU;YACZ;QACF,EAAE,OAAOC,OAAO;YACdC,QAAQD,KAAK,CAAC,4BAA4BA;QAC5C;IACF,GAAG,EAAE;IAEL,MAAME,gBAAgBR,YAAY,OAAOE;QACvC,IAAI;YACF,MAAMO,IAAAA,cAAO,EAAC;gBACZL,aAAaF,SAASE,eAAe;gBACrCC,UAAU;YACZ;QACF,EAAE,OAAOC,OAAO;YACdC,QAAQD,KAAK,CAAC,2BAA2BA;QAC3C;IACF,GAAG,EAAE;IAEL,+CAA+C;IAC/C,MAAMI,OAAwBhB,SAASgB,OAAO;QAC5CC,IAAIjB,QAAQgB,IAAI,CAACC,EAAE,IAAIjB,QAAQgB,IAAI,CAACE,KAAK,IAAI;QAC7CC,MAAMnB,QAAQgB,IAAI,CAACG,IAAI;QACvBD,OAAOlB,QAAQgB,IAAI,CAACE,KAAK;QACzBE,OAAOpB,QAAQgB,IAAI,CAACI,KAAK;IAC3B,IAAI;IAEJ,OAAO;QACLJ;QACAK,UAAUpB,WAAW;QACrBqB,YAAYrB,WAAW;QACvBQ,QAAQJ;QACRU,SAASD;QACTd;QACAC;IACF;AACF;AAGO,SAASJ;IACd,MAAM,EAAEmB,IAAI,EAAEM,UAAU,EAAE,GAAG1B;IAE7B,uDAAuD;IACvD,kDAAkD;IAClD,OAAO0B,cAAc,CAAC,CAACN;AACzB;AAGO,SAASlB,eAAeyB,aAAqB,kBAAkB;IACpE,MAAM,EAAED,UAAU,EAAED,QAAQ,EAAE,GAAGzB;IACjC,MAAMO,SAASC,IAAAA,qBAAS;IAExB,IAAIiB,YAAY,CAACC,YAAY;QAC3BnB,OAAOqB,IAAI,CAACD;IACd;IAEA,OAAO;QAAED;QAAYD;IAAS;AAChC"}