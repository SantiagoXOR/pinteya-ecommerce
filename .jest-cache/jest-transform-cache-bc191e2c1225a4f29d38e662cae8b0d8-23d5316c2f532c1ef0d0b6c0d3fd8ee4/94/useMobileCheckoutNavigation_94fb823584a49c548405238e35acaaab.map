{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\hooks\\useMobileCheckoutNavigation.ts"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useCallback, useEffect } from 'react';\r\nimport { useSwipeGestures } from './useSwipeGestures';\r\nimport { useRouter } from 'next/navigation';\r\n\r\nexport interface MobileCheckoutNavigationConfig {\r\n  /** Habilitar gestos de swipe */\r\n  enableSwipeGestures?: boolean;\r\n  /** Habilitar vibración háptica */\r\n  enableHapticFeedback?: boolean;\r\n  /** Callback cuando se swipe hacia atrás */\r\n  onSwipeBack?: () => void;\r\n  /** Callback cuando se swipe hacia adelante */\r\n  onSwipeForward?: () => void;\r\n  /** Habilitar navegación por teclado */\r\n  enableKeyboardNavigation?: boolean;\r\n}\r\n\r\nexport interface MobileCheckoutNavigationReturn {\r\n  /** Ref para el contenedor principal */\r\n  containerRef: React.RefObject<HTMLDivElement>;\r\n  /** Estado de si está en mobile */\r\n  isMobile: boolean;\r\n  /** Función para ir hacia atrás */\r\n  goBack: () => void;\r\n  /** Función para ir hacia adelante */\r\n  goForward: () => void;\r\n  /** Función para vibración háptica */\r\n  triggerHapticFeedback: (type?: 'light' | 'medium' | 'heavy') => void;\r\n  /** Estado de si el usuario está interactuando */\r\n  isInteracting: boolean;\r\n}\r\n\r\n/**\r\n * Hook para mejorar la navegación móvil en el checkout\r\n * Incluye gestos táctiles, feedback háptico y navegación por teclado\r\n */\r\nexport const useMobileCheckoutNavigation = (\r\n  config: MobileCheckoutNavigationConfig = {}\r\n): MobileCheckoutNavigationReturn => {\r\n  const {\r\n    enableSwipeGestures = true,\r\n    enableHapticFeedback = true,\r\n    onSwipeBack,\r\n    onSwipeForward,\r\n    enableKeyboardNavigation = true\r\n  } = config;\r\n\r\n  const router = useRouter();\r\n  const [isMobile, setIsMobile] = useState(false);\r\n  const [isInteracting, setIsInteracting] = useState(false);\r\n\r\n  // Detectar si estamos en mobile\r\n  useEffect(() => {\r\n    const checkMobile = () => {\r\n      const userAgent = navigator.userAgent.toLowerCase();\r\n      const isMobileDevice = /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/.test(userAgent);\r\n      const isSmallScreen = window.innerWidth < 768;\r\n      setIsMobile(isMobileDevice || isSmallScreen);\r\n    };\r\n\r\n    checkMobile();\r\n    window.addEventListener('resize', checkMobile);\r\n    return () => window.removeEventListener('resize', checkMobile);\r\n  }, []);\r\n\r\n  // Función para vibración háptica\r\n  const triggerHapticFeedback = useCallback((type: 'light' | 'medium' | 'heavy' = 'light') => {\r\n    if (!enableHapticFeedback || !isMobile) {return;}\r\n    \r\n    try {\r\n      // Vibración háptica moderna\r\n      if ('vibrate' in navigator) {\r\n        const patterns = {\r\n          light: [10],\r\n          medium: [20],\r\n          heavy: [30]\r\n        };\r\n        navigator.vibrate(patterns[type]);\r\n      }\r\n      \r\n      // Feedback háptico en iOS (si está disponible)\r\n      if ('hapticFeedback' in window) {\r\n        const feedbackTypes = {\r\n          light: 'impactLight',\r\n          medium: 'impactMedium', \r\n          heavy: 'impactHeavy'\r\n        };\r\n        // @ts-ignore - API experimental\r\n        window.hapticFeedback?.[feedbackTypes[type]]?.();\r\n      }\r\n    } catch (error) {\r\n      console.debug('Haptic feedback not available:', error);\r\n    }\r\n  }, [enableHapticFeedback, isMobile]);\r\n\r\n  // Funciones de navegación\r\n  const goBack = useCallback(() => {\r\n    triggerHapticFeedback('light');\r\n    onSwipeBack?.() || router.back();\r\n  }, [router, triggerHapticFeedback, onSwipeBack]);\r\n\r\n  const goForward = useCallback(() => {\r\n    triggerHapticFeedback('light');\r\n    onSwipeForward?.();\r\n  }, [triggerHapticFeedback, onSwipeForward]);\r\n\r\n  // Configurar gestos de swipe\r\n  const containerRef = useSwipeGestures({\r\n    enabled: enableSwipeGestures && isMobile,\r\n    threshold: 80, // Threshold más alto para evitar activaciones accidentales\r\n    preventDefaultTouchmove: true,\r\n    onSwipeRight: () => {\r\n      // Swipe derecha = ir hacia atrás\r\n      setIsInteracting(true);\r\n      goBack();\r\n      setTimeout(() => setIsInteracting(false), 300);\r\n    },\r\n    onSwipeLeft: () => {\r\n      // Swipe izquierda = ir hacia adelante (si está disponible)\r\n      setIsInteracting(true);\r\n      goForward();\r\n      setTimeout(() => setIsInteracting(false), 300);\r\n    }\r\n  });\r\n\r\n  // Navegación por teclado\r\n  useEffect(() => {\r\n    if (!enableKeyboardNavigation) {return;}\r\n\r\n    const handleKeyDown = (event: KeyboardEvent) => {\r\n      // Solo activar si no estamos en un input\r\n      if (event.target instanceof HTMLInputElement || \r\n          event.target instanceof HTMLTextAreaElement) {\r\n        return;\r\n      }\r\n\r\n      switch (event.key) {\r\n        case 'Escape':\r\n          event.preventDefault();\r\n          goBack();\r\n          break;\r\n        case 'ArrowLeft':\r\n          if (event.altKey) {\r\n            event.preventDefault();\r\n            goBack();\r\n          }\r\n          break;\r\n        case 'ArrowRight':\r\n          if (event.altKey) {\r\n            event.preventDefault();\r\n            goForward();\r\n          }\r\n          break;\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', handleKeyDown);\r\n    return () => document.removeEventListener('keydown', handleKeyDown);\r\n  }, [enableKeyboardNavigation, goBack, goForward]);\r\n\r\n  // Detectar interacciones táctiles\r\n  useEffect(() => {\r\n    if (!isMobile) {return;}\r\n\r\n    const handleTouchStart = () => setIsInteracting(true);\r\n    const handleTouchEnd = () => {\r\n      setTimeout(() => setIsInteracting(false), 100);\r\n    };\r\n\r\n    const element = containerRef.current;\r\n    if (element) {\r\n      element.addEventListener('touchstart', handleTouchStart, { passive: true });\r\n      element.addEventListener('touchend', handleTouchEnd, { passive: true });\r\n      \r\n      return () => {\r\n        element.removeEventListener('touchstart', handleTouchStart);\r\n        element.removeEventListener('touchend', handleTouchEnd);\r\n      };\r\n    }\r\n  }, [isMobile, containerRef]);\r\n\r\n  return {\r\n    containerRef,\r\n    isMobile,\r\n    goBack,\r\n    goForward,\r\n    triggerHapticFeedback,\r\n    isInteracting\r\n  };\r\n};\r\n\r\nexport default useMobileCheckoutNavigation;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":["useMobileCheckoutNavigation","config","enableSwipeGestures","enableHapticFeedback","onSwipeBack","onSwipeForward","enableKeyboardNavigation","router","useRouter","isMobile","setIsMobile","useState","isInteracting","setIsInteracting","useEffect","checkMobile","userAgent","navigator","toLowerCase","isMobileDevice","test","isSmallScreen","window","innerWidth","addEventListener","removeEventListener","triggerHapticFeedback","useCallback","type","patterns","light","medium","heavy","vibrate","feedbackTypes","hapticFeedback","error","console","debug","goBack","back","goForward","containerRef","useSwipeGestures","enabled","threshold","preventDefaultTouchmove","onSwipeRight","setTimeout","onSwipeLeft","handleKeyDown","event","target","HTMLInputElement","HTMLTextAreaElement","key","preventDefault","altKey","document","handleTouchStart","handleTouchEnd","element","current","passive"],"mappings":"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"}