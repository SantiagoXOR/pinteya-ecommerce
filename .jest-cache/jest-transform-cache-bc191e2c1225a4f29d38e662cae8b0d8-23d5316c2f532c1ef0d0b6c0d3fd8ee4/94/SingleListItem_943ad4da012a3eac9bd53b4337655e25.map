{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\components\\Shop\\SingleListItem.tsx"],"sourcesContent":["\"use client\";\r\nimport React from \"react\";\r\nimport Image from \"next/image\";\r\nimport Link from \"next/link\";\r\nimport { Product } from \"@/types/product\";\r\nimport { useCartActions } from \"@/hooks/useCartActions\";\r\nimport { useAnalytics } from \"@/hooks/useAnalytics\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { AppDispatch } from \"@/redux/store\";\r\nimport { updateQuickView } from \"@/redux/features/quickView-slice\";\r\nimport { addItemToWishlist } from \"@/redux/features/wishlist-slice\";\r\nimport { useCartWithBackend } from \"@/hooks/useCartWithBackend\";\r\nimport { CommercialProductCard } from \"@/components/ui/product-card-commercial\";\r\nimport { ExtendedProduct, calculateProductFeatures } from \"@/lib/adapters/productAdapter\";\r\n\r\ninterface SingleListItemProps {\r\n  product: ExtendedProduct;\r\n}\r\n\r\nconst SingleListItem: React.FC<SingleListItemProps> = ({ product }) => {\r\n  const { addToCart } = useCartActions();\r\n  const { trackEvent } = useAnalytics();\r\n  const dispatch = useDispatch<AppDispatch>();\r\n  const { addItem } = useCartWithBackend();\r\n\r\n  // Usar product directamente\r\n  const item = product;\r\n\r\n  // update the QuickView state\r\n  const handleQuickViewUpdate = () => {\r\n    dispatch(updateQuickView({ ...item }));\r\n  };\r\n\r\n  // add to cart - Conectado con backend\r\n  const handleAddToCart = async () => {\r\n    // Intentar agregar al backend primero\r\n    const success = await addItem(item.id, 1);\r\n\r\n    if (success) {\r\n      // Si el backend funciona, también actualizar Redux para compatibilidad\r\n      dispatch(\r\n        addItemToCart({\r\n          ...item,\r\n          quantity: 1,\r\n        })\r\n      );\r\n    } else {\r\n      // Si falla el backend, solo usar Redux (fallback)\r\n      dispatch(\r\n        addItemToCart({\r\n          ...item,\r\n          quantity: 1,\r\n        })\r\n      );\r\n    }\r\n  };\r\n\r\n  const handleItemToWishList = () => {\r\n    dispatch(\r\n      addItemToWishlist({\r\n        ...item,\r\n        status: \"available\",\r\n        quantity: 1,\r\n      })\r\n    );\r\n  };\r\n\r\n  // Calcular características del producto usando el adaptador\r\n  const features = calculateProductFeatures(item);\r\n\r\n  return (\r\n    <CommercialProductCard\r\n      className=\"bg-white\" // Forzar fondo blanco\r\n      image={item.images?.previews?.[0] || item.imgs?.previews?.[0] || '/images/products/placeholder.svg'}\r\n      title={item.name || item.title}\r\n      brand={item.brand}\r\n      price={features.discount ? Math.round(item.price * (1 - features.discount / 100)) : features.currentPrice}\r\n      originalPrice={features.discount ? item.price : undefined}\r\n      discount={features.discount ? `${features.discount}%` : undefined}\r\n      isNew={features.isNew}\r\n      stock={features.stock}\r\n      productId={item.id}\r\n      cta=\"Agregar al carrito\"\r\n      onAddToCart={handleAddToCart}\r\n      showCartAnimation={true}\r\n      // Información de cuotas automática\r\n      installments={features.currentPrice >= 5000 ? {\r\n        quantity: 3,\r\n        amount: Math.round(features.currentPrice / 3),\r\n        interestFree: true\r\n      } : undefined}\r\n      // Envío gratis automático para productos >= $15000\r\n      freeShipping={features.freeShipping || features.currentPrice >= 15000}\r\n      shippingText={features.freeShipping ? \"Envío gratis\" : features.fastShipping ? \"Envío rápido\" : undefined}\r\n    />\r\n  );\r\n};\r\n\r\nexport default SingleListItem;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":["SingleListItem","product","addToCart","useCartActions","trackEvent","useAnalytics","dispatch","useDispatch","addItem","useCartWithBackend","item","handleQuickViewUpdate","updateQuickView","handleAddToCart","success","id","addItemToCart","quantity","handleItemToWishList","addItemToWishlist","status","features","calculateProductFeatures","CommercialProductCard","className","image","images","previews","imgs","title","name","brand","price","discount","Math","round","currentPrice","originalPrice","undefined","isNew","stock","productId","cta","onAddToCart","showCartAnimation","installments","amount","interestFree","freeShipping","shippingText","fastShipping"],"mappings":"AAAA;;;;;+BAkGA;;;eAAA;;;;8DAjGkB;gCAIa;8BACF;4BACD;gCAEI;+BACE;oCACC;uCACG;gCACoB;;;;;;AAM1D,MAAMA,iBAAgD,CAAC,EAAEC,OAAO,EAAE;IAChE,MAAM,EAAEC,SAAS,EAAE,GAAGC,IAAAA,8BAAc;IACpC,MAAM,EAAEC,UAAU,EAAE,GAAGC,IAAAA,0BAAY;IACnC,MAAMC,WAAWC,IAAAA,uBAAW;IAC5B,MAAM,EAAEC,OAAO,EAAE,GAAGC,IAAAA,sCAAkB;IAEtC,4BAA4B;IAC5B,MAAMC,OAAOT;IAEb,6BAA6B;IAC7B,MAAMU,wBAAwB;QAC5BL,SAASM,IAAAA,+BAAe,EAAC;YAAE,GAAGF,IAAI;QAAC;IACrC;IAEA,sCAAsC;IACtC,MAAMG,kBAAkB;QACtB,sCAAsC;QACtC,MAAMC,UAAU,MAAMN,QAAQE,KAAKK,EAAE,EAAE;QAEvC,IAAID,SAAS;YACX,uEAAuE;YACvER,SACEU,cAAc;gBACZ,GAAGN,IAAI;gBACPO,UAAU;YACZ;QAEJ,OAAO;YACL,kDAAkD;YAClDX,SACEU,cAAc;gBACZ,GAAGN,IAAI;gBACPO,UAAU;YACZ;QAEJ;IACF;IAEA,MAAMC,uBAAuB;QAC3BZ,SACEa,IAAAA,gCAAiB,EAAC;YAChB,GAAGT,IAAI;YACPU,QAAQ;YACRH,UAAU;QACZ;IAEJ;IAEA,4DAA4D;IAC5D,MAAMI,WAAWC,IAAAA,wCAAwB,EAACZ;IAE1C,qBACE,qBAACa,4CAAqB;QACpBC,WAAU;QACVC,OAAOf,KAAKgB,MAAM,EAAEC,UAAU,CAAC,EAAE,IAAIjB,KAAKkB,IAAI,EAAED,UAAU,CAAC,EAAE,IAAI;QACjEE,OAAOnB,KAAKoB,IAAI,IAAIpB,KAAKmB,KAAK;QAC9BE,OAAOrB,KAAKqB,KAAK;QACjBC,OAAOX,SAASY,QAAQ,GAAGC,KAAKC,KAAK,CAACzB,KAAKsB,KAAK,GAAI,CAAA,IAAIX,SAASY,QAAQ,GAAG,GAAE,KAAMZ,SAASe,YAAY;QACzGC,eAAehB,SAASY,QAAQ,GAAGvB,KAAKsB,KAAK,GAAGM;QAChDL,UAAUZ,SAASY,QAAQ,GAAG,GAAGZ,SAASY,QAAQ,CAAC,CAAC,CAAC,GAAGK;QACxDC,OAAOlB,SAASkB,KAAK;QACrBC,OAAOnB,SAASmB,KAAK;QACrBC,WAAW/B,KAAKK,EAAE;QAClB2B,KAAI;QACJC,aAAa9B;QACb+B,mBAAmB;QACnB,mCAAmC;QACnCC,cAAcxB,SAASe,YAAY,IAAI,OAAO;YAC5CnB,UAAU;YACV6B,QAAQZ,KAAKC,KAAK,CAACd,SAASe,YAAY,GAAG;YAC3CW,cAAc;QAChB,IAAIT;QACJ,mDAAmD;QACnDU,cAAc3B,SAAS2B,YAAY,IAAI3B,SAASe,YAAY,IAAI;QAChEa,cAAc5B,SAAS2B,YAAY,GAAG,iBAAiB3B,SAAS6B,YAAY,GAAG,iBAAiBZ;;AAGtG;MAEA,WAAetC"}