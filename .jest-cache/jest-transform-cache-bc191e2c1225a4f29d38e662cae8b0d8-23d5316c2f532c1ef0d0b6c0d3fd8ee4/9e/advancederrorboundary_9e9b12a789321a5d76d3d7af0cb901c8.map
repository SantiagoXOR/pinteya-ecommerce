{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\lib\\error-boundary\\advanced-error-boundary.tsx"],"sourcesContent":["'use client'\n\n// ===================================\n// ADVANCED ERROR BOUNDARY SYSTEM\n// ===================================\n// Sistema avanzado de manejo de errores con recuperaci√≥n autom√°tica\n\nimport React, { Component, ReactNode, ErrorInfo } from 'react'\nimport { AlertTriangle, RefreshCw, Home, Bug, Mail } from 'lucide-react'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert'\n\n// ===================================\n// INTERFACES Y TIPOS\n// ===================================\n\nexport interface ErrorBoundaryState {\n  hasError: boolean\n  error: Error | null\n  errorInfo: ErrorInfo | null\n  errorId: string\n  retryCount: number\n  lastErrorTime: number\n  errorType: 'component' | 'chunk' | 'network' | 'unknown'\n  recoveryStrategy: 'retry' | 'fallback' | 'redirect' | 'reload'\n}\n\nexport interface ErrorBoundaryProps {\n  children: ReactNode\n  fallback?: ReactNode\n  onError?: (error: Error, errorInfo: ErrorInfo, errorId: string) => void\n  enableRetry?: boolean\n  maxRetries?: number\n  retryDelay?: number\n  enableAutoRecovery?: boolean\n  recoveryTimeout?: number\n  level?: 'page' | 'section' | 'component'\n  context?: string\n  enableReporting?: boolean\n}\n\nexport interface ErrorReport {\n  errorId: string\n  timestamp: number\n  error: {\n    name: string\n    message: string\n    stack?: string\n  }\n  errorInfo: {\n    componentStack: string\n  }\n  context: {\n    level: string\n    component: string\n    url: string\n    userAgent: string\n    userId?: string\n  }\n  recovery: {\n    strategy: string\n    retryCount: number\n    successful: boolean\n  }\n  performance: {\n    timeToError: number\n    memoryUsage?: number\n  }\n}\n\n// ===================================\n// ERROR BOUNDARY PRINCIPAL\n// ===================================\n\nexport class AdvancedErrorBoundary extends Component<ErrorBoundaryProps, ErrorBoundaryState> {\n  private retryTimeoutId: NodeJS.Timeout | null = null\n  private recoveryTimeoutId: NodeJS.Timeout | null = null\n  private startTime: number = Date.now()\n\n  constructor(props: ErrorBoundaryProps) {\n    super(props)\n\n    this.state = {\n      hasError: false,\n      error: null,\n      errorInfo: null,\n      errorId: '',\n      retryCount: 0,\n      lastErrorTime: 0,\n      errorType: 'unknown',\n      recoveryStrategy: 'retry',\n    }\n  }\n\n  static getDerivedStateFromError(error: Error): Partial<ErrorBoundaryState> {\n    const errorId = `error_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`\n    const errorType = AdvancedErrorBoundary.classifyError(error)\n    const recoveryStrategy = AdvancedErrorBoundary.determineRecoveryStrategy(error, errorType)\n\n    return {\n      hasError: true,\n      error,\n      errorId,\n      errorType,\n      recoveryStrategy,\n      lastErrorTime: Date.now(),\n    }\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    const { onError, enableReporting = true } = this.props\n\n    this.setState({ errorInfo })\n\n    // Reportar error\n    if (enableReporting) {\n      this.reportError(error, errorInfo)\n    }\n\n    // Callback personalizado\n    if (onError) {\n      onError(error, errorInfo, this.state.errorId)\n    }\n\n    // Intentar recuperaci√≥n autom√°tica\n    if (this.props.enableAutoRecovery) {\n      this.attemptAutoRecovery()\n    }\n\n    console.error('üö® Error Boundary caught an error:', error)\n    console.error('üìç Error Info:', errorInfo)\n  }\n\n  componentWillUnmount() {\n    if (this.retryTimeoutId) {\n      clearTimeout(this.retryTimeoutId)\n    }\n    if (this.recoveryTimeoutId) {\n      clearTimeout(this.recoveryTimeoutId)\n    }\n  }\n\n  // ===================================\n  // M√âTODOS DE CLASIFICACI√ìN\n  // ===================================\n\n  static classifyError(error: Error): ErrorBoundaryState['errorType'] {\n    const message = error.message.toLowerCase()\n    const stack = error.stack?.toLowerCase() || ''\n\n    // Error de chunk loading (lazy loading)\n    if (message.includes('loading chunk') || message.includes('loading css chunk')) {\n      return 'chunk'\n    }\n\n    // Error de red\n    if (message.includes('network') || message.includes('fetch') || message.includes('timeout')) {\n      return 'network'\n    }\n\n    // Error de componente\n    if (stack.includes('react') || message.includes('render') || message.includes('component')) {\n      return 'component'\n    }\n\n    return 'unknown'\n  }\n\n  static determineRecoveryStrategy(\n    error: Error,\n    errorType: ErrorBoundaryState['errorType']\n  ): ErrorBoundaryState['recoveryStrategy'] {\n    switch (errorType) {\n      case 'chunk':\n        return 'reload' // Recargar para obtener chunks actualizados\n      case 'network':\n        return 'retry' // Reintentar operaci√≥n de red\n      case 'component':\n        return 'fallback' // Mostrar UI de fallback\n      default:\n        return 'retry'\n    }\n  }\n\n  // ===================================\n  // M√âTODOS DE RECUPERACI√ìN\n  // ===================================\n\n  attemptAutoRecovery = () => {\n    const { recoveryTimeout = 5000 } = this.props\n    const { recoveryStrategy } = this.state\n\n    this.recoveryTimeoutId = setTimeout(() => {\n      switch (recoveryStrategy) {\n        case 'retry':\n          this.handleRetry()\n          break\n        case 'reload':\n          window.location.reload()\n          break\n        case 'redirect':\n          window.location.href = '/'\n          break\n        default:\n          // Fallback ya se maneja en render\n          break\n      }\n    }, recoveryTimeout)\n  }\n\n  handleRetry = () => {\n    const { maxRetries = 3, retryDelay = 1000 } = this.props\n    const { retryCount } = this.state\n\n    if (retryCount >= maxRetries) {\n      console.warn('üîÑ Max retries reached, showing fallback UI')\n      return\n    }\n\n    this.retryTimeoutId = setTimeout(\n      () => {\n        this.setState(prevState => ({\n          hasError: false,\n          error: null,\n          errorInfo: null,\n          retryCount: prevState.retryCount + 1,\n        }))\n      },\n      retryDelay * (retryCount + 1)\n    ) // Backoff exponencial\n  }\n\n  handleManualRetry = () => {\n    this.setState({\n      hasError: false,\n      error: null,\n      errorInfo: null,\n      retryCount: 0,\n    })\n  }\n\n  handleReload = () => {\n    window.location.reload()\n  }\n\n  handleGoHome = () => {\n    window.location.href = '/'\n  }\n\n  // ===================================\n  // REPORTE DE ERRORES\n  // ===================================\n\n  reportError = async (error: Error, errorInfo: ErrorInfo) => {\n    try {\n      const report: ErrorReport = {\n        errorId: this.state.errorId,\n        timestamp: Date.now(),\n        error: {\n          name: error.name,\n          message: error.message,\n          stack: error.stack,\n        },\n        errorInfo: {\n          componentStack: errorInfo.componentStack,\n        },\n        context: {\n          level: this.props.level || 'component',\n          component: this.props.context || 'unknown',\n          url: window.location.href,\n          userAgent: navigator.userAgent,\n          userId: this.getUserId(),\n        },\n        recovery: {\n          strategy: this.state.recoveryStrategy,\n          retryCount: this.state.retryCount,\n          successful: false,\n        },\n        performance: {\n          timeToError: Date.now() - this.startTime,\n          memoryUsage: this.getMemoryUsage(),\n        },\n      }\n\n      // Enviar reporte al sistema de monitoreo\n      await this.sendErrorReport(report)\n    } catch (reportError) {\n      console.error('‚ùå Failed to report error:', reportError)\n    }\n  }\n\n  private getUserId(): string | undefined {\n    // Intentar obtener ID de usuario de diferentes fuentes\n    try {\n      // Clerk\n      const clerkUser = (window as any).__clerk_user\n      if (clerkUser?.id) {\n        return clerkUser.id\n      }\n\n      // LocalStorage\n      const storedUser = localStorage.getItem('user')\n      if (storedUser) {\n        const user = JSON.parse(storedUser)\n        return user.id\n      }\n\n      return undefined\n    } catch {\n      return undefined\n    }\n  }\n\n  private getMemoryUsage(): number | undefined {\n    try {\n      if ('memory' in performance) {\n        return (performance as any).memory.usedJSHeapSize\n      }\n      return undefined\n    } catch {\n      return undefined\n    }\n  }\n\n  private async sendErrorReport(report: ErrorReport): Promise<void> {\n    try {\n      await fetch('/api/monitoring/errors', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(report),\n      })\n    } catch (error) {\n      console.error('‚ùå Failed to send error report:', error)\n    }\n  }\n\n  // ===================================\n  // RENDER\n  // ===================================\n\n  render() {\n    const { hasError, error, errorType, recoveryStrategy, retryCount } = this.state\n    const {\n      children,\n      fallback,\n      enableRetry = true,\n      maxRetries = 3,\n      level = 'component',\n    } = this.props\n\n    if (hasError && error) {\n      // Si hay un fallback personalizado, usarlo\n      if (fallback) {\n        return fallback\n      }\n\n      // Renderizar UI de error apropiada seg√∫n el nivel\n      return this.renderErrorUI(\n        error,\n        errorType,\n        recoveryStrategy,\n        retryCount,\n        maxRetries,\n        enableRetry,\n        level\n      )\n    }\n\n    return children\n  }\n\n  private renderErrorUI(\n    error: Error,\n    errorType: ErrorBoundaryState['errorType'],\n    recoveryStrategy: ErrorBoundaryState['recoveryStrategy'],\n    retryCount: number,\n    maxRetries: number,\n    enableRetry: boolean,\n    level: string\n  ) {\n    const isPageLevel = level === 'page'\n    const canRetry = enableRetry && retryCount < maxRetries\n\n    if (isPageLevel) {\n      return this.renderPageErrorUI(error, errorType, canRetry)\n    } else {\n      return this.renderComponentErrorUI(error, errorType, canRetry)\n    }\n  }\n\n  private renderPageErrorUI(\n    error: Error,\n    errorType: ErrorBoundaryState['errorType'],\n    canRetry: boolean\n  ) {\n    return (\n      <div className='min-h-screen flex items-center justify-center bg-gray-50 px-4'>\n        <Card className='w-full max-w-md'>\n          <CardHeader className='text-center'>\n            <div className='mx-auto w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-4'>\n              <AlertTriangle className='w-6 h-6 text-red-600' />\n            </div>\n            <CardTitle className='text-xl'>¬°Oops! Algo sali√≥ mal</CardTitle>\n            <CardDescription>{this.getErrorMessage(errorType)}</CardDescription>\n          </CardHeader>\n          <CardContent className='space-y-4'>\n            <Alert>\n              <Bug className='h-4 w-4' />\n              <AlertTitle>Detalles del Error</AlertTitle>\n              <AlertDescription className='text-sm'>\n                ID: {this.state.errorId}\n                <br />\n                Tipo: {errorType}\n                <br />\n                {process.env.NODE_ENV === 'development' && <>Mensaje: {error.message}</>}\n              </AlertDescription>\n            </Alert>\n\n            <div className='flex flex-col gap-2'>\n              {canRetry && (\n                <Button onClick={this.handleManualRetry} className='w-full'>\n                  <RefreshCw className='w-4 h-4 mr-2' />\n                  Intentar de nuevo\n                </Button>\n              )}\n              <Button variant='outline' onClick={this.handleGoHome} className='w-full'>\n                <Home className='w-4 h-4 mr-2' />\n                Ir al inicio\n              </Button>\n              <Button variant='outline' onClick={this.handleReload} className='w-full'>\n                <RefreshCw className='w-4 h-4 mr-2' />\n                Recargar p√°gina\n              </Button>\n            </div>\n\n            <div className='text-center'>\n              <Button variant='link' size='sm' onClick={() => this.reportIssue()}>\n                <Mail className='w-4 h-4 mr-2' />\n                Reportar problema\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    )\n  }\n\n  private renderComponentErrorUI(\n    error: Error,\n    errorType: ErrorBoundaryState['errorType'],\n    canRetry: boolean\n  ) {\n    return (\n      <div className='p-4 border border-red-200 rounded-lg bg-red-50'>\n        <div className='flex items-center gap-2 mb-2'>\n          <AlertTriangle className='w-4 h-4 text-red-600' />\n          <span className='text-sm font-medium text-red-800'>Error en componente</span>\n        </div>\n        <p className='text-sm text-red-700 mb-3'>{this.getErrorMessage(errorType)}</p>\n        {canRetry && (\n          <Button size='sm' variant='outline' onClick={this.handleManualRetry}>\n            <RefreshCw className='w-3 h-3 mr-1' />\n            Reintentar\n          </Button>\n        )}\n      </div>\n    )\n  }\n\n  private getErrorMessage(errorType: ErrorBoundaryState['errorType']): string {\n    switch (errorType) {\n      case 'chunk':\n        return 'Error cargando recursos. La p√°gina se recargar√° autom√°ticamente.'\n      case 'network':\n        return 'Error de conexi√≥n. Verifica tu conexi√≥n a internet.'\n      case 'component':\n        return 'Error en el componente. Intentando recuperaci√≥n autom√°tica.'\n      default:\n        return 'Ha ocurrido un error inesperado. Estamos trabajando para solucionarlo.'\n    }\n  }\n\n  private reportIssue = () => {\n    const subject = `Error Report - ${this.state.errorId}`\n    const body = `Error ID: ${this.state.errorId}\\nTipo: ${this.state.errorType}\\nURL: ${window.location.href}\\nFecha: ${new Date().toISOString()}`\n    const mailtoUrl = `mailto:soporte@pinteya.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`\n    window.open(mailtoUrl)\n  }\n}\n"],"names":["AdvancedErrorBoundary","Component","props","retryTimeoutId","recoveryTimeoutId","startTime","Date","now","attemptAutoRecovery","recoveryTimeout","recoveryStrategy","state","setTimeout","handleRetry","window","location","reload","href","maxRetries","retryDelay","retryCount","console","warn","setState","prevState","hasError","error","errorInfo","handleManualRetry","handleReload","handleGoHome","reportError","report","errorId","timestamp","name","message","stack","componentStack","context","level","component","url","userAgent","navigator","userId","getUserId","recovery","strategy","successful","performance","timeToError","memoryUsage","getMemoryUsage","sendErrorReport","reportIssue","subject","body","errorType","toISOString","mailtoUrl","encodeURIComponent","open","lastErrorTime","getDerivedStateFromError","Math","random","toString","substr","classifyError","determineRecoveryStrategy","componentDidCatch","onError","enableReporting","enableAutoRecovery","componentWillUnmount","clearTimeout","toLowerCase","includes","clerkUser","__clerk_user","id","storedUser","localStorage","getItem","user","JSON","parse","undefined","memory","usedJSHeapSize","fetch","method","headers","stringify","render","children","fallback","enableRetry","renderErrorUI","isPageLevel","canRetry","renderPageErrorUI","renderComponentErrorUI","div","className","Card","CardHeader","AlertTriangle","CardTitle","CardDescription","getErrorMessage","CardContent","Alert","Bug","AlertTitle","AlertDescription","br","process","env","NODE_ENV","Button","onClick","RefreshCw","variant","Home","size","Mail","span","p"],"mappings":"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"}