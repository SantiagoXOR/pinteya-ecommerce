{"version":3,"sources":["C:\\Users\\marti\\Desktop\\DESARROLLOSW\\BOILERPLATTE E-COMMERCE\\src\\__tests__\\components\\ProductItem.test.tsx"],"sourcesContent":["// ===================================\n// PINTEYA E-COMMERCE - TESTS PARA PRODUCTITEM COMPONENT\n// ===================================\n\nimport React from 'react'\nimport { render, screen, fireEvent, act } from '@testing-library/react'\nimport { Provider } from 'react-redux'\nimport { configureStore } from '@reduxjs/toolkit'\nimport ProductItem from '@/components/Common/ProductItem'\nimport cartReducer from '@/redux/features/cart-slice'\nimport wishlistReducer from '@/redux/features/wishlist-slice'\nimport quickViewReducer from '@/redux/features/quickView-slice'\nimport productDetailsReducer from '@/redux/features/product-details'\nimport { Product } from '@/types/product'\n\n// Mock del contexto de modal - Eliminado ya que QuickViewModalContext fue removido\n// const mockOpenModal = jest.fn();\n// jest.mock('@/app/context/QuickViewModalContext', () => ({\n//   useModalContext: () => ({\n//     openModal: mockOpenModal,\n//   }),\n// }));\n\n// Mock de Next.js Link\njest.mock('next/link', () => {\n  return ({ children, href }: { children: React.ReactNode; href: string }) => (\n    <a href={href}>{children}</a>\n  )\n})\n\n// Mock de Next.js Image\njest.mock('next/image', () => {\n  return ({\n    src,\n    alt,\n    width,\n    height,\n  }: {\n    src: string\n    alt: string\n    width: number\n    height: number\n  }) => <img src={src} alt={alt} width={width} height={height} />\n})\n\n// Producto de prueba\nconst mockProduct: Product = {\n  id: 1,\n  title: 'Pintura Latex Interior Blanco 4L',\n  reviews: 25,\n  price: 18000,\n  discountedPrice: 15000,\n  imgs: {\n    thumbnails: ['/images/products/pintura-latex-blanco-sm.jpg'],\n    previews: ['/images/products/pintura-latex-blanco.jpg'],\n  },\n}\n\n// Función helper para renderizar con Redux store\nconst renderWithStore = (component: React.ReactElement, initialState = {}) => {\n  const store = configureStore({\n    reducer: {\n      cartReducer,\n      wishlistReducer,\n      quickViewReducer,\n      productDetailsReducer,\n    },\n    preloadedState: initialState,\n  })\n\n  return render(<Provider store={store}>{component}</Provider>)\n}\n\ndescribe('ProductItem Component', () => {\n  beforeEach(() => {\n    jest.clearAllMocks()\n  })\n\n  it('should render product information correctly', async () => {\n    await act(async () => {\n      renderWithStore(<ProductItem item={mockProduct} />)\n    })\n\n    expect(screen.getByText('Pintura Latex Interior Blanco 4L')).toBeInTheDocument()\n    expect(\n      screen.getByText((content, element) => {\n        return element?.textContent === '$ 15.000' || content.includes('15.000')\n      })\n    ).toBeInTheDocument()\n    expect(\n      screen.getByText((content, element) => {\n        return element?.textContent === '$ 18.000' || content.includes('18.000')\n      })\n    ).toBeInTheDocument()\n\n    // Buscar la imagen principal del producto\n    const productImage = screen.getByAltText('Pintura Latex Interior Blanco 4L')\n    expect(productImage).toHaveAttribute('src', '/images/products/pintura-latex-blanco.jpg')\n  })\n\n  it('should display product image', async () => {\n    await act(async () => {\n      renderWithStore(<ProductItem item={mockProduct} />)\n    })\n\n    // Buscar la imagen principal del producto por su alt text\n    const productImage = screen.getByAltText('Pintura Latex Interior Blanco 4L')\n    expect(productImage).toBeInTheDocument()\n    expect(productImage).toHaveAttribute('src', '/images/products/pintura-latex-blanco.jpg')\n    expect(productImage).toHaveClass('object-contain', 'w-full', 'h-full')\n  })\n\n  it('should show discounted price and original price', async () => {\n    await act(async () => {\n      renderWithStore(<ProductItem item={mockProduct} />)\n    })\n\n    // Precio con descuento (formateado con puntos)\n    expect(\n      screen.getByText((content, element) => {\n        return element?.textContent === '$ 15.000' || content.includes('15.000')\n      })\n    ).toBeInTheDocument()\n    // Precio original tachado (formateado con puntos)\n    expect(\n      screen.getByText((content, element) => {\n        return element?.textContent === '$ 18.000' || content.includes('18.000')\n      })\n    ).toBeInTheDocument()\n  })\n\n  it('should handle add to cart action', async () => {\n    const store = configureStore({\n      reducer: {\n        cartReducer,\n        wishlistReducer,\n        quickViewReducer,\n        productDetailsReducer,\n      },\n    })\n\n    await act(async () => {\n      render(\n        <Provider store={store}>\n          <ProductItem item={mockProduct} />\n        </Provider>\n      )\n    })\n\n    const addToCartButton = screen.getByText('Agregar al carrito')\n\n    await act(async () => {\n      fireEvent.click(addToCartButton)\n    })\n\n    // Verificar que el producto se agregó al carrito\n    const state = store.getState()\n    expect(state.cartReducer.items).toHaveLength(1)\n    expect(state.cartReducer.items[0].id).toBe(mockProduct.id)\n    expect(state.cartReducer.items[0].quantity).toBe(1)\n  })\n\n  it('should handle add to wishlist action', async () => {\n    const store = configureStore({\n      reducer: {\n        cartReducer,\n        wishlistReducer,\n        quickViewReducer,\n        productDetailsReducer,\n      },\n    })\n\n    await act(async () => {\n      render(\n        <Provider store={store}>\n          <ProductItem item={mockProduct} />\n        </Provider>\n      )\n    })\n\n    // El ProductCard unificado no tiene botón de wishlist visible\n    // Solo verifica que el componente se renderiza correctamente\n    expect(screen.getByTestId('commercial-product-card')).toBeInTheDocument()\n    expect(screen.getByText('Pintura Latex Interior Blanco 4L')).toBeInTheDocument()\n  })\n\n  it('should handle quick view action', async () => {\n    const store = configureStore({\n      reducer: {\n        cartReducer,\n        wishlistReducer,\n        quickViewReducer,\n        productDetailsReducer,\n      },\n    })\n\n    await act(async () => {\n      render(\n        <Provider store={store}>\n          <ProductItem item={mockProduct} />\n        </Provider>\n      )\n    })\n\n    // El ProductCard unificado no tiene botón de quick view visible\n    // Solo verifica que el componente se renderiza correctamente\n    expect(screen.getByTestId('commercial-product-card')).toBeInTheDocument()\n    expect(screen.getByText('Pintura Latex Interior Blanco 4L')).toBeInTheDocument()\n  })\n\n  it('should handle product details navigation', async () => {\n    await act(async () => {\n      renderWithStore(<ProductItem item={mockProduct} />)\n    })\n\n    const productTitle = screen.getByText('Pintura Latex Interior Blanco 4L')\n\n    await act(async () => {\n      fireEvent.click(productTitle)\n    })\n\n    // El ProductCard unificado no tiene link directo, solo el botón de agregar al carrito\n    const addToCartButton = screen.getByTestId('add-to-cart-btn')\n    expect(addToCartButton).toBeInTheDocument()\n  })\n\n  it('should show hover effects on buttons', async () => {\n    await act(async () => {\n      renderWithStore(<ProductItem item={mockProduct} />)\n    })\n\n    const addToCartButton = screen.getByTestId('add-to-cart-btn')\n    expect(addToCartButton).toHaveClass('bg-yellow-400')\n\n    // El ProductCard unificado no tiene botón de wishlist visible\n    expect(addToCartButton).toBeInTheDocument()\n  })\n\n  it('should handle product without discount', async () => {\n    const productWithoutDiscount: Product = {\n      ...mockProduct,\n      discountedPrice: mockProduct.price, // Sin descuento\n    }\n\n    await act(async () => {\n      renderWithStore(<ProductItem item={productWithoutDiscount} />)\n    })\n\n    // Solo debería mostrar un precio (sin descuento)\n    expect(\n      screen.getByText((content, element) => {\n        return element?.textContent === '$ 18.000' || content.includes('18.000')\n      })\n    ).toBeInTheDocument()\n    // No debería haber precio tachado\n    expect(screen.queryByText('line-through')).not.toBeInTheDocument()\n  })\n\n  it('should handle missing images gracefully', async () => {\n    const productWithoutImages: Product = {\n      ...mockProduct,\n      imgs: {\n        thumbnails: [],\n        previews: [],\n      },\n    }\n\n    await act(async () => {\n      renderWithStore(<ProductItem item={productWithoutImages} />)\n    })\n\n    // El componente debería renderizar sin errores\n    expect(screen.getByText('Pintura Latex Interior Blanco 4L')).toBeInTheDocument()\n  })\n\n  it('should have proper accessibility attributes', async () => {\n    await act(async () => {\n      renderWithStore(<ProductItem item={mockProduct} />)\n    })\n\n    // El ProductCard unificado tiene diferentes atributos de accesibilidad\n    const addToCartButton = screen.getByTestId('add-to-cart-btn')\n    expect(addToCartButton).toBeInTheDocument()\n\n    const productCard = screen.getByTestId('commercial-product-card')\n    expect(productCard).toBeInTheDocument()\n  })\n})\n"],"names":["jest","mock","children","href","a","src","alt","width","height","img","mockProduct","id","title","reviews","price","discountedPrice","imgs","thumbnails","previews","renderWithStore","component","initialState","store","configureStore","reducer","cartReducer","wishlistReducer","quickViewReducer","productDetailsReducer","preloadedState","render","Provider","describe","beforeEach","clearAllMocks","it","act","ProductItem","item","expect","screen","getByText","toBeInTheDocument","content","element","textContent","includes","productImage","getByAltText","toHaveAttribute","toHaveClass","addToCartButton","fireEvent","click","state","getState","items","toHaveLength","toBe","quantity","getByTestId","productTitle","productWithoutDiscount","queryByText","not","productWithoutImages","productCard"],"mappings":"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"}