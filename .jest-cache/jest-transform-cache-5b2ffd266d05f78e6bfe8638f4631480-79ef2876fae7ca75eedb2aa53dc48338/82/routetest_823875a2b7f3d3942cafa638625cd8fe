4881bfeffa7502312737802b67b26361
// ðŸ§ª Enterprise Unit Tests - Individual Product API
"use strict";
// Mock dependencies
jest.mock('@/lib/auth/admin-auth', ()=>({
        checkCRUDPermissions: jest.fn()
    }));
jest.mock('@supabase/supabase-js', ()=>({
        createClient: jest.fn(()=>({
                from: jest.fn(()=>({
                        select: jest.fn(()=>({
                                eq: jest.fn(()=>({
                                        single: jest.fn()
                                    }))
                            })),
                        update: jest.fn(()=>({
                                eq: jest.fn(()=>({
                                        select: jest.fn(()=>({
                                                single: jest.fn()
                                            }))
                                    }))
                            })),
                        delete: jest.fn(()=>({
                                eq: jest.fn()
                            }))
                    }))
            }))
    }));
// Mock middleware
jest.mock('@/lib/api/middleware-composer', ()=>({
        composeMiddlewares: jest.fn((...middlewares)=>(handler)=>handler)
    }));
jest.mock('@/lib/api/error-handler', ()=>({
        withErrorHandler: jest.fn((handler)=>handler),
        ApiError: class ApiError extends Error {
            constructor(message, statusCode = 500){
                super(message), this.statusCode = statusCode;
            }
        },
        NotFoundError: jest.fn((resource)=>new Error(`${resource} no encontrado`)),
        ValidationError: jest.fn((message)=>new Error(message))
    }));
jest.mock('@/lib/api/api-logger', ()=>({
        withApiLogging: jest.fn((handler)=>handler),
        logAdminAction: jest.fn()
    }));
jest.mock('@/lib/auth/api-auth-middleware', ()=>({
        withAdminAuth: jest.fn(()=>(handler)=>handler)
    }));
jest.mock('@/lib/validation/admin-schemas', ()=>({
        withValidation: jest.fn(()=>(handler)=>handler)
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _route = require("../route");
describe('/api/admin/products/[id] - Enterprise API Tests', ()=>{
    let mockSupabase;
    let mockRequest;
    beforeEach(()=>{
        jest.clearAllMocks();
        mockSupabase = {
            from: jest.fn(()=>({
                    select: jest.fn(()=>({
                            eq: jest.fn(()=>({
                                    single: jest.fn()
                                }))
                        })),
                    update: jest.fn(()=>({
                            eq: jest.fn(()=>({
                                    select: jest.fn(()=>({
                                            single: jest.fn()
                                        }))
                                }))
                        })),
                    delete: jest.fn(()=>({
                            eq: jest.fn()
                        }))
                }))
        };
        mockRequest = {
            supabase: mockSupabase,
            user: {
                id: 'test-user-id'
            },
            validatedData: {}
        };
    });
    describe('GET /api/admin/products/[id]', ()=>{
        it('should return product successfully', async ()=>{
            const mockProduct = {
                id: 'test-product-id',
                name: 'Test Product',
                price: 100,
                stock: 10,
                categories: {
                    name: 'Test Category'
                }
            };
            mockSupabase.from().select().eq().single.mockResolvedValue({
                data: mockProduct,
                error: null
            });
            const response = await (0, _route.GET)(mockRequest, {
                params: {
                    id: 'test-product-id'
                }
            });
            const responseData = await response.json();
            expect(response.status).toBe(200);
            expect(responseData.success).toBe(true);
            expect(responseData.data.name).toBe('Test Product');
            expect(responseData.data.category_name).toBe('Test Category');
        });
        it('should handle product not found', async ()=>{
            mockSupabase.from().select().eq().single.mockResolvedValue({
                data: null,
                error: {
                    message: 'Not found'
                }
            });
            await expect((0, _route.GET)(mockRequest, {
                params: {
                    id: 'non-existent-id'
                }
            })).rejects.toThrow('Producto no encontrado');
        });
        it('should validate product ID format', async ()=>{
            await expect((0, _route.GET)(mockRequest, {
                params: {
                    id: 'invalid-uuid'
                }
            })).rejects.toThrow('ID de producto invÃ¡lido');
        });
    });
    describe('PUT /api/admin/products/[id]', ()=>{
        beforeEach(()=>{
            mockRequest.validatedData = {
                name: 'Updated Product',
                price: 150,
                stock: 20
            };
            // Mock existing product check
            mockSupabase.from().select().eq().single.mockResolvedValueOnce({
                data: {
                    id: 'test-product-id',
                    name: 'Original Product'
                },
                error: null
            }).mockResolvedValueOnce({
                data: {
                    id: 'category-id'
                },
                error: null
            });
        });
        it('should update product successfully', async ()=>{
            const mockUpdatedProduct = {
                id: 'test-product-id',
                name: 'Updated Product',
                price: 150,
                stock: 20,
                categories: {
                    name: 'Test Category'
                }
            };
            mockSupabase.from().update().eq().select().single.mockResolvedValue({
                data: mockUpdatedProduct,
                error: null
            });
            const response = await (0, _route.PUT)(mockRequest, {
                params: {
                    id: 'test-product-id'
                }
            });
            const responseData = await response.json();
            expect(response.status).toBe(200);
            expect(responseData.success).toBe(true);
            expect(responseData.data.name).toBe('Updated Product');
            expect(responseData.message).toBe('Producto actualizado exitosamente');
        });
        it('should generate slug when name is updated', async ()=>{
            mockRequest.validatedData.name = 'New Product Name!';
            mockSupabase.from().update().eq().select().single.mockResolvedValue({
                data: {
                    id: 'test-product-id',
                    slug: 'new-product-name'
                },
                error: null
            });
            await (0, _route.PUT)(mockRequest, {
                params: {
                    id: 'test-product-id'
                }
            });
            expect(mockSupabase.from().update).toHaveBeenCalledWith(expect.objectContaining({
                slug: 'new-product-name'
            }));
        });
        it('should validate category exists when updating category_id', async ()=>{
            mockRequest.validatedData.category_id = 'invalid-category-id';
            mockSupabase.from().select().eq().single.mockResolvedValueOnce({
                data: {
                    id: 'test-product-id'
                },
                error: null
            }).mockResolvedValueOnce({
                data: null,
                error: {
                    message: 'Not found'
                }
            });
            await expect((0, _route.PUT)(mockRequest, {
                params: {
                    id: 'test-product-id'
                }
            })).rejects.toThrow('CategorÃ­a no encontrada');
        });
        it('should handle database update errors', async ()=>{
            mockSupabase.from().update().eq().select().single.mockResolvedValue({
                data: null,
                error: {
                    message: 'Database error'
                }
            });
            await expect((0, _route.PUT)(mockRequest, {
                params: {
                    id: 'test-product-id'
                }
            })).rejects.toThrow('Error al actualizar producto');
        });
    });
    describe('DELETE /api/admin/products/[id]', ()=>{
        beforeEach(()=>{
            // Mock existing product check
            mockSupabase.from().select().eq().single.mockResolvedValue({
                data: {
                    id: 'test-product-id',
                    name: 'Test Product'
                },
                error: null
            });
        });
        it('should perform soft delete when product has orders', async ()=>{
            // Mock order items check - product has orders
            mockSupabase.from().select().eq().limit.mockResolvedValue({
                data: [
                    {
                        id: 'order-item-id'
                    }
                ],
                error: null
            });
            // Mock soft delete update
            mockSupabase.from().update().eq.mockResolvedValue({
                error: null
            });
            const response = await (0, _route.DELETE)(mockRequest, {
                params: {
                    id: 'test-product-id'
                }
            });
            const responseData = await response.json();
            expect(response.status).toBe(200);
            expect(responseData.success).toBe(true);
            expect(responseData.soft_delete).toBe(true);
            expect(responseData.message).toContain('marcado como inactivo');
        });
        it('should perform hard delete when product has no orders', async ()=>{
            // Mock order items check - no orders
            mockSupabase.from().select().eq().limit.mockResolvedValue({
                data: [],
                error: null
            });
            // Mock hard delete
            mockSupabase.from().delete().eq.mockResolvedValue({
                error: null
            });
            const response = await (0, _route.DELETE)(mockRequest, {
                params: {
                    id: 'test-product-id'
                }
            });
            const responseData = await response.json();
            expect(response.status).toBe(200);
            expect(responseData.success).toBe(true);
            expect(responseData.hard_delete).toBe(true);
            expect(responseData.message).toBe('Producto eliminado exitosamente');
        });
        it('should handle delete errors gracefully', async ()=>{
            mockSupabase.from().select().eq().limit.mockResolvedValue({
                data: [],
                error: null
            });
            mockSupabase.from().delete().eq.mockResolvedValue({
                error: {
                    message: 'Delete failed'
                }
            });
            await expect((0, _route.DELETE)(mockRequest, {
                params: {
                    id: 'test-product-id'
                }
            })).rejects.toThrow('Error al eliminar producto');
        });
    });
    describe('Error Handling', ()=>{
        it('should handle invalid UUID format', async ()=>{
            await expect((0, _route.GET)(mockRequest, {
                params: {
                    id: 'not-a-uuid'
                }
            })).rejects.toThrow('ID de producto invÃ¡lido');
        });
        it('should handle missing product ID', async ()=>{
            await expect((0, _route.GET)(mockRequest, {
                params: {
                    id: ''
                }
            })).rejects.toThrow('ID de producto invÃ¡lido');
        });
        it('should handle database connection errors', async ()=>{
            mockSupabase.from().select().eq().single.mockRejectedValue(new Error('Database connection failed'));
            await expect((0, _route.GET)(mockRequest, {
                params: {
                    id: 'test-product-id'
                }
            })).rejects.toThrow('Database connection failed');
        });
    });
    describe('Audit Logging', ()=>{
        it('should log update actions', async ()=>{
            const { logAdminAction } = require('@/lib/api/api-logger');
            mockSupabase.from().select().eq().single.mockResolvedValue({
                data: {
                    id: 'test-product-id',
                    name: 'Original'
                },
                error: null
            });
            mockSupabase.from().update().eq().select().single.mockResolvedValue({
                data: {
                    id: 'test-product-id',
                    name: 'Updated'
                },
                error: null
            });
            await (0, _route.PUT)(mockRequest, {
                params: {
                    id: 'test-product-id'
                }
            });
            expect(logAdminAction).toHaveBeenCalledWith('test-user-id', 'UPDATE', 'product', 'test-product-id', expect.any(Object), expect.any(Object));
        });
        it('should log delete actions', async ()=>{
            const { logAdminAction } = require('@/lib/api/api-logger');
            mockSupabase.from().select().eq().limit.mockResolvedValue({
                data: [],
                error: null
            });
            mockSupabase.from().delete().eq.mockResolvedValue({
                error: null
            });
            await (0, _route.DELETE)(mockRequest, {
                params: {
                    id: 'test-product-id'
                }
            });
            expect(logAdminAction).toHaveBeenCalledWith('test-user-id', 'DELETE', 'product', 'test-product-id', expect.any(Object), null);
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcYXBwXFxhcGlcXGFkbWluXFxwcm9kdWN0c1xcW2lkXVxcX190ZXN0c19fXFxyb3V0ZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIPCfp6ogRW50ZXJwcmlzZSBVbml0IFRlc3RzIC0gSW5kaXZpZHVhbCBQcm9kdWN0IEFQSVxuXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IEdFVCwgUFVULCBERUxFVEUgfSBmcm9tICcuLi9yb3V0ZSc7XG5pbXBvcnQgeyBjcmVhdGVNb2NrcyB9IGZyb20gJ25vZGUtbW9ja3MtaHR0cCc7XG5cbi8vIE1vY2sgZGVwZW5kZW5jaWVzXG5qZXN0Lm1vY2soJ0AvbGliL2F1dGgvYWRtaW4tYXV0aCcsICgpID0+ICh7XG4gIGNoZWNrQ1JVRFBlcm1pc3Npb25zOiBqZXN0LmZuKCksXG59KSk7XG5cbmplc3QubW9jaygnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJywgKCkgPT4gKHtcbiAgY3JlYXRlQ2xpZW50OiBqZXN0LmZuKCgpID0+ICh7XG4gICAgZnJvbTogamVzdC5mbigoKSA9PiAoe1xuICAgICAgc2VsZWN0OiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICAgIGVxOiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICAgICAgc2luZ2xlOiBqZXN0LmZuKCksXG4gICAgICAgIH0pKSxcbiAgICAgIH0pKSxcbiAgICAgIHVwZGF0ZTogamVzdC5mbigoKSA9PiAoe1xuICAgICAgICBlcTogamVzdC5mbigoKSA9PiAoe1xuICAgICAgICAgIHNlbGVjdDogamVzdC5mbigoKSA9PiAoe1xuICAgICAgICAgICAgc2luZ2xlOiBqZXN0LmZuKCksXG4gICAgICAgICAgfSkpLFxuICAgICAgICB9KSksXG4gICAgICB9KSksXG4gICAgICBkZWxldGU6IGplc3QuZm4oKCkgPT4gKHtcbiAgICAgICAgZXE6IGplc3QuZm4oKSxcbiAgICAgIH0pKSxcbiAgICB9KSksXG4gIH0pKSxcbn0pKTtcblxuLy8gTW9jayBtaWRkbGV3YXJlXG5qZXN0Lm1vY2soJ0AvbGliL2FwaS9taWRkbGV3YXJlLWNvbXBvc2VyJywgKCkgPT4gKHtcbiAgY29tcG9zZU1pZGRsZXdhcmVzOiBqZXN0LmZuKCguLi5taWRkbGV3YXJlcykgPT4gKGhhbmRsZXIpID0+IGhhbmRsZXIpLFxufSkpO1xuXG5qZXN0Lm1vY2soJ0AvbGliL2FwaS9lcnJvci1oYW5kbGVyJywgKCkgPT4gKHtcbiAgd2l0aEVycm9ySGFuZGxlcjogamVzdC5mbigoaGFuZGxlcikgPT4gaGFuZGxlciksXG4gIEFwaUVycm9yOiBjbGFzcyBBcGlFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcsIHB1YmxpYyBzdGF0dXNDb2RlOiBudW1iZXIgPSA1MDApIHtcbiAgICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgIH1cbiAgfSxcbiAgTm90Rm91bmRFcnJvcjogamVzdC5mbigocmVzb3VyY2UpID0+IG5ldyBFcnJvcihgJHtyZXNvdXJjZX0gbm8gZW5jb250cmFkb2ApKSxcbiAgVmFsaWRhdGlvbkVycm9yOiBqZXN0LmZuKChtZXNzYWdlKSA9PiBuZXcgRXJyb3IobWVzc2FnZSkpLFxufSkpO1xuXG5qZXN0Lm1vY2soJ0AvbGliL2FwaS9hcGktbG9nZ2VyJywgKCkgPT4gKHtcbiAgd2l0aEFwaUxvZ2dpbmc6IGplc3QuZm4oKGhhbmRsZXIpID0+IGhhbmRsZXIpLFxuICBsb2dBZG1pbkFjdGlvbjogamVzdC5mbigpLFxufSkpO1xuXG5qZXN0Lm1vY2soJ0AvbGliL2F1dGgvYXBpLWF1dGgtbWlkZGxld2FyZScsICgpID0+ICh7XG4gIHdpdGhBZG1pbkF1dGg6IGplc3QuZm4oKCkgPT4gKGhhbmRsZXIpID0+IGhhbmRsZXIpLFxufSkpO1xuXG5qZXN0Lm1vY2soJ0AvbGliL3ZhbGlkYXRpb24vYWRtaW4tc2NoZW1hcycsICgpID0+ICh7XG4gIHdpdGhWYWxpZGF0aW9uOiBqZXN0LmZuKCgpID0+IChoYW5kbGVyKSA9PiBoYW5kbGVyKSxcbn0pKTtcblxuZGVzY3JpYmUoJy9hcGkvYWRtaW4vcHJvZHVjdHMvW2lkXSAtIEVudGVycHJpc2UgQVBJIFRlc3RzJywgKCkgPT4ge1xuICBsZXQgbW9ja1N1cGFiYXNlOiBhbnk7XG4gIGxldCBtb2NrUmVxdWVzdDogYW55O1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICAgIFxuICAgIG1vY2tTdXBhYmFzZSA9IHtcbiAgICAgIGZyb206IGplc3QuZm4oKCkgPT4gKHtcbiAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICAgICAgZXE6IGplc3QuZm4oKCkgPT4gKHtcbiAgICAgICAgICAgIHNpbmdsZTogamVzdC5mbigpLFxuICAgICAgICAgIH0pKSxcbiAgICAgICAgfSkpLFxuICAgICAgICB1cGRhdGU6IGplc3QuZm4oKCkgPT4gKHtcbiAgICAgICAgICBlcTogamVzdC5mbigoKSA9PiAoe1xuICAgICAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICAgICAgICAgIHNpbmdsZTogamVzdC5mbigpLFxuICAgICAgICAgICAgfSkpLFxuICAgICAgICAgIH0pKSxcbiAgICAgICAgfSkpLFxuICAgICAgICBkZWxldGU6IGplc3QuZm4oKCkgPT4gKHtcbiAgICAgICAgICBlcTogamVzdC5mbigpLFxuICAgICAgICB9KSksXG4gICAgICB9KSksXG4gICAgfTtcblxuICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgc3VwYWJhc2U6IG1vY2tTdXBhYmFzZSxcbiAgICAgIHVzZXI6IHsgaWQ6ICd0ZXN0LXVzZXItaWQnIH0sXG4gICAgICB2YWxpZGF0ZWREYXRhOiB7fSxcbiAgICB9IGFzIGFueTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0dFVCAvYXBpL2FkbWluL3Byb2R1Y3RzL1tpZF0nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gcHJvZHVjdCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUHJvZHVjdCA9IHtcbiAgICAgICAgaWQ6ICd0ZXN0LXByb2R1Y3QtaWQnLFxuICAgICAgICBuYW1lOiAnVGVzdCBQcm9kdWN0JyxcbiAgICAgICAgcHJpY2U6IDEwMCxcbiAgICAgICAgc3RvY2s6IDEwLFxuICAgICAgICBjYXRlZ29yaWVzOiB7IG5hbWU6ICdUZXN0IENhdGVnb3J5JyB9LFxuICAgICAgfTtcblxuICAgICAgbW9ja1N1cGFiYXNlLmZyb20oKS5zZWxlY3QoKS5lcSgpLnNpbmdsZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IG1vY2tQcm9kdWN0LFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IEdFVChtb2NrUmVxdWVzdCwgeyBwYXJhbXM6IHsgaWQ6ICd0ZXN0LXByb2R1Y3QtaWQnIH0gfSk7XG4gICAgICBjb25zdCByZXNwb25zZURhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZURhdGEuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZURhdGEuZGF0YS5uYW1lKS50b0JlKCdUZXN0IFByb2R1Y3QnKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZURhdGEuZGF0YS5jYXRlZ29yeV9uYW1lKS50b0JlKCdUZXN0IENhdGVnb3J5Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBwcm9kdWN0IG5vdCBmb3VuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tTdXBhYmFzZS5mcm9tKCkuc2VsZWN0KCkuZXEoKS5zaW5nbGUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICBlcnJvcjogeyBtZXNzYWdlOiAnTm90IGZvdW5kJyB9LFxuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgR0VUKG1vY2tSZXF1ZXN0LCB7IHBhcmFtczogeyBpZDogJ25vbi1leGlzdGVudC1pZCcgfSB9KVxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coJ1Byb2R1Y3RvIG5vIGVuY29udHJhZG8nKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgcHJvZHVjdCBJRCBmb3JtYXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIEdFVChtb2NrUmVxdWVzdCwgeyBwYXJhbXM6IHsgaWQ6ICdpbnZhbGlkLXV1aWQnIH0gfSlcbiAgICAgICkucmVqZWN0cy50b1Rocm93KCdJRCBkZSBwcm9kdWN0byBpbnbDoWxpZG8nKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1BVVCAvYXBpL2FkbWluL3Byb2R1Y3RzL1tpZF0nLCAoKSA9PiB7XG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBtb2NrUmVxdWVzdC52YWxpZGF0ZWREYXRhID0ge1xuICAgICAgICBuYW1lOiAnVXBkYXRlZCBQcm9kdWN0JyxcbiAgICAgICAgcHJpY2U6IDE1MCxcbiAgICAgICAgc3RvY2s6IDIwLFxuICAgICAgfTtcblxuICAgICAgLy8gTW9jayBleGlzdGluZyBwcm9kdWN0IGNoZWNrXG4gICAgICBtb2NrU3VwYWJhc2UuZnJvbSgpLnNlbGVjdCgpLmVxKCkuc2luZ2xlXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICAgIGRhdGE6IHsgaWQ6ICd0ZXN0LXByb2R1Y3QtaWQnLCBuYW1lOiAnT3JpZ2luYWwgUHJvZHVjdCcgfSxcbiAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgfSlcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgICAgZGF0YTogeyBpZDogJ2NhdGVnb3J5LWlkJyB9LFxuICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdXBkYXRlIHByb2R1Y3Qgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1VwZGF0ZWRQcm9kdWN0ID0ge1xuICAgICAgICBpZDogJ3Rlc3QtcHJvZHVjdC1pZCcsXG4gICAgICAgIG5hbWU6ICdVcGRhdGVkIFByb2R1Y3QnLFxuICAgICAgICBwcmljZTogMTUwLFxuICAgICAgICBzdG9jazogMjAsXG4gICAgICAgIGNhdGVnb3JpZXM6IHsgbmFtZTogJ1Rlc3QgQ2F0ZWdvcnknIH0sXG4gICAgICB9O1xuXG4gICAgICBtb2NrU3VwYWJhc2UuZnJvbSgpLnVwZGF0ZSgpLmVxKCkuc2VsZWN0KCkuc2luZ2xlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YTogbW9ja1VwZGF0ZWRQcm9kdWN0LFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IFBVVChtb2NrUmVxdWVzdCwgeyBwYXJhbXM6IHsgaWQ6ICd0ZXN0LXByb2R1Y3QtaWQnIH0gfSk7XG4gICAgICBjb25zdCByZXNwb25zZURhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZURhdGEuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZURhdGEuZGF0YS5uYW1lKS50b0JlKCdVcGRhdGVkIFByb2R1Y3QnKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZURhdGEubWVzc2FnZSkudG9CZSgnUHJvZHVjdG8gYWN0dWFsaXphZG8gZXhpdG9zYW1lbnRlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGdlbmVyYXRlIHNsdWcgd2hlbiBuYW1lIGlzIHVwZGF0ZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrUmVxdWVzdC52YWxpZGF0ZWREYXRhLm5hbWUgPSAnTmV3IFByb2R1Y3QgTmFtZSEnO1xuXG4gICAgICBtb2NrU3VwYWJhc2UuZnJvbSgpLnVwZGF0ZSgpLmVxKCkuc2VsZWN0KCkuc2luZ2xlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YTogeyBpZDogJ3Rlc3QtcHJvZHVjdC1pZCcsIHNsdWc6ICduZXctcHJvZHVjdC1uYW1lJyB9LFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBQVVQobW9ja1JlcXVlc3QsIHsgcGFyYW1zOiB7IGlkOiAndGVzdC1wcm9kdWN0LWlkJyB9IH0pO1xuXG4gICAgICBleHBlY3QobW9ja1N1cGFiYXNlLmZyb20oKS51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgc2x1ZzogJ25ldy1wcm9kdWN0LW5hbWUnLFxuICAgICAgICB9KVxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgY2F0ZWdvcnkgZXhpc3RzIHdoZW4gdXBkYXRpbmcgY2F0ZWdvcnlfaWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrUmVxdWVzdC52YWxpZGF0ZWREYXRhLmNhdGVnb3J5X2lkID0gJ2ludmFsaWQtY2F0ZWdvcnktaWQnO1xuXG4gICAgICBtb2NrU3VwYWJhc2UuZnJvbSgpLnNlbGVjdCgpLmVxKCkuc2luZ2xlXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICAgIGRhdGE6IHsgaWQ6ICd0ZXN0LXByb2R1Y3QtaWQnIH0sXG4gICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgIH0pXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgZXJyb3I6IHsgbWVzc2FnZTogJ05vdCBmb3VuZCcgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgUFVUKG1vY2tSZXF1ZXN0LCB7IHBhcmFtczogeyBpZDogJ3Rlc3QtcHJvZHVjdC1pZCcgfSB9KVxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coJ0NhdGVnb3LDrWEgbm8gZW5jb250cmFkYScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZGF0YWJhc2UgdXBkYXRlIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tTdXBhYmFzZS5mcm9tKCkudXBkYXRlKCkuZXEoKS5zZWxlY3QoKS5zaW5nbGUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICBlcnJvcjogeyBtZXNzYWdlOiAnRGF0YWJhc2UgZXJyb3InIH0sXG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBQVVQobW9ja1JlcXVlc3QsIHsgcGFyYW1zOiB7IGlkOiAndGVzdC1wcm9kdWN0LWlkJyB9IH0pXG4gICAgICApLnJlamVjdHMudG9UaHJvdygnRXJyb3IgYWwgYWN0dWFsaXphciBwcm9kdWN0bycpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnREVMRVRFIC9hcGkvYWRtaW4vcHJvZHVjdHMvW2lkXScsICgpID0+IHtcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIC8vIE1vY2sgZXhpc3RpbmcgcHJvZHVjdCBjaGVja1xuICAgICAgbW9ja1N1cGFiYXNlLmZyb20oKS5zZWxlY3QoKS5lcSgpLnNpbmdsZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHsgaWQ6ICd0ZXN0LXByb2R1Y3QtaWQnLCBuYW1lOiAnVGVzdCBQcm9kdWN0JyB9LFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwZXJmb3JtIHNvZnQgZGVsZXRlIHdoZW4gcHJvZHVjdCBoYXMgb3JkZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBvcmRlciBpdGVtcyBjaGVjayAtIHByb2R1Y3QgaGFzIG9yZGVyc1xuICAgICAgbW9ja1N1cGFiYXNlLmZyb20oKS5zZWxlY3QoKS5lcSgpLmxpbWl0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YTogW3sgaWQ6ICdvcmRlci1pdGVtLWlkJyB9XSxcbiAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICB9KTtcblxuICAgICAgLy8gTW9jayBzb2Z0IGRlbGV0ZSB1cGRhdGVcbiAgICAgIG1vY2tTdXBhYmFzZS5mcm9tKCkudXBkYXRlKCkuZXEubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IERFTEVURShtb2NrUmVxdWVzdCwgeyBwYXJhbXM6IHsgaWQ6ICd0ZXN0LXByb2R1Y3QtaWQnIH0gfSk7XG4gICAgICBjb25zdCByZXNwb25zZURhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZURhdGEuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZURhdGEuc29mdF9kZWxldGUpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzcG9uc2VEYXRhLm1lc3NhZ2UpLnRvQ29udGFpbignbWFyY2FkbyBjb21vIGluYWN0aXZvJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHBlcmZvcm0gaGFyZCBkZWxldGUgd2hlbiBwcm9kdWN0IGhhcyBubyBvcmRlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIG9yZGVyIGl0ZW1zIGNoZWNrIC0gbm8gb3JkZXJzXG4gICAgICBtb2NrU3VwYWJhc2UuZnJvbSgpLnNlbGVjdCgpLmVxKCkubGltaXQubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiBbXSxcbiAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICB9KTtcblxuICAgICAgLy8gTW9jayBoYXJkIGRlbGV0ZVxuICAgICAgbW9ja1N1cGFiYXNlLmZyb20oKS5kZWxldGUoKS5lcS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgREVMRVRFKG1vY2tSZXF1ZXN0LCB7IHBhcmFtczogeyBpZDogJ3Rlc3QtcHJvZHVjdC1pZCcgfSB9KTtcbiAgICAgIGNvbnN0IHJlc3BvbnNlRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlRGF0YS5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlRGF0YS5oYXJkX2RlbGV0ZSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZURhdGEubWVzc2FnZSkudG9CZSgnUHJvZHVjdG8gZWxpbWluYWRvIGV4aXRvc2FtZW50ZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZGVsZXRlIGVycm9ycyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1N1cGFiYXNlLmZyb20oKS5zZWxlY3QoKS5lcSgpLmxpbWl0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YTogW10sXG4gICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgfSk7XG5cbiAgICAgIG1vY2tTdXBhYmFzZS5mcm9tKCkuZGVsZXRlKCkuZXEubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBlcnJvcjogeyBtZXNzYWdlOiAnRGVsZXRlIGZhaWxlZCcgfSxcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIERFTEVURShtb2NrUmVxdWVzdCwgeyBwYXJhbXM6IHsgaWQ6ICd0ZXN0LXByb2R1Y3QtaWQnIH0gfSlcbiAgICAgICkucmVqZWN0cy50b1Rocm93KCdFcnJvciBhbCBlbGltaW5hciBwcm9kdWN0bycpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRXJyb3IgSGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgaW52YWxpZCBVVUlEIGZvcm1hdCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgR0VUKG1vY2tSZXF1ZXN0LCB7IHBhcmFtczogeyBpZDogJ25vdC1hLXV1aWQnIH0gfSlcbiAgICAgICkucmVqZWN0cy50b1Rocm93KCdJRCBkZSBwcm9kdWN0byBpbnbDoWxpZG8nKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1pc3NpbmcgcHJvZHVjdCBJRCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgR0VUKG1vY2tSZXF1ZXN0LCB7IHBhcmFtczogeyBpZDogJycgfSB9KVxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coJ0lEIGRlIHByb2R1Y3RvIGludsOhbGlkbycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZGF0YWJhc2UgY29ubmVjdGlvbiBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrU3VwYWJhc2UuZnJvbSgpLnNlbGVjdCgpLmVxKCkuc2luZ2xlLm1vY2tSZWplY3RlZFZhbHVlKFxuICAgICAgICBuZXcgRXJyb3IoJ0RhdGFiYXNlIGNvbm5lY3Rpb24gZmFpbGVkJylcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgR0VUKG1vY2tSZXF1ZXN0LCB7IHBhcmFtczogeyBpZDogJ3Rlc3QtcHJvZHVjdC1pZCcgfSB9KVxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coJ0RhdGFiYXNlIGNvbm5lY3Rpb24gZmFpbGVkJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdBdWRpdCBMb2dnaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgbG9nIHVwZGF0ZSBhY3Rpb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgeyBsb2dBZG1pbkFjdGlvbiB9ID0gcmVxdWlyZSgnQC9saWIvYXBpL2FwaS1sb2dnZXInKTtcbiAgICAgIFxuICAgICAgbW9ja1N1cGFiYXNlLmZyb20oKS5zZWxlY3QoKS5lcSgpLnNpbmdsZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHsgaWQ6ICd0ZXN0LXByb2R1Y3QtaWQnLCBuYW1lOiAnT3JpZ2luYWwnIH0sXG4gICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgfSk7XG5cbiAgICAgIG1vY2tTdXBhYmFzZS5mcm9tKCkudXBkYXRlKCkuZXEoKS5zZWxlY3QoKS5zaW5nbGUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7IGlkOiAndGVzdC1wcm9kdWN0LWlkJywgbmFtZTogJ1VwZGF0ZWQnIH0sXG4gICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IFBVVChtb2NrUmVxdWVzdCwgeyBwYXJhbXM6IHsgaWQ6ICd0ZXN0LXByb2R1Y3QtaWQnIH0gfSk7XG5cbiAgICAgIGV4cGVjdChsb2dBZG1pbkFjdGlvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICd0ZXN0LXVzZXItaWQnLFxuICAgICAgICAnVVBEQVRFJyxcbiAgICAgICAgJ3Byb2R1Y3QnLFxuICAgICAgICAndGVzdC1wcm9kdWN0LWlkJyxcbiAgICAgICAgZXhwZWN0LmFueShPYmplY3QpLFxuICAgICAgICBleHBlY3QuYW55KE9iamVjdClcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGxvZyBkZWxldGUgYWN0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHsgbG9nQWRtaW5BY3Rpb24gfSA9IHJlcXVpcmUoJ0AvbGliL2FwaS9hcGktbG9nZ2VyJyk7XG4gICAgICBcbiAgICAgIG1vY2tTdXBhYmFzZS5mcm9tKCkuc2VsZWN0KCkuZXEoKS5saW1pdC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IFtdLFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICBtb2NrU3VwYWJhc2UuZnJvbSgpLmRlbGV0ZSgpLmVxLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgREVMRVRFKG1vY2tSZXF1ZXN0LCB7IHBhcmFtczogeyBpZDogJ3Rlc3QtcHJvZHVjdC1pZCcgfSB9KTtcblxuICAgICAgZXhwZWN0KGxvZ0FkbWluQWN0aW9uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJ3Rlc3QtdXNlci1pZCcsXG4gICAgICAgICdERUxFVEUnLFxuICAgICAgICAncHJvZHVjdCcsXG4gICAgICAgICd0ZXN0LXByb2R1Y3QtaWQnLFxuICAgICAgICBleHBlY3QuYW55KE9iamVjdCksXG4gICAgICAgIG51bGxcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwibmFtZXMiOlsiamVzdCIsIm1vY2siLCJjaGVja0NSVURQZXJtaXNzaW9ucyIsImZuIiwiY3JlYXRlQ2xpZW50IiwiZnJvbSIsInNlbGVjdCIsImVxIiwic2luZ2xlIiwidXBkYXRlIiwiZGVsZXRlIiwiY29tcG9zZU1pZGRsZXdhcmVzIiwibWlkZGxld2FyZXMiLCJoYW5kbGVyIiwid2l0aEVycm9ySGFuZGxlciIsIkFwaUVycm9yIiwiRXJyb3IiLCJjb25zdHJ1Y3RvciIsIm1lc3NhZ2UiLCJzdGF0dXNDb2RlIiwiTm90Rm91bmRFcnJvciIsInJlc291cmNlIiwiVmFsaWRhdGlvbkVycm9yIiwid2l0aEFwaUxvZ2dpbmciLCJsb2dBZG1pbkFjdGlvbiIsIndpdGhBZG1pbkF1dGgiLCJ3aXRoVmFsaWRhdGlvbiIsImRlc2NyaWJlIiwibW9ja1N1cGFiYXNlIiwibW9ja1JlcXVlc3QiLCJiZWZvcmVFYWNoIiwiY2xlYXJBbGxNb2NrcyIsInN1cGFiYXNlIiwidXNlciIsImlkIiwidmFsaWRhdGVkRGF0YSIsIml0IiwibW9ja1Byb2R1Y3QiLCJuYW1lIiwicHJpY2UiLCJzdG9jayIsImNhdGVnb3JpZXMiLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsImRhdGEiLCJlcnJvciIsInJlc3BvbnNlIiwiR0VUIiwicGFyYW1zIiwicmVzcG9uc2VEYXRhIiwianNvbiIsImV4cGVjdCIsInN0YXR1cyIsInRvQmUiLCJzdWNjZXNzIiwiY2F0ZWdvcnlfbmFtZSIsInJlamVjdHMiLCJ0b1Rocm93IiwibW9ja1Jlc29sdmVkVmFsdWVPbmNlIiwibW9ja1VwZGF0ZWRQcm9kdWN0IiwiUFVUIiwic2x1ZyIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIiwib2JqZWN0Q29udGFpbmluZyIsImNhdGVnb3J5X2lkIiwibGltaXQiLCJERUxFVEUiLCJzb2Z0X2RlbGV0ZSIsInRvQ29udGFpbiIsImhhcmRfZGVsZXRlIiwibW9ja1JlamVjdGVkVmFsdWUiLCJyZXF1aXJlIiwiYW55IiwiT2JqZWN0Il0sIm1hcHBpbmdzIjoiQUFBQSxvREFBb0Q7O0FBTXBELG9CQUFvQjtBQUNwQkEsS0FBS0MsSUFBSSxDQUFDLHlCQUF5QixJQUFPLENBQUE7UUFDeENDLHNCQUFzQkYsS0FBS0csRUFBRTtJQUMvQixDQUFBO0FBRUFILEtBQUtDLElBQUksQ0FBQyx5QkFBeUIsSUFBTyxDQUFBO1FBQ3hDRyxjQUFjSixLQUFLRyxFQUFFLENBQUMsSUFBTyxDQUFBO2dCQUMzQkUsTUFBTUwsS0FBS0csRUFBRSxDQUFDLElBQU8sQ0FBQTt3QkFDbkJHLFFBQVFOLEtBQUtHLEVBQUUsQ0FBQyxJQUFPLENBQUE7Z0NBQ3JCSSxJQUFJUCxLQUFLRyxFQUFFLENBQUMsSUFBTyxDQUFBO3dDQUNqQkssUUFBUVIsS0FB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