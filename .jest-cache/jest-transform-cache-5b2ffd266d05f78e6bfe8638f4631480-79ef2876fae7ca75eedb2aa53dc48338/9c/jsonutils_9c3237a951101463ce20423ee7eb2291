b2260bb3bf2fa9013e5c422d62f0c24c
/**
 * Utilidades para manejo seguro de JSON
 * Previene errores de parsing con datos corruptos o malformados
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    STORAGE_KEYS: function() {
        return STORAGE_KEYS;
    },
    cleanCorruptedLocalStorage: function() {
        return cleanCorruptedLocalStorage;
    },
    initializeJsonSafety: function() {
        return initializeJsonSafety;
    },
    safeApiResponseJson: function() {
        return safeApiResponseJson;
    },
    safeJsonParse: function() {
        return safeJsonParse;
    },
    safeJsonStringify: function() {
        return safeJsonStringify;
    },
    safeLocalStorageGet: function() {
        return safeLocalStorageGet;
    },
    safeLocalStorageSet: function() {
        return safeLocalStorageSet;
    }
});
function safeJsonParse(jsonString) {
    // Validaciones b√°sicas
    if (!jsonString) {
        return {
            success: false,
            data: null,
            error: 'JSON string is null or undefined'
        };
    }
    // Limpiar string
    const trimmed = jsonString.trim();
    // Detectar casos problem√°ticos
    if (trimmed === '' || trimmed === '""' || trimmed === "''" || trimmed === 'null' || trimmed === 'undefined') {
        return {
            success: false,
            data: null,
            error: 'JSON string is empty or invalid'
        };
    }
    // Detectar comillas dobles corruptas
    if (trimmed.includes('""') && trimmed.length < 5) {
        return {
            success: false,
            data: null,
            error: 'Detected corrupted JSON with empty quotes'
        };
    }
    // Intentar parsear
    try {
        const parsed = JSON.parse(trimmed);
        return {
            success: true,
            data: parsed,
            error: undefined
        };
    } catch (error) {
        return {
            success: false,
            data: null,
            error: error instanceof Error ? error.message : 'Unknown JSON parse error'
        };
    }
}
function safeJsonStringify(data, space) {
    try {
        const result = JSON.stringify(data, null, space);
        return {
            success: true,
            data: result,
            error: undefined
        };
    } catch (error) {
        // Intentar con replacer para objetos circulares
        try {
            const seen = new WeakSet();
            const result = JSON.stringify(data, (key, value)=>{
                if (typeof value === 'object' && value !== null) {
                    if (seen.has(value)) {
                        return '[Circular Reference]';
                    }
                    seen.add(value);
                }
                return value;
            }, space);
            return {
                success: true,
                data: result,
                error: undefined
            };
        } catch (fallbackError) {
            return {
                success: false,
                data: null,
                error: fallbackError instanceof Error ? fallbackError.message : 'Unknown JSON stringify error'
            };
        }
    }
}
function safeLocalStorageGet(key) {
    if (typeof window === 'undefined') {
        return {
            success: false,
            data: null,
            error: 'localStorage not available (SSR)'
        };
    }
    try {
        const stored = localStorage.getItem(key);
        if (!stored) {
            return {
                success: false,
                data: null,
                error: 'No data found in localStorage'
            };
        }
        return safeJsonParse(stored);
    } catch (error) {
        return {
            success: false,
            data: null,
            error: error instanceof Error ? error.message : 'localStorage access error'
        };
    }
}
function safeLocalStorageSet(key, data) {
    if (typeof window === 'undefined') {
        return {
            success: false,
            data: false,
            error: 'localStorage not available (SSR)'
        };
    }
    try {
        const stringifyResult = safeJsonStringify(data);
        if (!stringifyResult.success) {
            return {
                success: false,
                data: false,
                error: `Failed to stringify data: ${stringifyResult.error}`
            };
        }
        localStorage.setItem(key, stringifyResult.data);
        return {
            success: true,
            data: true,
            error: undefined
        };
    } catch (error) {
        return {
            success: false,
            data: false,
            error: error instanceof Error ? error.message : 'localStorage write error'
        };
    }
}
function cleanCorruptedLocalStorage(keys) {
    if (typeof window === 'undefined') {
        return 0;
    }
    let cleanedCount = 0;
    keys.forEach((key)=>{
        try {
            const stored = localStorage.getItem(key);
            if (stored) {
                const parseResult = safeJsonParse(stored);
                if (!parseResult.success) {
                    console.warn(`Cleaning corrupted localStorage key: ${key}`, parseResult.error);
                    localStorage.removeItem(key);
                    cleanedCount++;
                }
            }
        } catch (error) {
            console.warn(`Error checking localStorage key ${key}:`, error);
            localStorage.removeItem(key);
            cleanedCount++;
        }
    });
    return cleanedCount;
}
async function safeApiResponseJson(response) {
    const DEBUG_MODE = process.env.NODE_ENV === 'development';
    try {
        if (DEBUG_MODE) {}
        // Verificar que la respuesta sea v√°lida
        if (!response.ok) {
            // Try to get error details from response body
            let errorDetails = '';
            try {
                const errorText = await response.text();
                if (DEBUG_MODE) {}
                errorDetails = errorText ? ` - ${errorText}` : '';
            } catch (textError) {
                if (DEBUG_MODE) {
                    console.warn('Could not read error response body:', textError);
                }
            }
            return {
                success: false,
                data: null,
                error: `HTTP ${response.status}: ${response.statusText}${errorDetails}`
            };
        }
        // Obtener el texto primero
        const text = await response.text();
        if (DEBUG_MODE) {
            console.log('üìÑ Response text preview:', text.substring(0, 200) + (text.length > 200 ? '...' : ''));
        }
        // Parsear de forma segura
        const parseResult = safeJsonParse(text);
        if (DEBUG_MODE) {}
        return parseResult;
    } catch (error) {
        console.error('‚ùå safeApiResponseJson error:', error);
        return {
            success: false,
            data: null,
            error: error instanceof Error ? error.message : 'API response error'
        };
    }
}
const STORAGE_KEYS = {
    CART: 'pinteya-cart',
    RECENT_SEARCHES: 'pinteya-recent-searches',
    USER_PREFERENCES: 'pinteya-user-preferences',
    ANALYTICS: 'pinteya-analytics'
};
function initializeJsonSafety() {
    if (typeof window === 'undefined') return;
    const keysToCheck = Object.values(STORAGE_KEYS);
    const cleanedCount = cleanCorruptedLocalStorage(keysToCheck);
    if (cleanedCount > 0) {}
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFydGlcXERlc2t0b3BcXERFU0FSUk9MTE9TV1xcQk9JTEVSUExBVFRFIEUtQ09NTUVSQ0VcXHNyY1xcbGliXFxqc29uLXV0aWxzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVXRpbGlkYWRlcyBwYXJhIG1hbmVqbyBzZWd1cm8gZGUgSlNPTlxuICogUHJldmllbmUgZXJyb3JlcyBkZSBwYXJzaW5nIGNvbiBkYXRvcyBjb3JydXB0b3MgbyBtYWxmb3JtYWRvc1xuICovXG5cbmV4cG9ydCBpbnRlcmZhY2UgU2FmZUpzb25SZXN1bHQ8VD4ge1xuICBzdWNjZXNzOiBib29sZWFuO1xuICBkYXRhOiBUIHwgbnVsbDtcbiAgZXJyb3I/OiBzdHJpbmc7XG59XG5cbi8qKlxuICogUGFyc2VhIEpTT04gZGUgZm9ybWEgc2VndXJhLCBtYW5lamFuZG8gY2Fzb3MgZWRnZSB5IGRhdG9zIGNvcnJ1cHRvc1xuICovXG5leHBvcnQgZnVuY3Rpb24gc2FmZUpzb25QYXJzZTxUID0gYW55Pihqc29uU3RyaW5nOiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkKTogU2FmZUpzb25SZXN1bHQ8VD4ge1xuICAvLyBWYWxpZGFjaW9uZXMgYsOhc2ljYXNcbiAgaWYgKCFqc29uU3RyaW5nKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZGF0YTogbnVsbCxcbiAgICAgIGVycm9yOiAnSlNPTiBzdHJpbmcgaXMgbnVsbCBvciB1bmRlZmluZWQnXG4gICAgfTtcbiAgfVxuXG4gIC8vIExpbXBpYXIgc3RyaW5nXG4gIGNvbnN0IHRyaW1tZWQgPSBqc29uU3RyaW5nLnRyaW0oKTtcbiAgXG4gIC8vIERldGVjdGFyIGNhc29zIHByb2JsZW3DoXRpY29zXG4gIGlmICh0cmltbWVkID09PSAnJyB8fCB0cmltbWVkID09PSAnXCJcIicgfHwgdHJpbW1lZCA9PT0gXCInJ1wiIHx8IHRyaW1tZWQgPT09ICdudWxsJyB8fCB0cmltbWVkID09PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGRhdGE6IG51bGwsXG4gICAgICBlcnJvcjogJ0pTT04gc3RyaW5nIGlzIGVtcHR5IG9yIGludmFsaWQnXG4gICAgfTtcbiAgfVxuXG4gIC8vIERldGVjdGFyIGNvbWlsbGFzIGRvYmxlcyBjb3JydXB0YXNcbiAgaWYgKHRyaW1tZWQuaW5jbHVkZXMoJ1wiXCInKSAmJiB0cmltbWVkLmxlbmd0aCA8IDUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBkYXRhOiBudWxsLFxuICAgICAgZXJyb3I6ICdEZXRlY3RlZCBjb3JydXB0ZWQgSlNPTiB3aXRoIGVtcHR5IHF1b3RlcydcbiAgICB9O1xuICB9XG5cbiAgLy8gSW50ZW50YXIgcGFyc2VhclxuICB0cnkge1xuICAgIGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UodHJpbW1lZCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiBwYXJzZWQsXG4gICAgICBlcnJvcjogdW5kZWZpbmVkXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBkYXRhOiBudWxsLFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gSlNPTiBwYXJzZSBlcnJvcidcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogU3RyaW5naWZ5IEpTT04gZGUgZm9ybWEgc2VndXJhLCBtYW5lamFuZG8gb2JqZXRvcyBjaXJjdWxhcmVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzYWZlSnNvblN0cmluZ2lmeShkYXRhOiBhbnksIHNwYWNlPzogbnVtYmVyKTogU2FmZUpzb25SZXN1bHQ8c3RyaW5nPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgc3BhY2UpO1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YTogcmVzdWx0LFxuICAgICAgZXJyb3I6IHVuZGVmaW5lZFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgLy8gSW50ZW50YXIgY29uIHJlcGxhY2VyIHBhcmEgb2JqZXRvcyBjaXJjdWxhcmVzXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNlZW4gPSBuZXcgV2Vha1NldCgpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gSlNPTi5zdHJpbmdpZnkoZGF0YSwgKGtleSwgdmFsdWUpID0+IHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGwpIHtcbiAgICAgICAgICBpZiAoc2Vlbi5oYXModmFsdWUpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ1tDaXJjdWxhciBSZWZlcmVuY2VdJztcbiAgICAgICAgICB9XG4gICAgICAgICAgc2Vlbi5hZGQodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH0sIHNwYWNlKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogcmVzdWx0LFxuICAgICAgICBlcnJvcjogdW5kZWZpbmVkXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGZhbGxiYWNrRXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICBlcnJvcjogZmFsbGJhY2tFcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZmFsbGJhY2tFcnJvci5tZXNzYWdlIDogJ1Vua25vd24gSlNPTiBzdHJpbmdpZnkgZXJyb3InXG4gICAgICB9O1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIENhcmdhIGRhdG9zIGRlIGxvY2FsU3RvcmFnZSBkZSBmb3JtYSBzZWd1cmFcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNhZmVMb2NhbFN0b3JhZ2VHZXQ8VCA9IGFueT4oa2V5OiBzdHJpbmcpOiBTYWZlSnNvblJlc3VsdDxUPiB7XG4gIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGRhdGE6IG51bGwsXG4gICAgICBlcnJvcjogJ2xvY2FsU3RvcmFnZSBub3QgYXZhaWxhYmxlIChTU1IpJ1xuICAgIH07XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IHN0b3JlZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSk7XG4gICAgaWYgKCFzdG9yZWQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICBlcnJvcjogJ05vIGRhdGEgZm91bmQgaW4gbG9jYWxTdG9yYWdlJ1xuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4gc2FmZUpzb25QYXJzZTxUPihzdG9yZWQpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGRhdGE6IG51bGwsXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnbG9jYWxTdG9yYWdlIGFjY2VzcyBlcnJvcidcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogR3VhcmRhIGRhdG9zIGVuIGxvY2FsU3RvcmFnZSBkZSBmb3JtYSBzZWd1cmFcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNhZmVMb2NhbFN0b3JhZ2VTZXQoa2V5OiBzdHJpbmcsIGRhdGE6IGFueSk6IFNhZmVKc29uUmVzdWx0PGJvb2xlYW4+IHtcbiAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZGF0YTogZmFsc2UsXG4gICAgICBlcnJvcjogJ2xvY2FsU3RvcmFnZSBub3QgYXZhaWxhYmxlIChTU1IpJ1xuICAgIH07XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IHN0cmluZ2lmeVJlc3VsdCA9IHNhZmVKc29uU3RyaW5naWZ5KGRhdGEpO1xuICAgIGlmICghc3RyaW5naWZ5UmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBkYXRhOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IGBGYWlsZWQgdG8gc3RyaW5naWZ5IGRhdGE6ICR7c3RyaW5naWZ5UmVzdWx0LmVycm9yfWBcbiAgICAgIH07XG4gICAgfVxuXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBzdHJpbmdpZnlSZXN1bHQuZGF0YSEpO1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YTogdHJ1ZSxcbiAgICAgIGVycm9yOiB1bmRlZmluZWRcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGRhdGE6IGZhbHNlLFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ2xvY2FsU3RvcmFnZSB3cml0ZSBlcnJvcidcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogTGltcGlhIGxvY2FsU3RvcmFnZSBkZSBkYXRvcyBjb3JydXB0b3NcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNsZWFuQ29ycnVwdGVkTG9jYWxTdG9yYWdlKGtleXM6IHN0cmluZ1tdKTogbnVtYmVyIHtcbiAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgcmV0dXJuIDA7XG4gIH1cblxuICBsZXQgY2xlYW5lZENvdW50ID0gMDtcblxuICBrZXlzLmZvckVhY2goa2V5ID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3RvcmVkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KTtcbiAgICAgIGlmIChzdG9yZWQpIHtcbiAgICAgICAgY29uc3QgcGFyc2VSZXN1bHQgPSBzYWZlSnNvblBhcnNlKHN0b3JlZCk7XG4gICAgICAgIGlmICghcGFyc2VSZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgIGNvbnNvbGUud2FybihgQ2xlYW5pbmcgY29ycnVwdGVkIGxvY2FsU3RvcmFnZSBrZXk6ICR7a2V5fWAsIHBhcnNlUmVzdWx0LmVycm9yKTtcbiAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xuICAgICAgICAgIGNsZWFuZWRDb3VudCsrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybihgRXJyb3IgY2hlY2tpbmcgbG9jYWxTdG9yYWdlIGtleSAke2tleX06YCwgZXJyb3IpO1xuICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTtcbiAgICAgIGNsZWFuZWRDb3VudCsrO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIGNsZWFuZWRDb3VudDtcbn1cblxuLyoqXG4gKiBWYWxpZGEgcXVlIHVuYSByZXNwdWVzdGEgZGUgQVBJIHRlbmdhIEpTT04gdsOhbGlkb1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2FmZUFwaVJlc3BvbnNlSnNvbjxUID0gYW55PihyZXNwb25zZTogUmVzcG9uc2UpOiBQcm9taXNlPFNhZmVKc29uUmVzdWx0PFQ+PiB7XG4gIGNvbnN0IERFQlVHX01PREUgPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JztcblxuICB0cnkge1xuICAgIGlmIChERUJVR19NT0RFKSB7XG4gICAgfVxuXG4gICAgLy8gVmVyaWZpY2FyIHF1ZSBsYSByZXNwdWVzdGEgc2VhIHbDoWxpZGFcbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAvLyBUcnkgdG8gZ2V0IGVycm9yIGRldGFpbHMgZnJvbSByZXNwb25zZSBib2R5XG4gICAgICBsZXQgZXJyb3JEZXRhaWxzID0gJyc7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBlcnJvclRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICAgIGlmIChERUJVR19NT0RFKSB7XG4gICAgICAgIH1cbiAgICAgICAgZXJyb3JEZXRhaWxzID0gZXJyb3JUZXh0ID8gYCAtICR7ZXJyb3JUZXh0fWAgOiAnJztcbiAgICAgIH0gY2F0Y2ggKHRleHRFcnJvcikge1xuICAgICAgICBpZiAoREVCVUdfTU9ERSkge1xuICAgICAgICAgIGNvbnNvbGUud2FybignQ291bGQgbm90IHJlYWQgZXJyb3IgcmVzcG9uc2UgYm9keTonLCB0ZXh0RXJyb3IpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICBlcnJvcjogYEhUVFAgJHtyZXNwb25zZS5zdGF0dXN9OiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9JHtlcnJvckRldGFpbHN9YFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBPYnRlbmVyIGVsIHRleHRvIHByaW1lcm9cbiAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgIGlmIChERUJVR19NT0RFKSB7XG4gICAgICBjb25zb2xlLmxvZygn8J+ThCBSZXNwb25zZSB0ZXh0IHByZXZpZXc6JywgdGV4dC5zdWJzdHJpbmcoMCwgMjAwKSArICh0ZXh0Lmxlbmd0aCA+IDIwMCA/ICcuLi4nIDogJycpKTtcbiAgICB9XG5cbiAgICAvLyBQYXJzZWFyIGRlIGZvcm1hIHNlZ3VyYVxuICAgIGNvbnN0IHBhcnNlUmVzdWx0ID0gc2FmZUpzb25QYXJzZTxUPih0ZXh0KTtcbiAgICBpZiAoREVCVUdfTU9ERSkge1xuICAgIH1cblxuICAgIHJldHVybiBwYXJzZVJlc3VsdDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfinYwgc2FmZUFwaVJlc3BvbnNlSnNvbiBlcnJvcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZGF0YTogbnVsbCxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdBUEkgcmVzcG9uc2UgZXJyb3InXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIENvbnN0YW50ZXMgcGFyYSBrZXlzIGRlIGxvY2FsU3RvcmFnZSBjb211bmVzXG4gKi9cbmV4cG9ydCBjb25zdCBTVE9SQUdFX0tFWVMgPSB7XG4gIENBUlQ6ICdwaW50ZXlhLWNhcnQnLFxuICBSRUNFTlRfU0VBUkNIRVM6ICdwaW50ZXlhLXJlY2VudC1zZWFyY2hlcycsXG4gIFVTRVJfUFJFRkVSRU5DRVM6ICdwaW50ZXlhLXVzZXItcHJlZmVyZW5jZXMnLFxuICBBTkFMWVRJQ1M6ICdwaW50ZXlhLWFuYWx5dGljcycsXG59IGFzIGNvbnN0O1xuXG4vKipcbiAqIEZ1bmNpw7NuIGRlIGluaWNpYWxpemFjacOzbiBwYXJhIGxpbXBpYXIgbG9jYWxTdG9yYWdlIGNvcnJ1cHRvIGFsIGNhcmdhciBsYSBhcHBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluaXRpYWxpemVKc29uU2FmZXR5KCk6IHZvaWQge1xuICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHJldHVybjtcblxuICBjb25zdCBrZXlzVG9DaGVjayA9IE9iamVjdC52YWx1ZXMoU1RPUkFHRV9LRVlTKTtcbiAgY29uc3QgY2xlYW5lZENvdW50ID0gY2xlYW5Db3JydXB0ZWRMb2NhbFN0b3JhZ2Uoa2V5c1RvQ2hlY2spO1xuICBcbiAgaWYgKGNsZWFuZWRDb3VudCA+IDApIHtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIlNUT1JBR0VfS0VZUyIsImNsZWFuQ29ycnVwdGVkTG9jYWxTdG9yYWdlIiwiaW5pdGlhbGl6ZUpzb25TYWZldHkiLCJzYWZlQXBpUmVzcG9uc2VKc29uIiwic2FmZUpzb25QYXJzZSIsInNhZmVKc29uU3RyaW5naWZ5Iiwic2FmZUxvY2FsU3RvcmFnZUdldCIsInNhZmVMb2NhbFN0b3JhZ2VTZXQiLCJqc29uU3RyaW5nIiwic3VjY2VzcyIsImRhdGEiLCJlcnJvciIsInRyaW1tZWQiLCJ0cmltIiwiaW5jbHVkZXMiLCJsZW5ndGgiLCJwYXJzZWQiLCJKU09OIiwicGFyc2UiLCJ1bmRlZmluZWQiLCJFcnJvciIsIm1lc3NhZ2UiLCJzcGFjZSIsInJlc3VsdCIsInN0cmluZ2lmeSIsInNlZW4iLCJXZWFrU2V0Iiwia2V5IiwidmFsdWUiLCJoYXMiLCJhZGQiLCJmYWxsYmFja0Vycm9yIiwid2luZG93Iiwic3RvcmVkIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsInN0cmluZ2lmeVJlc3VsdCIsInNldEl0ZW0iLCJrZXlzIiwiY2xlYW5lZENvdW50IiwiZm9yRWFjaCIsInBhcnNlUmVzdWx0IiwiY29uc29sZSIsIndhcm4iLCJyZW1vdmVJdGVtIiwicmVzcG9uc2UiLCJERUJVR19NT0RFIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwib2siLCJlcnJvckRldGFpbHMiLCJlcnJvclRleHQiLCJ0ZXh0IiwidGV4dEVycm9yIiwic3RhdHVzIiwic3RhdHVzVGV4dCIsImxvZyIsInN1YnN0cmluZyIsIkNBUlQiLCJSRUNFTlRfU0VBUkNIRVMiLCJVU0VSX1BSRUZFUkVOQ0VTIiwiQU5BTFlUSUNTIiwia2V5c1RvQ2hlY2siLCJPYmplY3QiLCJ2YWx1ZXMiXSwibWFwcGluZ3MiOiJBQUFBOzs7Q0FHQzs7Ozs7Ozs7Ozs7SUFnUVlBLFlBQVk7ZUFBWkE7O0lBckZHQywwQkFBMEI7ZUFBMUJBOztJQStGQUMsb0JBQW9CO2VBQXBCQTs7SUFoRU1DLG1CQUFtQjtlQUFuQkE7O0lBL0xOQyxhQUFhO2VBQWJBOztJQW1EQUMsaUJBQWlCO2VBQWpCQTs7SUF3Q0FDLG1CQUFt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