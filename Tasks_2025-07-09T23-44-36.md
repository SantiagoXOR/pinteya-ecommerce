[ ] NAME:Current Task List DESCRIPTION:Root task for conversation __NEW_AGENT__
-[ ] NAME:Optimización MercadoPago Checkout Pro - Pinteya E-commerce DESCRIPTION:Implementar mejores prácticas oficiales de MercadoPago para mejorar UX, seguridad y configuración avanzada basado en análisis comparativo completo.
--[x] NAME:FASE 1: Mejoras Críticas (1-2 días) DESCRIPTION:Implementar las mejoras más críticas que impactan directamente en UX y seguridad. Duración estimada: 16 horas.
---[x] NAME:Implementar Wallet Brick de MercadoPago DESCRIPTION:Crear componente MercadoPagoWallet.tsx con SDK JavaScript, reemplazar redirección directa por Wallet Brick integrado. Archivos: src/components/Checkout/MercadoPagoWallet.tsx, src/hooks/useCheckout.ts. Tiempo: 8h
---[x] NAME:Configurar Métodos de Pago Avanzados DESCRIPTION:Agregar configuración payment_methods con exclusiones, cuotas máximas, métodos preferidos. Archivos: src/lib/mercadopago.ts, src/app/api/payments/create-preference/route.ts. Tiempo: 4h
---[x] NAME:Implementar IdempotencyKey Dinámico DESCRIPTION:Reemplazar clave estática 'abc' por UUID único por transacción. Crear función createMercadoPagoClient. Archivos: src/lib/mercadopago.ts. Tiempo: 2h
---[x] NAME:Habilitar Auto Return en Producción DESCRIPTION:Configurar auto_return condicionalmente según entorno (development/production). Archivos: src/lib/mercadopago.ts. Tiempo: 2h
--[x] NAME:FASE 2: Mejoras Importantes (3-5 días) DESCRIPTION:Implementar mejoras de seguridad, configuración avanzada y logging. Duración estimada: 24 horas.
---[x] NAME:Mejorar Validación de Webhook Signature DESCRIPTION:Implementar validación robusta de firma de webhook, configurar MERCADOPAGO_WEBHOOK_SECRET, habilitar validación en todos los entornos. Archivos: src/app/api/payments/webhook/route.ts. Tiempo: 8h
---[x] NAME:Configurar Expiración de Preferencias DESCRIPTION:Agregar configuración expires: true y expiration_date_to (24-48h). Archivos: src/lib/mercadopago.ts. Tiempo: 4h
---[x] NAME:Implementar Logging Estructurado DESCRIPTION:Crear sistema de logging estructurado para transacciones, errores y métricas. Archivos: src/lib/logger.ts, APIs de pagos. Tiempo: 8h
---[x] NAME:Testing y Validación Fase 2 DESCRIPTION:Probar todas las mejoras implementadas, validar seguridad, logging y configuraciones. Tiempo: 4h
--[ ] NAME:FASE 3: Optimizaciones Avanzadas (1-2 semanas) DESCRIPTION:Implementar optimizaciones de performance, monitoreo y funcionalidades avanzadas. Duración estimada: 32 horas.
---[ ] NAME:Implementar Rate Limiting DESCRIPTION:Agregar protección contra abuso en APIs de pagos con rate limiting por IP. Archivos: src/middleware/rateLimiting.ts, APIs. Tiempo: 8h
---[ ] NAME:Implementar Retry Logic DESCRIPTION:Agregar lógica de reintentos con backoff exponencial para llamadas a MercadoPago. Archivos: src/lib/mercadopago.ts. Tiempo: 8h
---[ ] NAME:Monitoreo y Métricas Avanzadas DESCRIPTION:Implementar dashboard de métricas de conversión, errores de pago, tiempos de respuesta. Archivos: src/lib/analytics.ts. Tiempo: 8h
---[ ] NAME:Optimizaciones de Performance DESCRIPTION:Cache de preferencias, optimización de queries, lazy loading de componentes. Tiempo: 8h
--[x] NAME:PREPARACIÓN: Tareas Previas a la Implementación DESCRIPTION:Tareas preparatorias necesarias antes de comenzar las mejoras de MercadoPago. Configuración de entorno, dependencias y validaciones.
---[x] NAME:Instalar Dependencias Necesarias DESCRIPTION:Instalar uuid para IdempotencyKey dinámico: npm install uuid @types/uuid. Verificar versión actual de mercadopago SDK. Tiempo: 1h
---[x] NAME:Configurar Variables de Entorno DESCRIPTION:Agregar MERCADOPAGO_WEBHOOK_SECRET al .env.local y .env.example. Verificar NEXT_PUBLIC_MERCADOPAGO_PUBLIC_KEY. Tiempo: 1h
---[x] NAME:Backup de Implementación Actual DESCRIPTION:Crear backup de archivos que se modificarán: src/lib/mercadopago.ts, src/hooks/useCheckout.ts, APIs de pagos. Tiempo: 0.5h
---[x] NAME:Validar Credenciales de MercadoPago DESCRIPTION:Ejecutar tests existentes, verificar que credenciales actuales funcionan correctamente antes de modificaciones. Tiempo: 1h